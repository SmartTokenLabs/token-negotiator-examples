(self.webpackChunkAngular_bare_bones_demo=self.webpackChunkAngular_bare_bones_demo||[]).push([[255],{4255:(Jn,un,sr)=>{"use strict";sr.r(un),sr.d(un,{CUSTOM_RPCS_FOR_WC_V2:()=>Bt,WC_V2_CHAINS:()=>Zn,getWalletConnectV2ProviderInstance:()=>Qn});var x=sr(9899),vr=sr.n(x),Bt={1:"https://ethereum.publicnode.com",5:"https://eth-goerli.g.alchemy.com/v2/yVhq9zPJorAWsw-F87fEabSUl7cCU6z4",137:"https://polygon-rpc.com/",80001:"https://polygon-mumbai.g.alchemy.com/v2/rVI6pOV4irVsrw20cJxc1fxK_1cSeiY0",56:"https://bsc-dataseed.binance.org/",43114:"https://api.avax.network/ext/bc/C/rpc",250:"https://rpc.fantom.network/",25:"https://evm-cronos.crypto.org",42161:"https://arb1.arbitrum.io/rpc",10:"https://mainnet.optimism.io"},Zn=["eip155:1","eip155:137","eip155:250","eip155:25","eip155:42161","eip155:10"],Qn=function(){return Xt=void 0,_r=void 0,vt=function(){return function(Xt,_r){var vt,_t,fe,Be,Pe={label:0,sent:function(){if(1&fe[0])throw fe[1];return fe[1]},trys:[],ops:[]};return Be={next:Pt(0),throw:Pt(1),return:Pt(2)},"function"==typeof Symbol&&(Be[Symbol.iterator]=function(){return this}),Be;function Pt(ye){return function(ht){return function Nr(ye){if(vt)throw new TypeError("Generator is already executing.");for(;Be&&(Be=0,ye[0]&&(Pe=0)),Pe;)try{if(vt=1,_t&&(fe=2&ye[0]?_t.return:ye[0]?_t.throw||((fe=_t.return)&&fe.call(_t),0):_t.next)&&!(fe=fe.call(_t,ye[1])).done)return fe;switch(_t=0,fe&&(ye=[2&ye[0],fe.value]),ye[0]){case 0:case 1:fe=ye;break;case 4:return Pe.label++,{value:ye[1],done:!1};case 5:Pe.label++,_t=ye[1],ye=[0];continue;case 7:ye=Pe.ops.pop(),Pe.trys.pop();continue;default:if(!(fe=(fe=Pe.trys).length>0&&fe[fe.length-1])&&(6===ye[0]||2===ye[0])){Pe=0;continue}if(3===ye[0]&&(!fe||ye[1]>fe[0]&&ye[1]<fe[3])){Pe.label=ye[1];break}if(6===ye[0]&&Pe.label<fe[1]){Pe.label=fe[1],fe=ye;break}if(fe&&Pe.label<fe[2]){Pe.label=fe[2],Pe.ops.push(ye);break}fe[2]&&Pe.ops.pop(),Pe.trys.pop();continue}ye=_r.call(Xt,Pe)}catch(ht){ye=[6,ht],_t=0}finally{vt=fe=0}if(5&ye[0])throw ye[1];return{value:ye[0]?ye[1]:void 0,done:!0}}([ye,ht])}}}(this,function(Xt){switch(Xt.label){case 0:return[4,vr().init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,Xt.sent()]}})},new((Pe=void 0)||(Pe=Promise))(function(fe,Be){function Pt(ht){try{ye(vt.next(ht))}catch(Ct){Be(Ct)}}function Nr(ht){try{ye(vt.throw(ht))}catch(Ct){Be(Ct)}}function ye(ht){ht.done?fe(ht.value):function _t(fe){return fe instanceof Pe?fe:new Pe(function(Be){Be(fe)})}(ht.value).then(Pt,Nr)}ye((vt=vt.apply(Xt,_r||[])).next())});var Xt,_r,Pe,vt}},9899:function(Jn,un,sr){var x=sr(1052).default;!function(vr){"use strict";var gt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bt(t){var e=t.default;if("function"==typeof e){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function Zn(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}const _r=function Xt(t,e,r){var n=r&&r.stringify||Zn;if("object"==typeof t&&null!==t){var o=e.length+1;if(1===o)return t;var s=new Array(o);s[0]=n(t);for(var a=1;a<o;a++)s[a]=n(e[a]);return s.join(" ")}if("string"!=typeof t)return t;var h=e.length;if(0===h)return t;for(var l="",f=0,m=-1,_=t&&t.length||0,v=0;v<_;){if(37===t.charCodeAt(v)&&v+1<_){switch(m=m>-1?m:0,t.charCodeAt(v+1)){case 100:case 102:if(f>=h||null==e[f])break;m<v&&(l+=t.slice(m,v)),l+=Number(e[f]),m=v+2,v++;break;case 105:if(f>=h||null==e[f])break;m<v&&(l+=t.slice(m,v)),l+=Math.floor(Number(e[f])),m=v+2,v++;break;case 79:case 111:case 106:if(f>=h||void 0===e[f])break;m<v&&(l+=t.slice(m,v));var b=typeof e[f];if("string"===b){l+="'"+e[f]+"'",m=v+2,v++;break}if("function"===b){l+=e[f].name||"<anonymous>",m=v+2,v++;break}l+=n(e[f]),m=v+2,v++;break;case 115:if(f>=h)break;m<v&&(l+=t.slice(m,v)),l+=String(e[f]),m=v+2,v++;break;case 37:m<v&&(l+=t.slice(m,v)),l+="%",m=v+2,v++,f--}++f}++v}return-1===m?t:(m<_&&(l+=t.slice(m)),l)};var Pe=Be;const vt=function zc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}().console||{},_t={mapHttpRequest:cn,mapHttpResponse:cn,wrapRequestSerializer:ti,wrapResponseSerializer:ti,wrapErrorSerializer:ti,req:cn,res:cn,err:function Cc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)void 0===e[r]&&(e[r]=t[r]);return e}};function Be(t){(t=t||{}).browser=t.browser||{};const e=t.browser.transmit;if(e&&"function"!=typeof e.send)throw Error("pino: transmit option must have a send function");const r=t.browser.write||vt;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=function fe(t,e){return Array.isArray(t)?t.filter(function(r){return"!stdSerializers.err"!==r}):!0===t&&Object.keys(e)}(t.browser.serialize,n);let o=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===t.enabled&&(t.level="silent");const a=t.level||"info",h=Object.create(r);h.log||(h.log=Rr),Object.defineProperty(h,"levelVal",{get:function f(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(h,"level",{get:function m(){return this._level},set:function _(b){if("silent"!==b&&!this.levels.values[b])throw Error("unknown level "+b);this._level=b,Pt(l,h,"error","log"),Pt(l,h,"fatal","error"),Pt(l,h,"warn","error"),Pt(l,h,"info","log"),Pt(l,h,"debug","log"),Pt(l,h,"trace","log")}});const l={transmit:e,serialize:i,asObject:t.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:Uc(t)};return h.levels=Be.levels,h.level=a,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=Rr,h.serializers=n,h._serialize=i,h._stdErrSerialize=o,h.child=function v(b,R){if(!b)throw new Error("missing bindings for child Pino");R=R||{},i&&b.serializers&&(R.serializers=b.serializers);const M=R.serializers;if(i&&M){var $=Object.assign({},n,M),I=!0===t.browser.serialize?Object.keys($):i;delete b.serializers,ht([b],I,$,this._stdErrSerialize)}function L(g){this._childLevel=1+(0|g._childLevel),this.error=Ct(g,b,"error"),this.fatal=Ct(g,b,"fatal"),this.warn=Ct(g,b,"warn"),this.info=Ct(g,b,"info"),this.debug=Ct(g,b,"debug"),this.trace=Ct(g,b,"trace"),$&&(this.serializers=$,this._serialize=I),e&&(this._logEvent=ei([].concat(g._logEvent.bindings,b)))}return L.prototype=this,new L(this)},e&&(h._logEvent=ei()),h}function Pt(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Rr:i[r]?i[r]:vt[r]||vt[n]||Rr,function Nr(t,e,r){var n;!t.transmit&&e[r]===Rr||(e[r]=(n=e[r],function(){const i=t.timestamp(),o=new Array(arguments.length),s=Object.getPrototypeOf&&Object.getPrototypeOf(this)===vt?vt:this;for(var a=0;a<o.length;a++)o[a]=arguments[a];if(t.serialize&&!t.asObject&&ht(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(s,ye(this,r,o,i)):n.apply(s,o),t.transmit){const h=t.transmit.level||e.level,f=Be.levels.values[r];if(f<Be.levels.values[h])return;Mc(this,{ts:i,methodLevel:r,methodValue:f,transmitLevel:h,transmitValue:Be.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}))}(t,e,r)}function ye(t,e,r,n){t._serialize&&ht(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let o=i[0];const s={};n&&(s.time=n),s.level=Be.levels.values[e];let a=1+(0|t._childLevel);if(a<1&&(a=1),null!==o&&"object"==typeof o){for(;a--&&"object"==typeof i[0];)Object.assign(s,i.shift());o=i.length?_r(i.shift(),i):void 0}else"string"==typeof o&&(o=_r(i.shift(),i));return void 0!==o&&(s.msg=o),s}function ht(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Be.stdSerializers.err(t[i]);else if("object"==typeof t[i]&&!Array.isArray(t[i]))for(const o in t[i])e&&e.indexOf(o)>-1&&o in r&&(t[i][o]=r[o](t[i][o]))}function Ct(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function Mc(t,e,r){const n=e.send,i=e.ts,o=e.methodLevel,s=e.methodValue,a=e.val,h=t._logEvent.bindings;ht(r,t._serialize||Object.keys(t.serializers),t.serializers,void 0===t._stdErrSerialize||t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(l){return-1===h.indexOf(l)}),t._logEvent.level.label=o,t._logEvent.level.value=s,n(o,t._logEvent,a),t._logEvent=ei(h)}function ei(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Uc(t){return"function"==typeof t.timestamp?t.timestamp:!1===t.timestamp?po:yo}function cn(){return{}}function ti(t){return t}function Rr(){}function po(){return!1}function yo(){return Date.now()}Be.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Be.stdSerializers=_t,Be.stdTimeFunctions=Object.assign({},{nullTime:po,epochTime:yo,unixTime:function Dc(){return Math.round(Date.now()/1e3)},isoTime:function kc(){return new Date(Date.now()).toISOString()}});var ln,$t={exports:{}},mr="object"==typeof Reflect?Reflect:null,go=mr&&"function"==typeof mr.apply?mr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};ln=mr&&"function"==typeof mr.ownKeys?mr.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var vo=Number.isNaN||function(t){return t!=t};function Le(){Le.init.call(this)}$t.exports=Le,$t.exports.once=function Hc(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}xo(t,e,o,{once:!0}),"error"!==e&&function qc(t,e,r){"function"==typeof t.on&&xo(t,"error",e,r)}(t,i,{once:!0})})},Le.EventEmitter=Le,Le.prototype._events=void 0,Le.prototype._eventsCount=0,Le.prototype._maxListeners=void 0;var _o=10;function hn(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function mo(t){return void 0===t._maxListeners?Le.defaultMaxListeners:t._maxListeners}function bo(t,e,r,n){var i,o,s;if(hn(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=mo(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function Kc(t){console&&console.warn&&console.warn(t)}(a)}return t}function Bc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wo(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Bc.bind(n);return i.listener=r,n.wrapFn=i,i}function Eo(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function Vc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):So(i,i.length)}function Oo(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function So(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function xo(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(Le,"defaultMaxListeners",{enumerable:!0,get:function(){return _o},set:function(t){if("number"!=typeof t||t<0||vo(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_o=t}}),Le.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Le.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||vo(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Le.prototype.getMaxListeners=function(){return mo(this)},Le.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)go(a,this,e);else{var h=a.length,l=So(a,h);for(r=0;r<h;++r)go(l[r],this,e)}return!0},Le.prototype.on=Le.prototype.addListener=function(t,e){return bo(this,t,e,!1)},Le.prototype.prependListener=function(t,e){return bo(this,t,e,!0)},Le.prototype.once=function(t,e){return hn(e),this.on(t,wo(this,t,e)),this},Le.prototype.prependOnceListener=function(t,e){return hn(e),this.prependListener(t,wo(this,t,e)),this},Le.prototype.off=Le.prototype.removeListener=function(t,e){var r,n,i,o,s;if(hn(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function $c(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Le.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Le.prototype.listeners=function(t){return Eo(this,t,!0)},Le.prototype.rawListeners=function(t){return Eo(this,t,!1)},Le.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Oo.call(t,e)},Le.prototype.listenerCount=Oo,Le.prototype.eventNames=function(){return this._eventsCount>0?ln(this._events):[]};var fn={},ri=function(t,e){return(ri=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])})(t,e)};var ni=function(){return ni=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ni.apply(this,arguments)};function ii(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Io(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,s,n=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function Tr(t){return this instanceof Tr?(this.v=t,this):new Tr(t)}var Fo=Bt(Object.freeze({__proto__:null,__extends:function Gc(t,e){function r(){this.constructor=t}ri(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return ni},__rest:function Wc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function Yc(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o},__param:function Jc(t,e){return function(r,n){e(r,n,t)}},__metadata:function Xc(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function Zc(t,e,r,n){return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(m){s(m)}}function h(f){try{l(n.throw(f))}catch(m){s(m)}}function l(f){f.done?o(f.value):function i(o){return o instanceof r?o:new r(function(s){s(o)})}(f.value).then(a,h)}l((n=n.apply(t,e||[])).next())})},__generator:function Qc(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return function h(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,f])}}},__createBinding:function el(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function tl(t,e){for(var r in t)"default"!==r&&!e.hasOwnProperty(r)&&(e[r]=t[r])},__values:ii,__read:Io,__spread:function rl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Io(arguments[e]));return t},__spreadArrays:function nl(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:Tr,__asyncGenerator:function il(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(_){n[_]&&(i[_]=function(v){return new Promise(function(b,R){o.push([_,v,b,R])>1||a(_,v)})})}function a(_,v){try{!function h(_){_.value instanceof Tr?Promise.resolve(_.value.v).then(l,f):m(o[0][2],_)}(n[_](v))}catch(b){m(o[0][3],b)}}function l(_){a("next",_)}function f(_){a("throw",_)}function m(_,v){_(v),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function ol(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:Tr(t[i](s)),done:"return"===i}:o?o(s):s}:o}},__asyncValues:function sl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];return e?e.call(t):(t=ii(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,h){!function i(o,s,a,h){Promise.resolve(h).then(function(l){o({value:l,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}},__makeTemplateObject:function al(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function ul(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function cl(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function ll(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function hl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}})),jr={};Object.defineProperty(jr,"__esModule",{value:!0}),jr.safeJsonParse=function pl(t){if("string"!=typeof t)throw new Error("Cannot safe json parse value of type "+typeof t);try{return JSON.parse(t)}catch{return t}},jr.safeJsonStringify=function dl(t){return"string"==typeof t?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)};var Po,pn={exports:{}};var Ao,Lo={},Mr={};var No,Ro,Cr={};Object.defineProperty(fn,"__esModule",{value:!0}),fn.KeyValueStorage=void 0;const br=Fo,To=jr,ml=br.__importDefault(function yl(){return Po||(Po=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),pn.exports=typeof gt<"u"&&gt.localStorage?gt.localStorage:typeof window<"u"&&window.localStorage?window.localStorage:new e}()),pn.exports}()),bl=function _l(){return Ro||(Ro=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Fo;e.__exportStar(function gl(){return Ao||(Ao=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.IKeyValueStorage=void 0,Mr.IKeyValueStorage=class t{}),Mr}(),t),e.__exportStar(function vl(){if(No)return Cr;No=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.parseEntry=void 0;const t=jr;return Cr.parseEntry=function e(r){var n;return[r[0],t.safeJsonParse(null!==(n=r[1])&&void 0!==n?n:"")]},Cr}(),t)}(Lo)),Lo}();class jo{constructor(){this.localStorage=ml.default}getKeys(){return br.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return br.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(bl.parseEntry)})}getItem(e){return br.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(null!==r)return To.safeJsonParse(r)})}setItem(e,r){return br.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,To.safeJsonStringify(r))})}removeItem(e){return br.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}fn.KeyValueStorage=jo;var wl=fn.default=jo,Ur={},oi=function(t,e){return(oi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])})(t,e)};var si=function(){return si=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},si.apply(this,arguments)};function ai(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mo(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,s,n=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function Dr(t){return this instanceof Dr?(this.v=t,this):new Dr(t)}var dn=Bt(Object.freeze({__proto__:null,__extends:function El(t,e){function r(){this.constructor=t}oi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return si},__rest:function Ol(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function Sl(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o},__param:function xl(t,e){return function(r,n){e(r,n,t)}},__metadata:function Il(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function Fl(t,e,r,n){return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(m){s(m)}}function h(f){try{l(n.throw(f))}catch(m){s(m)}}function l(f){f.done?o(f.value):function i(o){return o instanceof r?o:new r(function(s){s(o)})}(f.value).then(a,h)}l((n=n.apply(t,e||[])).next())})},__generator:function Pl(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return function h(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,f])}}},__createBinding:function Ll(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function Al(t,e){for(var r in t)"default"!==r&&!e.hasOwnProperty(r)&&(e[r]=t[r])},__values:ai,__read:Mo,__spread:function Nl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Mo(arguments[e]));return t},__spreadArrays:function Rl(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:Dr,__asyncGenerator:function Tl(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(_){n[_]&&(i[_]=function(v){return new Promise(function(b,R){o.push([_,v,b,R])>1||a(_,v)})})}function a(_,v){try{!function h(_){_.value instanceof Dr?Promise.resolve(_.value.v).then(l,f):m(o[0][2],_)}(n[_](v))}catch(b){m(o[0][3],b)}}function l(_){a("next",_)}function f(_){a("throw",_)}function m(_,v){_(v),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function jl(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:Dr(t[i](s)),done:"return"===i}:o?o(s):s}:o}},__asyncValues:function Ml(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];return e?e.call(t):(t=ai(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,h){!function i(o,s,a,h){Promise.resolve(h).then(function(l){o({value:l,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}},__makeTemplateObject:function Cl(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function Ul(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function Dl(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function kl(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function zl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}})),kr={};function Ze(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var ui=Ze;function Vt(t){return"function"==typeof t}function zr(t){return"object"==typeof t&&null!==t}function Co(t){return void 0===t}Ze.EventEmitter=Ze,Ze.prototype._events=void 0,Ze.prototype._maxListeners=void 0,Ze.defaultMaxListeners=10,Ze.prototype.setMaxListeners=function(t){if(!function Bl(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Ze.prototype.emit=function(t){var e,r,n,i,o,s;if(this._events||(this._events={}),"error"===t&&(!this._events.error||zr(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var a=new Error('Uncaught, unspecified "error" event. ('+e+")");throw a.context=e,a}if(Co(r=this._events[t]))return!1;if(Vt(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(zr(r))for(i=Array.prototype.slice.call(arguments,1),n=(s=r.slice()).length,o=0;o<n;o++)s[o].apply(this,i);return!0},Ze.prototype.on=Ze.prototype.addListener=function(t,e){var r;if(!Vt(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Vt(e.listener)?e.listener:e),this._events[t]?zr(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,zr(this._events[t])&&!this._events[t].warned&&(r=Co(this._maxListeners)?Ze.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},Ze.prototype.once=function(t,e){if(!Vt(e))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}return n.listener=e,this.on(t,n),this},Ze.prototype.removeListener=function(t,e){var r,n,i,o;if(!Vt(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(r=this._events[t]).length,n=-1,r===e||Vt(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(zr(r)){for(o=i;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){n=o;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Ze.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(Vt(r=this._events[t]))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},Ze.prototype.listeners=function(t){return this._events&&this._events[t]?Vt(this._events[t])?[this._events[t]]:this._events[t].slice():[]},Ze.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Vt(e))return 1;if(e)return e.length}return 0},Ze.listenerCount=function(t,e){return t.listenerCount(e)};var Q={},ci=function(t,e){return(ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])})(t,e)};var li=function(){return li=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},li.apply(this,arguments)};function hi(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Uo(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,s,n=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function Kr(t){return this instanceof Kr?(this.v=t,this):new Kr(t)}var ko,yn=Bt(Object.freeze({__proto__:null,__extends:function $l(t,e){function r(){this.constructor=t}ci(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return li},__rest:function Vl(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function Hl(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o},__param:function ql(t,e){return function(r,n){e(r,n,t)}},__metadata:function Gl(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function Wl(t,e,r,n){return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(m){s(m)}}function h(f){try{l(n.throw(f))}catch(m){s(m)}}function l(f){f.done?o(f.value):function i(o){return o instanceof r?o:new r(function(s){s(o)})}(f.value).then(a,h)}l((n=n.apply(t,e||[])).next())})},__generator:function Yl(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return function h(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,f])}}},__createBinding:function Jl(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function Xl(t,e){for(var r in t)"default"!==r&&!e.hasOwnProperty(r)&&(e[r]=t[r])},__values:hi,__read:Uo,__spread:function Zl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Uo(arguments[e]));return t},__spreadArrays:function Ql(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:Kr,__asyncGenerator:function eh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(_){n[_]&&(i[_]=function(v){return new Promise(function(b,R){o.push([_,v,b,R])>1||a(_,v)})})}function a(_,v){try{!function h(_){_.value instanceof Kr?Promise.resolve(_.value.v).then(l,f):m(o[0][2],_)}(n[_](v))}catch(b){m(o[0][3],b)}}function l(_){a("next",_)}function f(_){a("throw",_)}function m(_,v){_(v),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function th(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:Kr(t[i](s)),done:"return"===i}:o?o(s):s}:o}},__asyncValues:function rh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];return e?e.call(t):(t=hi(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,h){!function i(o,s,a,h){Promise.resolve(h).then(function(l){o({value:l,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}},__makeTemplateObject:function nh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function ih(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function oh(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function sh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function ah(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}})),Do={},Br={};var Ko,ar={},zo={},wr={};var $o,Vo,qo,Go,Bo={};function Ho(){return Vo||(Vo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yn;e.__exportStar(function lh(){return Ko||(Ko=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.ONE_THOUSAND=wr.ONE_HUNDRED=void 0,wr.ONE_HUNDRED=100,wr.ONE_THOUSAND=1e3),wr}(),t),e.__exportStar(function hh(){return $o||($o=1,t=Bo,Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY),Bo;var t}(),t)}(zo)),zo}function ph(){return Go||(Go=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yn;e.__exportStar(function ch(){return ko||(ko=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.delay=void 0,Br.delay=function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}),Br}(),t),e.__exportStar(function fh(){if(qo)return ar;qo=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.fromMiliseconds=ar.toMiliseconds=void 0;const t=Ho();return ar.toMiliseconds=function e(n){return n*t.ONE_THOUSAND},ar.fromMiliseconds=function r(n){return Math.floor(n/t.ONE_THOUSAND)},ar}(),t)}(Do)),Do}var Wo,Er={};var Jo,Xo,Yo={},$r={};function gh(){return Xo||(Xo=1,t=Yo,Object.defineProperty(t,"__esModule",{value:!0}),yn.__exportStar(function yh(){return Jo||(Jo=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.IWatch=void 0,$r.IWatch=class t{}),$r}(),t)),Yo;var t}!function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yn;e.__exportStar(ph(),t),e.__exportStar(function dh(){if(Wo)return Er;Wo=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Er.Watch=t,Er.default=t,Er}(),t),e.__exportStar(gh(),t),e.__exportStar(Ho(),t)}(Q);var Zo={},Vr={};class ur{}var Qo,es,_h=Bt(Object.freeze({__proto__:null,IEvents:ur}));function ts(){return es||(es=1,t=Zo,Object.defineProperty(t,"__esModule",{value:!0}),dn.__exportStar(function mh(){if(Qo)return Vr;Qo=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.IHeartBeat=void 0;const t=_h;return Vr.IHeartBeat=class e extends t.IEvents{constructor(n){super()}},Vr}(),t)),Zo;var t}var ns,is,ss,rs={},cr={};function os(){return is||(is=1,t=rs,Object.defineProperty(t,"__esModule",{value:!0}),dn.__exportStar(function bh(){return ns||(ns=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.HEARTBEAT_EVENTS=cr.HEARTBEAT_INTERVAL=void 0,cr.HEARTBEAT_INTERVAL=Q.FIVE_SECONDS,cr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}),cr}(),t)),rs;var t}!function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=dn;e.__exportStar(function wh(){if(ss)return kr;ss=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.HeartBeat=void 0;const t=dn,e=ui,r=Q,n=ts(),i=os();class o extends n.IHeartBeat{constructor(a){super(a),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=a?.interval||i.HEARTBEAT_INTERVAL}static init(a){return t.__awaiter(this,void 0,void 0,function*(){const h=new o(a);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(a,h){this.events.on(a,h)}once(a,h){this.events.once(a,h)}off(a,h){this.events.off(a,h)}removeListener(a,h){this.events.removeListener(a,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return kr.HeartBeat=o,kr}(),t),e.__exportStar(ts(),t),e.__exportStar(os(),t)}(Ur);var Fe={},fi=function(t,e){return(fi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])})(t,e)};var pi=function(){return pi=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},pi.apply(this,arguments)};function di(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function as(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,s,n=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function Hr(t){return this instanceof Hr?(this.v=t,this):new Hr(t)}var us,Bh=Bt(Object.freeze({__proto__:null,__extends:function Eh(t,e){function r(){this.constructor=t}fi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return pi},__rest:function Oh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function Sh(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o},__param:function xh(t,e){return function(r,n){e(r,n,t)}},__metadata:function Ih(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function Fh(t,e,r,n){return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(m){s(m)}}function h(f){try{l(n.throw(f))}catch(m){s(m)}}function l(f){f.done?o(f.value):function i(o){return o instanceof r?o:new r(function(s){s(o)})}(f.value).then(a,h)}l((n=n.apply(t,e||[])).next())})},__generator:function Ph(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return function h(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,f])}}},__createBinding:function Lh(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function Ah(t,e){for(var r in t)"default"!==r&&!e.hasOwnProperty(r)&&(e[r]=t[r])},__values:di,__read:as,__spread:function Nh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(as(arguments[e]));return t},__spreadArrays:function Rh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:Hr,__asyncGenerator:function Th(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(_){n[_]&&(i[_]=function(v){return new Promise(function(b,R){o.push([_,v,b,R])>1||a(_,v)})})}function a(_,v){try{!function h(_){_.value instanceof Hr?Promise.resolve(_.value.v).then(l,f):m(o[0][2],_)}(n[_](v))}catch(b){m(o[0][3],b)}}function l(_){a("next",_)}function f(_){a("throw",_)}function m(_,v){_(v),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function jh(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:Hr(t[i](s)),done:"return"===i}:o?o(s):s}:o}},__asyncValues:function Mh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];return e?e.call(t):(t=di(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,h){!function i(o,s,a,h){Promise.resolve(h).then(function(l){o({value:l,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}},__makeTemplateObject:function Ch(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function Uh(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function Dh(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function kh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function zh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}})),Or={};function cs(){return us||(us=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.PINO_CUSTOM_CONTEXT_KEY=Or.PINO_LOGGER_DEFAULTS=void 0,Or.PINO_LOGGER_DEFAULTS={level:"info"},Or.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Or}var ls,dt={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Bh,r=e.__importDefault(Pe);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(cs(),t),e.__exportStar(function $h(){if(ls)return dt;ls=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.generateChildLogger=dt.formatChildLoggerContext=dt.getLoggerContext=dt.setBrowserLoggerContext=dt.getBrowserLoggerContext=dt.getDefaultLoggerOptions=void 0;const t=cs();function r(a,h=t.PINO_CUSTOM_CONTEXT_KEY){return a[h]||""}function n(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return a[l]=h,a}function i(a,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return l=typeof a.bindings>"u"?r(a,h):a.bindings().context||"",l}function o(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=i(a,l);return f.trim()?`${f}/${h}`:h}return dt.getDefaultLoggerOptions=function e(a){return Object.assign(Object.assign({},a),{level:a?.level||t.PINO_LOGGER_DEFAULTS.level})},dt.getBrowserLoggerContext=r,dt.setBrowserLoggerContext=n,dt.getLoggerContext=i,dt.formatChildLoggerContext=o,dt.generateChildLogger=function s(a,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const f=o(a,h,l);return n(a.child({context:f}),f,l)},dt}(),t)}(Fe);var gn,hs={exports:{}},Sr="object"==typeof Reflect?Reflect:null,fs=Sr&&"function"==typeof Sr.apply?Sr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};gn=Sr&&"function"==typeof Sr.ownKeys?Sr.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var ps=Number.isNaN||function(t){return t!=t};function Ae(){Ae.init.call(this)}hs.exports=Ae,hs.exports.once=function Wh(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}ws(t,e,o,{once:!0}),"error"!==e&&function Yh(t,e,r){"function"==typeof t.on&&ws(t,"error",e,r)}(t,i,{once:!0})})},Ae.EventEmitter=Ae,Ae.prototype._events=void 0,Ae.prototype._eventsCount=0,Ae.prototype._maxListeners=void 0;var ds=10;function vn(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function ys(t){return void 0===t._maxListeners?Ae.defaultMaxListeners:t._maxListeners}function gs(t,e,r,n){var i,o,s;if(vn(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=ys(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function Vh(t){console&&console.warn&&console.warn(t)}(a)}return t}function Hh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vs(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Hh.bind(n);return i.listener=r,n.wrapFn=i,i}function _s(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function Gh(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):bs(i,i.length)}function ms(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function bs(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function ws(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(Ae,"defaultMaxListeners",{enumerable:!0,get:function(){return ds},set:function(t){if("number"!=typeof t||t<0||ps(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ds=t}}),Ae.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ae.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||ps(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Ae.prototype.getMaxListeners=function(){return ys(this)},Ae.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)fs(a,this,e);else{var h=a.length,l=bs(a,h);for(r=0;r<h;++r)fs(l[r],this,e)}return!0},Ae.prototype.on=Ae.prototype.addListener=function(t,e){return gs(this,t,e,!1)},Ae.prototype.prependListener=function(t,e){return gs(this,t,e,!0)},Ae.prototype.once=function(t,e){return vn(e),this.on(t,vs(this,t,e)),this},Ae.prototype.prependOnceListener=function(t,e){return vn(e),this.prependListener(t,vs(this,t,e)),this},Ae.prototype.off=Ae.prototype.removeListener=function(t,e){var r,n,i,o,s;if(vn(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function qh(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Ae.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Ae.prototype.listeners=function(t){return _s(this,t,!0)},Ae.prototype.rawListeners=function(t){return _s(this,t,!1)},Ae.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):ms.call(t,e)},Ae.prototype.listenerCount=ms,Ae.prototype.eventNames=function(){return this._eventsCount>0?gn(this._events):[]};class Jh extends ur{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Xh extends ur{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Qh extends ur{constructor(e,r){super(),this.relayer=e,this.logger=r}}class ef extends ur{constructor(e){super()}}class rf extends ur{constructor(e,r){super(),this.relayer=e,this.logger=r}}class nf extends ur{constructor(e,r){super(),this.core=e,this.logger=r}}function yi(t){if("string"!=typeof t)throw new Error("Cannot safe json parse value of type "+typeof t);try{return JSON.parse(t)}catch{return t}}function qr(t){return"string"==typeof t?t:JSON.stringify(t)}var gi={},xr={},_n={},mn={};Object.defineProperty(mn,"__esModule",{value:!0}),mn.BrowserRandomSource=void 0;mn.BrowserRandomSource=class af{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=65536)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,65536)));return r}};var bn={},xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.wipe=function cf(t){for(var e=0;e<t.length;e++)t[e]=0;return t};var ff=Bt(Object.freeze({__proto__:null,default:{}}));Object.defineProperty(bn,"__esModule",{value:!0}),bn.NodeRandomSource=void 0;const pf=xt;bn.NodeRandomSource=class df{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=ff;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,pf.wipe)(r),n}},Object.defineProperty(_n,"__esModule",{value:!0}),_n.SystemRandomSource=void 0;const yf=mn,gf=bn;_n.SystemRandomSource=class vf{constructor(){return this.isAvailable=!1,this.name="",this._source=new yf.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new gf.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}};var t,ne={},Os={};t=Os,Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function e(a,h){var f=65535&a,_=65535&h;return f*_+((a>>>16&65535)*_+f*(h>>>16&65535)<<16>>>0)|0},t.add=function r(a,h){return a+h|0},t.sub=function n(a,h){return a-h|0},t.rotl=function i(a,h){return a<<h|a>>>32-h},t.rotr=function o(a,h){return a<<32-h|a>>>h},t.isInteger=Number.isInteger||function s(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(a){return t.isInteger(a)&&a>=-t.MAX_SAFE_INTEGER&&a<=t.MAX_SAFE_INTEGER},Object.defineProperty(ne,"__esModule",{value:!0});var Ss=Os;function xs(t,e,r){return void 0===e&&(e=new Uint8Array(2)),void 0===r&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}function Is(t,e,r){return void 0===e&&(e=new Uint8Array(2)),void 0===r&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}function vi(t,e){return void 0===e&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function _i(t,e){return void 0===e&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function mi(t,e){return void 0===e&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function bi(t,e){return void 0===e&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}function wn(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}function En(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}function Fs(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),wn(t/4294967296>>>0,e,r),wn(t>>>0,e,r+4),e}function Ps(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),En(t>>>0,e,r),En(t/4294967296>>>0,e,r+4),e}ne.readInt16BE=function _f(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16},ne.readUint16BE=function mf(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])>>>0},ne.readInt16LE=function bf(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])<<16>>16},ne.readUint16LE=function wf(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])>>>0},ne.writeUint16BE=xs,ne.writeInt16BE=xs,ne.writeUint16LE=Is,ne.writeInt16LE=Is,ne.readInt32BE=vi,ne.readUint32BE=_i,ne.readInt32LE=mi,ne.readUint32LE=bi,ne.writeUint32BE=wn,ne.writeInt32BE=wn,ne.writeUint32LE=En,ne.writeInt32LE=En,ne.readInt64BE=function Ef(t,e){void 0===e&&(e=0);var r=vi(t,e),n=vi(t,e+4);return 4294967296*r+n-4294967296*(n>>31)},ne.readUint64BE=function Of(t,e){return void 0===e&&(e=0),4294967296*_i(t,e)+_i(t,e+4)},ne.readInt64LE=function Sf(t,e){void 0===e&&(e=0);var r=mi(t,e);return 4294967296*mi(t,e+4)+r-4294967296*(r>>31)},ne.readUint64LE=function xf(t,e){void 0===e&&(e=0);var r=bi(t,e);return 4294967296*bi(t,e+4)+r},ne.writeUint64BE=Fs,ne.writeInt64BE=Fs,ne.writeUint64LE=Ps,ne.writeInt64LE=Ps,ne.readUintBE=function If(t,e,r){if(void 0===r&&(r=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,o=t/8+r-1;o>=r;o--)n+=e[o]*i,i*=256;return n},ne.readUintLE=function Ff(t,e,r){if(void 0===r&&(r=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,o=r;o<r+t/8;o++)n+=e[o]*i,i*=256;return n},ne.writeUintBE=function Pf(t,e,r,n){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===n&&(n=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ss.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,o=t/8+n-1;o>=n;o--)r[o]=e/i&255,i*=256;return r},ne.writeUintLE=function Lf(t,e,r,n){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===n&&(n=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ss.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,o=n;o<n+t/8;o++)r[o]=e/i&255,i*=256;return r},ne.readFloat32BE=function Af(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e)},ne.readFloat32LE=function Nf(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},ne.readFloat64BE=function Rf(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e)},ne.readFloat64LE=function Tf(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},ne.writeFloat32BE=function jf(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(r,t),e},ne.writeFloat32LE=function Mf(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(r,t,!0),e},ne.writeFloat64BE=function Cf(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(r,t),e},ne.writeFloat64LE=function Uf(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(r,t,!0),e},function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const r=ne,n=xt;function i(l,f=t.defaultRandomSource){return f.randomBytes(l)}t.defaultRandomSource=new _n.SystemRandomSource,t.randomBytes=i,t.randomUint32=function o(l=t.defaultRandomSource){const f=i(4,l),m=(0,r.readUint32LE)(f);return(0,n.wipe)(f),m};const s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(l,f=s,m=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let _="";const v=f.length,b=256-256%v;for(;l>0;){const R=i(Math.ceil(256*l/b),m);for(let M=0;M<R.length&&l>0;M++){const $=R[M];$<b&&(_+=f.charAt($%v),l--)}(0,n.wipe)(R)}return _}t.randomString=a,t.randomStringForEntropy=function h(l,f=s,m=t.defaultRandomSource){return a(Math.ceil(l/(Math.log(f.length)/Math.LN2)),f,m)}}(xr);var Ls={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=xt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},a.prototype.update=function(h,l){if(void 0===l&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},a.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,m=l/536870912|0,_=l<<3,v=l%128<112?128:256;this._buffer[f]=128;for(var b=f+1;b<v-8;b++)this._buffer[b]=0;e.writeUint32BE(m,this._buffer,v-8),e.writeUint32BE(_,this._buffer,v-4),o(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(b=0;b<this.digestLength/8;b++)e.writeUint32BE(this._stateHi[b],h,8*b),e.writeUint32BE(this._stateLo[b],h,8*b+4);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function o(a,h,l,f,m,_,v){for(var d,E,U,D,j,T,z,K,b=l[0],R=l[1],M=l[2],$=l[3],I=l[4],L=l[5],g=l[6],S=l[7],O=f[0],u=f[1],p=f[2],k=f[3],B=f[4],G=f[5],X=f[6],Z=f[7];v>=128;){for(var ee=0;ee<16;ee++)a[ee]=e.readUint32BE(m,V=8*ee+_),h[ee]=e.readUint32BE(m,V+4);for(ee=0;ee<80;ee++){var w,De,J=R,ue=M,N=$,A=I,F=L,c=g,W=u,pe=p,be=k,ge=B,Oe=G,Ve=X;if(j=65535&(E=Z),T=E>>>16,z=65535&(d=S),K=d>>>16,j+=65535&(E=(B>>>14|I<<18)^(B>>>18|I<<14)^(I>>>9|B<<23)),T+=E>>>16,z+=65535&(d=(I>>>14|B<<18)^(I>>>18|B<<14)^(B>>>9|I<<23)),K+=d>>>16,j+=65535&(E=B&G^~B&X),T+=E>>>16,z+=65535&(d=I&L^~I&g),K+=d>>>16,j+=65535&(E=i[2*ee+1]),T+=E>>>16,z+=65535&(d=i[2*ee]),K+=d>>>16,T+=(E=h[ee%16])>>>16,z+=65535&(d=a[ee%16]),K+=d>>>16,z+=(T+=(j+=65535&E)>>>16)>>>16,j=65535&(E=D=65535&j|T<<16),T=E>>>16,z=65535&(d=U=65535&z|(K+=z>>>16)<<16),K=d>>>16,j+=65535&(E=(O>>>28|b<<4)^(b>>>2|O<<30)^(b>>>7|O<<25)),T+=E>>>16,z+=65535&(d=(b>>>28|O<<4)^(O>>>2|b<<30)^(O>>>7|b<<25)),K+=d>>>16,T+=(E=O&u^O&p^u&p)>>>16,z+=65535&(d=b&R^b&M^R&M),K+=d>>>16,w=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,De=65535&j|T<<16,j=65535&(E=be),T=E>>>16,z=65535&(d=N),K=d>>>16,T+=(E=D)>>>16,z+=65535&(d=U),K+=d>>>16,R=b,M=J,$=ue,I=N=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,L=A,g=F,S=c,b=w,u=O,p=W,k=pe,B=be=65535&j|T<<16,G=ge,X=Oe,Z=Ve,O=De,ee%16==15)for(var V=0;V<16;V++)j=65535&(E=h[V]),T=E>>>16,z=65535&(d=a[V]),K=d>>>16,j+=65535&(E=h[(V+9)%16]),T+=E>>>16,z+=65535&(d=a[(V+9)%16]),K+=d>>>16,j+=65535&(E=((D=h[(V+1)%16])>>>1|(U=a[(V+1)%16])<<31)^(D>>>8|U<<24)^(D>>>7|U<<25)),T+=E>>>16,z+=65535&(d=(U>>>1|D<<31)^(U>>>8|D<<24)^U>>>7),K+=d>>>16,T+=(E=((D=h[(V+14)%16])>>>19|(U=a[(V+14)%16])<<13)^(U>>>29|D<<3)^(D>>>6|U<<26))>>>16,z+=65535&(d=(U>>>19|D<<13)^(D>>>29|U<<3)^U>>>6),K+=d>>>16,a[V]=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,h[V]=65535&j|T<<16}j=65535&(E=O),T=E>>>16,z=65535&(d=b),K=d>>>16,T+=(E=f[0])>>>16,z+=65535&(d=l[0]),K+=d>>>16,l[0]=b=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[0]=O=65535&j|T<<16,j=65535&(E=u),T=E>>>16,z=65535&(d=R),K=d>>>16,T+=(E=f[1])>>>16,z+=65535&(d=l[1]),K+=d>>>16,l[1]=R=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[1]=u=65535&j|T<<16,j=65535&(E=p),T=E>>>16,z=65535&(d=M),K=d>>>16,T+=(E=f[2])>>>16,z+=65535&(d=l[2]),K+=d>>>16,l[2]=M=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[2]=p=65535&j|T<<16,j=65535&(E=k),T=E>>>16,z=65535&(d=$),K=d>>>16,T+=(E=f[3])>>>16,z+=65535&(d=l[3]),K+=d>>>16,l[3]=$=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[3]=k=65535&j|T<<16,j=65535&(E=B),T=E>>>16,z=65535&(d=I),K=d>>>16,T+=(E=f[4])>>>16,z+=65535&(d=l[4]),K+=d>>>16,l[4]=I=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[4]=B=65535&j|T<<16,j=65535&(E=G),T=E>>>16,z=65535&(d=L),K=d>>>16,T+=(E=f[5])>>>16,z+=65535&(d=l[5]),K+=d>>>16,l[5]=L=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[5]=G=65535&j|T<<16,j=65535&(E=X),T=E>>>16,z=65535&(d=g),K=d>>>16,T+=(E=f[6])>>>16,z+=65535&(d=l[6]),K+=d>>>16,l[6]=g=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[6]=X=65535&j|T<<16,j=65535&(E=Z),T=E>>>16,z=65535&(d=S),K=d>>>16,T+=(E=f[7])>>>16,z+=65535&(d=l[7]),K+=d>>>16,l[7]=S=65535&(z+=(T+=(j+=65535&E)>>>16)>>>16)|(K+=z>>>16)<<16,f[7]=Z=65535&j|T<<16,_+=128,v-=128}return _}t.hash=function s(a){var h=new n;h.update(a);var l=h.digest();return h.clean(),l}})(Ls),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=xr,r=Ls,n=xt;function i(N){const A=new Float64Array(16);if(N)for(let F=0;F<N.length;F++)A[F]=N[F];return A}t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32,new Uint8Array(32)[0]=9;const s=i(),a=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(N,A){for(let F=0;F<16;F++)N[F]=0|A[F]}function b(N){let A=1;for(let F=0;F<16;F++){let c=N[F]+A+65535;A=Math.floor(c/65536),N[F]=c-65536*A}N[0]+=A-1+37*(A-1)}function R(N,A,F){const c=~(F-1);for(let w=0;w<16;w++){const H=c&(N[w]^A[w]);N[w]^=H,A[w]^=H}}function M(N,A){const F=i(),c=i();for(let w=0;w<16;w++)c[w]=A[w];b(c),b(c),b(c);for(let w=0;w<2;w++){F[0]=c[0]-65517;for(let W=1;W<15;W++)F[W]=c[W]-65535-(F[W-1]>>16&1),F[W-1]&=65535;F[15]=c[15]-32767-(F[14]>>16&1);const H=F[15]>>16&1;F[14]&=65535,R(c,F,1-H)}for(let w=0;w<16;w++)N[2*w]=255&c[w],N[2*w+1]=c[w]>>8}function $(N,A){let F=0;for(let c=0;c<32;c++)F|=N[c]^A[c];return(1&F-1>>>8)-1}function I(N,A){const F=new Uint8Array(32),c=new Uint8Array(32);return M(F,N),M(c,A),$(F,c)}function L(N){const A=new Uint8Array(32);return M(A,N),1&A[0]}function S(N,A,F){for(let c=0;c<16;c++)N[c]=A[c]+F[c]}function O(N,A,F){for(let c=0;c<16;c++)N[c]=A[c]-F[c]}function u(N,A,F){let c,w,H=0,W=0,pe=0,be=0,ge=0,Oe=0,Ve=0,De=0,me=0,ve=0,de=0,le=0,ce=0,ae=0,oe=0,re=0,he=0,_e=0,ie=0,we=0,Ee=0,xe=0,Ie=0,Se=0,jt=0,Kt=0,rr=0,It=0,pr=0,on=0,$n=0,He=F[0],ke=F[1],qe=F[2],Ge=F[3],We=F[4],ze=F[5],Qe=F[6],et=F[7],tt=F[8],rt=F[9],nt=F[10],Xe=F[11],Ye=F[12],Ce=F[13],it=F[14],ot=F[15];c=A[0],H+=c*He,W+=c*ke,pe+=c*qe,be+=c*Ge,ge+=c*We,Oe+=c*ze,Ve+=c*Qe,De+=c*et,me+=c*tt,ve+=c*rt,de+=c*nt,le+=c*Xe,ce+=c*Ye,ae+=c*Ce,oe+=c*it,re+=c*ot,c=A[1],W+=c*He,pe+=c*ke,be+=c*qe,ge+=c*Ge,Oe+=c*We,Ve+=c*ze,De+=c*Qe,me+=c*et,ve+=c*tt,de+=c*rt,le+=c*nt,ce+=c*Xe,ae+=c*Ye,oe+=c*Ce,re+=c*it,he+=c*ot,c=A[2],pe+=c*He,be+=c*ke,ge+=c*qe,Oe+=c*Ge,Ve+=c*We,De+=c*ze,me+=c*Qe,ve+=c*et,de+=c*tt,le+=c*rt,ce+=c*nt,ae+=c*Xe,oe+=c*Ye,re+=c*Ce,he+=c*it,_e+=c*ot,c=A[3],be+=c*He,ge+=c*ke,Oe+=c*qe,Ve+=c*Ge,De+=c*We,me+=c*ze,ve+=c*Qe,de+=c*et,le+=c*tt,ce+=c*rt,ae+=c*nt,oe+=c*Xe,re+=c*Ye,he+=c*Ce,_e+=c*it,ie+=c*ot,c=A[4],ge+=c*He,Oe+=c*ke,Ve+=c*qe,De+=c*Ge,me+=c*We,ve+=c*ze,de+=c*Qe,le+=c*et,ce+=c*tt,ae+=c*rt,oe+=c*nt,re+=c*Xe,he+=c*Ye,_e+=c*Ce,ie+=c*it,we+=c*ot,c=A[5],Oe+=c*He,Ve+=c*ke,De+=c*qe,me+=c*Ge,ve+=c*We,de+=c*ze,le+=c*Qe,ce+=c*et,ae+=c*tt,oe+=c*rt,re+=c*nt,he+=c*Xe,_e+=c*Ye,ie+=c*Ce,we+=c*it,Ee+=c*ot,c=A[6],Ve+=c*He,De+=c*ke,me+=c*qe,ve+=c*Ge,de+=c*We,le+=c*ze,ce+=c*Qe,ae+=c*et,oe+=c*tt,re+=c*rt,he+=c*nt,_e+=c*Xe,ie+=c*Ye,we+=c*Ce,Ee+=c*it,xe+=c*ot,c=A[7],De+=c*He,me+=c*ke,ve+=c*qe,de+=c*Ge,le+=c*We,ce+=c*ze,ae+=c*Qe,oe+=c*et,re+=c*tt,he+=c*rt,_e+=c*nt,ie+=c*Xe,we+=c*Ye,Ee+=c*Ce,xe+=c*it,Ie+=c*ot,c=A[8],me+=c*He,ve+=c*ke,de+=c*qe,le+=c*Ge,ce+=c*We,ae+=c*ze,oe+=c*Qe,re+=c*et,he+=c*tt,_e+=c*rt,ie+=c*nt,we+=c*Xe,Ee+=c*Ye,xe+=c*Ce,Ie+=c*it,Se+=c*ot,c=A[9],ve+=c*He,de+=c*ke,le+=c*qe,ce+=c*Ge,ae+=c*We,oe+=c*ze,re+=c*Qe,he+=c*et,_e+=c*tt,ie+=c*rt,we+=c*nt,Ee+=c*Xe,xe+=c*Ye,Ie+=c*Ce,Se+=c*it,jt+=c*ot,c=A[10],de+=c*He,le+=c*ke,ce+=c*qe,ae+=c*Ge,oe+=c*We,re+=c*ze,he+=c*Qe,_e+=c*et,ie+=c*tt,we+=c*rt,Ee+=c*nt,xe+=c*Xe,Ie+=c*Ye,Se+=c*Ce,jt+=c*it,Kt+=c*ot,c=A[11],le+=c*He,ce+=c*ke,ae+=c*qe,oe+=c*Ge,re+=c*We,he+=c*ze,_e+=c*Qe,ie+=c*et,we+=c*tt,Ee+=c*rt,xe+=c*nt,Ie+=c*Xe,Se+=c*Ye,jt+=c*Ce,Kt+=c*it,rr+=c*ot,c=A[12],ce+=c*He,ae+=c*ke,oe+=c*qe,re+=c*Ge,he+=c*We,_e+=c*ze,ie+=c*Qe,we+=c*et,Ee+=c*tt,xe+=c*rt,Ie+=c*nt,Se+=c*Xe,jt+=c*Ye,Kt+=c*Ce,rr+=c*it,It+=c*ot,c=A[13],ae+=c*He,oe+=c*ke,re+=c*qe,he+=c*Ge,_e+=c*We,ie+=c*ze,we+=c*Qe,Ee+=c*et,xe+=c*tt,Ie+=c*rt,Se+=c*nt,jt+=c*Xe,Kt+=c*Ye,rr+=c*Ce,It+=c*it,pr+=c*ot,c=A[14],oe+=c*He,re+=c*ke,he+=c*qe,_e+=c*Ge,ie+=c*We,we+=c*ze,Ee+=c*Qe,xe+=c*et,Ie+=c*tt,Se+=c*rt,jt+=c*nt,Kt+=c*Xe,rr+=c*Ye,It+=c*Ce,pr+=c*it,on+=c*ot,c=A[15],re+=c*He,he+=c*ke,_e+=c*qe,ie+=c*Ge,we+=c*We,Ee+=c*ze,xe+=c*Qe,Ie+=c*et,Se+=c*tt,jt+=c*rt,Kt+=c*nt,rr+=c*Xe,It+=c*Ye,pr+=c*Ce,on+=c*it,$n+=c*ot,H+=38*he,W+=38*_e,pe+=38*ie,be+=38*we,ge+=38*Ee,Oe+=38*xe,Ve+=38*Ie,De+=38*Se,me+=38*jt,ve+=38*Kt,de+=38*rr,le+=38*It,ce+=38*pr,ae+=38*on,oe+=38*$n,w=1,c=H+w+65535,w=Math.floor(c/65536),H=c-65536*w,c=W+w+65535,w=Math.floor(c/65536),W=c-65536*w,c=pe+w+65535,w=Math.floor(c/65536),pe=c-65536*w,c=be+w+65535,w=Math.floor(c/65536),be=c-65536*w,c=ge+w+65535,w=Math.floor(c/65536),ge=c-65536*w,c=Oe+w+65535,w=Math.floor(c/65536),Oe=c-65536*w,c=Ve+w+65535,w=Math.floor(c/65536),Ve=c-65536*w,c=De+w+65535,w=Math.floor(c/65536),De=c-65536*w,c=me+w+65535,w=Math.floor(c/65536),me=c-65536*w,c=ve+w+65535,w=Math.floor(c/65536),ve=c-65536*w,c=de+w+65535,w=Math.floor(c/65536),de=c-65536*w,c=le+w+65535,w=Math.floor(c/65536),le=c-65536*w,c=ce+w+65535,w=Math.floor(c/65536),ce=c-65536*w,c=ae+w+65535,w=Math.floor(c/65536),ae=c-65536*w,c=oe+w+65535,w=Math.floor(c/65536),oe=c-65536*w,c=re+w+65535,w=Math.floor(c/65536),re=c-65536*w,H+=w-1+37*(w-1),w=1,c=H+w+65535,w=Math.floor(c/65536),H=c-65536*w,c=W+w+65535,w=Math.floor(c/65536),W=c-65536*w,c=pe+w+65535,w=Math.floor(c/65536),pe=c-65536*w,c=be+w+65535,w=Math.floor(c/65536),be=c-65536*w,c=ge+w+65535,w=Math.floor(c/65536),ge=c-65536*w,c=Oe+w+65535,w=Math.floor(c/65536),Oe=c-65536*w,c=Ve+w+65535,w=Math.floor(c/65536),Ve=c-65536*w,c=De+w+65535,w=Math.floor(c/65536),De=c-65536*w,c=me+w+65535,w=Math.floor(c/65536),me=c-65536*w,c=ve+w+65535,w=Math.floor(c/65536),ve=c-65536*w,c=de+w+65535,w=Math.floor(c/65536),de=c-65536*w,c=le+w+65535,w=Math.floor(c/65536),le=c-65536*w,c=ce+w+65535,w=Math.floor(c/65536),ce=c-65536*w,c=ae+w+65535,w=Math.floor(c/65536),ae=c-65536*w,c=oe+w+65535,w=Math.floor(c/65536),oe=c-65536*w,c=re+w+65535,w=Math.floor(c/65536),re=c-65536*w,H+=w-1+37*(w-1),N[0]=H,N[1]=W,N[2]=pe,N[3]=be,N[4]=ge,N[5]=Oe,N[6]=Ve,N[7]=De,N[8]=me,N[9]=ve,N[10]=de,N[11]=le,N[12]=ce,N[13]=ae,N[14]=oe,N[15]=re}function p(N,A){u(N,A,A)}function k(N,A){const F=i();let c;for(c=0;c<16;c++)F[c]=A[c];for(c=253;c>=0;c--)p(F,F),2!==c&&4!==c&&u(F,F,A);for(c=0;c<16;c++)N[c]=F[c]}function G(N,A){const F=i(),c=i(),w=i(),H=i(),W=i(),pe=i(),be=i(),ge=i(),Oe=i();O(F,N[1],N[0]),O(Oe,A[1],A[0]),u(F,F,Oe),S(c,N[0],N[1]),S(Oe,A[0],A[1]),u(c,c,Oe),u(w,N[3],A[3]),u(w,w,l),u(H,N[2],A[2]),S(H,H,H),O(W,c,F),O(pe,H,w),S(be,H,w),S(ge,c,F),u(N[0],W,pe),u(N[1],ge,be),u(N[2],be,pe),u(N[3],W,ge)}function X(N,A,F){for(let c=0;c<4;c++)R(N[c],A[c],F)}function Z(N,A){const F=i(),c=i(),w=i();k(w,A[2]),u(F,A[0],w),u(c,A[1],w),M(N,c),N[31]^=L(F)<<7}function d(N,A,F){v(N[0],s),v(N[1],a),v(N[2],a),v(N[3],s);for(let c=255;c>=0;--c){const w=F[c/8|0]>>(7&c)&1;X(N,A,w),G(A,N),G(N,N),X(N,A,w)}}function E(N,A){const F=[i(),i(),i(),i()];v(F[0],f),v(F[1],m),v(F[2],a),u(F[3],f,m),d(N,F,A)}function U(N){if(N.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const A=(0,r.hash)(N);A[0]&=248,A[31]&=127,A[31]|=64;const F=new Uint8Array(32),c=[i(),i(),i(),i()];E(c,A),Z(F,c);const w=new Uint8Array(64);return w.set(N),w.set(F,32),{publicKey:F,secretKey:w}}t.generateKeyPairFromSeed=U,t.generateKeyPair=function D(N){const A=(0,e.randomBytes)(32,N),F=U(A);return(0,n.wipe)(A),F},t.extractPublicKeyFromSecretKey=function j(N){if(N.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))};const T=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(N,A){let F,c,w,H;for(c=63;c>=32;--c){for(F=0,w=c-32,H=c-12;w<H;++w)A[w]+=F-16*A[c]*T[w-(c-32)],F=Math.floor((A[w]+128)/256),A[w]-=256*F;A[w]+=F,A[c]=0}for(F=0,w=0;w<32;w++)A[w]+=F-(A[31]>>4)*T[w],F=A[w]>>8,A[w]&=255;for(w=0;w<32;w++)A[w]-=F*T[w];for(c=0;c<32;c++)A[c+1]+=A[c]>>8,N[c]=255&A[c]}function K(N){const A=new Float64Array(64);for(let F=0;F<64;F++)A[F]=N[F];for(let F=0;F<64;F++)N[F]=0;z(N,A)}function V(N,A){const F=i(),c=i(),w=i(),H=i(),W=i(),pe=i(),be=i();return v(N[2],a),function g(N,A){for(let F=0;F<16;F++)N[F]=A[2*F]+(A[2*F+1]<<8);N[15]&=32767}(N[1],A),p(w,N[1]),u(H,w,h),O(w,w,N[2]),S(H,N[2],H),p(W,H),p(pe,W),u(be,pe,W),u(F,be,w),u(F,F,H),function B(N,A){const F=i();let c;for(c=0;c<16;c++)F[c]=A[c];for(c=250;c>=0;c--)p(F,F),1!==c&&u(F,F,A);for(c=0;c<16;c++)N[c]=F[c]}(F,F),u(F,F,w),u(F,F,H),u(F,F,H),u(N[0],F,H),p(c,N[0]),u(c,c,H),I(c,w)&&u(N[0],N[0],_),p(c,N[0]),u(c,c,H),I(c,w)?-1:(L(N[0])===A[31]>>7&&O(N[0],s,N[0]),u(N[3],N[0],N[1]),0)}t.sign=function ee(N,A){const F=new Float64Array(64),c=[i(),i(),i(),i()],w=(0,r.hash)(N.subarray(0,32));w[0]&=248,w[31]&=127,w[31]|=64;const H=new Uint8Array(64);H.set(w.subarray(32),32);const W=new r.SHA512;W.update(H.subarray(32)),W.update(A);const pe=W.digest();W.clean(),K(pe),E(c,pe),Z(H,c),W.reset(),W.update(H.subarray(0,32)),W.update(N.subarray(32)),W.update(A);const be=W.digest();K(be);for(let ge=0;ge<32;ge++)F[ge]=pe[ge];for(let ge=0;ge<32;ge++)for(let Oe=0;Oe<32;Oe++)F[ge+Oe]+=be[ge]*w[Oe];return z(H.subarray(32),F),H},t.verify=function te(N,A,F){const c=new Uint8Array(32),w=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(F.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(V(H,N))return!1;const W=new r.SHA512;W.update(F.subarray(0,32)),W.update(N),W.update(A);const pe=W.digest();return K(pe),d(w,H,pe),E(H,F.subarray(32)),G(w,H),Z(c,w),!$(F,c)},t.convertPublicKeyToX25519=function J(N){let A=[i(),i(),i(),i()];if(V(A,N))throw new Error("Ed25519: invalid public key");let F=i(),c=i(),w=A[1];S(F,a,w),O(c,a,w),k(c,c),u(F,F,c);let H=new Uint8Array(32);return M(H,F),H},t.convertSecretKeyToX25519=function ue(N){const A=(0,r.hash)(N.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const F=new Uint8Array(A.subarray(0,32));return(0,n.wipe)(A),F}}(gi);const Ns="base64url",$f="did",Vf="key",Rs="base58btc";function Ts(t=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function wi(t,e){e||(e=t.reduce((i,o)=>i+o.length,0));const r=Ts(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}var Jf=function Wf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,h=t.charAt(0),l=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function _(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var R=0;if(" "!==b[R]){for(var M=0,$=0;b[R]===h;)M++,R++;for(var I=(b.length-R)*l+1>>>0,L=new Uint8Array(I);b[R];){var g=r[b.charCodeAt(R)];if(255===g)return;for(var S=0,O=I-1;(0!==g||S<$)&&-1!==O;O--,S++)L[O]=(g+=a*L[O]>>>0)%256>>>0,g=g/256>>>0;if(0!==g)throw new Error("Non-zero carry");$=S,R++}if(" "!==b[R]){for(var u=I-$;u!==I&&0===L[u];)u++;for(var p=new Uint8Array(M+(I-u)),k=M;u!==I;)p[k++]=L[u++];return p}}}return{encode:function m(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var R=0,M=0,$=0,I=b.length;$!==I&&0===b[$];)$++,R++;for(var L=(I-$)*f+1>>>0,g=new Uint8Array(L);$!==I;){for(var S=b[$],O=0,u=L-1;(0!==S||O<M)&&-1!==u;u--,O++)g[u]=(S+=256*g[u]>>>0)%a>>>0,S=S/a>>>0;if(0!==S)throw new Error("Non-zero carry");M=O,$++}for(var p=L-M;p!==L&&0===g[p];)p++;for(var k=h.repeat(R);p<L;++p)k+=t.charAt(g[p]);return k},decodeUnsafe:_,decode:function v(b){var R=_(b);if(R)return R;throw new Error(`Non-${e} character`)}}};const js=t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};class Qf{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ep{constructor(e,r,n){if(this.name=e,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ms(this,e)}}class tp{constructor(e){this.decoders=e}or(e){return Ms(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ms=(t,e)=>new tp({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class rp{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Qf(e,r,n),this.decoder=new ep(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const On=({name:t,prefix:e,encode:r,decode:n})=>new rp(t,e,r,n),Gr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Jf(r,e);return On({prefix:t,name:e,encode:n,decode:o=>js(i(o))})},at=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>On({prefix:e,name:t,encode:i=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(i,n,r),decode:i=>((t,e,r,n)=>{const i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,h=0,l=0;for(let f=0;f<o;++f){const m=i[t[f]];if(void 0===m)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,a+=r,a>=8&&(a-=8,s[l++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return s})(i,n,r,t)}),op=On({prefix:"\0",name:"identity",encode:t=>(t=>(new TextDecoder).decode(t))(t),decode:t=>(t=>(new TextEncoder).encode(t))(t)});var sp=Object.freeze({__proto__:null,identity:op});const ap=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var up=Object.freeze({__proto__:null,base2:ap});const cp=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var lp=Object.freeze({__proto__:null,base8:cp});const hp=Gr({prefix:"9",name:"base10",alphabet:"0123456789"});var fp=Object.freeze({__proto__:null,base10:hp});const pp=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dp=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var yp=Object.freeze({__proto__:null,base16:pp,base16upper:dp});const gp=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vp=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_p=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mp=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bp=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),wp=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ep=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Op=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Sp=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var xp=Object.freeze({__proto__:null,base32:gp,base32upper:vp,base32pad:_p,base32padupper:mp,base32hex:bp,base32hexupper:wp,base32hexpad:Ep,base32hexpadupper:Op,base32z:Sp});const Ip=Gr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fp=Gr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pp=Object.freeze({__proto__:null,base36:Ip,base36upper:Fp});const Lp=Gr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ap=Gr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Np=Object.freeze({__proto__:null,base58btc:Lp,base58flickr:Ap});const Rp=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tp=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jp=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Mp=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Cp=Object.freeze({__proto__:null,base64:Rp,base64pad:Tp,base64url:jp,base64urlpad:Mp});const Cs=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),Up=Cs.reduce((t,e,r)=>(t[r]=e,t),[]),Dp=Cs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);const Kp=On({prefix:"\u{1f680}",name:"base256emoji",encode:function kp(t){return t.reduce((e,r)=>e+Up[r],"")},decode:function zp(t){const e=[];for(const r of t){const n=Dp[r.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}});var Bp=Object.freeze({__proto__:null,base256emoji:Kp}),$p=function Ds(t,e,r){e=e||[];for(var n=r=r||0;t>=qp;)e[r++]=255&t|128,t/=128;for(;-128&t;)e[r++]=255&t|128,t>>>=7;return e[r]=0|t,Ds.bytes=r-n+1,e},qp=Math.pow(2,31);var Gp=function Ei(t,n){var s,r=0,i=0,o=n=n||0,a=t.length;do{if(o>=a)throw Ei.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(127&s)<<i:(127&s)*Math.pow(2,i),i+=7}while(s>=128);return Ei.bytes=o-n,r};var Yp=Math.pow(2,7),Jp=Math.pow(2,14),Xp=Math.pow(2,21),Zp=Math.pow(2,28),Qp=Math.pow(2,35),ed=Math.pow(2,42),td=Math.pow(2,49),rd=Math.pow(2,56),nd=Math.pow(2,63),zs={encode:$p,decode:Gp,encodingLength:function(t){return t<Yp?1:t<Jp?2:t<Xp?3:t<Zp?4:t<Qp?5:t<ed?6:t<td?7:t<rd?8:t<nd?9:10}};const Ks=(t,e,r=0)=>(zs.encode(t,e,r),e),Bs=t=>zs.encodingLength(t),Oi=(t,e)=>{const r=e.byteLength,n=Bs(t),i=n+Bs(r),o=new Uint8Array(i+r);return Ks(t,o,0),Ks(r,o,n),o.set(e,i),new sd(t,r,e,o)};class sd{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const $s=({name:t,code:e,encode:r})=>new ad(t,e,r);class ad{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Oi(this.code,r):r.then(n=>Oi(this.code,n))}throw Error("Unknown type, must be binary type")}}const Vs=t=>function(){var e=x(function*(r){return new Uint8Array(yield crypto.subtle.digest(t,r))});return function(r){return e.apply(this,arguments)}}(),ud=$s({name:"sha2-256",code:18,encode:Vs("SHA-256")}),cd=$s({name:"sha2-512",code:19,encode:Vs("SHA-512")});Object.freeze({__proto__:null,sha256:ud,sha512:cd});const qs=js;Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:qs,digest:t=>Oi(0,qs(t))}}),new TextEncoder,new TextDecoder;const Gs={...sp,...up,...lp,...fp,...yp,...xp,...Pp,...Np,...Cp,...Bp};function Ws(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Ys=Ws("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>(new TextEncoder).encode(t.substring(1))),Si=Ws("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{const e=Ts((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Js={utf8:Ys,"utf-8":Ys,hex:Gs.base16,latin1:Si,ascii:Si,binary:Si,...Gs};function mt(t,e="utf8"){const r=Js[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(t).substring(1):globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8")}function bt(t,e="utf8"){const r=Js[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${t}`):globalThis.Buffer.from(t,"utf8")}function Sn(t){return mt(bt(qr(t),"utf8"),Ns)}function Xs(t){const r="z"+mt(wi([bt("K36",Rs),t]),Rs);return[$f,Vf,r].join(":")}function pd(t){return mt(t,Ns)}function dd(t){return bt([Sn(t.header),Sn(t.payload)].join("."),"utf8")}function yd(t){return[Sn(t.header),Sn(t.payload),pd(t.signature)].join(".")}function Zs(t=xr.randomBytes(32)){return gi.generateKeyPairFromSeed(t)}function xi(){return(xi=x(function*(t,e,r,n,i=Q.fromMiliseconds(Date.now())){const o={alg:"EdDSA",typ:"JWT"},h={iss:Xs(n.publicKey),sub:t,aud:e,iat:i,exp:i+r},l=dd({header:o,payload:h});return yd({header:o,payload:h,signature:gi.sign(n.secretKey,l)})})).apply(this,arguments)}var Ii={},xn={};Object.defineProperty(xn,"__esModule",{value:!0});var ft=ne,Fi=xt;function _d(t,e,r){for(var n=1634760805,i=857760878,o=2036477234,s=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],b=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],M=e[7]<<24|e[6]<<16|e[5]<<8|e[4],$=e[11]<<24|e[10]<<16|e[9]<<8|e[8],I=e[15]<<24|e[14]<<16|e[13]<<8|e[12],L=n,g=i,S=o,O=s,u=a,p=h,k=l,B=f,G=m,X=_,Z=v,d=b,E=R,U=M,D=$,j=I,T=0;T<20;T+=2)u=(u^=G=G+(E=(E^=L=L+u|0)>>>16|E<<16)|0)>>>20|u<<12,p=(p^=X=X+(U=(U^=g=g+p|0)>>>16|U<<16)|0)>>>20|p<<12,k=(k^=Z=Z+(D=(D^=S=S+k|0)>>>16|D<<16)|0)>>>20|k<<12,B=(B^=d=d+(j=(j^=O=O+B|0)>>>16|j<<16)|0)>>>20|B<<12,k=(k^=Z=Z+(D=(D^=S=S+k|0)>>>24|D<<8)|0)>>>25|k<<7,B=(B^=d=d+(j=(j^=O=O+B|0)>>>24|j<<8)|0)>>>25|B<<7,p=(p^=X=X+(U=(U^=g=g+p|0)>>>24|U<<8)|0)>>>25|p<<7,u=(u^=G=G+(E=(E^=L=L+u|0)>>>24|E<<8)|0)>>>25|u<<7,p=(p^=Z=Z+(j=(j^=L=L+p|0)>>>16|j<<16)|0)>>>20|p<<12,k=(k^=d=d+(E=(E^=g=g+k|0)>>>16|E<<16)|0)>>>20|k<<12,B=(B^=G=G+(U=(U^=S=S+B|0)>>>16|U<<16)|0)>>>20|B<<12,u=(u^=X=X+(D=(D^=O=O+u|0)>>>16|D<<16)|0)>>>20|u<<12,B=(B^=G=G+(U=(U^=S=S+B|0)>>>24|U<<8)|0)>>>25|B<<7,u=(u^=X=X+(D=(D^=O=O+u|0)>>>24|D<<8)|0)>>>25|u<<7,k=(k^=d=d+(E=(E^=g=g+k|0)>>>24|E<<8)|0)>>>25|k<<7,p=(p^=Z=Z+(j=(j^=L=L+p|0)>>>24|j<<8)|0)>>>25|p<<7;ft.writeUint32LE(L+n|0,t,0),ft.writeUint32LE(g+i|0,t,4),ft.writeUint32LE(S+o|0,t,8),ft.writeUint32LE(O+s|0,t,12),ft.writeUint32LE(u+a|0,t,16),ft.writeUint32LE(p+h|0,t,20),ft.writeUint32LE(k+l|0,t,24),ft.writeUint32LE(B+f|0,t,28),ft.writeUint32LE(G+m|0,t,32),ft.writeUint32LE(X+_|0,t,36),ft.writeUint32LE(Z+v|0,t,40),ft.writeUint32LE(d+b|0,t,44),ft.writeUint32LE(E+R|0,t,48),ft.writeUint32LE(U+M|0,t,52),ft.writeUint32LE(D+$|0,t,56),ft.writeUint32LE(j+I|0,t,60)}function Qs(t,e,r,n,i){if(void 0===i&&(i=0),32!==t.length)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var o,s;if(0===i){if(8!==e.length&&12!==e.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");(o=new Uint8Array(16)).set(e,s=o.length-e.length)}else{if(16!==e.length)throw new Error("ChaCha nonce with counter must be 16 bytes");o=e,s=i}for(var a=new Uint8Array(64),h=0;h<r.length;h+=64){_d(a,o,t);for(var l=h;l<h+64&&l<r.length;l++)n[l]=r[l]^a[l-h];bd(o,0,s)}return Fi.wipe(a),0===i&&Fi.wipe(o),n}function bd(t,e,r){for(var n=1;r--;)t[e]=255&(n=n+(255&t[e])|0),n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}xn.streamXOR=Qs,xn.stream=function md(t,e,r,n){return void 0===n&&(n=0),Fi.wipe(r),Qs(t,e,r,r,n)};var ea={},Zt={};function ta(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.select=function wd(t,e,r){return~(t-1)&e|t-1&r},Zt.lessOrEqual=function Ed(t,e){return(0|t)-(0|e)-1>>>31&1},Zt.compare=ta,Zt.equal=function Od(t,e){return 0!==t.length&&0!==e.length&&0!==ta(t,e)},function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Zt,r=xt;t.DIGEST_LENGTH=16;var n=function(){function s(a){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=a[0]|a[1]<<8;this._r[0]=8191&h;var l=a[2]|a[3]<<8;this._r[1]=8191&(h>>>13|l<<3);var f=a[4]|a[5]<<8;this._r[2]=7939&(l>>>10|f<<6);var m=a[6]|a[7]<<8;this._r[3]=8191&(f>>>7|m<<9);var _=a[8]|a[9]<<8;this._r[4]=255&(m>>>4|_<<12),this._r[5]=_>>>1&8190;var v=a[10]|a[11]<<8;this._r[6]=8191&(_>>>14|v<<2);var b=a[12]|a[13]<<8;this._r[7]=8065&(v>>>11|b<<5);var R=a[14]|a[15]<<8;this._r[8]=8191&(b>>>8|R<<8),this._r[9]=R>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return s.prototype._blocks=function(a,h,l){for(var f=this._fin?0:2048,m=this._h[0],_=this._h[1],v=this._h[2],b=this._h[3],R=this._h[4],M=this._h[5],$=this._h[6],I=this._h[7],L=this._h[8],g=this._h[9],S=this._r[0],O=this._r[1],u=this._r[2],p=this._r[3],k=this._r[4],B=this._r[5],G=this._r[6],X=this._r[7],Z=this._r[8],d=this._r[9];l>=16;){var E=a[h+0]|a[h+1]<<8,U=a[h+2]|a[h+3]<<8,D=a[h+4]|a[h+5]<<8,j=a[h+6]|a[h+7]<<8,T=a[h+8]|a[h+9]<<8,z=a[h+10]|a[h+11]<<8,K=a[h+12]|a[h+13]<<8,ee=a[h+14]|a[h+15]<<8,V=0,te=V;te+=(m+=8191&E)*S,te+=(_+=8191&(E>>>13|U<<3))*(5*d),te+=(v+=8191&(U>>>10|D<<6))*(5*Z),te+=(b+=8191&(D>>>7|j<<9))*(5*X),V=(te+=(R+=8191&(j>>>4|T<<12))*(5*G))>>>13,te&=8191,te+=(M+=T>>>1&8191)*(5*B),te+=($+=8191&(T>>>14|z<<2))*(5*k),te+=(I+=8191&(z>>>11|K<<5))*(5*p),te+=(L+=8191&(K>>>8|ee<<8))*(5*u);var J=V+=(te+=(g+=ee>>>5|f)*(5*O))>>>13;J+=m*O,J+=_*S,J+=v*(5*d),J+=b*(5*Z),V=(J+=R*(5*X))>>>13,J&=8191,J+=M*(5*G),J+=$*(5*B),J+=I*(5*k),J+=L*(5*p),V+=(J+=g*(5*u))>>>13,J&=8191;var ue=V;ue+=m*u,ue+=_*O,ue+=v*S,ue+=b*(5*d),V=(ue+=R*(5*Z))>>>13,ue&=8191,ue+=M*(5*X),ue+=$*(5*G),ue+=I*(5*B),ue+=L*(5*k);var N=V+=(ue+=g*(5*p))>>>13;N+=m*p,N+=_*u,N+=v*O,N+=b*S,V=(N+=R*(5*d))>>>13,N&=8191,N+=M*(5*Z),N+=$*(5*X),N+=I*(5*G),N+=L*(5*B);var A=V+=(N+=g*(5*k))>>>13;A+=m*k,A+=_*p,A+=v*u,A+=b*O,V=(A+=R*S)>>>13,A&=8191,A+=M*(5*d),A+=$*(5*Z),A+=I*(5*X),A+=L*(5*G);var F=V+=(A+=g*(5*B))>>>13;F+=m*B,F+=_*k,F+=v*p,F+=b*u,V=(F+=R*O)>>>13,F&=8191,F+=M*S,F+=$*(5*d),F+=I*(5*Z),F+=L*(5*X);var c=V+=(F+=g*(5*G))>>>13;c+=m*G,c+=_*B,c+=v*k,c+=b*p,V=(c+=R*u)>>>13,c&=8191,c+=M*O,c+=$*S,c+=I*(5*d),c+=L*(5*Z);var w=V+=(c+=g*(5*X))>>>13;w+=m*X,w+=_*G,w+=v*B,w+=b*k,V=(w+=R*p)>>>13,w&=8191,w+=M*u,w+=$*O,w+=I*S,w+=L*(5*d);var H=V+=(w+=g*(5*Z))>>>13;H+=m*Z,H+=_*X,H+=v*G,H+=b*B,V=(H+=R*k)>>>13,H&=8191,H+=M*p,H+=$*u,H+=I*O,H+=L*S;var W=V+=(H+=g*(5*d))>>>13;W+=m*d,W+=_*Z,W+=v*X,W+=b*G,V=(W+=R*B)>>>13,W&=8191,W+=M*k,W+=$*p,W+=I*u,W+=L*O,m=te=8191&(V=(V=((V+=(W+=g*S)>>>13)<<2)+V|0)+(te&=8191)|0),_=J+=V>>>=13,v=ue&=8191,b=N&=8191,R=A&=8191,M=F&=8191,$=c&=8191,I=w&=8191,L=H&=8191,g=W&=8191,h+=16,l-=16}this._h[0]=m,this._h[1]=_,this._h[2]=v,this._h[3]=b,this._h[4]=R,this._h[5]=M,this._h[6]=$,this._h[7]=I,this._h[8]=L,this._h[9]=g},s.prototype.finish=function(a,h){void 0===h&&(h=0);var f,m,_,v,l=new Uint16Array(10);if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=f,f=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=5*f,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,l[0]=this._h[0]+5,f=l[0]>>>13,l[0]&=8191,v=1;v<10;v++)l[v]=this._h[v]+f,f=l[v]>>>13,l[v]&=8191;for(l[9]-=8192,m=(1^f)-1,v=0;v<10;v++)l[v]&=m;for(m=~m,v=0;v<10;v++)this._h[v]=this._h[v]&m|l[v];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),this._h[0]=65535&(_=this._h[0]+this._pad[0]),v=1;v<8;v++)this._h[v]=65535&(_=(this._h[v]+this._pad[v]|0)+(_>>>16)|0);return a[h+0]=this._h[0]>>>0,a[h+1]=this._h[0]>>>8,a[h+2]=this._h[1]>>>0,a[h+3]=this._h[1]>>>8,a[h+4]=this._h[2]>>>0,a[h+5]=this._h[2]>>>8,a[h+6]=this._h[3]>>>0,a[h+7]=this._h[3]>>>8,a[h+8]=this._h[4]>>>0,a[h+9]=this._h[4]>>>8,a[h+10]=this._h[5]>>>0,a[h+11]=this._h[5]>>>8,a[h+12]=this._h[6]>>>0,a[h+13]=this._h[6]>>>8,a[h+14]=this._h[7]>>>0,a[h+15]=this._h[7]>>>8,this._finished=!0,this},s.prototype.update=function(a){var f,h=0,l=a.length;if(this._leftover){(f=16-this._leftover)>l&&(f=l);for(var m=0;m<f;m++)this._buffer[this._leftover+m]=a[h+m];if(l-=f,h+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(this._blocks(a,h,f=l-l%16),h+=f,l-=f),l){for(m=0;m<l;m++)this._buffer[this._leftover+m]=a[h+m];this._leftover+=l}return this},s.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},s.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},s}();t.Poly1305=n,t.oneTimeAuth=function i(s,a){var h=new n(s);h.update(a);var l=h.digest();return h.clean(),l},t.equal=function o(s,a){return s.length===t.DIGEST_LENGTH&&a.length===t.DIGEST_LENGTH&&e.equal(s,a)}}(ea),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=xn,r=ea,n=xt,i=ne,o=Zt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var s=new Uint8Array(16),a=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,f,m,_){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(l,v.length-l.length);var b=new Uint8Array(32);e.stream(this._key,v,b,4);var M,R=f.length+this.tagLength;if(_){if(_.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");M=_}else M=new Uint8Array(R);return e.streamXOR(this._key,v,f,M,4),this._authenticate(M.subarray(M.length-this.tagLength,M.length),b,M.subarray(0,M.length-this.tagLength),m),n.wipe(v),M},h.prototype.open=function(l,f,m,_){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(l,v.length-l.length);var b=new Uint8Array(32);e.stream(this._key,v,b,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,b,f.subarray(0,f.length-this.tagLength),m),!o.equal(R,f.subarray(f.length-this.tagLength,f.length)))return null;var $,M=f.length-this.tagLength;if(_){if(_.length!==M)throw new Error("ChaCha20Poly1305: incorrect destination length");$=_}else $=new Uint8Array(M);return e.streamXOR(this._key,v,f.subarray(0,f.length-this.tagLength),$,4),n.wipe(v),$},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(l,f,m,_){var v=new r.Poly1305(f);_&&(v.update(_),_.length%16>0&&v.update(s.subarray(_.length%16))),v.update(m),m.length%16>0&&v.update(s.subarray(m.length%16));var b=new Uint8Array(8);_&&i.writeUint64LE(_.length,b),v.update(b),i.writeUint64LE(m.length,b),v.update(b);for(var R=v.digest(),M=0;M<R.length;M++)l[M]=R[M];v.clean(),n.wipe(R),n.wipe(b)},h}();t.ChaCha20Poly1305=a}(Ii);var ra={},Wr={},Pi={};Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.isSerializableHash=function Sd(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"},Object.defineProperty(Wr,"__esModule",{value:!0});var Ut=Pi,xd=Zt,Id=xt,na=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;for(this._inner.update(n),i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Ut.isSerializableHash(this._inner)&&Ut.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Id.wipe(n)}return t.prototype.reset=function(){if(!Ut.isSerializableHash(this._inner)||!Ut.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ut.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ut.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ut.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ut.isSerializableHash(this._inner)||!Ut.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ut.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Wr.HMAC=na,Wr.hmac=function Fd(t,e,r){var n=new na(t,e);n.update(r);var i=n.digest();return n.clean(),i},Wr.equal=xd.equal,Object.defineProperty(ra,"__esModule",{value:!0});var ia=Wr,oa=xt,Pd=function(){function t(e,r,n,i){void 0===n&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var o=ia.hmac(this._hash,n,r);this._hmac=new ia.HMAC(e,o),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),oa.wipe(this._buffer),oa.wipe(this._counter),this._bufpos=0},t}(),Ld=ra.HKDF=Pd,In={};!function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=xt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},a.prototype.update=function(h,l){if(void 0===l&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[f++],l--;this._bufferLength===this.blockSize&&(o(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(f=o(this._temp,this._state,h,f,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[f++],l--;return this},a.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,f=this._bufferLength,m=l/536870912|0,_=l<<3,v=l%64<56?64:128;this._buffer[f]=128;for(var b=f+1;b<v-8;b++)this._buffer[b]=0;e.writeUint32BE(m,this._buffer,v-8),e.writeUint32BE(_,this._buffer,v-4),o(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(b=0;b<this.digestLength/4;b++)e.writeUint32BE(this._state[b],h,4*b);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function o(a,h,l,f,m){for(;m>=64;){for(var _=h[0],v=h[1],b=h[2],R=h[3],M=h[4],$=h[5],I=h[6],L=h[7],g=0;g<16;g++)a[g]=e.readUint32BE(l,f+4*g);for(g=16;g<64;g++){var O=a[g-2];a[g]=((u=(O>>>17|O<<15)^(O>>>19|O<<13)^O>>>10)+a[g-7]|0)+((p=((O=a[g-15])>>>7|O<<25)^(O>>>18|O<<14)^O>>>3)+a[g-16]|0)}for(g=0;g<64;g++){var u=(((M>>>6|M<<26)^(M>>>11|M<<21)^(M>>>25|M<<7))+(M&$^~M&I)|0)+(L+(i[g]+a[g]|0)|0)|0,p=((_>>>2|_<<30)^(_>>>13|_<<19)^(_>>>22|_<<10))+(_&v^_&b^v&b)|0;L=I,I=$,$=M,M=R+u|0,R=b,b=v,v=_,_=u+p|0}h[0]+=_,h[1]+=v,h[2]+=b,h[3]+=R,h[4]+=M,h[5]+=$,h[6]+=I,h[7]+=L,f+=64,m-=64}return f}t.hash=function s(a){var h=new n;h.update(a);var l=h.digest();return h.clean(),l}}(In);var Li={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=xr,r=xt;function n(g){const S=new Float64Array(16);if(g)for(let O=0;O<g.length;O++)S[O]=g[O];return S}t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;const i=new Uint8Array(32);i[0]=9;const o=n([56129,1]);function s(g){let S=1;for(let O=0;O<16;O++){let u=g[O]+S+65535;S=Math.floor(u/65536),g[O]=u-65536*S}g[0]+=S-1+37*(S-1)}function a(g,S,O){const u=~(O-1);for(let p=0;p<16;p++){const k=u&(g[p]^S[p]);g[p]^=k,S[p]^=k}}function f(g,S,O){for(let u=0;u<16;u++)g[u]=S[u]+O[u]}function m(g,S,O){for(let u=0;u<16;u++)g[u]=S[u]-O[u]}function _(g,S,O){let u,p,k=0,B=0,G=0,X=0,Z=0,d=0,E=0,U=0,D=0,j=0,T=0,z=0,K=0,ee=0,V=0,te=0,J=0,ue=0,N=0,A=0,F=0,c=0,w=0,H=0,W=0,pe=0,be=0,ge=0,Oe=0,Ve=0,De=0,me=O[0],ve=O[1],de=O[2],le=O[3],ce=O[4],ae=O[5],oe=O[6],re=O[7],he=O[8],_e=O[9],ie=O[10],we=O[11],Ee=O[12],xe=O[13],Ie=O[14],Se=O[15];u=S[0],k+=u*me,B+=u*ve,G+=u*de,X+=u*le,Z+=u*ce,d+=u*ae,E+=u*oe,U+=u*re,D+=u*he,j+=u*_e,T+=u*ie,z+=u*we,K+=u*Ee,ee+=u*xe,V+=u*Ie,te+=u*Se,u=S[1],B+=u*me,G+=u*ve,X+=u*de,Z+=u*le,d+=u*ce,E+=u*ae,U+=u*oe,D+=u*re,j+=u*he,T+=u*_e,z+=u*ie,K+=u*we,ee+=u*Ee,V+=u*xe,te+=u*Ie,J+=u*Se,u=S[2],G+=u*me,X+=u*ve,Z+=u*de,d+=u*le,E+=u*ce,U+=u*ae,D+=u*oe,j+=u*re,T+=u*he,z+=u*_e,K+=u*ie,ee+=u*we,V+=u*Ee,te+=u*xe,J+=u*Ie,ue+=u*Se,u=S[3],X+=u*me,Z+=u*ve,d+=u*de,E+=u*le,U+=u*ce,D+=u*ae,j+=u*oe,T+=u*re,z+=u*he,K+=u*_e,ee+=u*ie,V+=u*we,te+=u*Ee,J+=u*xe,ue+=u*Ie,N+=u*Se,u=S[4],Z+=u*me,d+=u*ve,E+=u*de,U+=u*le,D+=u*ce,j+=u*ae,T+=u*oe,z+=u*re,K+=u*he,ee+=u*_e,V+=u*ie,te+=u*we,J+=u*Ee,ue+=u*xe,N+=u*Ie,A+=u*Se,u=S[5],d+=u*me,E+=u*ve,U+=u*de,D+=u*le,j+=u*ce,T+=u*ae,z+=u*oe,K+=u*re,ee+=u*he,V+=u*_e,te+=u*ie,J+=u*we,ue+=u*Ee,N+=u*xe,A+=u*Ie,F+=u*Se,u=S[6],E+=u*me,U+=u*ve,D+=u*de,j+=u*le,T+=u*ce,z+=u*ae,K+=u*oe,ee+=u*re,V+=u*he,te+=u*_e,J+=u*ie,ue+=u*we,N+=u*Ee,A+=u*xe,F+=u*Ie,c+=u*Se,u=S[7],U+=u*me,D+=u*ve,j+=u*de,T+=u*le,z+=u*ce,K+=u*ae,ee+=u*oe,V+=u*re,te+=u*he,J+=u*_e,ue+=u*ie,N+=u*we,A+=u*Ee,F+=u*xe,c+=u*Ie,w+=u*Se,u=S[8],D+=u*me,j+=u*ve,T+=u*de,z+=u*le,K+=u*ce,ee+=u*ae,V+=u*oe,te+=u*re,J+=u*he,ue+=u*_e,N+=u*ie,A+=u*we,F+=u*Ee,c+=u*xe,w+=u*Ie,H+=u*Se,u=S[9],j+=u*me,T+=u*ve,z+=u*de,K+=u*le,ee+=u*ce,V+=u*ae,te+=u*oe,J+=u*re,ue+=u*he,N+=u*_e,A+=u*ie,F+=u*we,c+=u*Ee,w+=u*xe,H+=u*Ie,W+=u*Se,u=S[10],T+=u*me,z+=u*ve,K+=u*de,ee+=u*le,V+=u*ce,te+=u*ae,J+=u*oe,ue+=u*re,N+=u*he,A+=u*_e,F+=u*ie,c+=u*we,w+=u*Ee,H+=u*xe,W+=u*Ie,pe+=u*Se,u=S[11],z+=u*me,K+=u*ve,ee+=u*de,V+=u*le,te+=u*ce,J+=u*ae,ue+=u*oe,N+=u*re,A+=u*he,F+=u*_e,c+=u*ie,w+=u*we,H+=u*Ee,W+=u*xe,pe+=u*Ie,be+=u*Se,u=S[12],K+=u*me,ee+=u*ve,V+=u*de,te+=u*le,J+=u*ce,ue+=u*ae,N+=u*oe,A+=u*re,F+=u*he,c+=u*_e,w+=u*ie,H+=u*we,W+=u*Ee,pe+=u*xe,be+=u*Ie,ge+=u*Se,u=S[13],ee+=u*me,V+=u*ve,te+=u*de,J+=u*le,ue+=u*ce,N+=u*ae,A+=u*oe,F+=u*re,c+=u*he,w+=u*_e,H+=u*ie,W+=u*we,pe+=u*Ee,be+=u*xe,ge+=u*Ie,Oe+=u*Se,u=S[14],V+=u*me,te+=u*ve,J+=u*de,ue+=u*le,N+=u*ce,A+=u*ae,F+=u*oe,c+=u*re,w+=u*he,H+=u*_e,W+=u*ie,pe+=u*we,be+=u*Ee,ge+=u*xe,Oe+=u*Ie,Ve+=u*Se,u=S[15],te+=u*me,J+=u*ve,ue+=u*de,N+=u*le,A+=u*ce,F+=u*ae,c+=u*oe,w+=u*re,H+=u*he,W+=u*_e,pe+=u*ie,be+=u*we,ge+=u*Ee,Oe+=u*xe,Ve+=u*Ie,De+=u*Se,k+=38*J,B+=38*ue,G+=38*N,X+=38*A,Z+=38*F,d+=38*c,E+=38*w,U+=38*H,D+=38*W,j+=38*pe,T+=38*be,z+=38*ge,K+=38*Oe,ee+=38*Ve,V+=38*De,p=1,u=k+p+65535,p=Math.floor(u/65536),k=u-65536*p,u=B+p+65535,p=Math.floor(u/65536),B=u-65536*p,u=G+p+65535,p=Math.floor(u/65536),G=u-65536*p,u=X+p+65535,p=Math.floor(u/65536),X=u-65536*p,u=Z+p+65535,p=Math.floor(u/65536),Z=u-65536*p,u=d+p+65535,p=Math.floor(u/65536),d=u-65536*p,u=E+p+65535,p=Math.floor(u/65536),E=u-65536*p,u=U+p+65535,p=Math.floor(u/65536),U=u-65536*p,u=D+p+65535,p=Math.floor(u/65536),D=u-65536*p,u=j+p+65535,p=Math.floor(u/65536),j=u-65536*p,u=T+p+65535,p=Math.floor(u/65536),T=u-65536*p,u=z+p+65535,p=Math.floor(u/65536),z=u-65536*p,u=K+p+65535,p=Math.floor(u/65536),K=u-65536*p,u=ee+p+65535,p=Math.floor(u/65536),ee=u-65536*p,u=V+p+65535,p=Math.floor(u/65536),V=u-65536*p,u=te+p+65535,p=Math.floor(u/65536),te=u-65536*p,k+=p-1+37*(p-1),p=1,u=k+p+65535,p=Math.floor(u/65536),k=u-65536*p,u=B+p+65535,p=Math.floor(u/65536),B=u-65536*p,u=G+p+65535,p=Math.floor(u/65536),G=u-65536*p,u=X+p+65535,p=Math.floor(u/65536),X=u-65536*p,u=Z+p+65535,p=Math.floor(u/65536),Z=u-65536*p,u=d+p+65535,p=Math.floor(u/65536),d=u-65536*p,u=E+p+65535,p=Math.floor(u/65536),E=u-65536*p,u=U+p+65535,p=Math.floor(u/65536),U=u-65536*p,u=D+p+65535,p=Math.floor(u/65536),D=u-65536*p,u=j+p+65535,p=Math.floor(u/65536),j=u-65536*p,u=T+p+65535,p=Math.floor(u/65536),T=u-65536*p,u=z+p+65535,p=Math.floor(u/65536),z=u-65536*p,u=K+p+65535,p=Math.floor(u/65536),K=u-65536*p,u=ee+p+65535,p=Math.floor(u/65536),ee=u-65536*p,u=V+p+65535,p=Math.floor(u/65536),V=u-65536*p,u=te+p+65535,p=Math.floor(u/65536),te=u-65536*p,k+=p-1+37*(p-1),g[0]=k,g[1]=B,g[2]=G,g[3]=X,g[4]=Z,g[5]=d,g[6]=E,g[7]=U,g[8]=D,g[9]=j,g[10]=T,g[11]=z,g[12]=K,g[13]=ee,g[14]=V,g[15]=te}function v(g,S){_(g,S,S)}function R(g,S){const O=new Uint8Array(32),u=new Float64Array(80),p=n(),k=n(),B=n(),G=n(),X=n(),Z=n();for(let D=0;D<31;D++)O[D]=g[D];O[31]=127&g[31]|64,O[0]&=248,function l(g,S){for(let O=0;O<16;O++)g[O]=S[2*O]+(S[2*O+1]<<8);g[15]&=32767}(u,S);for(let D=0;D<16;D++)k[D]=u[D];p[0]=G[0]=1;for(let D=254;D>=0;--D){const j=O[D>>>3]>>>(7&D)&1;a(p,k,j),a(B,G,j),f(X,p,B),m(p,p,B),f(B,k,G),m(k,k,G),v(G,X),v(Z,p),_(p,B,p),_(B,k,X),f(X,p,B),m(p,p,B),v(k,p),m(B,G,Z),_(p,B,o),f(p,p,G),_(B,B,p),_(p,G,Z),_(G,k,u),v(k,X),a(p,k,j),a(B,G,j)}for(let D=0;D<16;D++)u[D+16]=p[D],u[D+32]=B[D],u[D+48]=k[D],u[D+64]=G[D];const d=u.subarray(32),E=u.subarray(16);(function b(g,S){const O=n();for(let u=0;u<16;u++)O[u]=S[u];for(let u=253;u>=0;u--)v(O,O),2!==u&&4!==u&&_(O,O,S);for(let u=0;u<16;u++)g[u]=O[u]})(d,d),_(E,E,d);const U=new Uint8Array(32);return function h(g,S){const O=n(),u=n();for(let p=0;p<16;p++)u[p]=S[p];s(u),s(u),s(u);for(let p=0;p<2;p++){O[0]=u[0]-65517;for(let B=1;B<15;B++)O[B]=u[B]-65535-(O[B-1]>>16&1),O[B-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const k=O[15]>>16&1;O[14]&=65535,a(u,O,1-k)}for(let p=0;p<16;p++)g[2*p]=255&u[p],g[2*p+1]=u[p]>>8}(U,E),U}function M(g){return R(g,i)}function $(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const S=new Uint8Array(g);return{publicKey:M(S),secretKey:S}}t.scalarMult=R,t.scalarMultBase=M,t.generateKeyPairFromSeed=$,t.generateKeyPair=function I(g){const S=(0,e.randomBytes)(32,g),O=$(S);return(0,r.wipe)(S),O},t.sharedKey=function L(g,S,O=!1){if(g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(S.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=R(g,S);if(O){let p=0;for(let k=0;k<u.length;k++)p|=u[k];if(0===p)throw new Error("X25519: invalid shared key")}return u}}(Li);var sa=function(t,e,r){if(r||2===arguments.length)for(var o,n=0,i=e.length;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},Ad=function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"},Nd=function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},Rd=function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"},Td=function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},jd=function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Cd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ud=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],ua=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Dd(t){return t?ca(t):typeof document>"u"&&typeof navigator<"u"&&"ReactNative"===navigator.product?new jd:typeof navigator<"u"?ca(navigator.userAgent):function Kd(){return typeof process<"u"&&process.version?new Nd(process.version.slice(1)):null}()}function ca(t){var e=function kd(t){return""!==t&&Ud.reduce(function(e,r){var n=r[0];if(e)return e;var o=r[1].exec(t);return!!o&&[n,o]},!1)}(t);if(!e)return null;var r=e[0],n=e[1];if("searchbot"===r)return new Td;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=sa(sa([],i,!0),function Bd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}(3-i.length),!0)):i=[];var o=i.join("."),s=function zd(t){for(var e=0,r=ua.length;e<r;e++){var n=ua[e],i=n[0];if(n[1].exec(t))return i}return null}(t),a=Cd.exec(t);return a&&a[1]?new Rd(r,o,s,a[1]):new Ad(r,o,s)}var je={};function lr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}function Ir(t){const e=lr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Object.defineProperty(je,"__esModule",{value:!0}),je.getLocalStorage=je.getLocalStorageOrThrow=je.getCrypto=je.getCryptoOrThrow=ha=je.getLocation=je.getLocationOrThrow=Ai=je.getNavigator=je.getNavigatorOrThrow=la=je.getDocument=je.getDocumentOrThrow=je.getFromWindowOrThrow=je.getFromWindow=void 0,je.getFromWindow=lr,je.getFromWindowOrThrow=Ir,je.getDocumentOrThrow=function $d(){return Ir("document")};var la=je.getDocument=function Vd(){return lr("document")};je.getNavigatorOrThrow=function Hd(){return Ir("navigator")};var Ai=je.getNavigator=function qd(){return lr("navigator")};je.getLocationOrThrow=function Gd(){return Ir("location")};var ha=je.getLocation=function Wd(){return lr("location")};je.getCryptoOrThrow=function Yd(){return Ir("crypto")},je.getCrypto=function Jd(){return lr("crypto")},je.getLocalStorageOrThrow=function Xd(){return Ir("localStorage")},je.getLocalStorage=function Zd(){return lr("localStorage")};var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0});var fa=Ni.getWindowMetadata=void 0;const pa=je;fa=Ni.getWindowMetadata=function Qd(){let t,e;try{t=pa.getDocumentOrThrow(),e=pa.getLocationOrThrow()}catch{return null}function n(...f){const m=t.getElementsByTagName("meta");for(let _=0;_<m.length;_++){const v=m[_],b=["itemprop","property","name"].map(R=>v.getAttribute(R)).filter(R=>!!R&&f.includes(R));if(b.length&&b){const R=v.getAttribute("content");if(R)return R}}return""}const s=function i(){let f=n("name","og:site_name","og:title","twitter:title");return f||(f=t.title),f}();return{description:function o(){return n("description","og:description","twitter:description","keywords")}(),url:e.origin,icons:function r(){const f=t.getElementsByTagName("link"),m=[];for(let _=0;_<f.length;_++){const v=f[_],b=v.getAttribute("rel");if(b&&b.toLowerCase().indexOf("icon")>-1){const R=v.getAttribute("href");if(R)if(-1===R.toLowerCase().indexOf("https:")&&-1===R.toLowerCase().indexOf("http:")&&0!==R.indexOf("//")){let M=e.protocol+"//"+e.host;if(0===R.indexOf("/"))M+=R;else{const $=e.pathname.split("/");$.pop(),M+=$.join("/")+"/"+R}m.push(M)}else 0===R.indexOf("//")?m.push(e.protocol+R):m.push(R)}}return m}(),name:s}};var Yr={},ey=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),da="%[a-f0-9]{2}",ya=new RegExp(da,"gi"),ga=new RegExp("("+da+")+","gi");function Ri(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(1===t.length)return t;var r=t.slice(0,e=e||1),n=t.slice(e);return Array.prototype.concat.call([],Ri(r),Ri(n))}function ty(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(ya),r=1;r<e.length;r++)e=(t=Ri(e,r).join("")).match(ya);return t}}var ny=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return function ry(t){for(var e={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=ga.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=ty(r[0]);n!==r[0]&&(e[r[0]]=n)}r=ga.exec(t)}e["%C2"]="\ufffd";for(var i=Object.keys(e),o=0;o<i.length;o++){var s=i[o];t=t.replace(new RegExp(s,"g"),e[s])}return t}(t)}},iy=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const r=t.indexOf(e);return-1===r?[t]:[t.slice(0,r),t.slice(r+e.length)]},oy=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),o=0;o<n.length;o++){var s=n[o],a=t[s];(i?-1!==e.indexOf(s):e(s,a,t))&&(r[s]=a)}return r};!function(t){const e=ey,r=ny,n=iy,i=oy,s=Symbol("encodeFragmentIdentifier");function l(I){if("string"!=typeof I||1!==I.length)throw new TypeError("arrayFormatSeparator must be single character string")}function f(I,L){return L.encode?L.strict?e(I):encodeURIComponent(I):I}function m(I,L){return L.decode?r(I):I}function _(I){return Array.isArray(I)?I.sort():"object"==typeof I?_(Object.keys(I)).sort((L,g)=>Number(L)-Number(g)).map(L=>I[L]):I}function v(I){const L=I.indexOf("#");return-1!==L&&(I=I.slice(0,L)),I}function R(I){const L=(I=v(I)).indexOf("?");return-1===L?"":I.slice(L+1)}function M(I,L){return L.parseNumbers&&!Number.isNaN(Number(I))&&"string"==typeof I&&""!==I.trim()?I=Number(I):L.parseBooleans&&null!==I&&("true"===I.toLowerCase()||"false"===I.toLowerCase())&&(I="true"===I.toLowerCase()),I}function $(I,L){l((L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L)).arrayFormatSeparator);const g=function h(I){let L;switch(I.arrayFormat){case"index":return(g,S,O)=>{L=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),L?(void 0===O[g]&&(O[g]={}),O[g][L[1]]=S):O[g]=S};case"bracket":return(g,S,O)=>{L=/(\[\])$/.exec(g),O[g=g.replace(/\[\]$/,"")]=L?void 0!==O[g]?[].concat(O[g],S):[S]:S};case"colon-list-separator":return(g,S,O)=>{L=/(:list)$/.exec(g),O[g=g.replace(/:list$/,"")]=L?void 0!==O[g]?[].concat(O[g],S):[S]:S};case"comma":case"separator":return(g,S,O)=>{const u="string"==typeof S&&S.includes(I.arrayFormatSeparator),p="string"==typeof S&&!u&&m(S,I).includes(I.arrayFormatSeparator);S=p?m(S,I):S;const k=u||p?S.split(I.arrayFormatSeparator).map(B=>m(B,I)):null===S?S:m(S,I);O[g]=k};case"bracket-separator":return(g,S,O)=>{const u=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!u)return void(O[g]=S&&m(S,I));const p=null===S?[]:S.split(I.arrayFormatSeparator).map(k=>m(k,I));O[g]=void 0!==O[g]?[].concat(O[g],p):p};default:return(g,S,O)=>{O[g]=void 0!==O[g]?[].concat(O[g],S):S}}}(L),S=Object.create(null);if("string"!=typeof I||!(I=I.trim().replace(/^[?#&]/,"")))return S;for(const O of I.split("&")){if(""===O)continue;let[u,p]=n(L.decode?O.replace(/\+/g," "):O,"=");p=void 0===p?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?p:m(p,L),g(m(u,L),p,S)}for(const O of Object.keys(S)){const u=S[O];if("object"==typeof u&&null!==u)for(const p of Object.keys(u))u[p]=M(u[p],L);else S[O]=M(u,L)}return!1===L.sort?S:(!0===L.sort?Object.keys(S).sort():Object.keys(S).sort(L.sort)).reduce((O,u)=>{const p=S[u];return O[u]=Boolean(p)&&"object"==typeof p&&!Array.isArray(p)?_(p):p,O},Object.create(null))}t.extract=R,t.parse=$,t.stringify=(I,L)=>{if(!I)return"";l((L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L)).arrayFormatSeparator);const g=p=>L.skipNull&&(I=>null==I)(I[p])||L.skipEmptyString&&""===I[p],S=function a(I){switch(I.arrayFormat){case"index":return L=>(g,S)=>{const O=g.length;return void 0===S||I.skipNull&&null===S||I.skipEmptyString&&""===S?g:null===S?[...g,[f(L,I),"[",O,"]"].join("")]:[...g,[f(L,I),"[",f(O,I),"]=",f(S,I)].join("")]};case"bracket":return L=>(g,S)=>void 0===S||I.skipNull&&null===S||I.skipEmptyString&&""===S?g:null===S?[...g,[f(L,I),"[]"].join("")]:[...g,[f(L,I),"[]=",f(S,I)].join("")];case"colon-list-separator":return L=>(g,S)=>void 0===S||I.skipNull&&null===S||I.skipEmptyString&&""===S?g:null===S?[...g,[f(L,I),":list="].join("")]:[...g,[f(L,I),":list=",f(S,I)].join("")];case"comma":case"separator":case"bracket-separator":{const L="bracket-separator"===I.arrayFormat?"[]=":"=";return g=>(S,O)=>void 0===O||I.skipNull&&null===O||I.skipEmptyString&&""===O?S:(O=null===O?"":O,0===S.length?[[f(g,I),L,f(O,I)].join("")]:[[S,f(O,I)].join(I.arrayFormatSeparator)])}default:return L=>(g,S)=>void 0===S||I.skipNull&&null===S||I.skipEmptyString&&""===S?g:null===S?[...g,f(L,I)]:[...g,[f(L,I),"=",f(S,I)].join("")]}}(L),O={};for(const p of Object.keys(I))g(p)||(O[p]=I[p]);const u=Object.keys(O);return!1!==L.sort&&u.sort(L.sort),u.map(p=>{const k=I[p];return void 0===k?"":null===k?f(p,L):Array.isArray(k)?0===k.length&&"bracket-separator"===L.arrayFormat?f(p,L)+"[]":k.reduce(S(p),[]).join("&"):f(p,L)+"="+f(k,L)}).filter(p=>p.length>0).join("&")},t.parseUrl=(I,L)=>{L=Object.assign({decode:!0},L);const[g,S]=n(I,"#");return Object.assign({url:g.split("?")[0]||"",query:$(R(I),L)},L&&L.parseFragmentIdentifier&&S?{fragmentIdentifier:m(S,L)}:{})},t.stringifyUrl=(I,L)=>{L=Object.assign({encode:!0,strict:!0,[s]:!0},L);const g=v(I.url).split("?")[0]||"",S=t.extract(I.url),O=t.parse(S,{sort:!1}),u=Object.assign(O,I.query);let p=t.stringify(u,L);p&&(p=`?${p}`);let k=function b(I){let L="";const g=I.indexOf("#");return-1!==g&&(L=I.slice(g)),L}(I.url);return I.fragmentIdentifier&&(k=`#${L[s]?f(I.fragmentIdentifier,L):I.fragmentIdentifier}`),`${g}${p}${k}`},t.pick=(I,L,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[s]:!1},g);const{url:S,query:O,fragmentIdentifier:u}=t.parseUrl(I,g);return t.stringifyUrl({url:S,query:i(O,L),fragmentIdentifier:u},g)},t.exclude=(I,L,g)=>{const S=Array.isArray(L)?O=>!L.includes(O):(O,u)=>!L(O,u);return t.pick(I,S,g)}}(Yr);const sy={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},wt="base16",Ti="base64pad",ji="utf8";function Ui(){return mt(xr.randomBytes(32),wt)}function Di(t){return mt(In.hash(bt(t,ji)),wt)}function Jr(t){return Number(mt(t,"base10"))}function fy(t){const e=function hy(t){return bt(`${t}`,"base10")}(typeof t.type<"u"?t.type:0);if(1===Jr(e)&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?bt(t.senderPublicKey,wt):void 0,n=typeof t.iv<"u"?bt(t.iv,wt):xr.randomBytes(12);return function dy(t){if(1===Jr(t.type)){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return mt(wi([t.type,t.senderPublicKey,t.iv,t.sealed]),Ti)}return mt(wi([t.type,t.iv,t.sealed]),Ti)}({type:e,sealed:new Ii.ChaCha20Poly1305(bt(t.symKey,wt)).seal(n,bt(t.message,ji)),iv:n,senderPublicKey:r})}function ki(t){const e=bt(t,Ti),r=e.slice(0,1);if(1===Jr(r)){const a=33,h=a+12,l=e.slice(1,a),f=e.slice(a,h);return{type:r,sealed:e.slice(h),iv:f,senderPublicKey:l}}const o=e.slice(1,13);return{type:r,sealed:e.slice(13),iv:o}}function ba(t){const e=t?.type||0;if(1===e){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function wa(t){return 1===t.type&&"string"==typeof t.senderPublicKey&&"string"==typeof t.receiverPublicKey}var gy=Object.defineProperty,Ea=Object.getOwnPropertySymbols,vy=Object.prototype.hasOwnProperty,_y=Object.prototype.propertyIsEnumerable,Oa=(t,e,r)=>e in t?gy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sa=(t,e)=>{for(var r in e||(e={}))vy.call(e,r)&&Oa(t,r,e[r]);if(Ea)for(var r of Ea(e))_y.call(e,r)&&Oa(t,r,e[r]);return t};const Xr_reactNative="react-native",Xr_node="node",Xr_browser="browser",Xr_unknown="unknown",by="js";function xa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Oy(){return function wy(){return!la()&&!!Ai()&&"ReactNative"===navigator.product}()?Xr_reactNative:xa()?Xr_node:function Ey(){return!xa()&&!!Ai()}()?Xr_browser:Xr_unknown}function Py(t,e,r){const n=function Iy(){const t=Dd();if(null===t)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return"browser"===t.type?[e,t.name,t.version].join("-"):[e,t.version].join("-")}(),i=function Fy(){var t;const e=Oy();return e===Xr_browser?[e,(null==(t=ha())?void 0:t.host)||"unknown"].join(":"):e}();return[[t,e].join("-"),[by,r].join("-"),n,i].join("/")}function Ly({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:o}){const s=r.split("?"),a=Py(t,e,n),l=function Sy(t,e){let r=Yr.parse(t);return r=Sa(Sa({},r),e),Yr.stringify(r)}(s[1]||"",{auth:i,ua:a,projectId:o});return s[0]+"?"+l}function Et(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Ia(t){return Object.fromEntries(t.entries())}function Fa(t){return new Map(Object.entries(t))}function Ht(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function Qt(t){return Q.fromMiliseconds(Date.now())>=Q.toMiliseconds(t)}function fr(){const t=Q.toMiliseconds(Q.FIVE_MINUTES);let e,r,n;return{resolve:i=>{n&&e&&(clearTimeout(n),e(i))},reject:i=>{n&&r&&(clearTimeout(n),r(i))},done:()=>new Promise((i,o)=>{n=setTimeout(o,t),e=i,r=o})}}function Pa(t,e){return new Promise(function(){var r=x(function*(n,i){const o=setTimeout(()=>i(),e),s=yield t;clearTimeout(o),n(s)});return function(n,i){return r.apply(this,arguments)}}())}function La(t,e){if("string"==typeof e&&e.startsWith(`${t}:`))return e;if("topic"===t.toLowerCase()){if("string"!=typeof e)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}if("id"===t.toLowerCase()){if("number"!=typeof e)throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Aa(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if("topic"===e&&"string"==typeof r)n.topic=r;else{if("id"!==e||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);n.id=Number(r)}return n}function $e(t,e){return`${t}${e?`:${e}`:""}`}function zi(t){return t?.relay||{protocol:"irn"}}function Ki(t){const e=sy[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Ty=Object.defineProperty,Na=Object.getOwnPropertySymbols,jy=Object.prototype.hasOwnProperty,My=Object.prototype.propertyIsEnumerable,Ra=(t,e,r)=>e in t?Ty(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;function Uy(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const o=i.replace(n,"");r[o]=t[i]}}),r}function zy(t){return`${t.protocol}:${t.topic}@${t.version}?`+Yr.stringify(((t,e)=>{for(var r in e||(e={}))jy.call(e,r)&&Ra(t,r,e[r]);if(Na)for(var r of Na(e))My.call(e,r)&&Ra(t,r,e[r]);return t})({symKey:t.symKey},function ky(t,e="-"){const n={};return Object.keys(t).forEach(i=>{t[i]&&(n["relay"+e+i]=t[i])}),n}(t.relay)))}function Dt(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}const Vy={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Hy={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function q(t,e){const{message:r,code:n}=Hy[t];return{message:e?`${r} ${e}`:r,code:n}}function Je(t,e){const{message:r,code:n}=Vy[t];return{message:e?`${r} ${e}`:r,code:n}}function Zr(t,e){return!!Array.isArray(t)&&(!(typeof e<"u"&&t.length)||t.every(e))}function Ta(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Lt(t){return typeof t>"u"}function ut(t,e){return!(!e||!Lt(t))||"string"==typeof t&&Boolean(t.trim().length)}function ja(t,e){return!(!e||!Lt(t))||"number"==typeof t&&!isNaN(t)}function Bi(t){return!(!ut(t,!1)||!t.includes(":"))&&2===t.split(":").length}function $i(t,e){let r=null;return Lt(t?.extension)||(!Zr(t.extension)||!t.extension.length)&&(r=q("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function Ma(t){let e=!0;return Zr(t)?t.length&&(e=t.every(r=>ut(r,!1))):e=!1,e}function Ca(t,e,r){let n=null;return Zr(e)?e.forEach(i=>{n||(!Bi(i)||!i.includes(t))&&(n=Je("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Je("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function Ua(t,e){let r=null;return Zr(t)?t.forEach(n=>{r||function Gy(t){if(ut(t,!1)&&t.includes(":")){const e=t.split(":");if(3===e.length){const r=e[0]+":"+e[1];return!!e[2]&&Bi(r)}}return!1}(n)||(r=Je("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Je("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Da(t,e){let r=null;return Ma(t?.methods)?Ma(t?.events)||(r=Je("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Je("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function ka(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Da(n,`${e}, namespace`),o=$i(n,e);i?r=i:o?r=o:n.extension&&n.extension.forEach(s=>{if(r)return;const a=Da(s,`${e}, extension`);a&&(r=a)})}),r}function eg(t,e){let r=null;if(t&&Ta(t)){const n=ka(t,e);n&&(r=n);const i=function Zy(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const o=Ca(n,i?.chains,`${e} requiredNamespace`),s=$i(i,e);o?r=o:s?r=s:i.extension&&i.extension.forEach(a=>{if(r)return;const h=Ca(n,a.chains,`${e} extension`);h&&(r=h)})}),r}(t,e);i&&(r=i)}else r=q("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function Vi(t,e){let r=null;if(t&&Ta(t)){const n=ka(t,e);n&&(r=n);const i=function Qy(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Ua(n?.accounts,`${e} namespace`),o=$i(n,e);i?r=i:o?r=o:n.extension&&n.extension.forEach(s=>{if(r)return;const a=Ua(s.accounts,`${e} extension`);a&&(r=a)})}),r}(t,e);i&&(r=i)}else r=q("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function za(t){return ut(t.protocol,!0)}function Ot(t){return typeof t<"u"&&null!==typeof t}function Ka(t,e){return!(!Bi(e)||!function Ky(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Dt(r.accounts)),r.extension&&r.extension.forEach(n=>{e.push(...Dt(n.accounts))})}),e}(t).includes(e))}function ag(t,e,r){return!!ut(r,!1)&&function By(t,e){const r=[];return Object.values(t).forEach(n=>{Dt(n.accounts).includes(e)&&r.push(...n.methods),n.extension&&n.extension.forEach(i=>{Dt(i.accounts).includes(e)&&r.push(...i.methods)})}),r}(t,e).includes(r)}function ug(t,e,r){return!!ut(r,!1)&&function $y(t,e){const r=[];return Object.values(t).forEach(n=>{Dt(n.accounts).includes(e)&&r.push(...n.events),n.extension&&n.extension.forEach(i=>{Dt(i.accounts).includes(e)&&r.push(...i.events)})}),r}(t,e).includes(r)}function Ba(t,e,r){let n=null;const i=Object.keys(t);return Et(i,Object.keys(e))?i.forEach(s=>{var a;n||(Et(t[s].chains,Dt(e[s].accounts))?Et(t[s].methods,e[s].methods)?Et(t[s].events,e[s].events)?t[s].extension&&!e[s].extension?n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${s}`):t[s].extension&&e[s].extension&&(null==(a=t[s].extension)||a.forEach(({methods:f,events:m,chains:_})=>{var v;n||null!=(v=e[s].extension)&&v.find(b=>{const R=Dt(b.accounts);return Et(_,R)&&Et(m,b.events)&&Et(f,b.methods)})||(n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${s}`))})):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${s}`):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${s}`):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${s}`))}):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),n}const $a="INTERNAL_ERROR",Hi="SERVER_ERROR",pg=[-32700,-32600,-32601,-32602,-32603],Qr={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[$a]:{code:-32603,message:"Internal error"},[Hi]:{code:-32e3,message:"Server error"}},Va=Hi;function Ha(t){return Object.keys(Qr).includes(t)?Qr[t]:Qr[Va]}function qa(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ga={},qi=function(t,e){return(qi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])})(t,e)};var Gi=function(){return Gi=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Gi.apply(this,arguments)};function Wi(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wa(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,s,n=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function en(t){return this instanceof en?(this.v=t,this):new en(t)}var Ya,Cg=Bt(Object.freeze({__proto__:null,__extends:function gg(t,e){function r(){this.constructor=t}qi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return Gi},__rest:function vg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:function _g(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o},__param:function mg(t,e){return function(r,n){e(r,n,t)}},__metadata:function bg(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function wg(t,e,r,n){return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(m){s(m)}}function h(f){try{l(n.throw(f))}catch(m){s(m)}}function l(f){f.done?o(f.value):function i(o){return o instanceof r?o:new r(function(s){s(o)})}(f.value).then(a,h)}l((n=n.apply(t,e||[])).next())})},__generator:function Eg(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return function h(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,f])}}},__createBinding:function Og(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__exportStar:function Sg(t,e){for(var r in t)"default"!==r&&!e.hasOwnProperty(r)&&(e[r]=t[r])},__values:Wi,__read:Wa,__spread:function xg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Wa(arguments[e]));return t},__spreadArrays:function Ig(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:en,__asyncGenerator:function Fg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(_){n[_]&&(i[_]=function(v){return new Promise(function(b,R){o.push([_,v,b,R])>1||a(_,v)})})}function a(_,v){try{!function h(_){_.value instanceof en?Promise.resolve(_.value.v).then(l,f):m(o[0][2],_)}(n[_](v))}catch(b){m(o[0][3],b)}}function l(_){a("next",_)}function f(_){a("throw",_)}function m(_,v){_(v),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function Pg(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,o){e[i]=t[i]?function(s){return(r=!r)?{value:en(t[i](s)),done:"return"===i}:o?o(s):s}:o}},__asyncValues:function Lg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];return e?e.call(t):(t=Wi(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,h){!function i(o,s,a,h){Promise.resolve(h).then(function(l){o({value:l,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}},__makeTemplateObject:function Ag(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function Ng(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function Rg(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function Tg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function jg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}})),qt={};var Ja,Gt={};function Fn(t,e,r){return{id:r||Date.now()*Math.pow(10,3)+Math.floor(Math.random()*Math.pow(10,3)),jsonrpc:"2.0",method:t,params:e}}function Yi(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Pn(t,e,r){return{id:t,jsonrpc:"2.0",error:zg(e,r)}}function zg(t,e){return typeof t>"u"?Ha($a):("string"==typeof t&&(t=Object.assign(Object.assign({},Ha(Hi)),{message:t})),typeof e<"u"&&(t.data=e),function dg(t){return pg.includes(t)}(t.code)&&(t=function yg(t){return Object.values(Qr).find(r=>r.code===t)||Qr[Va]}(t.code)),t)}!function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cg;e.__exportStar(function Ug(){if(Ya)return qt;function t(){return gt?.crypto||gt?.msCrypto||{}}function e(){const n=t();return n.subtle||n.webkitSubtle}return Ya=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.isBrowserCryptoAvailable=qt.getSubtleCrypto=qt.getBrowerCrypto=void 0,qt.getBrowerCrypto=t,qt.getSubtleCrypto=e,qt.isBrowserCryptoAvailable=function r(){return!!t()&&!!e()},qt}(),t),e.__exportStar(function Dg(){if(Ja)return Gt;function t(){return typeof document>"u"&&typeof navigator<"u"&&"ReactNative"===navigator.product}function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}return Ja=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.isBrowser=Gt.isNode=Gt.isReactNative=void 0,Gt.isReactNative=t,Gt.isNode=e,Gt.isBrowser=function r(){return!t()&&!e()},Gt}(),t)}(Ga);function Xa(t,e){const r=function qg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(e&&e.length)return e[0]}(t);return!(typeof r>"u")&&new RegExp(e).test(r)}function Za(t){return Xa(t,"^https?:")}function Qa(t){return Xa(t,"^wss?:")}function Gg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function eu(t){return"object"==typeof t&&"id"in t&&"jsonrpc"in t&&"2.0"===t.jsonrpc}function Ji(t){return eu(t)&&"method"in t}function Xi(t){return eu(t)&&(Wt(t)||Tt(t))}function Wt(t){return"result"in t}function Tt(t){return"error"in t}class Zi extends class $g extends class Bg extends class Kg{}{constructor(){super()}}{constructor(e){super()}}{constructor(e){super(e),this.events=new ui.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}connect(e=this.connection){var r=this;return x(function*(){yield r.open(e)})()}disconnect(){var e=this;return x(function*(){yield e.close()})()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}request(e,r){var n=this;return x(function*(){return n.requestStrict(Fn(e.method,e.params||[]),r)})()}requestStrict(e,r){var n=this;return x(function*(){return new Promise(function(){var i=x(function*(o,s){if(!n.connection.connected)try{yield n.open()}catch(a){s(a)}n.events.on(`${e.id}`,a=>{Tt(a)?s(a.error):o(a.result)});try{yield n.connection.send(e,r)}catch(a){s(a)}});return function(o,s){return i.apply(this,arguments)}}())})()}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Xi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}open(e=this.connection){var r=this;return x(function*(){r.connection===e&&r.connection.connected||(r.connection.connected&&r.close(),"string"==typeof e&&(yield r.connection.open(e),e=r.connection),r.connection=r.setConnection(e),yield r.connection.open(),r.registerEventListeners(),r.events.emit("connect"))})()}close(){var e=this;return x(function*(){yield e.connection.close()})()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}var Ln,Qi={exports:{}},Fr="object"==typeof Reflect?Reflect:null,tu=Fr&&"function"==typeof Fr.apply?Fr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};Ln=Fr&&"function"==typeof Fr.ownKeys?Fr.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var ru=Number.isNaN||function(t){return t!=t};function Ne(){Ne.init.call(this)}Qi.exports=Ne,Qi.exports.once=function Zg(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}lu(t,e,o,{once:!0}),"error"!==e&&function Qg(t,e,r){"function"==typeof t.on&&lu(t,"error",e,r)}(t,i,{once:!0})})},Ne.EventEmitter=Ne,Ne.prototype._events=void 0,Ne.prototype._eventsCount=0,Ne.prototype._maxListeners=void 0;var nu=10;function An(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function iu(t){return void 0===t._maxListeners?Ne.defaultMaxListeners:t._maxListeners}function ou(t,e,r,n){var i,o,s;if(An(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=iu(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function Wg(t){console&&console.warn&&console.warn(t)}(a)}return t}function Yg(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function su(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Yg.bind(n);return i.listener=r,n.wrapFn=i,i}function au(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function Xg(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):cu(i,i.length)}function uu(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function cu(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function lu(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(Ne,"defaultMaxListeners",{enumerable:!0,get:function(){return nu},set:function(t){if("number"!=typeof t||t<0||ru(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");nu=t}}),Ne.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ne.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||ru(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Ne.prototype.getMaxListeners=function(){return iu(this)},Ne.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)tu(a,this,e);else{var h=a.length,l=cu(a,h);for(r=0;r<h;++r)tu(l[r],this,e)}return!0},Ne.prototype.on=Ne.prototype.addListener=function(t,e){return ou(this,t,e,!1)},Ne.prototype.prependListener=function(t,e){return ou(this,t,e,!0)},Ne.prototype.once=function(t,e){return An(e),this.on(t,su(this,t,e)),this},Ne.prototype.prependOnceListener=function(t,e){return An(e),this.prependListener(t,su(this,t,e)),this},Ne.prototype.off=Ne.prototype.removeListener=function(t,e){var r,n,i,o,s;if(An(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function Jg(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Ne.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Ne.prototype.listeners=function(t){return au(this,t,!0)},Ne.prototype.rawListeners=function(t){return au(this,t,!1)},Ne.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):uu.call(t,e)},Ne.prototype.listenerCount=uu,Ne.prototype.eventNames=function(){return this._eventsCount>0?Ln(this._events):[]};const r1=typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:sr(2791);class n1{constructor(e){if(this.url=e,this.events=new Qi.exports.EventEmitter,this.registering=!1,!Qa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}open(e=this.url){var r=this;return x(function*(){yield r.register(e)})()}close(){var e=this;return x(function*(){if(typeof e.socket>"u")throw new Error("Connection already closed");e.socket.close(),e.onClose()})()}send(e,r){var n=this;return x(function*(){typeof n.socket>"u"&&(n.socket=yield n.register());try{n.socket.send(qr(e))}catch(i){n.onError(e.id,i)}})()}register(e=this.url){if(!Qa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),i(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Ga.isReactNative()?void 0:{rejectUnauthorized:!Gg(e)},o=new r1(e,[],i);typeof window<"u"?o.onerror=s=>{n(this.emitError(s.error))}:o.on("error",s=>{n(this.emitError(s))}),o.onopen=()=>{this.onOpen(o),r(o)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r="string"==typeof e.data?yi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),o=Pn(e,n.message||n.toString());this.events.emit("payload",o)}parseError(e,r=this.url){return qa(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var eo={exports:{}};!function(t,e){var n="__lodash_hash_undefined__",s=9007199254740991,a="[object Arguments]",h="[object Array]",f="[object Boolean]",m="[object Date]",_="[object Error]",v="[object Function]",R="[object Map]",M="[object Number]",I="[object Object]",L="[object Promise]",S="[object RegExp]",O="[object Set]",u="[object String]",p="[object Symbol]",B="[object WeakMap]",G="[object ArrayBuffer]",X="[object DataView]",V=/^\[object .+?Constructor\]$/,te=/^(?:0|[1-9]\d*)$/,J={};J["[object Float32Array]"]=J["[object Float64Array]"]=J["[object Int8Array]"]=J["[object Int16Array]"]=J["[object Int32Array]"]=J["[object Uint8Array]"]=J["[object Uint8ClampedArray]"]=J["[object Uint16Array]"]=J["[object Uint32Array]"]=!0,J[a]=J[h]=J[G]=J[f]=J[X]=J[m]=J[_]=J[v]=J[R]=J[M]=J[I]=J[S]=J[O]=J[u]=J[B]=!1;var ue="object"==typeof gt&&gt&&gt.Object===Object&&gt,N="object"==typeof self&&self&&self.Object===Object&&self,A=ue||N||Function("return this")(),F=e&&!e.nodeType&&e,c=F&&t&&!t.nodeType&&t,w=c&&c.exports===F,H=w&&ue.process,W=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),pe=W&&W.isTypedArray;function Oe(y,P){for(var C=-1,Y=null==y?0:y.length;++C<Y;)if(P(y[C],C,y))return!0;return!1}function me(y,P){return y.has(P)}function de(y){var P=-1,C=Array(y.size);return y.forEach(function(Y,Me){C[++P]=[Me,Y]}),C}function ce(y){var P=-1,C=Array(y.size);return y.forEach(function(Y){C[++P]=Y}),C}var y,ae=Array.prototype,re=Object.prototype,he=A["__core-js_shared__"],_e=Function.prototype.toString,ie=re.hasOwnProperty,we=(y=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",Ee=re.toString,xe=RegExp("^"+_e.call(ie).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=w?A.Buffer:void 0,Se=A.Symbol,jt=A.Uint8Array,Kt=re.propertyIsEnumerable,rr=ae.splice,It=Se?Se.toStringTag:void 0,pr=Object.getOwnPropertySymbols,on=Ie?Ie.isBuffer:void 0,$n=function le(y,P){return function(C){return y(P(C))}}(Object.keys,Object),He=Ar(A,"DataView"),ke=Ar(A,"Map"),qe=Ar(A,"Promise"),Ge=Ar(A,"Set"),We=Ar(A,"WeakMap"),ze=Ar(Object,"create"),Qe=yr(He),et=yr(ke),tt=yr(qe),rt=yr(Ge),nt=yr(We),Xe=Se?Se.prototype:void 0,Ye=Xe?Xe.valueOf:void 0;function Ce(y){var P=-1,C=null==y?0:y.length;for(this.clear();++P<C;){var Y=y[P];this.set(Y[0],Y[1])}}function Yt(y){var P=-1,C=null==y?0:y.length;for(this.clear();++P<C;){var Y=y[P];this.set(Y[0],Y[1])}}function dr(y){var P=-1,C=null==y?0:y.length;for(this.clear();++P<C;){var Y=y[P];this.set(Y[0],Y[1])}}function Vn(y){var P=-1,C=null==y?0:y.length;for(this.__data__=new dr;++P<C;)this.add(y[P])}function nr(y){var P=this.__data__=new Yt(y);this.size=P.size}function T0(y,P){var C=Gn(y),Y=!C&&W0(y),Me=!C&&!Y&&fo(y),se=!C&&!Y&&!Me&&Tc(y),Ke=C||Y||Me||se,st=Ke?function Ve(y,P){for(var C=-1,Y=Array(y);++C<y;)Y[C]=P(C);return Y}(y.length,String):[],lt=st.length;for(var Ue in y)(P||ie.call(y,Ue))&&(!Ke||!("length"==Ue||Me&&("offset"==Ue||"parent"==Ue)||se&&("buffer"==Ue||"byteLength"==Ue||"byteOffset"==Ue)||$0(Ue,lt)))&&st.push(Ue);return st}function Hn(y,P){for(var C=y.length;C--;)if(Lc(y[C][0],P))return C;return-1}function sn(y){return null==y?void 0===y?"[object Undefined]":"[object Null]":It&&It in Object(y)?function K0(y){var P=ie.call(y,It),C=y[It];try{y[It]=void 0;var Y=!0}catch{}var Me=Ee.call(y);return Y&&(P?y[It]=C:delete y[It]),Me}(y):function G0(y){return Ee.call(y)}(y)}function xc(y){return an(y)&&sn(y)==a}function Ic(y,P,C,Y,Me){return y===P||(null==y||null==P||!an(y)&&!an(P)?y!=y&&P!=P:function M0(y,P,C,Y,Me,se){var Ke=Gn(y),st=Gn(P),lt=Ke?h:ir(y),Ue=st?h:ir(P),Ft=(lt=lt==a?I:lt)==I,Mt=(Ue=Ue==a?I:Ue)==I,pt=lt==Ue;if(pt&&fo(y)){if(!fo(P))return!1;Ke=!0,Ft=!1}if(pt&&!Ft)return se||(se=new nr),Ke||Tc(y)?Fc(y,P,C,Y,Me,se):function k0(y,P,C,Y,Me,se,Ke){switch(C){case X:if(y.byteLength!=P.byteLength||y.byteOffset!=P.byteOffset)return!1;y=y.buffer,P=P.buffer;case G:return!(y.byteLength!=P.byteLength||!se(new jt(y),new jt(P)));case f:case m:case M:return Lc(+y,+P);case _:return y.name==P.name&&y.message==P.message;case S:case u:return y==P+"";case R:var st=de;case O:if(st||(st=ce),y.size!=P.size&&!(1&Y))return!1;var Ue=Ke.get(y);if(Ue)return Ue==P;Y|=2,Ke.set(y,P);var Ft=Fc(st(y),st(P),Y,Me,se,Ke);return Ke.delete(y),Ft;case p:if(Ye)return Ye.call(y)==Ye.call(P)}return!1}(y,P,lt,C,Y,Me,se);if(!(1&C)){var Nt=Ft&&ie.call(y,"__wrapped__"),Rt=Mt&&ie.call(P,"__wrapped__");if(Nt||Rt){var or=Nt?y.value():y,Jt=Rt?P.value():P;return se||(se=new nr),Me(or,Jt,C,Y,se)}}return!!pt&&(se||(se=new nr),function z0(y,P,C,Y,Me,se){var Ke=1&C,st=Pc(y),lt=st.length;if(lt!=Pc(P).length&&!Ke)return!1;for(var Mt=lt;Mt--;){var pt=st[Mt];if(!(Ke?pt in P:ie.call(P,pt)))return!1}var Nt=se.get(y);if(Nt&&se.get(P))return Nt==P;var Rt=!0;se.set(y,P),se.set(P,y);for(var or=Ke;++Mt<lt;){var Jt=y[pt=st[Mt]],gr=P[pt];if(Y)var jc=Ke?Y(gr,Jt,pt,P,y,se):Y(Jt,gr,pt,y,P,se);if(!(void 0===jc?Jt===gr||Me(Jt,gr,C,Y,se):jc)){Rt=!1;break}or||(or="constructor"==pt)}if(Rt&&!or){var Wn=y.constructor,Yn=P.constructor;Wn!=Yn&&"constructor"in y&&"constructor"in P&&!("function"==typeof Wn&&Wn instanceof Wn&&"function"==typeof Yn&&Yn instanceof Yn)&&(Rt=!1)}return se.delete(y),se.delete(P),Rt}(y,P,C,Y,Me,se))}(y,P,C,Y,Ic,Me))}function C0(y){return!(!Rc(y)||function H0(y){return!!we&&we in y}(y))&&(Ac(y)?xe:V).test(yr(y))}function D0(y){if(!function q0(y){var P=y&&y.constructor;return y===("function"==typeof P&&P.prototype||re)}(y))return $n(y);var P=[];for(var C in Object(y))ie.call(y,C)&&"constructor"!=C&&P.push(C);return P}function Fc(y,P,C,Y,Me,se){var Ke=1&C,st=y.length,lt=P.length;if(st!=lt&&!(Ke&&lt>st))return!1;var Ue=se.get(y);if(Ue&&se.get(P))return Ue==P;var Ft=-1,Mt=!0,pt=2&C?new Vn:void 0;for(se.set(y,P),se.set(P,y);++Ft<st;){var Nt=y[Ft],Rt=P[Ft];if(Y)var or=Ke?Y(Rt,Nt,Ft,P,y,se):Y(Nt,Rt,Ft,y,P,se);if(void 0!==or){if(or)continue;Mt=!1;break}if(pt){if(!Oe(P,function(Jt,gr){if(!me(pt,gr)&&(Nt===Jt||Me(Nt,Jt,C,Y,se)))return pt.push(gr)})){Mt=!1;break}}else if(Nt!==Rt&&!Me(Nt,Rt,C,Y,se)){Mt=!1;break}}return se.delete(y),se.delete(P),Mt}function Pc(y){return function j0(y,P,C){var Y=P(y);return Gn(y)?Y:function ge(y,P){for(var C=-1,Y=P.length,Me=y.length;++C<Y;)y[Me+C]=P[C];return y}(Y,C(y))}(y,X0,B0)}function qn(y,P){var C=y.__data__;return function V0(y){var P=typeof y;return"string"==P||"number"==P||"symbol"==P||"boolean"==P?"__proto__"!==y:null===y}(P)?C["string"==typeof P?"string":"hash"]:C.map}function Ar(y,P){var C=function ve(y,P){return y?.[P]}(y,P);return C0(C)?C:void 0}Ce.prototype.clear=function it(){this.__data__=ze?ze(null):{},this.size=0},Ce.prototype.delete=function ot(y){var P=this.has(y)&&delete this.__data__[y];return this.size-=P?1:0,P},Ce.prototype.get=function p0(y){var P=this.__data__;if(ze){var C=P[y];return C===n?void 0:C}return ie.call(P,y)?P[y]:void 0},Ce.prototype.has=function d0(y){var P=this.__data__;return ze?void 0!==P[y]:ie.call(P,y)},Ce.prototype.set=function y0(y,P){var C=this.__data__;return this.size+=this.has(y)?0:1,C[y]=ze&&void 0===P?n:P,this},Yt.prototype.clear=function g0(){this.__data__=[],this.size=0},Yt.prototype.delete=function v0(y){var P=this.__data__,C=Hn(P,y);return!(C<0||(C==P.length-1?P.pop():rr.call(P,C,1),--this.size,0))},Yt.prototype.get=function _0(y){var P=this.__data__,C=Hn(P,y);return C<0?void 0:P[C][1]},Yt.prototype.has=function m0(y){return Hn(this.__data__,y)>-1},Yt.prototype.set=function b0(y,P){var C=this.__data__,Y=Hn(C,y);return Y<0?(++this.size,C.push([y,P])):C[Y][1]=P,this},dr.prototype.clear=function w0(){this.size=0,this.__data__={hash:new Ce,map:new(ke||Yt),string:new Ce}},dr.prototype.delete=function E0(y){var P=qn(this,y).delete(y);return this.size-=P?1:0,P},dr.prototype.get=function O0(y){return qn(this,y).get(y)},dr.prototype.has=function S0(y){return qn(this,y).has(y)},dr.prototype.set=function x0(y,P){var C=qn(this,y),Y=C.size;return C.set(y,P),this.size+=C.size==Y?0:1,this},Vn.prototype.add=Vn.prototype.push=function I0(y){return this.__data__.set(y,n),this},Vn.prototype.has=function F0(y){return this.__data__.has(y)},nr.prototype.clear=function P0(){this.__data__=new Yt,this.size=0},nr.prototype.delete=function L0(y){var P=this.__data__,C=P.delete(y);return this.size=P.size,C},nr.prototype.get=function A0(y){return this.__data__.get(y)},nr.prototype.has=function N0(y){return this.__data__.has(y)},nr.prototype.set=function R0(y,P){var C=this.__data__;if(C instanceof Yt){var Y=C.__data__;if(!ke||Y.length<199)return Y.push([y,P]),this.size=++C.size,this;C=this.__data__=new dr(Y)}return C.set(y,P),this.size=C.size,this};var B0=pr?function(y){return null==y?[]:(y=Object(y),function be(y,P){for(var C=-1,Y=null==y?0:y.length,Me=0,se=[];++C<Y;){var Ke=y[C];P(Ke,C,y)&&(se[Me++]=Ke)}return se}(pr(y),function(P){return Kt.call(y,P)}))}:function Z0(){return[]},ir=sn;function $0(y,P){return!!(P=P??s)&&("number"==typeof y||te.test(y))&&y>-1&&y%1==0&&y<P}function yr(y){if(null!=y){try{return _e.call(y)}catch{}try{return y+""}catch{}}return""}function Lc(y,P){return y===P||y!=y&&P!=P}(He&&ir(new He(new ArrayBuffer(1)))!=X||ke&&ir(new ke)!=R||qe&&ir(qe.resolve())!=L||Ge&&ir(new Ge)!=O||We&&ir(new We)!=B)&&(ir=function(y){var P=sn(y),C=P==I?y.constructor:void 0,Y=C?yr(C):"";if(Y)switch(Y){case Qe:return X;case et:return R;case tt:return L;case rt:return O;case nt:return B}return P});var W0=xc(function(){return arguments}())?xc:function(y){return an(y)&&ie.call(y,"callee")&&!Kt.call(y,"callee")},Gn=Array.isArray;var fo=on||function Q0(){return!1};function Ac(y){if(!Rc(y))return!1;var P=sn(y);return P==v||"[object GeneratorFunction]"==P||"[object AsyncFunction]"==P||"[object Proxy]"==P}function Nc(y){return"number"==typeof y&&y>-1&&y%1==0&&y<=s}function Rc(y){var P=typeof y;return null!=y&&("object"==P||"function"==P)}function an(y){return null!=y&&"object"==typeof y}var Tc=pe?function De(y){return function(P){return y(P)}}(pe):function U0(y){return an(y)&&Nc(y.length)&&!!J[sn(y)]};function X0(y){return function Y0(y){return null!=y&&Nc(y.length)&&!Ac(y)}(y)?T0(y):D0(y)}t.exports=function J0(y,P){return Ic(y,P)}}(eo,eo.exports);var i1=eo.exports,o1=Object.defineProperty,fu=Object.getOwnPropertySymbols,s1=Object.prototype.hasOwnProperty,a1=Object.prototype.propertyIsEnumerable,pu=(t,e,r)=>e in t?o1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yt=(t,e)=>{for(var r in e||(e={}))s1.call(e,r)&&pu(t,r,e[r]);if(fu)for(var r of fu(e))a1.call(e,r)&&pu(t,r,e[r]);return t};var l1=function u1(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,h=t.charAt(0),l=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function _(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;var R=0;if(" "!==b[R]){for(var M=0,$=0;b[R]===h;)M++,R++;for(var I=(b.length-R)*l+1>>>0,L=new Uint8Array(I);b[R];){var g=r[b.charCodeAt(R)];if(255===g)return;for(var S=0,O=I-1;(0!==g||S<$)&&-1!==O;O--,S++)L[O]=(g+=a*L[O]>>>0)%256>>>0,g=g/256>>>0;if(0!==g)throw new Error("Non-zero carry");$=S,R++}if(" "!==b[R]){for(var u=I-$;u!==I&&0===L[u];)u++;for(var p=new Uint8Array(M+(I-u)),k=M;u!==I;)p[k++]=L[u++];return p}}}return{encode:function m(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";for(var R=0,M=0,$=0,I=b.length;$!==I&&0===b[$];)$++,R++;for(var L=(I-$)*f+1>>>0,g=new Uint8Array(L);$!==I;){for(var S=b[$],O=0,u=L-1;(0!==S||O<M)&&-1!==u;u--,O++)g[u]=(S+=256*g[u]>>>0)%a>>>0,S=S/a>>>0;if(0!==S)throw new Error("Non-zero carry");M=O,$++}for(var p=L-M;p!==L&&0===g[p];)p++;for(var k=h.repeat(R);p<L;++p)k+=t.charAt(g[p]);return k},decodeUnsafe:_,decode:function v(b){var R=_(b);if(R)return R;throw new Error(`Non-${e} character`)}}};const du=t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};class p1{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class d1{constructor(e,r,n){if(this.name=e,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return yu(this,e)}}class y1{constructor(e){this.decoders=e}or(e){return yu(this,e)}decode(e){const n=this.decoders[e[0]];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const yu=(t,e)=>new y1(yt(yt({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class g1{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new p1(e,r,n),this.decoder=new d1(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Nn=({name:t,prefix:e,encode:r,decode:n})=>new g1(t,e,r,n),tn=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=l1(r,e);return Nn({prefix:t,name:e,encode:n,decode:o=>du(i(o))})},ct=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Nn({prefix:e,name:t,encode:i=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(i,n,r),decode:i=>((t,e,r,n)=>{const i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,h=0,l=0;for(let f=0;f<o;++f){const m=i[t[f]];if(void 0===m)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,a+=r,a>=8&&(a-=8,s[l++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return s})(i,n,r,t)}),m1=Nn({prefix:"\0",name:"identity",encode:t=>(t=>(new TextDecoder).decode(t))(t),decode:t=>(t=>(new TextEncoder).encode(t))(t)});var b1=Object.freeze({__proto__:null,identity:m1});const w1=ct({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var E1=Object.freeze({__proto__:null,base2:w1});const O1=ct({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var S1=Object.freeze({__proto__:null,base8:O1});const x1=tn({prefix:"9",name:"base10",alphabet:"0123456789"});var I1=Object.freeze({__proto__:null,base10:x1});const F1=ct({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),P1=ct({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var L1=Object.freeze({__proto__:null,base16:F1,base16upper:P1});const A1=ct({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),N1=ct({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),R1=ct({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),T1=ct({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j1=ct({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),M1=ct({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),C1=ct({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),U1=ct({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D1=ct({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var k1=Object.freeze({__proto__:null,base32:A1,base32upper:N1,base32pad:R1,base32padupper:T1,base32hex:j1,base32hexupper:M1,base32hexpad:C1,base32hexpadupper:U1,base32z:D1});const z1=tn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K1=tn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B1=Object.freeze({__proto__:null,base36:z1,base36upper:K1});const $1=tn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),V1=tn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var H1=Object.freeze({__proto__:null,base58btc:$1,base58flickr:V1});const q1=ct({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),G1=ct({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),W1=ct({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y1=ct({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var J1=Object.freeze({__proto__:null,base64:q1,base64pad:G1,base64url:W1,base64urlpad:Y1});const gu=Array.from("\u{1f680}\u{1fa90}\u2604\u{1f6f0}\u{1f30c}\u{1f311}\u{1f312}\u{1f313}\u{1f314}\u{1f315}\u{1f316}\u{1f317}\u{1f318}\u{1f30d}\u{1f30f}\u{1f30e}\u{1f409}\u2600\u{1f4bb}\u{1f5a5}\u{1f4be}\u{1f4bf}\u{1f602}\u2764\u{1f60d}\u{1f923}\u{1f60a}\u{1f64f}\u{1f495}\u{1f62d}\u{1f618}\u{1f44d}\u{1f605}\u{1f44f}\u{1f601}\u{1f525}\u{1f970}\u{1f494}\u{1f496}\u{1f499}\u{1f622}\u{1f914}\u{1f606}\u{1f644}\u{1f4aa}\u{1f609}\u263a\u{1f44c}\u{1f917}\u{1f49c}\u{1f614}\u{1f60e}\u{1f607}\u{1f339}\u{1f926}\u{1f389}\u{1f49e}\u270c\u2728\u{1f937}\u{1f631}\u{1f60c}\u{1f338}\u{1f64c}\u{1f60b}\u{1f497}\u{1f49a}\u{1f60f}\u{1f49b}\u{1f642}\u{1f493}\u{1f929}\u{1f604}\u{1f600}\u{1f5a4}\u{1f603}\u{1f4af}\u{1f648}\u{1f447}\u{1f3b6}\u{1f612}\u{1f92d}\u2763\u{1f61c}\u{1f48b}\u{1f440}\u{1f62a}\u{1f611}\u{1f4a5}\u{1f64b}\u{1f61e}\u{1f629}\u{1f621}\u{1f92a}\u{1f44a}\u{1f973}\u{1f625}\u{1f924}\u{1f449}\u{1f483}\u{1f633}\u270b\u{1f61a}\u{1f61d}\u{1f634}\u{1f31f}\u{1f62c}\u{1f643}\u{1f340}\u{1f337}\u{1f63b}\u{1f613}\u2b50\u2705\u{1f97a}\u{1f308}\u{1f608}\u{1f918}\u{1f4a6}\u2714\u{1f623}\u{1f3c3}\u{1f490}\u2639\u{1f38a}\u{1f498}\u{1f620}\u261d\u{1f615}\u{1f33a}\u{1f382}\u{1f33b}\u{1f610}\u{1f595}\u{1f49d}\u{1f64a}\u{1f639}\u{1f5e3}\u{1f4ab}\u{1f480}\u{1f451}\u{1f3b5}\u{1f91e}\u{1f61b}\u{1f534}\u{1f624}\u{1f33c}\u{1f62b}\u26bd\u{1f919}\u2615\u{1f3c6}\u{1f92b}\u{1f448}\u{1f62e}\u{1f646}\u{1f37b}\u{1f343}\u{1f436}\u{1f481}\u{1f632}\u{1f33f}\u{1f9e1}\u{1f381}\u26a1\u{1f31e}\u{1f388}\u274c\u270a\u{1f44b}\u{1f630}\u{1f928}\u{1f636}\u{1f91d}\u{1f6b6}\u{1f4b0}\u{1f353}\u{1f4a2}\u{1f91f}\u{1f641}\u{1f6a8}\u{1f4a8}\u{1f92c}\u2708\u{1f380}\u{1f37a}\u{1f913}\u{1f619}\u{1f49f}\u{1f331}\u{1f616}\u{1f476}\u{1f974}\u25b6\u27a1\u2753\u{1f48e}\u{1f4b8}\u2b07\u{1f628}\u{1f31a}\u{1f98b}\u{1f637}\u{1f57a}\u26a0\u{1f645}\u{1f61f}\u{1f635}\u{1f44e}\u{1f932}\u{1f920}\u{1f927}\u{1f4cc}\u{1f535}\u{1f485}\u{1f9d0}\u{1f43e}\u{1f352}\u{1f617}\u{1f911}\u{1f30a}\u{1f92f}\u{1f437}\u260e\u{1f4a7}\u{1f62f}\u{1f486}\u{1f446}\u{1f3a4}\u{1f647}\u{1f351}\u2744\u{1f334}\u{1f4a3}\u{1f438}\u{1f48c}\u{1f4cd}\u{1f940}\u{1f922}\u{1f445}\u{1f4a1}\u{1f4a9}\u{1f450}\u{1f4f8}\u{1f47b}\u{1f910}\u{1f92e}\u{1f3bc}\u{1f975}\u{1f6a9}\u{1f34e}\u{1f34a}\u{1f47c}\u{1f48d}\u{1f4e3}\u{1f942}"),X1=gu.reduce((t,e,r)=>(t[r]=e,t),[]),Z1=gu.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);const tv=Nn({prefix:"\u{1f680}",name:"base256emoji",encode:function Q1(t){return t.reduce((e,r)=>e+X1[r],"")},decode:function ev(t){const e=[];for(const r of t){const n=Z1[r.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}});var rv=Object.freeze({__proto__:null,base256emoji:tv}),nv=function _u(t,e,r){e=e||[];for(var n=r=r||0;t>=sv;)e[r++]=255&t|128,t/=128;for(;-128&t;)e[r++]=255&t|128,t>>>=7;return e[r]=0|t,_u.bytes=r-n+1,e},sv=Math.pow(2,31);var av=function to(t,n){var s,r=0,i=0,o=n=n||0,a=t.length;do{if(o>=a)throw to.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(127&s)<<i:(127&s)*Math.pow(2,i),i+=7}while(s>=128);return to.bytes=o-n,r};var cv=Math.pow(2,7),lv=Math.pow(2,14),hv=Math.pow(2,21),fv=Math.pow(2,28),pv=Math.pow(2,35),dv=Math.pow(2,42),yv=Math.pow(2,49),gv=Math.pow(2,56),vv=Math.pow(2,63),bu={encode:nv,decode:av,encodingLength:function(t){return t<cv?1:t<lv?2:t<hv?3:t<fv?4:t<pv?5:t<dv?6:t<yv?7:t<gv?8:t<vv?9:10}};const wu=(t,e,r=0)=>(bu.encode(t,e,r),e),Eu=t=>bu.encodingLength(t),ro=(t,e)=>{const r=e.byteLength,n=Eu(t),i=n+Eu(r),o=new Uint8Array(i+r);return wu(t,o,0),wu(r,o,n),o.set(e,i),new bv(t,r,e,o)};class bv{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Ou=({name:t,code:e,encode:r})=>new wv(t,e,r);class wv{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ro(this.code,r):r.then(n=>ro(this.code,n))}throw Error("Unknown type, must be binary type")}}const Su=t=>function(){var e=x(function*(r){return new Uint8Array(yield crypto.subtle.digest(t,r))});return function(r){return e.apply(this,arguments)}}(),Ev=Ou({name:"sha2-256",code:18,encode:Su("SHA-256")}),Ov=Ou({name:"sha2-512",code:19,encode:Su("SHA-512")});var Sv=Object.freeze({__proto__:null,sha256:Ev,sha512:Ov});const Iu=du;var Iv=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:Iu,digest:t=>ro(0,Iu(t))}});new TextEncoder,new TextDecoder;const Fu=yt(yt(yt(yt(yt(yt(yt(yt(yt(yt({},b1),E1),S1),I1),L1),k1),B1),H1),J1),rv);function Pu(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}yt(yt({},Sv),Iv);const Lu=Pu("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>(new TextEncoder).encode(t.substring(1))),no=Pu("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{const e=function Fv(t=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Pv=yt({utf8:Lu,"utf-8":Lu,hex:Fu.base16,latin1:no,ascii:no,binary:no},Fu);const io="core",er="wc@2:core:",Nv_logger="error",Rv={database:":memory:"},Nu="client_ed25519_seed",jv=Q.ONE_DAY,kv=Q.SIX_HOURS,St_message="relayer_message",St_connect="relayer_connect",St_disconnect="relayer_disconnect",St_error="relayer_error",St_connection_stalled="relayer_connection_stalled",St_transport_closed="relayer_transport_closed",Rn_payload="payload",Rn_connect="connect",Rn_disconnect="disconnect",Rn_error="error",Tu=Q.ONE_SECOND,kt_created="subscription_created",kt_deleted="subscription_deleted",kt_sync="subscription_sync",kt_resubscribed="subscription_resubscribed",Yv=1e3*Q.FIVE_SECONDS,rn={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},zt_created="history_created",zt_updated="history_updated",zt_deleted="history_deleted",zt_sync="history_sync",At_created="expirer_created",At_deleted="expirer_deleted",At_expired="expirer_expired",At_sync="expirer_sync";class r_{constructor(e,r){var n=this;this.core=e,this.logger=r,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=er,this.init=x(function*(){if(!n.initialized){const i=yield n.getKeyChain();typeof i<"u"&&(n.keychain=i),n.initialized=!0}}),this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=function(){var i=x(function*(o,s){n.isInitialized(),n.keychain.set(o,s),yield n.persist()});return function(o,s){return i.apply(this,arguments)}}(),this.get=i=>{this.isInitialized();const o=this.keychain.get(i);if(typeof o>"u"){const{message:s}=q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return o},this.del=function(){var i=x(function*(o){n.isInitialized(),n.keychain.delete(o),yield n.persist()});return function(o){return i.apply(this,arguments)}}(),this.core=e,this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}setKeyChain(e){var r=this;return x(function*(){yield r.core.storage.setItem(r.storageKey,Ia(e))})()}getKeyChain(){var e=this;return x(function*(){const r=yield e.core.storage.getItem(e.storageKey);return typeof r<"u"?Fa(r):void 0})()}persist(){var e=this;return x(function*(){yield e.setKeyChain(e.keychain)})()}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class n_{constructor(e,r,n){var i=this;this.core=e,this.logger=r,this.name="crypto",this.initialized=!1,this.init=x(function*(){i.initialized||(yield i.keychain.init(),i.initialized=!0)}),this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=x(function*(){return i.isInitialized(),Xs(Zs(yield i.getClientSeed()).publicKey)}),this.generateKeyPair=()=>{this.isInitialized();const o=function uy(){const t=Li.generateKeyPair();return{privateKey:mt(t.secretKey,wt),publicKey:mt(t.publicKey,wt)}}();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=function(){var o=x(function*(s){i.isInitialized();const h=Zs(yield i.getClientSeed()),l=Ui();return yield function gd(t,e,r,n){return xi.apply(this,arguments)}(l,s,jv,h)});return function(s){return o.apply(this,arguments)}}(),this.generateSharedKey=(o,s,a)=>{this.isInitialized();const l=function cy(t,e){const r=Li.sharedKey(bt(t,wt),bt(e,wt));return mt(new Ld(In.SHA256,r).expand(32),wt)}(this.getPrivateKey(o),s);return this.setSymKey(l,a)},this.setSymKey=function(){var o=x(function*(s,a){i.isInitialized();const h=a||function ly(t){return mt(In.hash(bt(t,wt)),wt)}(s);return yield i.keychain.set(h,s),h});return function(s,a){return o.apply(this,arguments)}}(),this.deleteKeyPair=function(){var o=x(function*(s){i.isInitialized(),yield i.keychain.del(s)});return function(s){return o.apply(this,arguments)}}(),this.deleteSymKey=function(){var o=x(function*(s){i.isInitialized(),yield i.keychain.del(s)});return function(s){return o.apply(this,arguments)}}(),this.encode=function(){var o=x(function*(s,a,h){i.isInitialized();const l=ba(h),f=qr(a);if(wa(l)){const b=l.senderPublicKey,R=l.receiverPublicKey;s=yield i.generateSharedKey(b,R)}const m=i.getSymKey(s),{type:_,senderPublicKey:v}=l;return fy({type:_,symKey:m,message:f,senderPublicKey:v})});return function(s,a,h){return o.apply(this,arguments)}}(),this.decode=function(){var o=x(function*(s,a,h){i.isInitialized();const l=function yy(t,e){const r=ki(t);return ba({type:Jr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?mt(r.senderPublicKey,wt):void 0,receiverPublicKey:e?.receiverPublicKey})}(a,h);if(wa(l)){const _=l.receiverPublicKey,v=l.senderPublicKey;s=yield i.generateSharedKey(_,v)}return yi(function py(t){const e=new Ii.ChaCha20Poly1305(bt(t.symKey,wt)),{sealed:r,iv:n}=ki(t.encoded),i=e.open(n,r);if(null===i)throw new Error("Failed to decrypt");return mt(i,ji)}({symKey:i.getSymKey(s),encoded:a}))});return function(s,a,h){return o.apply(this,arguments)}}(),this.core=e,this.logger=Fe.generateChildLogger(r,this.name),this.keychain=n||new r_(this.core,this.logger)}get context(){return Fe.getLoggerContext(this.logger)}getPayloadType(e){return Jr(ki(e).type)}setPrivateKey(e,r){var n=this;return x(function*(){return yield n.keychain.set(e,r),e})()}getPrivateKey(e){return this.keychain.get(e)}getClientSeed(){var e=this;return x(function*(){let r="";try{r=e.keychain.get(Nu)}catch{r=Ui(),yield e.keychain.set(Nu,r)}return function Lv(t,e="utf8"){const r=Pv[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${t}`):globalThis.Buffer.from(t,"utf8")}(r,"base16")})()}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class i_ extends class Zh{constructor(e,r){this.logger=e,this.core=r}}{constructor(e,r){var n;super(e,r),n=this,this.logger=e,this.core=r,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=er,this.init=x(function*(){if(!n.initialized){n.logger.trace("Initialized");try{const i=yield n.getRelayerMessages();typeof i<"u"&&(n.messages=i),n.logger.debug(`Successfully Restored records for ${n.name}`),n.logger.trace({type:"method",method:"restore",size:n.messages.size})}catch(i){n.logger.debug(`Failed to Restore records for ${n.name}`),n.logger.error(i)}finally{n.initialized=!0}}}),this.set=function(){var i=x(function*(o,s){n.isInitialized();const a=Di(s);let h=n.messages.get(o);return typeof h>"u"&&(h={}),typeof h[a]<"u"||(h[a]=s,n.messages.set(o,h),yield n.persist()),a});return function(o,s){return i.apply(this,arguments)}}(),this.get=i=>{this.isInitialized();let o=this.messages.get(i);return typeof o>"u"&&(o={}),o},this.has=(i,o)=>(this.isInitialized(),typeof this.get(i)[Di(o)]<"u"),this.del=function(){var i=x(function*(o){n.isInitialized(),n.messages.delete(o),yield n.persist()});return function(o){return i.apply(this,arguments)}}(),this.logger=Fe.generateChildLogger(e,this.name),this.core=r}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}setRelayerMessages(e){var r=this;return x(function*(){yield r.core.storage.setItem(r.storageKey,Ia(e))})()}getRelayerMessages(){var e=this;return x(function*(){const r=yield e.core.storage.getItem(e.storageKey);return typeof r<"u"?Fa(r):void 0})()}persist(){var e=this;return x(function*(){yield e.setRelayerMessages(e.messages)})()}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class o_ extends Qh{constructor(e,r){var n;super(e,r),n=this,this.relayer=e,this.logger=r,this.events=new $t.exports.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=1e4,this.publish=function(){var i=x(function*(o,s,a){n.logger.debug("Publishing Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:o,message:s,opts:a}});try{const h=a?.ttl||kv,l=zi(a),f=a?.prompt||!1,m=a?.tag||0,_={topic:o,message:s,opts:{ttl:h,relay:l,prompt:f,tag:m}},v=Di(s);n.queue.set(v,_);try{yield yield Pa(n.rpcPublish(o,s,h,l,f,m),n.publishTimeout)}catch{return n.logger.debug("Publishing Payload stalled"),void n.relayer.events.emit(St_connection_stalled)}n.onPublish(v,_),n.logger.debug("Successfully Published Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:o,message:s,opts:a}})}catch(h){throw n.logger.debug("Failed to Publish Payload"),n.logger.error(h),h}});return function(o,s,a){return i.apply(this,arguments)}}(),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.relayer=e,this.logger=Fe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Fe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,o,s){var a,h,l,f;const m={method:Ki(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:o,tag:s}};return Lt(null==(a=m.params)?void 0:a.prompt)&&(null==(h=m.params)||delete h.prompt),Lt(null==(l=m.params)?void 0:l.tag)&&(null==(f=m.params)||delete f.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:m}),this.relayer.provider.request(m)}onPublish(e,r){this.queue.delete(e)}checkQueue(){var e=this;this.queue.forEach(function(){var r=x(function*(n){const{topic:i,message:o,opts:s}=n;yield e.publish(i,o,s)});return function(n){return r.apply(this,arguments)}}())}registerEventListeners(){this.relayer.core.heartbeat.on(Ur.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class s_{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u")return void this.map.delete(e);if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(o=>o!==r);i.length?this.map.set(e,i):this.map.delete(e)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var a_=Object.defineProperty,u_=Object.defineProperties,c_=Object.getOwnPropertyDescriptors,ju=Object.getOwnPropertySymbols,l_=Object.prototype.hasOwnProperty,h_=Object.prototype.propertyIsEnumerable,Mu=(t,e,r)=>e in t?a_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tn=(t,e)=>{for(var r in e||(e={}))l_.call(e,r)&&Mu(t,r,e[r]);if(ju)for(var r of ju(e))h_.call(e,r)&&Mu(t,r,e[r]);return t},oo=(t,e)=>u_(t,c_(e));class f_ extends rf{constructor(e,r){var n;super(e,r),n=this,this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new s_,this.events=new $t.exports.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=er,this.subscribeTimeout=1e4,this.init=x(function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restart(),n.registerEventListeners(),n.onEnable())}),this.subscribe=function(){var i=x(function*(o,s){n.isInitialized(),n.logger.debug("Subscribing Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:o,opts:s}});try{const a=zi(s),h={topic:o,relay:a};n.pending.set(o,h);const l=yield n.rpcSubscribe(o,a);return n.onSubscribe(l,h),n.logger.debug("Successfully Subscribed Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:o,opts:s}}),l}catch(a){throw n.logger.debug("Failed to Subscribe Topic"),n.logger.error(a),a}});return function(o,s){return i.apply(this,arguments)}}(),this.unsubscribe=function(){var i=x(function*(o,s){n.isInitialized(),typeof s?.id<"u"?yield n.unsubscribeById(o,s.id,s):yield n.unsubscribeByTopic(o,s)});return function(o,s){return i.apply(this,arguments)}}(),this.isSubscribed=function(){var i=x(function*(o){return!!n.topics.includes(o)||(yield new Promise((s,a)=>{const h=new Q.Watch;h.start(n.pendingSubscriptionWatchLabel);const l=setInterval(()=>{!n.pending.has(o)&&n.topics.includes(o)&&(clearInterval(l),h.stop(n.pendingSubscriptionWatchLabel),s(!0)),h.elapsed(n.pendingSubscriptionWatchLabel)>=Yv&&(clearInterval(l),h.stop(n.pendingSubscriptionWatchLabel),a(!1))},n.pendingSubInterval)}))});return function(o){return i.apply(this,arguments)}}(),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.restart=x(function*(){yield n.restore(),yield n.reset()}),this.relayer=e,this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}unsubscribeByTopic(e,r){var n=this;return x(function*(){const i=n.topicMap.get(e);yield Promise.all(i.map(function(){var o=x(function*(s){return yield n.unsubscribeById(e,s,r)});return function(s){return o.apply(this,arguments)}}()))})()}unsubscribeById(e,r,n){var i=this;return x(function*(){i.logger.debug("Unsubscribing Topic"),i.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const o=zi(n);yield i.rpcUnsubscribe(e,r,o);const s=Je("USER_DISCONNECTED",`${i.name}, ${e}`);yield i.onUnsubscribe(e,r,s),i.logger.debug("Successfully Unsubscribed Topic"),i.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(o){throw i.logger.debug("Failed to Unsubscribe Topic"),i.logger.error(o),o}})()}rpcSubscribe(e,r){var n=this;return x(function*(){const i={method:Ki(r.protocol).subscribe,params:{topic:e}};let o;n.logger.debug("Outgoing Relay Payload"),n.logger.trace({type:"payload",direction:"outgoing",request:i});try{o=yield yield Pa(n.relayer.provider.request(i),n.subscribeTimeout)}catch{n.logger.debug("Outgoing Relay Payload stalled"),n.relayer.events.emit(St_connection_stalled)}return o})()}rpcUnsubscribe(e,r,n){const i={method:Ki(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,oo(Tn({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,oo(Tn({},r),{id:e})),this.pending.delete(r.topic)}onUnsubscribe(e,r,n){var i=this;return x(function*(){i.events.removeAllListeners(r),i.hasSubscription(r,e)&&i.deleteSubscription(r,n),yield i.relayer.messages.del(e)})()}setRelayerSubscriptions(e){var r=this;return x(function*(){yield r.relayer.core.storage.setItem(r.storageKey,e)})()}getRelayerSubscriptions(){var e=this;return x(function*(){return yield e.relayer.core.storage.getItem(e.storageKey)})()}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Tn({},r)),this.topicMap.set(r.topic,e),this.events.emit(kt_created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(kt_deleted,oo(Tn({},n),{reason:r}))}persist(){var e=this;return x(function*(){yield e.setRelayerSubscriptions(e.values),e.events.emit(kt_sync)})()}reset(){var e=this;return x(function*(){e.cached.length&&(yield Promise.all(e.cached.map(function(){var r=x(function*(n){return yield e.resubscribe(n)});return function(n){return r.apply(this,arguments)}}()))),e.events.emit(kt_resubscribed)})()}restore(){var e=this;return x(function*(){try{const r=yield e.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(e.subscriptions.size){const{message:n}=q("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(n),new Error(n)}e.cached=r,e.logger.debug(`Successfully Restored subscriptions for ${e.name}`),e.logger.trace({type:"method",method:"restore",subscriptions:e.values})}catch(r){e.logger.debug(`Failed to Restore subscriptions for ${e.name}`),e.logger.error(r)}})()}resubscribe(e){var r=this;return x(function*(){if(!r.ids.includes(e.id)){const{topic:n,relay:i}=e,o={topic:n,relay:i};r.pending.set(o.topic,o);const s=yield r.rpcSubscribe(o.topic,o.relay);r.onResubscribe(s,o)}})()}onConnect(){var e=this;return x(function*(){yield e.restart(),e.onEnable()})()}onDisconnect(){this.onDisable()}checkPending(){var e=this;this.relayer.transportExplicitlyClosed||this.pending.forEach(function(){var r=x(function*(n){const i=yield e.rpcSubscribe(n.topic,n.relay);e.onSubscribe(i,n)});return function(n){return r.apply(this,arguments)}}())}registerEventListeners(){var e=this;this.relayer.core.heartbeat.on(Ur.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(St_connect,x(function*(){yield e.onConnect()})),this.relayer.on(St_disconnect,()=>{this.onDisconnect()}),this.events.on(kt_created,function(){var r=x(function*(n){const i=kt_created;e.logger.info(`Emitting ${i}`),e.logger.debug({type:"event",event:i,data:n}),yield e.persist()});return function(n){return r.apply(this,arguments)}}()),this.events.on(kt_deleted,function(){var r=x(function*(n){const i=kt_deleted;e.logger.info(`Emitting ${i}`),e.logger.debug({type:"event",event:i,data:n}),yield e.persist()});return function(n){return r.apply(this,arguments)}}())}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var p_=Object.defineProperty,Cu=Object.getOwnPropertySymbols,d_=Object.prototype.hasOwnProperty,y_=Object.prototype.propertyIsEnumerable,Uu=(t,e,r)=>e in t?p_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;class v_ extends ef{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new $t.exports.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?Fe.generateChildLogger(e.logger,this.name):Pe(Fe.getDefaultLoggerOptions({level:e.logger||"error"})),this.messages=new i_(this.logger,e.core),this.subscriber=new f_(this,this.logger),this.publisher=new o_(this,this.logger),this.relayUrl=e?.relayUrl||"wss://relay.walletconnect.com",this.projectId=e.projectId,this.provider={}}init(){var e=this;return x(function*(){e.logger.trace("Initialized"),e.provider=yield e.createProvider(),yield Promise.all([e.messages.init(),e.transportOpen(),e.subscriber.init()]),e.registerEventListeners(),e.initialized=!0})()}get context(){return Fe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}publish(e,r,n){var i=this;return x(function*(){i.isInitialized(),yield i.publisher.publish(e,r,n),yield i.recordMessageEvent({topic:e,message:r})})()}subscribe(e,r){var n=this;return x(function*(){n.isInitialized();let i="";return yield Promise.all([new Promise(o=>{n.subscriber.once(kt_created,s=>{s.topic===e&&o()})}),new Promise(function(){var o=x(function*(s){i=yield n.subscriber.subscribe(e,r),s()});return function(s){return o.apply(this,arguments)}}())]),i})()}unsubscribe(e,r){var n=this;return x(function*(){n.isInitialized(),yield n.subscriber.unsubscribe(e,r)})()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}transportClose(){var e=this;return x(function*(){e.transportExplicitlyClosed=!0,e.connected&&(yield e.provider.disconnect()),e.events.emit(St_transport_closed)})()}transportOpen(e){var r=this;return x(function*(){r.relayUrl=e||r.relayUrl,r.transportExplicitlyClosed=!1;try{yield Promise.all([new Promise(n=>{r.initialized||n(),r.subscriber.once(kt_resubscribed,()=>{n()})}),yield Promise.race([r.provider.connect(),new Promise((n,i)=>r.once(St_transport_closed,()=>{i()}))])])}catch(n){const i=n;if(!/socket hang up/i.test(i.message))throw new Error(i.message);r.logger.error(i),r.events.emit(St_transport_closed)}})()}restartTransport(e){var r=this;return x(function*(){yield r.transportClose(),yield new Promise(n=>setTimeout(n,Tu)),yield r.transportOpen(e)})()}createProvider(){var e=this;return x(function*(){const r=yield e.core.crypto.signJWT(e.relayUrl);return new Zi(new n1(Ly({sdkVersion:"2.1.3",protocol:e.protocol,version:e.version,relayUrl:e.relayUrl,projectId:e.projectId,auth:r})))})()}recordMessageEvent(e){var r=this;return x(function*(){const{topic:n,message:i}=e;yield r.messages.set(n,i)})()}shouldIgnoreMessageEvent(e){var r=this;return x(function*(){const{topic:n,message:i}=e;return!(yield r.subscriber.isSubscribed(n))||r.messages.has(n,i)})()}onProviderPayload(e){var r=this;return x(function*(){if(r.logger.debug("Incoming Relay Payload"),r.logger.trace({type:"payload",direction:"incoming",payload:e}),Ji(e)){if(!e.method.endsWith("_subscription"))return;const n=e.params,{topic:i,message:o}=n.data,s={topic:i,message:o};r.logger.debug("Emitting Relayer Payload"),r.logger.trace(((t,e)=>{for(var r in e||(e={}))d_.call(e,r)&&Uu(t,r,e[r]);if(Cu)for(var r of Cu(e))y_.call(e,r)&&Uu(t,r,e[r]);return t})({type:"event",event:n.id},s)),r.events.emit(n.id,s),yield r.acknowledgePayload(e),yield r.onMessageEvent(s)}})()}onMessageEvent(e){var r=this;return x(function*(){(yield r.shouldIgnoreMessageEvent(e))||(r.events.emit(St_message,e),yield r.recordMessageEvent(e))})()}acknowledgePayload(e){var r=this;return x(function*(){const n=Yi(e.id,!0);yield r.provider.connection.send(n)})()}registerEventListeners(){var e=this;this.provider.on(Rn_payload,r=>this.onProviderPayload(r)),this.provider.on(Rn_connect,()=>{this.events.emit(St_connect)}),this.provider.on(Rn_disconnect,()=>{this.events.emit(St_disconnect),this.attemptToReconnect()}),this.provider.on(Rn_error,r=>this.events.emit(St_error,r)),this.events.on(St_connection_stalled,x(function*(){yield e.restartTransport()}))}attemptToReconnect(){var e=this;this.transportExplicitlyClosed||setTimeout(x(function*(){yield e.transportOpen()}),Q.toMiliseconds(Tu))}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var __=Object.defineProperty,Du=Object.getOwnPropertySymbols,m_=Object.prototype.hasOwnProperty,b_=Object.prototype.propertyIsEnumerable,ku=(t,e,r)=>e in t?__(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zu=(t,e)=>{for(var r in e||(e={}))m_.call(e,r)&&ku(t,r,e[r]);if(Du)for(var r of Du(e))b_.call(e,r)&&ku(t,r,e[r]);return t};class jn extends class tf{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}{constructor(e,r,n,i=er,o){var s;super(e,r,n,i),s=this,this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=er,this.init=x(function*(){s.initialized||(s.logger.trace("Initialized"),yield s.restore(),s.cached.forEach(a=>{!function Yy(t){var e;return null==(e=t?.proposer)?void 0:e.publicKey}(a)?function Jy(t){return t?.topic}(a)?s.map.set(a.topic,a):s.getKey&&null!==a&&!Lt(a)&&s.map.set(s.getKey(a),a):s.map.set(a.id,a)}),s.cached=[],s.initialized=!0)}),this.set=function(){var a=x(function*(h,l){s.isInitialized(),s.map.has(h)?yield s.update(h,l):(s.logger.debug("Setting value"),s.logger.trace({type:"method",method:"set",key:h,value:l}),s.map.set(h,l),yield s.persist())});return function(h,l){return a.apply(this,arguments)}}(),this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(h=>Object.keys(a).every(l=>i1(h[l],a[l]))):this.values),this.update=function(){var a=x(function*(h,l){s.isInitialized(),s.logger.debug("Updating value"),s.logger.trace({type:"method",method:"update",key:h,update:l});const f=zu(zu({},s.getData(h)),l);s.map.set(h,f),yield s.persist()});return function(h,l){return a.apply(this,arguments)}}(),this.delete=function(){var a=x(function*(h,l){s.isInitialized(),s.map.has(h)&&(s.logger.debug("Deleting value"),s.logger.trace({type:"method",method:"delete",key:h,reason:l}),s.map.delete(h),yield s.persist())});return function(h,l){return a.apply(this,arguments)}}(),this.logger=Fe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=o}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}setDataStore(e){var r=this;return x(function*(){yield r.core.storage.setItem(r.storageKey,e)})()}getDataStore(){var e=this;return x(function*(){return yield e.core.storage.getItem(e.storageKey)})()}getData(e){const r=this.map.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}persist(){var e=this;return x(function*(){yield e.setDataStore(e.values)})()}restore(){var e=this;return x(function*(){try{const r=yield e.getDataStore();if(typeof r>"u"||!r.length)return;if(e.map.size){const{message:n}=q("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(n),new Error(n)}e.cached=r,e.logger.debug(`Successfully Restored value for ${e.name}`),e.logger.trace({type:"method",method:"restore",value:e.values})}catch(r){e.logger.debug(`Failed to Restore value for ${e.name}`),e.logger.error(r)}})()}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class w_{constructor(e,r){var n=this;this.core=e,this.logger=r,this.name="pairing",this.version="0.3",this.events=new $t.exports,this.initialized=!1,this.storagePrefix=er,this.ignoredPayloadTypes=[1],this.registeredMethods=[],this.init=x(function*(){n.initialized||(yield n.pairings.init(),yield n.cleanup(),n.registerRelayerEvents(),n.registerExpirerEvents(),n.initialized=!0,n.logger.trace("Initialized"))}),this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=x(function*(){n.isInitialized();const i=Ui(),o=yield n.core.crypto.setSymKey(i),s=Ht(Q.FIVE_MINUTES),a={protocol:"irn"},h={topic:o,expiry:s,relay:a,active:!1},l=zy({protocol:n.core.protocol,version:n.core.version,topic:o,symKey:i,relay:a});return yield n.pairings.set(o,h),yield n.core.relayer.subscribe(o),n.core.expirer.set(o,s),{topic:o,uri:l}}),this.pair=function(){var i=x(function*(o){n.isInitialized(),n.isValidPair(o);const{topic:s,symKey:a,relay:h}=function Dy(t){const e=t.indexOf(":"),r=-1!==t.indexOf("?")?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),o=typeof r<"u"?t.substring(r):"",s=Yr.parse(o);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:s.symKey,relay:Uy(s)}}(o.uri),l=Ht(Q.FIVE_MINUTES),f={topic:s,relay:h,expiry:l,active:!1};return yield n.pairings.set(s,f),yield n.core.crypto.setSymKey(a,s),yield n.core.relayer.subscribe(s,{relay:h}),n.core.expirer.set(s,l),o.activatePairing&&(yield n.activate({topic:s})),f});return function(o){return i.apply(this,arguments)}}(),this.activate=function(){var i=x(function*({topic:o}){n.isInitialized();const s=Ht(Q.THIRTY_DAYS);yield n.pairings.update(o,{active:!0,expiry:s}),n.core.expirer.set(o,s)});return function(o){return i.apply(this,arguments)}}(),this.ping=function(){var i=x(function*(o){n.isInitialized(),yield n.isValidPing(o);const{topic:s}=o;if(n.pairings.keys.includes(s)){const a=yield n.sendRequest(s,"wc_pairingPing",{}),{done:h,resolve:l,reject:f}=fr();n.events.once($e("pairing_ping",a),({error:m})=>{m?f(m):l()}),yield h()}});return function(o){return i.apply(this,arguments)}}(),this.updateExpiry=function(){var i=x(function*({topic:o,expiry:s}){n.isInitialized(),yield n.pairings.update(o,{expiry:s})});return function(o){return i.apply(this,arguments)}}(),this.updateMetadata=function(){var i=x(function*({topic:o,metadata:s}){n.isInitialized(),yield n.pairings.update(o,{peerMetadata:s})});return function(o){return i.apply(this,arguments)}}(),this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=function(){var i=x(function*(o){n.isInitialized(),yield n.isValidDisconnect(o);const{topic:s}=o;n.pairings.keys.includes(s)&&(yield n.sendRequest(s,"wc_pairingDelete",Je("USER_DISCONNECTED")),yield n.deletePairing(s))});return function(o){return i.apply(this,arguments)}}(),this.sendRequest=function(){var i=x(function*(o,s,a){const h=Fn(s,a),l=yield n.core.crypto.encode(o,h),f=rn[s].req;return n.core.history.set(o,h),yield n.core.relayer.publish(o,l,f),h.id});return function(o,s,a){return i.apply(this,arguments)}}(),this.sendResult=function(){var i=x(function*(o,s,a){const h=Yi(o,a),l=yield n.core.crypto.encode(s,h),f=yield n.core.history.get(s,o),m=rn[f.request.method].res;yield n.core.relayer.publish(s,l,m),yield n.core.history.resolve(h)});return function(o,s,a){return i.apply(this,arguments)}}(),this.sendError=function(){var i=x(function*(o,s,a){const h=Pn(o,a),l=yield n.core.crypto.encode(s,h),f=yield n.core.history.get(s,o),m=rn[f.request.method]?rn[f.request.method].res:rn.unregistered_method.res;yield n.core.relayer.publish(s,l,m),yield n.core.history.resolve(h)});return function(o,s,a){return i.apply(this,arguments)}}(),this.deletePairing=function(){var i=x(function*(o,s){yield n.core.relayer.unsubscribe(o),yield Promise.all([n.pairings.delete(o,Je("USER_DISCONNECTED")),n.core.crypto.deleteSymKey(o),s?Promise.resolve():n.core.expirer.del(o)])});return function(o,s){return i.apply(this,arguments)}}(),this.cleanup=x(function*(){const i=n.pairings.getAll().filter(o=>Qt(o.expiry));yield Promise.all(i.map(o=>n.deletePairing(o.topic)))}),this.onRelayEventRequest=i=>{const{topic:o,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(o,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,s);default:return this.onUnknownRpcMethodRequest(o,s)}},this.onRelayEventResponse=function(){var i=x(function*(o){const{topic:s,payload:a}=o,h=(yield n.core.history.get(s,a.id)).request.method;return"wc_pairingPing"===h?n.onPairingPingResponse(s,a):n.onUnknownRpcMethodResponse(h)});return function(o){return i.apply(this,arguments)}}(),this.onPairingPingRequest=function(){var i=x(function*(o,s){const{id:a}=s;try{n.isValidPing({topic:o}),yield n.sendResult(a,o,!0),n.events.emit("pairing_ping",{id:a,topic:o})}catch(h){yield n.sendError(a,o,h),n.logger.error(h)}});return function(o,s){return i.apply(this,arguments)}}(),this.onPairingPingResponse=(i,o)=>{const{id:s}=o;setTimeout(()=>{Wt(o)?this.events.emit($e("pairing_ping",s),{}):Tt(o)&&this.events.emit($e("pairing_ping",s),{error:o.error})},500)},this.onPairingDeleteRequest=function(){var i=x(function*(o,s){const{id:a}=s;try{n.isValidDisconnect({topic:o}),yield n.sendResult(a,o,!0),yield n.deletePairing(o),n.events.emit("pairing_delete",{id:a,topic:o})}catch(h){yield n.sendError(a,o,h),n.logger.error(h)}});return function(o,s){return i.apply(this,arguments)}}(),this.onUnknownRpcMethodRequest=function(){var i=x(function*(o,s){const{id:a,method:h}=s;try{if(n.registeredMethods.includes(h))return;const l=Je("WC_METHOD_UNSUPPORTED",h);yield n.sendError(a,o,l),n.logger.error(l)}catch(l){yield n.sendError(a,o,l),n.logger.error(l)}});return function(o,s){return i.apply(this,arguments)}}(),this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Je("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!Ot(i)){const{message:o}=q("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(o)}if(!function Wy(t){if(ut(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}(i.uri)){const{message:o}=q("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(o)}},this.isValidPing=function(){var i=x(function*(o){if(!Ot(o)){const{message:a}=q("MISSING_OR_INVALID",`ping() params: ${o}`);throw new Error(a)}const{topic:s}=o;yield n.isValidPairingTopic(s)});return function(o){return i.apply(this,arguments)}}(),this.isValidDisconnect=function(){var i=x(function*(o){if(!Ot(o)){const{message:a}=q("MISSING_OR_INVALID",`disconnect() params: ${o}`);throw new Error(a)}const{topic:s}=o;yield n.isValidPairingTopic(s)});return function(o){return i.apply(this,arguments)}}(),this.isValidPairingTopic=function(){var i=x(function*(o){if(!ut(o,!1)){const{message:s}=q("MISSING_OR_INVALID",`pairing topic should be a string: ${o}`);throw new Error(s)}if(!n.pairings.keys.includes(o)){const{message:s}=q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${o}`);throw new Error(s)}if(Qt(n.pairings.get(o).expiry)){yield n.deletePairing(o);const{message:s}=q("EXPIRED",`pairing topic: ${o}`);throw new Error(s)}});return function(o){return i.apply(this,arguments)}}(),this.core=e,this.logger=Fe.generateChildLogger(r,this.name),this.pairings=new jn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Fe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){var e=this;this.core.relayer.on(St_message,function(){var r=x(function*(n){const{topic:i,message:o}=n;if(e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(o)))return;const s=yield e.core.crypto.decode(i,o);Ji(s)?(e.core.history.set(i,s),e.onRelayEventRequest({topic:i,payload:s})):Xi(s)&&(yield e.core.history.resolve(s),e.onRelayEventResponse({topic:i,payload:s}))});return function(n){return r.apply(this,arguments)}}())}registerExpirerEvents(){var e=this;this.core.expirer.on(At_expired,function(){var r=x(function*(n){const{topic:i}=Aa(n.target);i&&e.pairings.keys.includes(i)&&(yield e.deletePairing(i,!0),e.events.emit("pairing_expire",{topic:i}))});return function(n){return r.apply(this,arguments)}}())}}class E_ extends Xh{constructor(e,r){var n;super(e,r),n=this,this.core=e,this.logger=r,this.records=new Map,this.events=new $t.exports.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=er,this.init=x(function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach(i=>n.records.set(i.id,i)),n.cached=[],n.registerEventListeners(),n.initialized=!0)}),this.set=(i,o,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:o,chainId:s}),this.records.has(o.id))return;const a={id:o.id,topic:i,request:{method:o.method,params:o.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(zt_created,a)},this.resolve=function(){var i=x(function*(o){if(n.isInitialized(),n.logger.debug("Updating JSON-RPC response history record"),n.logger.trace({type:"method",method:"update",response:o}),!n.records.has(o.id))return;const s=yield n.getRecord(o.id);typeof s.response>"u"&&(s.response=Tt(o)?{error:o.error}:{result:o.result},n.records.set(s.id,s),n.events.emit(zt_updated,s))});return function(o){return i.apply(this,arguments)}}(),this.get=function(){var i=x(function*(o,s){return n.isInitialized(),n.logger.debug("Getting record"),n.logger.trace({type:"method",method:"get",topic:o,id:s}),yield n.getRecord(s)});return function(o,s){return i.apply(this,arguments)}}(),this.delete=(i,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(s=>{if(s.topic===i){if(typeof o<"u"&&s.id!==o)return;this.records.delete(s.id),this.events.emit(zt_deleted,s)}})},this.exists=function(){var i=x(function*(o,s){return n.isInitialized(),!!n.records.has(s)&&(yield n.getRecord(s)).topic===o});return function(o,s){return i.apply(this,arguments)}}(),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Fn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}setJsonRpcRecords(e){var r=this;return x(function*(){yield r.core.storage.setItem(r.storageKey,e)})()}getJsonRpcRecords(){var e=this;return x(function*(){return yield e.core.storage.getItem(e.storageKey)})()}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}persist(){var e=this;return x(function*(){yield e.setJsonRpcRecords(e.values),e.events.emit(zt_sync)})()}restore(){var e=this;return x(function*(){try{const r=yield e.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(e.records.size){const{message:n}=q("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(n),new Error(n)}e.cached=r,e.logger.debug(`Successfully Restored records for ${e.name}`),e.logger.trace({type:"method",method:"restore",records:e.values})}catch(r){e.logger.debug(`Failed to Restore records for ${e.name}`),e.logger.error(r)}})()}registerEventListeners(){this.events.on(zt_created,e=>{const r=zt_created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(zt_updated,e=>{const r=zt_updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(zt_deleted,e=>{const r=zt_deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class O_ extends nf{constructor(e,r){var n;super(e,r),n=this,this.core=e,this.logger=r,this.expirations=new Map,this.events=new $t.exports.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=er,this.init=x(function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach(i=>n.expirations.set(i.target,i)),n.cached=[],n.registerEventListeners(),n.initialized=!0)}),this.has=i=>{try{const o=this.formatTarget(i);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(i,o)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:o};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(At_created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const o=this.formatTarget(i);return this.getExpiration(o)},this.del=i=>{this.isInitialized();const o=this.formatTarget(i);if(this.has(o)){const s=this.getExpiration(o);this.expirations.delete(o),this.events.emit(At_deleted,{target:o,expiration:s})}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=Fe.generateChildLogger(r,this.name)}get context(){return Fe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function Ay(t){return La("topic",t)}(e);if("number"==typeof e)return function Ny(t){return La("id",t)}(e);const{message:r}=q("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(r)}setExpirations(e){var r=this;return x(function*(){yield r.core.storage.setItem(r.storageKey,e)})()}getExpirations(){var e=this;return x(function*(){return yield e.core.storage.getItem(e.storageKey)})()}persist(){var e=this;return x(function*(){yield e.setExpirations(e.values),e.events.emit(At_sync)})()}restore(){var e=this;return x(function*(){try{const r=yield e.getExpirations();if(typeof r>"u"||!r.length)return;if(e.expirations.size){const{message:n}=q("RESTORE_WILL_OVERRIDE",e.name);throw e.logger.error(n),new Error(n)}e.cached=r,e.logger.debug(`Successfully Restored expirations for ${e.name}`),e.logger.trace({type:"method",method:"restore",expirations:e.values})}catch(r){e.logger.debug(`Failed to Restore expirations for ${e.name}`),e.logger.error(r)}})()}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Q.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(At_expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Ur.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(At_created,e=>{const r=At_created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(At_expired,e=>{const r=At_expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(At_deleted,e=>{const r=At_deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var S_=Object.defineProperty,Ku=Object.getOwnPropertySymbols,x_=Object.prototype.hasOwnProperty,I_=Object.prototype.propertyIsEnumerable,Bu=(t,e,r)=>e in t?S_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$u=(t,e)=>{for(var r in e||(e={}))x_.call(e,r)&&Bu(t,r,e[r]);if(Ku)for(var r of Ku(e))I_.call(e,r)&&Bu(t,r,e[r]);return t};class so extends Jh{constructor(e){super(e),this.protocol="wc",this.version=2,this.name=io,this.events=new $t.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:Pe(Fe.getDefaultLoggerOptions({level:e?.logger||Nv_logger}));this.logger=Fe.generateChildLogger(r,this.name),this.heartbeat=new Ur.HeartBeat,this.crypto=new n_(this,this.logger,e?.keychain),this.history=new E_(this,this.logger),this.expirer=new O_(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new wl($u($u({},Rv),e?.storageOptions)),this.relayer=new v_({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new w_(this,this.logger)}static init(e){return x(function*(){const r=new so(e);return yield r.initialize(),r})()}get context(){return Fe.getLoggerContext(this.logger)}start(){var e=this;return x(function*(){e.initialized||(yield e.initialize())})()}initialize(){var e=this;return x(function*(){e.logger.trace("Initialized");try{yield e.crypto.init(),yield e.history.init(),yield e.expirer.init(),yield e.relayer.init(),yield e.heartbeat.init(),yield e.pairing.init(),e.initialized=!0,e.logger.info("Core Initilization Success")}catch(r){throw e.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,r),e.logger.error(r.message),r}})()}}const F_=so;var Cn,Mn={exports:{}},Pr="object"==typeof Reflect?Reflect:null,Vu=Pr&&"function"==typeof Pr.apply?Pr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};Cn=Pr&&"function"==typeof Pr.ownKeys?Pr.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var Hu=Number.isNaN||function(t){return t!=t};function Re(){Re.init.call(this)}Mn.exports=Re,Mn.exports.once=function R_(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}Qu(t,e,o,{once:!0}),"error"!==e&&function T_(t,e,r){"function"==typeof t.on&&Qu(t,"error",e,r)}(t,i,{once:!0})})},Re.EventEmitter=Re,Re.prototype._events=void 0,Re.prototype._eventsCount=0,Re.prototype._maxListeners=void 0;var qu=10;function Un(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function Gu(t){return void 0===t._maxListeners?Re.defaultMaxListeners:t._maxListeners}function Wu(t,e,r,n){var i,o,s;if(Un(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=Gu(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function P_(t){console&&console.warn&&console.warn(t)}(a)}return t}function L_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Yu(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=L_.bind(n);return i.listener=r,n.wrapFn=i,i}function Ju(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function N_(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):Zu(i,i.length)}function Xu(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Zu(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Qu(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(Re,"defaultMaxListeners",{enumerable:!0,get:function(){return qu},set:function(t){if("number"!=typeof t||t<0||Hu(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");qu=t}}),Re.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Re.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||Hu(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Re.prototype.getMaxListeners=function(){return Gu(this)},Re.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)Vu(a,this,e);else{var h=a.length,l=Zu(a,h);for(r=0;r<h;++r)Vu(l[r],this,e)}return!0},Re.prototype.on=Re.prototype.addListener=function(t,e){return Wu(this,t,e,!1)},Re.prototype.prependListener=function(t,e){return Wu(this,t,e,!0)},Re.prototype.once=function(t,e){return Un(e),this.on(t,Yu(this,t,e)),this},Re.prototype.prependOnceListener=function(t,e){return Un(e),this.prependListener(t,Yu(this,t,e)),this},Re.prototype.off=Re.prototype.removeListener=function(t,e){var r,n,i,o,s;if(Un(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function A_(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Re.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Re.prototype.listeners=function(t){return Ju(this,t,!0)},Re.prototype.rawListeners=function(t){return Ju(this,t,!1)},Re.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Xu.call(t,e)},Re.prototype.listenerCount=Xu,Re.prototype.eventNames=function(){return this._eventsCount>0?Cn(this._events):[]};const ao="wc@2:client:",uo_name="client",uo_logger="error",Dn=Q.SEVEN_DAYS,nn={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}};var D_=Object.defineProperty,k_=Object.defineProperties,z_=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,K_=Object.prototype.hasOwnProperty,B_=Object.prototype.propertyIsEnumerable,ic=(t,e,r)=>e in t?D_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,tr=(t,e)=>{for(var r in e||(e={}))K_.call(e,r)&&ic(t,r,e[r]);if(nc)for(var r of nc(e))B_.call(e,r)&&ic(t,r,e[r]);return t},oc=(t,e)=>k_(t,z_(e));class $_ extends class sf{constructor(e){this.client=e}}{constructor(e){var r;super(e),r=this,this.name="engine",this.events=new Mn.exports,this.initialized=!1,this.ignoredPayloadTypes=[1],this.init=x(function*(){r.initialized||(yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.client.core.pairing.register({methods:Object.keys(nn)}),r.initialized=!0)}),this.connect=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidConnect(i);const{pairingTopic:o,requiredNamespaces:s,relays:a}=i;let l,h=o,f=!1;if(h&&(f=r.client.core.pairing.pairings.get(h).active),!h||!f){const{topic:I,uri:L}=yield r.client.core.pairing.create();h=I,l=L}const m=yield r.client.core.crypto.generateKeyPair(),_={requiredNamespaces:s,relays:a??[{protocol:"irn"}],proposer:{publicKey:m,metadata:r.client.metadata}},{reject:v,resolve:b,done:R}=fr();if(r.events.once($e("session_connect"),function(){var I=x(function*({error:L,session:g}){if(L)v(L);else if(g){g.self.publicKey=m;const S=oc(tr({},g),{requiredNamespaces:s});yield r.client.session.set(g.topic,S),yield r.setExpiry(g.topic,g.expiry),h&&(yield r.client.core.pairing.updateMetadata({topic:h,metadata:g.peer.metadata})),b(S)}});return function(L){return I.apply(this,arguments)}}()),!h){const{message:I}=q("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw new Error(I)}const M=yield r.sendRequest(h,"wc_sessionPropose",_),$=Ht(Q.FIVE_MINUTES);return yield r.setProposal(M,tr({id:M,expiry:$},_)),{uri:l,approval:R}});return function(i){return n.apply(this,arguments)}}(),this.pair=function(){var n=x(function*(i){return r.isInitialized(),yield r.client.core.pairing.pair(i)});return function(i){return n.apply(this,arguments)}}(),this.approve=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidApprove(i);const{id:o,relayProtocol:s,namespaces:a}=i,{pairingTopic:h,proposer:l,requiredNamespaces:f}=r.client.proposal.get(o),m=yield r.client.core.crypto.generateKeyPair(),_=l.publicKey,v=yield r.client.core.crypto.generateSharedKey(m,_),b={relay:{protocol:s??"irn"},namespaces:a,requiredNamespaces:f,controller:{publicKey:m,metadata:r.client.metadata},expiry:Ht(Dn)};yield r.client.core.relayer.subscribe(v);const R=yield r.sendRequest(v,"wc_sessionSettle",b),{done:M,resolve:$,reject:I}=fr();r.events.once($e("session_approve",R),({error:g})=>{g?I(g):$(r.client.session.get(v))});const L=oc(tr({},b),{topic:v,acknowledged:!1,self:b.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:m});return yield r.client.session.set(v,L),yield r.setExpiry(v,Ht(Dn)),h&&(yield r.client.core.pairing.updateMetadata({topic:h,metadata:L.peer.metadata})),h&&o&&(yield r.sendResult(o,h,{relay:{protocol:s??"irn"},responderPublicKey:m}),yield r.client.proposal.delete(o,Je("USER_DISCONNECTED")),yield r.client.core.pairing.activate({topic:h})),{topic:v,acknowledged:M}});return function(i){return n.apply(this,arguments)}}(),this.reject=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidReject(i);const{id:o,reason:s}=i,{pairingTopic:a}=r.client.proposal.get(o);a&&(yield r.sendError(o,a,s),yield r.client.proposal.delete(o,Je("USER_DISCONNECTED")))});return function(i){return n.apply(this,arguments)}}(),this.update=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidUpdate(i);const{topic:o,namespaces:s}=i,a=yield r.sendRequest(o,"wc_sessionUpdate",{namespaces:s}),{done:h,resolve:l,reject:f}=fr();return r.events.once($e("session_update",a),({error:m})=>{m?f(m):l()}),yield r.client.session.update(o,{namespaces:s}),{acknowledged:h}});return function(i){return n.apply(this,arguments)}}(),this.extend=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidExtend(i);const{topic:o}=i,s=yield r.sendRequest(o,"wc_sessionExtend",{}),{done:a,resolve:h,reject:l}=fr();return r.events.once($e("session_extend",s),({error:f})=>{f?l(f):h()}),yield r.setExpiry(o,Ht(Dn)),{acknowledged:a}});return function(i){return n.apply(this,arguments)}}(),this.request=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidRequest(i);const{chainId:o,request:s,topic:a}=i,h=yield r.sendRequest(a,"wc_sessionRequest",{request:s,chainId:o}),{done:l,resolve:f,reject:m}=fr();return r.events.once($e("session_request",h),({error:_,result:v})=>{_?m(_):f(v)}),yield l()});return function(i){return n.apply(this,arguments)}}(),this.respond=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidRespond(i);const{topic:o,response:s}=i,{id:a}=s;Wt(s)?yield r.sendResult(a,o,s.result):Tt(s)&&(yield r.sendError(a,o,s.error)),r.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})});return function(i){return n.apply(this,arguments)}}(),this.ping=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidPing(i);const{topic:o}=i;if(r.client.session.keys.includes(o)){const s=yield r.sendRequest(o,"wc_sessionPing",{}),{done:a,resolve:h,reject:l}=fr();r.events.once($e("session_ping",s),({error:f})=>{f?l(f):h()}),yield a()}else r.client.core.pairing.pairings.keys.includes(o)&&(yield r.client.core.pairing.ping({topic:o}))});return function(i){return n.apply(this,arguments)}}(),this.emit=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidEmit(i);const{topic:o,event:s,chainId:a}=i;yield r.sendRequest(o,"wc_sessionEvent",{event:s,chainId:a})});return function(i){return n.apply(this,arguments)}}(),this.disconnect=function(){var n=x(function*(i){r.isInitialized(),yield r.isValidDisconnect(i);const{topic:o}=i;r.client.session.keys.includes(o)?(yield r.sendRequest(o,"wc_sessionDelete",Je("USER_DISCONNECTED")),yield r.deleteSession(o)):yield r.client.core.pairing.disconnect({topic:o})});return function(i){return n.apply(this,arguments)}}(),this.find=n=>(this.isInitialized(),this.client.session.getAll().filter(i=>function qy(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let o=!0;return!!Et(i,n)&&(n.forEach(s=>{const{accounts:a,methods:h,events:l,extension:f}=t.namespaces[s],m=Dt(a),_=r[s];Et(_.chains,m)&&Et(_.methods,h)&&Et(_.events,l)||(o=!1),o&&f&&f.forEach(v=>{var b;const{accounts:R,methods:M,events:$}=v,I=Dt(R);null!=(b=_.extension)&&b.find(L=>Et(L.chains,I)&&Et(L.methods,M)&&Et(L.events,$))||(o=!1)})}),o)}(i,n))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=function(){var n=x(function*(i,o){const{self:s}=r.client.session.get(i);yield r.client.core.relayer.unsubscribe(i),yield Promise.all([r.client.session.delete(i,Je("USER_DISCONNECTED")),r.client.core.crypto.deleteKeyPair(s.publicKey),r.client.core.crypto.deleteSymKey(i),o?Promise.resolve():r.client.core.expirer.del(i)])});return function(i,o){return n.apply(this,arguments)}}(),this.deleteProposal=function(){var n=x(function*(i,o){yield Promise.all([r.client.proposal.delete(i,Je("USER_DISCONNECTED")),o?Promise.resolve():r.client.core.expirer.del(i)])});return function(i,o){return n.apply(this,arguments)}}(),this.deletePendingSessionRequest=function(){var n=x(function*(i,o,s=!1){yield Promise.all([r.client.pendingRequest.delete(i,o),s?Promise.resolve():r.client.core.expirer.del(i)])});return function(i,o){return n.apply(this,arguments)}}(),this.setExpiry=function(){var n=x(function*(i,o){r.client.session.keys.includes(i)&&(yield r.client.session.update(i,{expiry:o})),r.client.core.expirer.set(i,o)});return function(i,o){return n.apply(this,arguments)}}(),this.setProposal=function(){var n=x(function*(i,o){yield r.client.proposal.set(i,o),r.client.core.expirer.set(i,o.expiry)});return function(i,o){return n.apply(this,arguments)}}(),this.setPendingSessionRequest=function(){var n=x(function*(i){const o=nn.wc_sessionRequest.req.ttl,{id:s,topic:a,params:h}=i;yield r.client.pendingRequest.set(s,{id:s,topic:a,params:h}),o&&r.client.core.expirer.set(s,o)});return function(i){return n.apply(this,arguments)}}(),this.sendRequest=function(){var n=x(function*(i,o,s){const a=Fn(o,s),h=yield r.client.core.crypto.encode(i,a),l=nn[o].req;return r.client.core.history.set(i,a),r.client.core.relayer.publish(i,h,l),a.id});return function(i,o,s){return n.apply(this,arguments)}}(),this.sendResult=function(){var n=x(function*(i,o,s){const a=Yi(i,s),h=yield r.client.core.crypto.encode(o,a),l=yield r.client.core.history.get(o,i);r.client.core.relayer.publish(o,h,nn[l.request.method].res),yield r.client.core.history.resolve(a)});return function(i,o,s){return n.apply(this,arguments)}}(),this.sendError=function(){var n=x(function*(i,o,s){const a=Pn(i,s),h=yield r.client.core.crypto.encode(o,a),l=yield r.client.core.history.get(o,i);r.client.core.relayer.publish(o,h,nn[l.request.method].res),yield r.client.core.history.resolve(a)});return function(i,o,s){return n.apply(this,arguments)}}(),this.cleanup=x(function*(){const n=[],i=[];r.client.session.getAll().forEach(o=>{Qt(o.expiry)&&n.push(o.topic)}),r.client.proposal.getAll().forEach(o=>{Qt(o.expiry)&&i.push(o.id)}),yield Promise.all([...n.map(o=>r.deleteSession(o)),...i.map(o=>r.deleteProposal(o))])}),this.onRelayEventRequest=n=>{const{topic:i,payload:o}=n,s=o.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,o);case"wc_sessionSettle":return this.onSessionSettleRequest(i,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,o);case"wc_sessionExtend":return this.onSessionExtendRequest(i,o);case"wc_sessionPing":return this.onSessionPingRequest(i,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,o);case"wc_sessionRequest":return this.onSessionRequest(i,o);case"wc_sessionEvent":return this.onSessionEventRequest(i,o);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=function(){var n=x(function*(i){const{topic:o,payload:s}=i,a=(yield r.client.core.history.get(o,s.id)).request.method;switch(a){case"wc_sessionPropose":return r.onSessionProposeResponse(o,s);case"wc_sessionSettle":return r.onSessionSettleResponse(o,s);case"wc_sessionUpdate":return r.onSessionUpdateResponse(o,s);case"wc_sessionExtend":return r.onSessionExtendResponse(o,s);case"wc_sessionPing":return r.onSessionPingResponse(o,s);case"wc_sessionRequest":return r.onSessionRequestResponse(o,s);default:return r.client.logger.info(`Unsupported response method ${a}`)}});return function(i){return n.apply(this,arguments)}}(),this.onSessionProposeRequest=function(){var n=x(function*(i,o){const{params:s,id:a}=o;try{r.isValidConnect(tr({},o.params));const h=Ht(Q.FIVE_MINUTES),l=tr({id:a,pairingTopic:i,expiry:h},s);yield r.setProposal(a,l),r.client.events.emit("session_proposal",{id:a,params:l})}catch(h){yield r.sendError(a,i,h),r.client.logger.error(h)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionProposeResponse=function(){var n=x(function*(i,o){const{id:s}=o;if(Wt(o)){const{result:a}=o;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const h=r.client.proposal.get(s);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const l=h.proposer.publicKey;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const f=a.responderPublicKey;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const m=yield r.client.core.crypto.generateSharedKey(l,f);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:m});const _=yield r.client.core.relayer.subscribe(m);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),yield r.client.core.pairing.activate({topic:i})}else Tt(o)&&(yield r.client.proposal.delete(s,Je("USER_DISCONNECTED")),r.events.emit($e("session_connect"),{error:o.error}))});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionSettleRequest=function(){var n=x(function*(i,o){const{id:s,params:a}=o;try{r.isValidSessionSettleRequest(a);const{relay:h,controller:l,expiry:f,namespaces:m}=o.params,_={topic:i,relay:h,expiry:f,namespaces:m,acknowledged:!0,controller:l.publicKey,self:{publicKey:"",metadata:r.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}};yield r.sendResult(o.id,i,!0),r.events.emit($e("session_connect"),{session:_})}catch(h){yield r.sendError(s,i,h),r.client.logger.error(h)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionSettleResponse=function(){var n=x(function*(i,o){const{id:s}=o;Wt(o)?(yield r.client.session.update(i,{acknowledged:!0}),r.events.emit($e("session_approve",s),{})):Tt(o)&&(yield r.client.session.delete(i,Je("USER_DISCONNECTED")),r.events.emit($e("session_approve",s),{error:o.error}))});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionUpdateRequest=function(){var n=x(function*(i,o){const{params:s,id:a}=o;try{r.isValidUpdate(tr({topic:i},s)),yield r.client.session.update(i,{namespaces:s.namespaces}),yield r.sendResult(a,i,!0),r.client.events.emit("session_update",{id:a,topic:i,params:s})}catch(h){yield r.sendError(a,i,h),r.client.logger.error(h)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionUpdateResponse=(n,i)=>{const{id:o}=i;Wt(i)?this.events.emit($e("session_update",o),{}):Tt(i)&&this.events.emit($e("session_update",o),{error:i.error})},this.onSessionExtendRequest=function(){var n=x(function*(i,o){const{id:s}=o;try{r.isValidExtend({topic:i}),yield r.setExpiry(i,Ht(Dn)),yield r.sendResult(s,i,!0),r.client.events.emit("session_extend",{id:s,topic:i})}catch(a){yield r.sendError(s,i,a),r.client.logger.error(a)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionExtendResponse=(n,i)=>{const{id:o}=i;Wt(i)?this.events.emit($e("session_extend",o),{}):Tt(i)&&this.events.emit($e("session_extend",o),{error:i.error})},this.onSessionPingRequest=function(){var n=x(function*(i,o){const{id:s}=o;try{r.isValidPing({topic:i}),yield r.sendResult(s,i,!0),r.client.events.emit("session_ping",{id:s,topic:i})}catch(a){yield r.sendError(s,i,a),r.client.logger.error(a)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionPingResponse=(n,i)=>{const{id:o}=i;setTimeout(()=>{Wt(i)?this.events.emit($e("session_ping",o),{}):Tt(i)&&this.events.emit($e("session_ping",o),{error:i.error})},500)},this.onSessionDeleteRequest=function(){var n=x(function*(i,o){const{id:s}=o;try{r.isValidDisconnect({topic:i,reason:o.params}),yield r.sendResult(s,i,!0),yield r.deleteSession(i),r.client.events.emit("session_delete",{id:s,topic:i})}catch(a){yield r.sendError(s,i,a),r.client.logger.error(a)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionRequest=function(){var n=x(function*(i,o){const{id:s,params:a}=o;try{r.isValidRequest(tr({topic:i},a)),yield r.setPendingSessionRequest({id:s,topic:i,params:a}),r.client.events.emit("session_request",{id:s,topic:i,params:a})}catch(h){yield r.sendError(s,i,h),r.client.logger.error(h)}});return function(i,o){return n.apply(this,arguments)}}(),this.onSessionRequestResponse=(n,i)=>{const{id:o}=i;Wt(i)?this.events.emit($e("session_request",o),{result:i.result}):Tt(i)&&this.events.emit($e("session_request",o),{error:i.error})},this.onSessionEventRequest=function(){var n=x(function*(i,o){const{id:s,params:a}=o;try{r.isValidEmit(tr({topic:i},a)),r.client.events.emit("session_event",{id:s,topic:i,params:a})}catch(h){yield r.sendError(s,i,h),r.client.logger.error(h)}});return function(i,o){return n.apply(this,arguments)}}(),this.isValidConnect=function(){var n=x(function*(i){if(!Ot(i)){const{message:l}=q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(l)}const{pairingTopic:o,requiredNamespaces:s,relays:a}=i;Lt(o)||(yield r.isValidPairingTopic(o));const h=eg(s,"connect()");if(h)throw new Error(h.message);if(!function tg(t,e){let r=!1;return e&&!t?r=!0:t&&Zr(t)&&t.length&&t.forEach(n=>{r=za(n)}),r}(a,!0)){const{message:l}=q("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(l)}});return function(i){return n.apply(this,arguments)}}(),this.isValidApprove=function(){var n=x(function*(i){if(!Ot(i))throw new Error(q("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:o,namespaces:s,relayProtocol:a}=i;yield r.isValidProposalId(o);const h=r.client.proposal.get(o),l=Vi(s,"approve()");if(l)throw new Error(l.message);const f=Ba(h.requiredNamespaces,s,"update()");if(f)throw new Error(f.message);if(!ut(a,!0)){const{message:m}=q("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(m)}});return function(i){return n.apply(this,arguments)}}(),this.isValidReject=function(){var n=x(function*(i){if(!Ot(i)){const{message:a}=q("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(a)}const{id:o,reason:s}=i;if(yield r.isValidProposalId(o),!function ng(t){return!!(t&&"object"==typeof t&&t.code&&ja(t.code,!1)&&t.message&&ut(t.message,!1))}(s)){const{message:a}=q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}});return function(i){return n.apply(this,arguments)}}(),this.isValidSessionSettleRequest=n=>{if(!Ot(n)){const{message:f}=q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(f)}const{relay:i,controller:o,namespaces:s,expiry:a}=n;if(!za(i)){const{message:f}=q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const h=function Xy(t,e){let r=null;return ut(t?.publicKey,!1)||(r=q("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}(o,"onSessionSettleRequest()");if(h)throw new Error(h.message);const l=Vi(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(Qt(a)){const{message:f}=q("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=function(){var n=x(function*(i){if(!Ot(i)){const{message:f}=q("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(f)}const{topic:o,namespaces:s}=i;yield r.isValidSessionTopic(o);const a=r.client.session.get(o),h=Vi(s,"update()");if(h)throw new Error(h.message);const l=Ba(a.requiredNamespaces,s,"update()");if(l)throw new Error(l.message)});return function(i){return n.apply(this,arguments)}}(),this.isValidExtend=function(){var n=x(function*(i){if(!Ot(i)){const{message:s}=q("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(s)}const{topic:o}=i;yield r.isValidSessionTopic(o)});return function(i){return n.apply(this,arguments)}}(),this.isValidRequest=function(){var n=x(function*(i){if(!Ot(i)){const{message:l}=q("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(l)}const{topic:o,request:s,chainId:a}=i;yield r.isValidSessionTopic(o);const{namespaces:h}=r.client.session.get(o);if(!Ka(h,a)){const{message:l}=q("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(l)}if(!function ig(t){return!(Lt(t)||!ut(t.method,!1))}(s)){const{message:l}=q("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(l)}if(!ag(h,a,s.method)){const{message:l}=q("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(l)}});return function(i){return n.apply(this,arguments)}}(),this.isValidRespond=function(){var n=x(function*(i){if(!Ot(i)){const{message:a}=q("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(a)}const{topic:o,response:s}=i;if(yield r.isValidSessionTopic(o),!function og(t){return!(Lt(t)||Lt(t.result)&&Lt(t.error)||!ja(t.id,!1)||!ut(t.jsonrpc,!1))}(s)){const{message:a}=q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}});return function(i){return n.apply(this,arguments)}}(),this.isValidPing=function(){var n=x(function*(i){if(!Ot(i)){const{message:s}=q("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:o}=i;yield r.isValidSessionOrPairingTopic(o)});return function(i){return n.apply(this,arguments)}}(),this.isValidEmit=function(){var n=x(function*(i){if(!Ot(i)){const{message:l}=q("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(l)}const{topic:o,event:s,chainId:a}=i;yield r.isValidSessionTopic(o);const{namespaces:h}=r.client.session.get(o);if(!Ka(h,a)){const{message:l}=q("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(l)}if(!function sg(t){return!(Lt(t)||!ut(t.name,!1))}(s)){const{message:l}=q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(l)}if(!ug(h,a,s.name)){const{message:l}=q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(l)}});return function(i){return n.apply(this,arguments)}}(),this.isValidDisconnect=function(){var n=x(function*(i){if(!Ot(i)){const{message:s}=q("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:o}=i;yield r.isValidSessionOrPairingTopic(o)});return function(i){return n.apply(this,arguments)}}()}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){var e=this;this.client.core.relayer.on(St_message,function(){var r=x(function*(n){const{topic:i,message:o}=n;if(e.ignoredPayloadTypes.includes(e.client.core.crypto.getPayloadType(o)))return;const s=yield e.client.core.crypto.decode(i,o);Ji(s)?(e.client.core.history.set(i,s),e.onRelayEventRequest({topic:i,payload:s})):Xi(s)&&(yield e.client.core.history.resolve(s),e.onRelayEventResponse({topic:i,payload:s}))});return function(n){return r.apply(this,arguments)}}())}registerExpirerEvents(){var e=this;this.client.core.expirer.on(At_expired,function(){var r=x(function*(n){const{topic:i,id:o}=Aa(n.target);if(o&&e.getPendingSessionRequests()[o])return yield e.deletePendingSessionRequest(o,q("EXPIRED"),!0);i?e.client.session.keys.includes(i)&&(yield e.deleteSession(i,!0),e.client.events.emit("session_expire",{topic:i})):o&&(yield e.deleteProposal(o,!0))});return function(n){return r.apply(this,arguments)}}())}isValidPairingTopic(e){if(!ut(e,!1)){const{message:r}=q("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Qt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=q("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}isValidSessionTopic(e){var r=this;return x(function*(){if(!ut(e,!1)){const{message:n}=q("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(!r.client.session.keys.includes(e)){const{message:n}=q("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(Qt(r.client.session.get(e).expiry)){yield r.deleteSession(e);const{message:n}=q("EXPIRED",`session topic: ${e}`);throw new Error(n)}})()}isValidSessionOrPairingTopic(e){var r=this;return x(function*(){if(r.client.session.keys.includes(e))yield r.isValidSessionTopic(e);else{if(!r.client.core.pairing.pairings.keys.includes(e)){if(ut(e,!1)){const{message:n}=q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}{const{message:n}=q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}r.isValidPairingTopic(e)}})()}isValidProposalId(e){var r=this;return x(function*(){if(!function rg(t){return"number"==typeof t}(e)){const{message:n}=q("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!r.client.proposal.keys.includes(e)){const{message:n}=q("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(Qt(r.client.proposal.get(e).expiry)){yield r.deleteProposal(e);const{message:n}=q("EXPIRED",`proposal id: ${e}`);throw new Error(n)}})()}}class V_ extends jn{constructor(e,r){super(e,r,"proposal",ao),this.core=e,this.logger=r}}class H_ extends jn{constructor(e,r){super(e,r,"session",ao),this.core=e,this.logger=r}}class q_ extends jn{constructor(e,r){super(e,r,"request",ao),this.core=e,this.logger=r}}class co extends class of{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}{constructor(e){var r;super(e),r=this,this.protocol="wc",this.version=2,this.name=uo_name,this.events=new Mn.exports.EventEmitter,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=function(){var i=x(function*(o){try{return yield r.engine.connect(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.pair=function(){var i=x(function*(o){try{return yield r.engine.pair(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.approve=function(){var i=x(function*(o){try{return yield r.engine.approve(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.reject=function(){var i=x(function*(o){try{return yield r.engine.reject(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.update=function(){var i=x(function*(o){try{return yield r.engine.update(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.extend=function(){var i=x(function*(o){try{return yield r.engine.extend(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.request=function(){var i=x(function*(o){try{return yield r.engine.request(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.respond=function(){var i=x(function*(o){try{return yield r.engine.respond(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.ping=function(){var i=x(function*(o){try{return yield r.engine.ping(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.emit=function(){var i=x(function*(o){try{return yield r.engine.emit(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.disconnect=function(){var i=x(function*(o){try{return yield r.engine.disconnect(o)}catch(s){throw r.logger.error(s.message),s}});return function(o){return i.apply(this,arguments)}}(),this.find=i=>{try{return this.engine.find(i)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||uo_name,this.metadata=e?.metadata||function xy(){return fa()||{name:"",description:"",url:"",icons:[""]}}();const n=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:Pe(Fe.getDefaultLoggerOptions({level:e?.logger||uo_logger}));this.core=e?.core||new F_(e),this.logger=Fe.generateChildLogger(n,this.name),this.session=new H_(this.core,this.logger),this.proposal=new V_(this.core,this.logger),this.pendingRequest=new q_(this.core,this.logger),this.engine=new $_(this)}static init(e){return x(function*(){const r=new co(e);return yield r.initialize(),r})()}get context(){return Fe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}initialize(){var e=this;return x(function*(){e.logger.trace("Initialized");try{yield e.core.start(),yield e.session.init(),yield e.proposal.init(),yield e.pendingRequest.init(),yield e.engine.init(),e.logger.info("SignClient Initilization Success")}catch(r){throw e.logger.info("SignClient Initilization Failure"),e.logger.error(r.message),r}})()}}var lo={exports:{}};!function(t,e){var o,r=typeof self<"u"?self:gt,n=function(){function o(){this.fetch=!1,this.DOMException=r.DOMException}return o.prototype=r,new o}();o=n,function(s){var a_searchParams="URLSearchParams"in o,a_iterable="Symbol"in o&&"iterator"in Symbol,a_blob="FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),a_formData="FormData"in o,a_arrayBuffer="ArrayBuffer"in o;if(a_arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(d){return d&&l.indexOf(Object.prototype.toString.call(d))>-1};function m(d){if("string"!=typeof d&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(d))throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function _(d){return"string"!=typeof d&&(d=String(d)),d}function v(d){var E={next:function(){var U=d.shift();return{done:void 0===U,value:U}}};return a_iterable&&(E[Symbol.iterator]=function(){return E}),E}function b(d){this.map={},d instanceof b?d.forEach(function(E,U){this.append(U,E)},this):Array.isArray(d)?d.forEach(function(E){this.append(E[0],E[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(E){this.append(E,d[E])},this)}function R(d){if(d.bodyUsed)return Promise.reject(new TypeError("Already read"));d.bodyUsed=!0}function M(d){return new Promise(function(E,U){d.onload=function(){E(d.result)},d.onerror=function(){U(d.error)}})}function $(d){var E=new FileReader,U=M(E);return E.readAsArrayBuffer(d),U}function g(d){if(d.slice)return d.slice(0);var E=new Uint8Array(d.byteLength);return E.set(new Uint8Array(d)),E.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(d){this._bodyInit=d,d?"string"==typeof d?this._bodyText=d:a_blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:a_formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:a_searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():a_arrayBuffer&&a_blob&&function h(d){return d&&DataView.prototype.isPrototypeOf(d)}(d)?(this._bodyArrayBuffer=g(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a_arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||f(d))?this._bodyArrayBuffer=g(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||("string"==typeof d?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a_searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a_blob&&(this.blob=function(){var d=R(this);if(d)return d;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?R(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then($)}),this.text=function(){var d=R(this);if(d)return d;if(this._bodyBlob)return function I(d){var E=new FileReader,U=M(E);return E.readAsText(d),U}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function L(d){for(var E=new Uint8Array(d),U=new Array(E.length),D=0;D<E.length;D++)U[D]=String.fromCharCode(E[D]);return U.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a_formData&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}b.prototype.append=function(d,E){d=m(d),E=_(E);var U=this.map[d];this.map[d]=U?U+", "+E:E},b.prototype.delete=function(d){delete this.map[m(d)]},b.prototype.get=function(d){return d=m(d),this.has(d)?this.map[d]:null},b.prototype.has=function(d){return this.map.hasOwnProperty(m(d))},b.prototype.set=function(d,E){this.map[m(d)]=_(E)},b.prototype.forEach=function(d,E){for(var U in this.map)this.map.hasOwnProperty(U)&&d.call(E,this.map[U],U,this)},b.prototype.keys=function(){var d=[];return this.forEach(function(E,U){d.push(U)}),v(d)},b.prototype.values=function(){var d=[];return this.forEach(function(E){d.push(E)}),v(d)},b.prototype.entries=function(){var d=[];return this.forEach(function(E,U){d.push([U,E])}),v(d)},a_iterable&&(b.prototype[Symbol.iterator]=b.prototype.entries);var O=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function p(d,E){var U=(E=E||{}).body;if(d instanceof p){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,E.headers||(this.headers=new b(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!U&&null!=d._bodyInit&&(U=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new b(E.headers)),this.method=function u(d){var E=d.toUpperCase();return O.indexOf(E)>-1?E:d}(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&U)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(U)}function k(d){var E=new FormData;return d.trim().split("&").forEach(function(U){if(U){var D=U.split("="),j=D.shift().replace(/\+/g," "),T=D.join("=").replace(/\+/g," ");E.append(decodeURIComponent(j),decodeURIComponent(T))}}),E}function B(d){var E=new b;return d.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(D){var j=D.split(":"),T=j.shift().trim();if(T){var z=j.join(":").trim();E.append(T,z)}}),E}function G(d,E){E||(E={}),this.type="default",this.status=void 0===E.status?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new b(E.headers),this.url=E.url||"",this._initBody(d)}p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},S.call(p.prototype),S.call(G.prototype),G.prototype.clone=function(){return new G(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new b(this.headers),url:this.url})},G.error=function(){var d=new G(null,{status:0,statusText:""});return d.type="error",d};var X=[301,302,303,307,308];G.redirect=function(d,E){if(-1===X.indexOf(E))throw new RangeError("Invalid status code");return new G(null,{status:E,headers:{location:d}})},s.DOMException=o.DOMException;try{new s.DOMException}catch{s.DOMException=function(d,E){this.message=d,this.name=E;var U=Error(d);this.stack=U.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function Z(d,E){return new Promise(function(U,D){var j=new p(d,E);if(j.signal&&j.signal.aborted)return D(new s.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function z(){T.abort()}T.onload=function(){var K={status:T.status,statusText:T.statusText,headers:B(T.getAllResponseHeaders()||"")};K.url="responseURL"in T?T.responseURL:K.headers.get("X-Request-URL"),U(new G("response"in T?T.response:T.responseText,K))},T.onerror=function(){D(new TypeError("Network request failed"))},T.ontimeout=function(){D(new TypeError("Network request failed"))},T.onabort=function(){D(new s.DOMException("Aborted","AbortError"))},T.open(j.method,j.url,!0),"include"===j.credentials?T.withCredentials=!0:"omit"===j.credentials&&(T.withCredentials=!1),"responseType"in T&&a_blob&&(T.responseType="blob"),j.headers.forEach(function(K,ee){T.setRequestHeader(ee,K)}),j.signal&&(j.signal.addEventListener("abort",z),T.onreadystatechange=function(){4===T.readyState&&j.signal.removeEventListener("abort",z)}),T.send(typeof j._bodyInit>"u"?null:j._bodyInit)})}Z.polyfill=!0,o.fetch||(o.fetch=Z,o.Headers=b,o.Request=p,o.Response=G),s.Headers=b,s.Request=p,s.Response=G,s.fetch=Z,Object.defineProperty(s,"__esModule",{value:!0})}({}),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e}(lo,lo.exports);var sc=function Xn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(lo.exports);const ac={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class cc{constructor(e){if(this.url=e,this.events=new ui.EventEmitter,this.isAvailable=!1,this.registering=!1,!Za(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}open(e=this.url){var r=this;return x(function*(){yield r.register(e)})()}close(){var e=this;return x(function*(){if(!e.isAvailable)throw new Error("Connection already closed");e.onClose()})()}send(e,r){var n=this;return x(function*(){n.isAvailable||(yield n.register());try{const i=qr(e),o=yield(yield sc(n.url,Object.assign(Object.assign({},ac),{body:i}))).json();n.onPayload({data:o})}catch(i){n.onError(e.id,i)}})()}register(e=this.url){var r=this;return x(function*(){if(!Za(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(r.registering){const n=r.events.getMaxListeners();return(r.events.listenerCount("register_error")>=n||r.events.listenerCount("open")>=n)&&r.events.setMaxListeners(n+1),new Promise((i,o)=>{r.events.once("register_error",s=>{r.resetMaxListeners(),o(s)}),r.events.once("open",()=>{if(r.resetMaxListeners(),typeof r.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));i()})})}r.url=e,r.registering=!0;try{const n=qr({id:1,jsonrpc:"2.0",method:"test",params:[]});yield sc(e,Object.assign(Object.assign({},ac),{body:n})),r.onOpen()}catch(n){const i=r.parseError(n);throw r.events.emit("register_error",i),r.onClose(),i}})()}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r="string"==typeof e.data?yi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),o=Pn(e,n.message||n.toString());this.events.emit("payload",o)}parseError(e,r=this.url){return qa(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}function kn(t,e){let r;return e.rpcMap&&(r=e.rpcMap[function W_(t){return Number(t[0].split(":")[1])}([t])]),r}class Y_{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}request(e){var r=this;return x(function*(){var n;switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return r.getAccounts();case"wallet_switchEthereumChain":{const i=e.request.params?null==(n=e.request.params[0])?void 0:n.chainId:"0x0";return r.setDefaultChain(parseInt(i,16).toString()),null}case"eth_chainId":return r.getDefaultChainId()}return r.namespace.methods.includes(e.request.method)?yield r.client.request(e):r.getHttpProvider().request(e.request)})()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){if(this.chainId=parseInt(e),!this.httpProviders[e]){const n=r||kn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit("chainChanged",this.chainId)}createHttpProvider(e,r){const n=r||kn(e,this.namespace);return typeof n>"u"?void 0:new Zi(new cc(n))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}}class J_{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||kn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||kn(e,this.namespace);return typeof n>"u"?void 0:new Zi(new cc(n))}}const hc="wc@2:universal_provider:";var zn,ho={exports:{}},Lr="object"==typeof Reflect?Reflect:null,fc=Lr&&"function"==typeof Lr.apply?Lr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};zn=Lr&&"function"==typeof Lr.ownKeys?Lr.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var pc=Number.isNaN||function(t){return t!=t};function Te(){Te.init.call(this)}ho.exports=Te,ho.exports.once=function i0(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}wc(t,e,o,{once:!0}),"error"!==e&&function o0(t,e,r){"function"==typeof t.on&&wc(t,"error",e,r)}(t,i,{once:!0})})},Te.EventEmitter=Te,Te.prototype._events=void 0,Te.prototype._eventsCount=0,Te.prototype._maxListeners=void 0;var dc=10;function Kn(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function yc(t){return void 0===t._maxListeners?Te.defaultMaxListeners:t._maxListeners}function gc(t,e,r,n){var i,o,s;if(Kn(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=yc(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function e0(t){console&&console.warn&&console.warn(t)}(a)}return t}function t0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vc(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=t0.bind(n);return i.listener=r,n.wrapFn=i,i}function _c(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function n0(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):bc(i,i.length)}function mc(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function bc(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function wc(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)})}}Object.defineProperty(Te,"defaultMaxListeners",{enumerable:!0,get:function(){return dc},set:function(t){if("number"!=typeof t||t<0||pc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");dc=t}}),Te.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Te.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||pc(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Te.prototype.getMaxListeners=function(){return yc(this)},Te.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)fc(a,this,e);else{var h=a.length,l=bc(a,h);for(r=0;r<h;++r)fc(l[r],this,e)}return!0},Te.prototype.on=Te.prototype.addListener=function(t,e){return gc(this,t,e,!1)},Te.prototype.prependListener=function(t,e){return gc(this,t,e,!0)},Te.prototype.once=function(t,e){return Kn(e),this.on(t,vc(this,t,e)),this},Te.prototype.prependOnceListener=function(t,e){return Kn(e),this.prependListener(t,vc(this,t,e)),this},Te.prototype.off=Te.prototype.removeListener=function(t,e){var r,n,i,o,s;if(Kn(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function r0(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Te.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Te.prototype.listeners=function(t){return _c(this,t,!0)},Te.prototype.rawListeners=function(t){return _c(this,t,!1)},Te.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):mc.call(t,e)},Te.prototype.listenerCount=mc,Te.prototype.eventNames=function(){return this._eventsCount>0?zn(this._events):[]};var s0=Object.defineProperty,a0=Object.defineProperties,u0=Object.getOwnPropertyDescriptors,Ec=Object.getOwnPropertySymbols,c0=Object.prototype.hasOwnProperty,l0=Object.prototype.propertyIsEnumerable,Oc=(t,e,r)=>e in t?s0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sc=(t,e)=>{for(var r in e||(e={}))c0.call(e,r)&&Oc(t,r,e[r]);if(Ec)for(var r of Ec(e))l0.call(e,r)&&Oc(t,r,e[r]);return t};class Bn{constructor(e){this.events=new ho.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:Pe(Fe.getDefaultLoggerOptions({level:e?.logger||"error"}))}static init(e){return x(function*(){const r=new Bn(e);return yield r.initialize(),r})()}request(e,r){var n=this;return x(function*(){var i;const[o,s]=n.validateChain(r);return yield n.getProvider(o).request({request:Sc({},e),chainId:`${o}:${s}`,topic:null==(i=n.session)?void 0:i.topic})})()}sendAsync(e,r,n){this.request(e,n).then(i=>r(null,i)).catch(i=>r(i,void 0))}enable(){var e=this;return x(function*(){if(!e.client)throw new Error("Sign Client not initialized");return yield e.request({method:"eth_requestAccounts",params:[]})})()}disconnect(){var e=this;return x(function*(){if(!e.client)throw new Error("Sign Client not initialized");yield e.client.disconnect({topic:e.session.topic,reason:Je("USER_DISCONNECTED")})})()}connect(e){var r=this;return x(function*(){if(!r.client)throw new Error("Sign Client not initialized");return r.setNamespaces(e.namespaces),r.createProviders(),!0===e.skipPairing?void 0:yield r.pair(e.pairingTopic)})()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}pair(e){var r=this;return x(function*(){const{uri:n,approval:i}=yield r.client.connect({pairingTopic:e,requiredNamespaces:r.namespaces});return n&&(r.uri=n,r.events.emit("display_uri",n)),r.session=yield i(),r.onSessionUpdate(),r.session})()}setDefaultChain(e,r){const[n,i]=this.validateChain(e);this.getProvider(n).setDefaultChain(i,r)}checkStorage(){var e=this;return x(function*(){e.namespaces=yield e.client.core.storage.getItem(`${hc}/namespaces`),e.namespaces&&e.createProviders(),e.client.session.length&&(e.session=e.client.session.get(e.client.session.keys[e.client.session.keys.length-1]),e.onSessionUpdate())})()}initialize(){var e=this;return x(function*(){e.logger.trace("Initialized"),yield e.createClient(),e.checkStorage(),e.registerEventListeners()})()}createClient(){var e=this;return x(function*(){e.client=e.providerOpts.client||(yield co.init({logger:e.providerOpts.logger||"error",relayUrl:e.providerOpts.relayUrl||"wss://relay.walletconnect.com",projectId:e.providerOpts.projectId,metadata:e.providerOpts.metadata,storageOptions:e.providerOpts.storageOptions,name:e.providerOpts.name})),e.logger.trace("SignClient Initialized")})()}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new Y_({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new J_({client:this.client,namespace:this.namespaces[e],events:this.events})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n;const{namespaces:i}=r,o=null==(n=this.client)?void 0:n.session.get(e);this.session=((t,e)=>a0(t,u0(e)))(Sc({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",()=>{this.events.emit("session_delete")})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>this.getProvider(e).updateNamespace(this.session.namespaces[e]))}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${hc}/namespaces`,e),this.namespaces=e}validateChain(e){const[r,n]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Invalid namespace: ${r}`);return r&&n?[r,n]:function G_(t){var e;const r=null==(e=t[Object.keys(t)[0]])?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}(this.namespaces)}}vr.UniversalProvider=Bn,vr.default=Bn,Object.defineProperty(vr,"__esModule",{value:!0})}(un)},2791:Jn=>{"use strict";Jn.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}}]);
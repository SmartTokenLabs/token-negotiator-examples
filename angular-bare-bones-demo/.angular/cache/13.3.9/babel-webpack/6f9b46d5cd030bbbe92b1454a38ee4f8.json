{"ast":null,"code":"const extend = require('xtend');\n\nconst createRandomId = require('json-rpc-random-id')();\n\nmodule.exports = EthQuery;\n\nfunction EthQuery(provider) {\n  const self = this;\n  self.currentProvider = provider;\n} //\n// base queries\n//\n// default block\n\n\nEthQuery.prototype.getBalance = generateFnWithDefaultBlockFor(2, 'eth_getBalance');\nEthQuery.prototype.getCode = generateFnWithDefaultBlockFor(2, 'eth_getCode');\nEthQuery.prototype.getTransactionCount = generateFnWithDefaultBlockFor(2, 'eth_getTransactionCount');\nEthQuery.prototype.getStorageAt = generateFnWithDefaultBlockFor(3, 'eth_getStorageAt');\nEthQuery.prototype.call = generateFnWithDefaultBlockFor(2, 'eth_call'); // standard\n\nEthQuery.prototype.protocolVersion = generateFnFor('eth_protocolVersion');\nEthQuery.prototype.syncing = generateFnFor('eth_syncing');\nEthQuery.prototype.coinbase = generateFnFor('eth_coinbase');\nEthQuery.prototype.mining = generateFnFor('eth_mining');\nEthQuery.prototype.hashrate = generateFnFor('eth_hashrate');\nEthQuery.prototype.gasPrice = generateFnFor('eth_gasPrice');\nEthQuery.prototype.accounts = generateFnFor('eth_accounts');\nEthQuery.prototype.blockNumber = generateFnFor('eth_blockNumber');\nEthQuery.prototype.getBlockTransactionCountByHash = generateFnFor('eth_getBlockTransactionCountByHash');\nEthQuery.prototype.getBlockTransactionCountByNumber = generateFnFor('eth_getBlockTransactionCountByNumber');\nEthQuery.prototype.getUncleCountByBlockHash = generateFnFor('eth_getUncleCountByBlockHash');\nEthQuery.prototype.getUncleCountByBlockNumber = generateFnFor('eth_getUncleCountByBlockNumber');\nEthQuery.prototype.sign = generateFnFor('eth_sign');\nEthQuery.prototype.sendTransaction = generateFnFor('eth_sendTransaction');\nEthQuery.prototype.sendRawTransaction = generateFnFor('eth_sendRawTransaction');\nEthQuery.prototype.estimateGas = generateFnFor('eth_estimateGas');\nEthQuery.prototype.getBlockByHash = generateFnFor('eth_getBlockByHash');\nEthQuery.prototype.getBlockByNumber = generateFnFor('eth_getBlockByNumber');\nEthQuery.prototype.getTransactionByHash = generateFnFor('eth_getTransactionByHash');\nEthQuery.prototype.getTransactionByBlockHashAndIndex = generateFnFor('eth_getTransactionByBlockHashAndIndex');\nEthQuery.prototype.getTransactionByBlockNumberAndIndex = generateFnFor('eth_getTransactionByBlockNumberAndIndex');\nEthQuery.prototype.getTransactionReceipt = generateFnFor('eth_getTransactionReceipt');\nEthQuery.prototype.getUncleByBlockHashAndIndex = generateFnFor('eth_getUncleByBlockHashAndIndex');\nEthQuery.prototype.getUncleByBlockNumberAndIndex = generateFnFor('eth_getUncleByBlockNumberAndIndex');\nEthQuery.prototype.getCompilers = generateFnFor('eth_getCompilers');\nEthQuery.prototype.compileLLL = generateFnFor('eth_compileLLL');\nEthQuery.prototype.compileSolidity = generateFnFor('eth_compileSolidity');\nEthQuery.prototype.compileSerpent = generateFnFor('eth_compileSerpent');\nEthQuery.prototype.newFilter = generateFnFor('eth_newFilter');\nEthQuery.prototype.newBlockFilter = generateFnFor('eth_newBlockFilter');\nEthQuery.prototype.newPendingTransactionFilter = generateFnFor('eth_newPendingTransactionFilter');\nEthQuery.prototype.uninstallFilter = generateFnFor('eth_uninstallFilter');\nEthQuery.prototype.getFilterChanges = generateFnFor('eth_getFilterChanges');\nEthQuery.prototype.getFilterLogs = generateFnFor('eth_getFilterLogs');\nEthQuery.prototype.getLogs = generateFnFor('eth_getLogs');\nEthQuery.prototype.getWork = generateFnFor('eth_getWork');\nEthQuery.prototype.submitWork = generateFnFor('eth_submitWork');\nEthQuery.prototype.submitHashrate = generateFnFor('eth_submitHashrate'); // network level\n\nEthQuery.prototype.sendAsync = function (opts, cb) {\n  const self = this;\n  self.currentProvider.sendAsync(createPayload(opts), function (err, response) {\n    if (!err && response.error) err = new Error('EthQuery - RPC Error - ' + response.error.message);\n    if (err) return cb(err);\n    cb(null, response.result);\n  });\n}; // util\n\n\nfunction generateFnFor(methodName) {\n  return function () {\n    const self = this;\n    var args = [].slice.call(arguments);\n    var cb = args.pop();\n    self.sendAsync({\n      method: methodName,\n      params: args\n    }, cb);\n  };\n}\n\nfunction generateFnWithDefaultBlockFor(argCount, methodName) {\n  return function () {\n    const self = this;\n    var args = [].slice.call(arguments);\n    var cb = args.pop(); // set optional default block param\n\n    if (args.length < argCount) args.push('latest');\n    self.sendAsync({\n      method: methodName,\n      params: args\n    }, cb);\n  };\n}\n\nfunction createPayload(data) {\n  return extend({\n    // defaults\n    id: createRandomId(),\n    jsonrpc: '2.0',\n    params: [] // user-specified\n\n  }, data);\n}","map":null,"metadata":{},"sourceType":"script"}
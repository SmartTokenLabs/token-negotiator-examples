LavaPack.loadBundle([[6028,{"../../../shared/constants/gas":5398,"../../../shared/constants/transaction":5410,"../../../shared/lib/metamask-controller-utils":5413,"../../../shared/lib/transactions-controller-utils":5417,"../../../shared/modules/conversion.utils":5422,"../../../shared/modules/hexstring-utils":5425,"../../../shared/modules/string-utils":5432,"../../../shared/modules/transaction.utils":5434,"../../helpers/constants/common":6031,"../../helpers/constants/error-keys":6034,"../../helpers/utils/confirm-tx.util":6052,"../../helpers/utils/optimism/fetchEstimatedL1Fee":6065,"../../helpers/utils/token-util":6068,"../../helpers/utils/transactions.util":6069,"../../helpers/utils/util":6071,"../../pages/send/send.constants":6312,"../../pages/send/send.utils":6314,"../../selectors":6437,"../../store/actionConstants":6443,"../../store/actions":6444,"../domains":6019,"../gas/gas.duck":6021,"../metamask/metamask":6025,"./helpers":6026,"@reduxjs/toolkit":1284,"bignumber.js":1706,"ethereumjs-util":2178,lodash:4765,uuid:5247},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.draftTransactionInitialState=n.default=n.computeEstimatedGasLimit=n.addHistoryEntry=n.acknowledgeRecipientWarning=n.SEND_STATUSES=n.SEND_STAGES=n.RECIPIENT_SEARCH_MODES=n.GAS_INPUT_MODES=n.AMOUNT_MODES=void 0,n.editExistingTransaction=function(e,t){return async(n,a)=>{await n(Y.clearPreviousDrafts());const r=a(),o=(0,g.getUnapprovedTxs)(r)[t],i=(0,E.getTargetAccount)(r,o.txParams.from);if(e===N.ASSET_TYPES.NATIVE){var u;await n(Y.addNewDraft({...F,id:t,fromAccount:i,gas:{...F.gas,gasLimit:o.txParams.gas,gasPrice:o.txParams.gasPrice},userInputHexData:o.txParams.data,recipient:{...F.recipient,address:o.txParams.to,nickname:null!==(u=(0,E.getAddressBookEntryOrAccountName)(r,o.txParams.to))&&void 0!==u?u:""},amount:{...F.amount,value:o.txParams.value},history:[`sendFlow - user clicked edit on transaction with id ${t}`]})),await n(ne({type:N.ASSET_TYPES.NATIVE},{initialAssetSet:!0}))}else{var d,l;const a=(0,C.parseStandardTokenTransactionData)(o.txParams.data),u=e===N.ASSET_TYPES.TOKEN?(0,y.getTokenValueParam)(a):"1",T=(0,h.getTokenAddressParam)(a),f=null!==(d=(0,E.getAddressBookEntryOrAccountName)(r,T))&&void 0!==d?d:"",m=(0,s.addHexPrefix)((0,c.conversionUtil)(u,{fromNumericBase:"dec",toNumericBase:"hex"}));await n(Y.addNewDraft({...F,id:t,fromAccount:i,gas:{...F.gas,gasLimit:o.txParams.gas,gasPrice:o.txParams.gasPrice},userInputHexData:o.txParams.data,recipient:{...F.recipient,address:T,nickname:f},amount:{...F.amount,value:m},history:[`sendFlow - user clicked edit on transaction with id ${t}`]})),await n(ne({type:e,details:{address:o.txParams.to,...e===N.ASSET_TYPES.NFT?{tokenId:null!==(l=(0,h.getTokenIdParam)(a))&&void 0!==l?l:(0,y.getTokenValueParam)(a)}:{}}},{initialAssetSet:!0}))}await n(H())}},n.gasFeeIsInError=function(e){var t;return Boolean(null===(t=re(e).gas)||void 0===t?void 0:t.error)},n.getAssetError=function(e){return se(e).error},n.getCurrentDraftTransaction=re,n.getCurrentTransactionUUID=ae,n.getDraftTransactionExists=function(e){const t=re(e);if(0===Object.keys(t).length)return!1;return!0},n.getDraftTransactionID=function(e){return re(e).id},n.getGasInputMode=function(e){const t=(0,E.getIsMainnet)(e),n=(0,g.getGasEstimateType)(e),a=(0,E.getAdvancedInlineGasShown)(e);if(e.send.gasIsSetInModal)return M.CUSTOM;if(!t||a)return M.INLINE;if(t&&n===u.GAS_ESTIMATE_TYPES.ETH_GASPRICE)return M.INLINE;return M.BASIC},n.getGasLimit=function(e){var t;return null===(t=re(e).gas)||void 0===t?void 0:t.gasLimit},n.getGasPrice=function(e){var t;return null===(t=re(e).gas)||void 0===t?void 0:t.gasPrice},n.getGasTotal=function(e){var t;return null===(t=re(e).gas)||void 0===t?void 0:t.gasTotal},n.getIsAssetSendable=function(e){var t,n,a;if((null===(t=se(e))||void 0===t?void 0:t.type)===N.ASSET_TYPES.NATIVE)return!0;return!1===(null===(n=se(e))||void 0===n||null===(a=n.details)||void 0===a?void 0:a.isERC721)},n.getIsBalanceInsufficient=function(e){var t;return(null===(t=re(e).gas)||void 0===t?void 0:t.error)===d.INSUFFICIENT_FUNDS_ERROR},n.getIsUsingMyAccountForRecipientSearch=function(e){return e.send.recipientMode===U.MY_ACCOUNTS},n.getMinimumGasLimitForSend=function(e){return e.send.gasLimitMinimum},n.getRecipient=oe,n.getRecipientUserInput=function(e){return e.send.recipientInput},n.getRecipientWarningAcknowledgement=function(e){var t,n;return null!==(t=null===(n=re(e).recipient)||void 0===n?void 0:n.recipientWarningAcknowledged)&&void 0!==t&&t},n.getSendAmount=function(e){var t;return null===(t=re(e).amount)||void 0===t?void 0:t.value},n.getSendAsset=se,n.getSendAssetAddress=function(e){var t,n;return null===(t=se(e))||void 0===t||null===(n=t.details)||void 0===n?void 0:n.address},n.getSendErrors=function(e){var t,n;return{gasFee:null===(t=re(e).gas)||void 0===t?void 0:t.error,amount:null===(n=re(e).amount)||void 0===n?void 0:n.error}},n.getSendHexData=function(e){return re(e).userInputHexData},n.getSendMaxModeState=function(e){return e.send.amountMode===L.MAX},n.getSendStage=function(e){return e.send.stage},n.getSendTo=function(e){var t;return null===(t=oe(e))||void 0===t?void 0:t.address},n.initializeSendState=n.initialState=void 0,n.isSendFormInvalid=function(e){const t=re(e);if(!t)return!0;return t.status===b.INVALID},n.isSendStateInitialized=function(e){return e.send.stage!==D.INACTIVE},n.resetRecipientInput=function(){return async(e,t)=>{const n=t(),a=(0,E.getCurrentChainId)(n);await e(Q("sendFlow - user cleared recipient input")),await e(te("")),await e(ee({address:"",nickname:""})),await e((0,_.resetDomainResolution)()),await e(X({chainId:a}))}},n.resetSendState=function(){return async(e,t)=>{const n=t();e(Y.resetSendState()),n.send.gasEstimatePollToken&&(await(0,T.disconnectGasFeeEstimatePoller)(n.send.gasEstimatePollToken),(0,T.removePollingTokenFromAppState)(n.send.gasEstimatePollToken))}},n.sendAmountIsInError=function(e){var t;return Boolean(null===(t=re(e).amount)||void 0===t?void 0:t.error)},n.signTransaction=function(){return async(e,t)=>{const n=t(),{stage:a,eip1559support:r}=n.send,s=(0,P.generateTransactionParams)(n.send),o=n.send.draftTransactions[n.send.currentTransactionUUID];if(a===D.EDIT){var i;const t=(0,g.getUnapprovedTxs)(n)[o.id],a={data:s.data,from:s.from,to:s.to,value:s.value,gas:t.userEditedGasLimit?t.txParams.gas:s.gas};t.originalGasEstimate=a.gas;const c={...t,txParams:Object.assign(t.txParams,r?a:s)};await e(Q("sendFlow - user clicked next and transaction should be updated in controller")),await e((0,T.updateTransactionSendFlowHistory)(o.id,(null===(i=t.sendFlowHistory)||void 0===i?void 0:i.length)||0,o.history)),await e((0,T.updateEditableParams)(o.id,c.txParams)),await e((0,T.updateTransactionGasFees)(o.id,c.txParams))}else{let t=o.recipient.type===d.RECIPIENT_TYPES.SMART_CONTRACT?N.TRANSACTION_TYPES.CONTRACT_INTERACTION:N.TRANSACTION_TYPES.SIMPLE_SEND;o.asset.type!==N.ASSET_TYPES.NATIVE&&(t=o.asset.type===N.ASSET_TYPES.NFT?N.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM:N.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER),await e(Q("sendFlow - user clicked next and transaction should be added to controller")),e((0,T.addUnapprovedTransactionAndRouteToConfirmationPage)(s,t,o.history))}}},n.startNewDraftTransaction=function(e){return async t=>{var n;await t(Y.clearPreviousDrafts()),await t(Y.addNewDraft({...F,history:["sendFlow - User started new draft transaction"]})),await t(ne({type:null!==(n=e.type)&&void 0!==n?n:N.ASSET_TYPES.NATIVE,details:e.details})),await t(H())}},n.toggleSendMaxMode=function(){return async(e,t)=>{t().send.amountMode===L.MAX?(await e(Y.updateAmountMode(L.INPUT)),await e(Y.updateSendAmount("0x0")),await e(Q("sendFlow - user toggled max mode off"))):(await e(Y.updateAmountMode(L.MAX)),await e(Y.updateAmountToMax()),await e(Q("sendFlow - user toggled max mode on"))),await e(G())}},n.updateGasLimit=void 0,n.updateGasPrice=function(e){return t=>{t(Q(`sendFlow - user set legacy gasPrice to ${e}`)),t(Y.updateGasFees({gasPrice:e,transactionType:N.TRANSACTION_ENVELOPE_TYPES.LEGACY,manuallyEdited:!0}))}},n.updateRecipient=ee,n.updateRecipientUserInput=te,n.updateSendAmount=function(e){return async(t,n)=>{const a=n(),{metamask:r}=a,o=a.send.draftTransactions[a.send.currentTransactionUUID];let i=e;if(o.asset.type===N.ASSET_TYPES.TOKEN){var u,d,l;const t=Math.pow(10,Number((null===(u=o.asset.details)||void 0===u?void 0:u.decimals)||0)),n=(0,c.conversionUtil)((0,s.addHexPrefix)(e),{fromNumericBase:"hex",toNumericBase:"dec",toCurrency:null===(d=o.asset.details)||void 0===d?void 0:d.symbol,conversionRate:t,invertConversionRate:!0});i=`${Number(n)?n:""} ${null===(l=o.asset.details)||void 0===l?void 0:l.symbol}`}else{var E;i=`${(0,v.getValueFromWeiHex)({value:e,toCurrency:I.ETH,numberOfDecimals:8})} ${(null==r||null===(E=r.provider)||void 0===E?void 0:E.ticker)||I.ETH}`}await t(Q(`sendFlow - user set amount to ${i}`)),await t(Y.updateSendAmount(e)),a.send.amountMode===L.MAX&&await t(Y.updateAmountMode(L.INPUT)),await t(G())}},n.updateSendAsset=ne,n.updateSendHexData=function(e){return async(t,n)=>{await t(Q(`sendFlow - user added custom hexData ${e}`)),await t(Y.updateUserInputHexData(e));const a=n();a.send.draftTransactions[a.send.currentTransactionUUID].asset.type===N.ASSET_TYPES.NATIVE&&await t(G())}},n.useContactListForRecipientSearch=function(){return e=>{e(Q("sendFlow - user selected back to all on recipient screen")),e(z(U.CONTACT_LIST))}},n.useDefaultGas=n.useCustomGas=void 0,n.useMyAccountsForRecipientSearch=function(){return e=>{e(Q("sendFlow - user selected transfer to my accounts on recipient screen")),e(z(U.MY_ACCOUNTS))}};var a=e("@reduxjs/toolkit"),r=w(e("bignumber.js")),s=e("ethereumjs-util"),o=e("lodash"),i=e("uuid"),c=e("../../../shared/modules/conversion.utils"),u=e("../../../shared/constants/gas"),d=e("../../pages/send/send.constants"),l=e("../../pages/send/send.utils"),E=e("../../selectors"),T=e("../../store/actions"),f=e("../gas/gas.duck"),m=e("../../store/actionConstants"),h=e("../../helpers/utils/token-util"),p=e("../../helpers/utils/util"),g=e("../metamask/metamask"),_=e("../domains"),S=e("../../../shared/modules/hexstring-utils"),A=e("../../helpers/utils/transactions.util"),R=w(e("../../helpers/utils/optimism/fetchEstimatedL1Fee")),I=e("../../helpers/constants/common"),N=e("../../../shared/constants/transaction"),O=(e("../../helpers/constants/error-keys"),e("../../../shared/modules/string-utils")),v=e("../../helpers/utils/confirm-tx.util"),C=e("../../../shared/modules/transaction.utils"),y=e("../../../shared/lib/metamask-controller-utils"),k=e("../../../shared/lib/transactions-controller-utils"),P=e("./helpers");function w(e){return e&&e.__esModule?e:{default:e}}const D={ADD_RECIPIENT:"ADD_RECIPIENT",DRAFT:"DRAFT",EDIT:"EDIT",INACTIVE:"INACTIVE"};n.SEND_STAGES=D;const b={INVALID:"INVALID",VALID:"VALID"};n.SEND_STATUSES=b;const M={BASIC:"BASIC",CUSTOM:"CUSTOM",INLINE:"INLINE"};n.GAS_INPUT_MODES=M;const L={INPUT:"INPUT",MAX:"MAX"};n.AMOUNT_MODES=L;const U={CONTACT_LIST:"CONTACT_LIST",MY_ACCOUNTS:"MY_ACCOUNTS"};n.RECIPIENT_SEARCH_MODES=U;const F={amount:{error:null,value:"0x0"},asset:{balance:"0x0",details:null,error:null,type:N.ASSET_TYPES.NATIVE},fromAccount:null,gas:{error:null,gasLimit:"0x0",gasPrice:"0x0",gasTotal:"0x0",maxFeePerGas:"0x0",maxPriorityFeePerGas:"0x0",wasManuallyEdited:!1},history:[],id:null,recipient:{address:"",error:null,nickname:"",warning:null,type:"",recipientWarningAcknowledged:!1},status:b.VALID,transactionType:N.TRANSACTION_ENVELOPE_TYPES.LEGACY,userInputHexData:null};n.draftTransactionInitialState=F;const x={amountMode:L.INPUT,currentTransactionUUID:null,draftTransactions:{},eip1559support:!1,gasEstimateIsLoading:!0,gasEstimatePollToken:null,gasIsSetInModal:!1,gasPriceEstimate:"0x0",gasLimitMinimum:u.GAS_LIMITS.SIMPLE,gasTotalForLayer1:"0x0",recipientMode:U.CONTACT_LIST,recipientInput:"",selectedAccount:{address:null,balance:"0x0"},stage:D.INACTIVE};n.initialState=x;const B="send",G=(0,a.createAsyncThunk)("send/computeEstimatedGasLimit",(async(e,t)=>{var n;const a=t.getState(),{send:r,metamask:s}=a,o=r.draftTransactions[r.currentTransactionUUID],i=(0,g.getUnapprovedTxs)(a),c=(0,E.getIsMultiLayerFeeNetwork)(a),u=i[o.id],d=(0,E.getIsNonStandardEthChain)(a),l=(0,E.getCurrentChainId)(a);let T;var m;c&&(T=await(0,R.default)(global.eth,{txParams:{gasPrice:o.gas.gasPrice,gas:o.gas.gasLimit,to:null===(m=o.recipient.address)||void 0===m?void 0:m.toLowerCase(),value:r.amountMode===L.MAX?r.selectedAccount.balance:o.amount.value,from:r.selectedAccount.address,data:o.userInputHexData,type:"0x0"}}));if(r.stage!==D.EDIT||null===(n=u.dappSuggestedGasFees)||void 0===n||!n.gas||!u.userEditedGasLimit){var h;const e=await(0,P.estimateGasLimitForSend)({gasPrice:o.gas.gasPrice,blockGasLimit:s.currentBlockGasLimit,selectedAddress:s.selectedAddress,sendToken:o.asset.details,to:null===(h=o.recipient.address)||void 0===h?void 0:h.toLowerCase(),value:o.amount.value,data:o.userInputHexData,isNonStandardEthChain:d,chainId:l,gasLimit:o.gas.gasLimit});return await t.dispatch((0,f.setCustomGasLimit)(e)),{gasLimit:e,gasTotalForLayer1:T}}return null}));n.computeEstimatedGasLimit=G;const H=(0,a.createAsyncThunk)("send/initializeSendState",(async({chainHasChanged:e=!1}={},t)=>{const n=t.getState(),a=(0,E.getIsNonStandardEthChain)(n),r=(0,E.getCurrentChainId)(n),o=(0,E.checkNetworkAndAccountSupports1559)(n),i=(0,E.getSelectedAccount)(n),{send:c,metamask:d}=n,l=c.draftTransactions[c.currentTransactionUUID];if(!l)return t.rejectWithValue("draftTransaction not found, possibly not on send flow");let m=c.stage===D.EDIT?l.gas.gasPrice:"0x1",h=null;h=await(0,T.getGasFeeEstimatesAndStartPolling)(),(0,T.addPollingTokenToAppState)(h);const{metamask:{gasFeeEstimates:p,gasEstimateType:_}}=t.getState();c.stage!==D.EDIT&&(m=_===u.GAS_ESTIMATE_TYPES.LEGACY?(0,E.getGasPriceInHexWei)(p.medium):_===u.GAS_ESTIMATE_TYPES.ETH_GASPRICE?(0,P.getRoundedGasPrice)(p.gasPrice):_===u.GAS_ESTIMATE_TYPES.FEE_MARKET?(0,E.getGasPriceInHexWei)(p.medium.suggestedMaxFeePerGas):p.gasPrice?(0,P.getRoundedGasPrice)(p.gasPrice):"0x0");let{gasLimit:S}=l.gas;if(_!==u.GAS_ESTIMATE_TYPES.NONE&&c.stage!==D.EDIT&&l.recipient.address){var A,R;S=l.asset.type===N.ASSET_TYPES.TOKEN||l.asset.type===N.ASSET_TYPES.NFT?u.GAS_LIMITS.BASE_TOKEN_ESTIMATE:u.GAS_LIMITS.SIMPLE;S=await(0,P.estimateGasLimitForSend)({gasPrice:m,blockGasLimit:d.currentBlockGasLimit,selectedAddress:null!==(A=null===(R=l.fromAccount)||void 0===R?void 0:R.address)&&void 0!==A?A:c.selectedAccount.address,sendToken:l.asset.details,to:l.recipient.address.toLowerCase(),value:l.amount.value,data:l.userInputHexData,isNonStandardEthChain:a,chainId:r})||S}await t.dispatch((0,f.setCustomGasLimit)(S));return t.getState().send.currentTransactionUUID!==c.currentTransactionUUID?t.rejectWithValue("draftTransaction changed during initialization.\n        A new initializeSendState action must be dispatched."):{account:i,chainId:(0,E.getCurrentChainId)(n),tokens:(0,g.getTokens)(n),chainHasChanged:e,gasFeeEstimates:p,gasEstimateType:_,gasLimit:S,gasTotal:(0,s.addHexPrefix)((0,k.calcGasTotal)(S,m)),gasEstimatePollToken:h,eip1559support:o,useTokenDetection:(0,E.getUseTokenDetection)(n),tokenAddressList:Object.keys((0,E.getTokenList)(n))}}));n.initializeSendState=H;const W=(0,a.createSlice)({name:B,initialState:x,reducers:{addNewDraft:(e,t)=>{e.currentTransactionUUID=(0,i.v4)(),e.draftTransactions[e.currentTransactionUUID]=t.payload,t.payload.id?e.stage=D.EDIT:e.stage=D.ADD_RECIPIENT},addHistoryEntry:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];n&&n.history.push({entry:t.payload,timestamp:Date.now()})},calculateGasTotal:e=>{const t=e.draftTransactions[e.currentTransactionUUID];t.transactionType===N.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET?t.gas.gasTotal=(0,s.addHexPrefix)((0,k.calcGasTotal)(t.gas.gasLimit,t.gas.maxFeePerGas)):t.gas.gasTotal=(0,s.addHexPrefix)((0,k.calcGasTotal)(t.gas.gasLimit,t.gas.gasPrice)),e.amountMode===L.MAX&&t.asset.type===N.ASSET_TYPES.NATIVE&&W.caseReducers.updateAmountToMax(e),W.caseReducers.validateAmountField(e),W.caseReducers.validateGasField(e),W.caseReducers.validateSendState(e)},clearPreviousDrafts:e=>{e.currentTransactionUUID=null,e.draftTransactions={}},resetSendState:()=>x,updateAmountMode:(e,t)=>{Object.values(L).includes(t.payload)&&(e.amountMode=t.payload)},updateAmountToMax:e=>{const t=e.draftTransactions[e.currentTransactionUUID];let n="0x0";if(t.asset.type===N.ASSET_TYPES.TOKEN){var a,r;const e=null!==(a=null===(r=t.asset.details)||void 0===r?void 0:r.decimals)&&void 0!==a?a:0,s=Math.pow(10,Number(e));n=(0,c.multiplyCurrencies)(t.asset.balance,s,{toNumericBase:"hex",multiplicandBase:16,multiplierBase:10})}else{const a=(0,A.sumHexes)(t.gas.gasTotal||"0x0",e.gasTotalForLayer1||"0x0");n=(0,c.subtractCurrencies)((0,s.addHexPrefix)(t.asset.balance),(0,s.addHexPrefix)(a),{toNumericBase:"hex",aBase:16,bBase:16})}W.caseReducers.updateSendAmount(e,{payload:n})},updateAsset:(e,t)=>{const{asset:n,initialAssetSet:a}=t.payload,r=e.draftTransactions[e.currentTransactionUUID];r.asset.type=n.type,r.asset.balance=n.balance,r.asset.error=n.error,r.asset.type===N.ASSET_TYPES.TOKEN||r.asset.type===N.ASSET_TYPES.NFT?r.asset.details=n.details:(r.asset.details=null,r.recipient.error===d.CONTRACT_ADDRESS_ERROR&&(r.recipient.error=null)),e.amountMode===L.MAX?W.caseReducers.updateAmountToMax(e):!1===a&&W.caseReducers.updateSendAmount(e,{payload:"0x0"}),W.caseReducers.validateSendState(e)},updateGasFeeEstimates:(e,t)=>{const{gasFeeEstimates:n,gasEstimateType:a}=t.payload;let r="0x0";switch(a){case u.GAS_ESTIMATE_TYPES.FEE_MARKET:W.caseReducers.updateGasFees(e,{payload:{transactionType:N.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET,maxFeePerGas:(0,E.getGasPriceInHexWei)(n.medium.suggestedMaxFeePerGas),maxPriorityFeePerGas:(0,E.getGasPriceInHexWei)(n.medium.suggestedMaxPriorityFeePerGas)}});break;case u.GAS_ESTIMATE_TYPES.LEGACY:r=(0,P.getRoundedGasPrice)(n.medium),W.caseReducers.updateGasFees(e,{payload:{gasPrice:r,type:N.TRANSACTION_ENVELOPE_TYPES.LEGACY,isAutomaticUpdate:!0}});break;case u.GAS_ESTIMATE_TYPES.ETH_GASPRICE:r=(0,P.getRoundedGasPrice)(n.gasPrice),W.caseReducers.updateGasFees(e,{payload:{gasPrice:(0,P.getRoundedGasPrice)(n.gasPrice),type:N.TRANSACTION_ENVELOPE_TYPES.LEGACY,isAutomaticUpdate:!0}});case u.GAS_ESTIMATE_TYPES.NONE:}e.gasPriceEstimate=(0,s.addHexPrefix)(r)},updateGasFees:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];n&&(t.payload.transactionType===N.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET?(n.gas.maxFeePerGas=(0,s.addHexPrefix)(t.payload.maxFeePerGas),n.gas.maxPriorityFeePerGas=(0,s.addHexPrefix)(t.payload.maxPriorityFeePerGas),n.transactionType=N.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET):(t.payload.manuallyEdited&&(n.gas.wasManuallyEdited=!0),n.gas.wasManuallyEdited&&!t.payload.manuallyEdited||(n.gas.gasPrice=(0,s.addHexPrefix)(t.payload.gasPrice)),n.transactionType=N.TRANSACTION_ENVELOPE_TYPES.LEGACY),W.caseReducers.calculateGasTotal(e))},updateGasLimit:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];n&&(n.gas.gasLimit=(0,s.addHexPrefix)(t.payload),W.caseReducers.calculateGasTotal(e))},updateLayer1Fees:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];e.gasTotalForLayer1=t.payload,e.amountMode===L.MAX&&n.asset.type===N.ASSET_TYPES.NATIVE&&W.caseReducers.updateAmountToMax(e)},updateRecipient:(e,t)=>{var n,a;const r=e.draftTransactions[e.currentTransactionUUID];r.recipient.error=null,e.recipientInput="",r.recipient.address=null!==(n=t.payload.address)&&void 0!==n?n:"",r.recipient.nickname=null!==(a=t.payload.nickname)&&void 0!==a?a:"",""===r.recipient.address?e.stage=D.ADD_RECIPIENT:(e.stage=null===r.id?D.DRAFT:D.EDIT,e.recipientMode=U.CONTACT_LIST),W.caseReducers.validateSendState(e)},updateRecipientSearchMode:(e,t)=>{e.recipientInput="",e.recipientMode=t.payload},updateRecipientWarning:(e,t)=>{e.draftTransactions[e.currentTransactionUUID].recipient.warning=t.payload},updateRecipientType:(e,t)=>{e.draftTransactions[e.currentTransactionUUID].recipient.type=t.payload},updateDraftTransactionStatus:(e,t)=>{e.draftTransactions[e.currentTransactionUUID].status=t.payload},acknowledgeRecipientWarning:e=>{e.draftTransactions[e.currentTransactionUUID].recipient.recipientWarningAcknowledged=!0,W.caseReducers.validateSendState(e)},updateRecipientUserInput:(e,t)=>{e.recipientInput=t.payload},updateSendAmount:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];n.amount.value=(0,s.addHexPrefix)(t.payload),W.caseReducers.validateAmountField(e),n.asset.type===N.ASSET_TYPES.NATIVE&&W.caseReducers.validateGasField(e),W.caseReducers.validateSendState(e)},updateUserInputHexData:(e,t)=>{e.draftTransactions[e.currentTransactionUUID].userInputHexData=t.payload},useCustomGas:e=>{e.gasIsSetInModal=!0},useDefaultGas:e=>{e.gasIsSetInModal=!1},validateAmountField:e=>{var t,n;const a=e.draftTransactions[e.currentTransactionUUID];switch(!0){case a.asset.type===N.ASSET_TYPES.NATIVE&&!(0,l.isBalanceSufficient)({amount:a.amount.value,balance:a.asset.balance,gasTotal:null!==(t=a.gas.gasTotal)&&void 0!==t?t:"0x0"}):a.amount.error=d.INSUFFICIENT_FUNDS_FOR_GAS_ERROR;break;case a.asset.type===N.ASSET_TYPES.TOKEN&&!(0,l.isTokenBalanceSufficient)({tokenBalance:null!==(n=a.asset.balance)&&void 0!==n?n:"0x0",amount:a.amount.value,decimals:a.asset.details.decimals}):a.amount.error=d.INSUFFICIENT_TOKENS_ERROR;break;case(0,c.conversionGreaterThan)({value:0,fromNumericBase:"dec"},{value:a.amount.value,fromNumericBase:"hex"}):a.amount.error=d.NEGATIVE_ETH_ERROR;break;default:a.amount.error=null}},validateGasField:e=>{var t,n,a;const r=e.draftTransactions[e.currentTransactionUUID],s=!(0,l.isBalanceSufficient)({amount:r.asset.type===N.ASSET_TYPES.NATIVE?r.amount.value:"0x0",balance:null!==(t=null===(n=r.fromAccount)||void 0===n?void 0:n.balance)&&void 0!==t?t:e.selectedAccount.balance,gasTotal:null!==(a=r.gas.gasTotal)&&void 0!==a?a:"0x0"});r.gas.error=s?d.INSUFFICIENT_FUNDS_ERROR:null},validateRecipientUserInput:(e,t)=>{const n=e.draftTransactions[e.currentTransactionUUID];if(n)if(e.recipientMode===U.MY_ACCOUNTS||""===e.recipientInput||null===e.recipientInput)n.recipient.error=null,n.recipient.warning=null;else{var a,r;const{chainId:s,tokens:o,tokenAddressList:i,isProbablyAnAssetContract:c}=t.payload;(0,S.isBurnAddress)(e.recipientInput)||!(0,S.isValidHexAddress)(e.recipientInput,{mixedCaseUseChecksum:!0})&&!(0,p.isValidDomainName)(e.recipientInput)?n.recipient.error=(0,p.isDefaultMetaMaskChain)(s)?d.INVALID_RECIPIENT_ADDRESS_ERROR:d.INVALID_RECIPIENT_ADDRESS_NOT_ETH_NETWORK_ERROR:(0,p.isOriginContractAddress)(e.recipientInput,null===(a=n.asset)||void 0===a||null===(r=a.details)||void 0===r?void 0:r.address)?n.recipient.error=d.CONTRACT_ADDRESS_ERROR:n.recipient.error=null,(0,S.isValidHexAddress)(e.recipientInput)&&(i.find((t=>(0,O.isEqualCaseInsensitive)(t,e.recipientInput)))||(0,p.checkExistingAddresses)(e.recipientInput,o))||c?n.recipient.warning=d.KNOWN_RECIPIENT_ADDRESS_WARNING:n.recipient.warning=null}W.caseReducers.validateSendState(e)},validateSendState:e=>{const t=e.draftTransactions[e.currentTransactionUUID];if(t)switch(!0){case Boolean(t.amount.error):case Boolean(t.gas.error):case Boolean(t.asset.error):case t.asset.type===N.ASSET_TYPES.TOKEN&&null===t.asset.details:case e.stage===D.ADD_RECIPIENT:case e.stage===D.INACTIVE:case e.gasEstimateIsLoading:case new r.default(t.gas.gasLimit,16).lessThan(new r.default(e.gasLimitMinimum)):case"loading"===t.recipient.warning:case t.recipient.warning===d.KNOWN_RECIPIENT_ADDRESS_WARNING&&!1===t.recipient.recipientWarningAcknowledged:t.status=b.INVALID;break;default:t.status=b.VALID}}},extraReducers:e=>{e.addCase(m.ACCOUNT_CHANGED,((e,t)=>{if(e.stage===D.EDIT&&t.payload.account){const n=e.draftTransactions[e.currentTransactionUUID];n&&n.fromAccount&&n.fromAccount.address===t.payload.account.address&&(n.fromAccount.balance=t.payload.account.balance,n.asset.type===N.ASSET_TYPES.NATIVE&&(n.asset.balance=t.payload.account.balance),W.caseReducers.validateAmountField(e),W.caseReducers.validateGasField(e),W.caseReducers.validateSendState(e))}})).addCase(m.ADDRESS_BOOK_UPDATED,((e,t)=>{var n;const{addressBook:a}=t.payload,r=e.draftTransactions[e.currentTransactionUUID];r&&null!==(n=a[r.recipient.address])&&void 0!==n&&n.name&&(r.recipient.nickname=a[r.recipient.address].name)})).addCase(G.pending,(e=>{e.gasEstimateIsLoading=!0})).addCase(G.fulfilled,((e,t)=>{var n,a;e.gasEstimateIsLoading=!1,null!==(n=t.payload)&&void 0!==n&&n.gasLimit&&W.caseReducers.updateGasLimit(e,{payload:t.payload.gasLimit}),null!==(a=t.payload)&&void 0!==a&&a.gasTotalForLayer1&&W.caseReducers.updateLayer1Fees(e,{payload:t.payload.gasTotalForLayer1})})).addCase(G.rejected,(e=>{e.gasEstimateIsLoading=!1})).addCase(m.GAS_FEE_ESTIMATES_UPDATED,((e,t)=>{W.caseReducers.updateGasFeeEstimates(e,{payload:t.payload})})).addCase(H.pending,(e=>{e.gasEstimateIsLoading=!0})).addCase(H.fulfilled,((e,t)=>{e.eip1559support=t.payload.eip1559support,e.selectedAccount.address=t.payload.account.address,e.selectedAccount.balance=t.payload.account.balance;const n=e.draftTransactions[e.currentTransactionUUID];var a,r;n&&(n.gas.gasLimit=t.payload.gasLimit,n.gas.gasTotal=t.payload.gasTotal,t.payload.chainHasChanged&&(n.asset.type=N.ASSET_TYPES.NATIVE,n.asset.balance=null!==(a=null===(r=n.fromAccount)||void 0===r?void 0:r.balance)&&void 0!==a?a:e.selectedAccount.balance,n.asset.details=null));W.caseReducers.updateGasFeeEstimates(e,{payload:{gasFeeEstimates:t.payload.gasFeeEstimates,gasEstimateType:t.payload.gasEstimateType}}),e.gasEstimatePollToken=t.payload.gasEstimatePollToken,t.payload.gasEstimatePollToken&&(e.gasEstimateIsLoading=!1),e.stage!==D.INACTIVE&&W.caseReducers.validateRecipientUserInput(e,{payload:{chainId:t.payload.chainId,tokens:t.payload.tokens,useTokenDetection:t.payload.useTokenDetection,tokenAddressList:t.payload.tokenAddressList}}),e.amountMode===L.MAX&&W.caseReducers.updateAmountToMax(e),W.caseReducers.validateAmountField(e),W.caseReducers.validateGasField(e),W.caseReducers.validateSendState(e)})).addCase(m.SELECTED_ACCOUNT_CHANGED,((e,t)=>{if(e.stage!==D.EDIT&&t.payload.account){e.selectedAccount.balance=t.payload.account.balance,e.selectedAccount.address=t.payload.account.address;const n=e.draftTransactions[e.currentTransactionUUID];n&&((null==n?void 0:n.asset.type)===N.ASSET_TYPES.NATIVE&&(n.asset.balance=t.payload.account.balance),W.caseReducers.validateAmountField(e),W.caseReducers.validateGasField(e),W.caseReducers.validateSendState(e))}})).addCase(m.QR_CODE_DETECTED,((e,t)=>{const n=t.value,a=e.draftTransactions[e.currentTransactionUUID];if(n&&a&&"address"===n.type){const t=n.values.address.toLowerCase();(0,S.isValidHexAddress)(t,{allowNonPrefixed:!1})?a.recipient.address!==t&&W.caseReducers.updateRecipient(e,{payload:{address:t}}):a.recipient.error=d.INVALID_RECIPIENT_ADDRESS_ERROR}}))}}),{actions:Y,reducer:j}=W;var K=j;n.default=K;const{useDefaultGas:V,useCustomGas:$,updateGasLimit:q,validateRecipientUserInput:X,updateRecipientSearchMode:z,addHistoryEntry:Q,acknowledgeRecipientWarning:Z}=Y;n.acknowledgeRecipientWarning=Z,n.addHistoryEntry=Q,n.updateGasLimit=q,n.useCustomGas=$,n.useDefaultGas=V;const J=(0,o.debounce)(((e,t,n)=>{e(Q(`sendFlow - user typed ${t.userInput} into recipient input field`)),e(X(t)),n()}),300);function ee({address:e,nickname:t}){return async(n,a)=>{var r;const s=a(),o=null!==(r=(0,E.getAddressBookEntryOrAccountName)(s,e))&&void 0!==r?r:"";await n(Y.updateRecipient({address:e,nickname:t||o})),await n(G())}}function te(e){return async(t,n)=>{var a,r,s;t(Y.updateRecipientWarning("loading")),t(Y.updateDraftTransactionStatus(b.INVALID)),await t(Y.updateRecipientUserInput(e));const o=n(),i=null!==(a=null!==(r=null===(s=o.send.draftTransactions[o.send.currentTransactionUUID].fromAccount)||void 0===s?void 0:s.address)&&void 0!==r?r:o.send.selectedAccount.address)&&void 0!==a?a:(0,E.getSelectedAddress)(o),c=(0,E.getCurrentChainId)(o),u=(0,g.getTokens)(o),l=(0,E.getUseTokenDetection)(o),f=(0,E.getTokenList)(o),m=Object.keys(f),p=(0,S.isValidHexAddress)(e);let _=!1;if(p){if(await(0,A.isSmartContractAddress)(e)){t(Y.updateRecipientType(d.RECIPIENT_TYPES.SMART_CONTRACT));const{symbol:n,decimals:a}=(0,h.getTokenMetadata)(e,f)||{};if(_=n&&a!==undefined,!_)try{const{standard:t}=await(0,T.getTokenStandardAndDetails)(e,i);_=Boolean(t)}catch(e){console.log(e)}}}return new Promise((n=>{J(t,{userInput:e,chainId:c,tokens:u,useTokenDetection:l,tokenAddressList:m,isProbablyAnAssetContract:_},n)}))}}function ne({type:e,details:t},{initialAssetSet:n=!1}={}){return async(a,r)=>{var o,i,c;const u=r(),d=u.send.draftTransactions[u.send.currentTransactionUUID],l=null!==(o=null!==(i=null===(c=d.fromAccount)||void 0===c?void 0:c.address)&&void 0!==i?i:u.send.selectedAccount.address)&&void 0!==o?o:(0,E.getSelectedAddress)(u),f=(0,E.getTargetAccount)(u,l);if(e===N.ASSET_TYPES.NATIVE){var m,h;const t=(0,g.getUnapprovedTxs)(u),r=null==t?void 0:t[d.id];await a(Q(`sendFlow - user set asset of type ${N.ASSET_TYPES.NATIVE} with symbol ${null!==(m=null===(h=u.metamask.provider)||void 0===h?void 0:h.ticker)&&void 0!==m?m:I.ETH}`)),await a(Y.updateAsset({asset:{type:e,details:null,balance:f.balance,error:null},initialAssetSet:n})),(null==r?void 0:r.type)!==N.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM&&(null==r?void 0:r.type)!==N.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER&&(null==r?void 0:r.type)!==N.TRANSACTION_TYPES.TOKEN_METHOD_SAFE_TRANSFER_FROM||await a(Y.updateUserInputHexData(""))}else{await a((0,T.showLoadingIndication)());const r={...t,...await(0,T.getTokenStandardAndDetails)(t.address,l,t.tokenId)};await a((0,T.hideLoadingIndication)());const o={type:e,details:r,error:null};if(r.standard===N.TOKEN_STANDARDS.ERC20)o.balance=(0,s.addHexPrefix)((0,k.calcTokenAmount)(r.balance,r.decimals).toString(16)),await a(Q(`sendFlow - user set asset to ERC20 token with symbol ${r.symbol} and address ${r.address}`));else{if(r.standard===N.TOKEN_STANDARDS.ERC1155&&e===N.ASSET_TYPES.NFT)throw new Error("Sends of ERC1155 tokens are not currently supported");if(r.standard===N.TOKEN_STANDARDS.ERC1155||r.standard===N.TOKEN_STANDARDS.ERC721){N.ASSET_TYPES.TOKEN;{let e=!0;try{e=await(0,T.isNftOwner)(l,r.address,r.tokenId)}catch(e){e.message.includes("Unable to verify ownership.")||a((0,T.displayWarning)(e.message))}if(!e)throw new Error("Send slice initialized as collectible send with a collectible not currently owned by the select account");o.error=null,o.balance="0x1",await a(Q(`sendFlow - user set asset to NFT with tokenId ${r.tokenId} and address ${r.address}`))}}}await a(Y.updateAsset({asset:o,initialAssetSet:n}))}!1===n&&await a(G())}}function ae(e){return e.send.currentTransactionUUID}function re(e){var t;return null!==(t=e.send.draftTransactions[ae(e)])&&void 0!==t?t:{}}function se(e){return re(e).asset}function oe(e){const t=re(e);if(!t.recipient)return{address:"",nickname:"",error:null,warning:null};const n=(0,S.toChecksumHexAddress)(t.recipient.address);return e.metamask.ensResolutionsByAddress?{...t.recipient,nickname:t.recipient.nickname||(0,E.getEnsResolutionByAddress)(e,n)}:t.recipient}}}},{package:"$root$"}],[6031,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WEI=n.SUPPORT_REQUEST_LINK=n.SECONDARY=n.PRIMARY=n.GWEI=n.GAS_ESTIMATE_TYPES=n.ETH=n.CONTRACT_ADDRESS_LINK=void 0;n.ETH="ETH";n.GWEI="GWEI";n.WEI="WEI";n.PRIMARY="PRIMARY";n.SECONDARY="SECONDARY";n.GAS_ESTIMATE_TYPES={SLOW:"SLOW",AVERAGE:"AVERAGE",FAST:"FAST",FASTEST:"FASTEST"};n.SUPPORT_REQUEST_LINK="https://metamask.zendesk.com/hc/en-us";n.CONTRACT_ADDRESS_LINK="https://metamask.zendesk.com/hc/en-us/articles/360020028092-What-is-the-known-contract-address-warning-"}}},{package:"$root$"}],[6033,{lodash:4765},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TYPOGRAPHY=n.TEXT_TRANSFORM=n.TEXT_COLORS=n.TEXT_ALIGN=n.TEXT=n.SIZES=n.SEVERITIES=n.RESIZE=n.OVERFLOW_WRAP=n.JUSTIFY_CONTENT=n.ICON_COLORS=n.FRACTIONS=n.FONT_WEIGHT=n.FONT_STYLE=n.FLEX_WRAP=n.FLEX_DIRECTION=n.DISPLAY=n.COLORS=n.BREAKPOINTS=n.BORDER_STYLE=n.BORDER_RADIUS=n.BORDER_COLORS=n.BLOCK_SIZES=n.BACKGROUND_COLORS=n.ALIGN_ITEMS=void 0;var a=e("lodash");const r={BACKGROUND_DEFAULT:"background-default",BACKGROUND_ALTERNATIVE:"background-alternative",TEXT_DEFAULT:"text-default",TEXT_ALTERNATIVE:"text-alternative",TEXT_MUTED:"text-muted",ICON_DEFAULT:"icon-default",ICON_ALTERNATIVE:"icon-alternative",ICON_MUTED:"icon-muted",BORDER_DEFAULT:"border-default",BORDER_MUTED:"border-muted",OVERLAY_DEFAULT:"overlay-default",OVERLAY_INVERSE:"overlay-inverse",PRIMARY_DEFAULT:"primary-default",PRIMARY_ALTERNATIVE:"primary-alternative",PRIMARY_MUTED:"primary-muted",PRIMARY_INVERSE:"primary-inverse",PRIMARY_DISABLED:"primary-disabled",ERROR_DEFAULT:"error-default",ERROR_ALTERNATIVE:"error-alternative",ERROR_MUTED:"error-muted",ERROR_INVERSE:"error-inverse",ERROR_DISABLED:"error-disabled",WARNING_DEFAULT:"warning-default",WARNING_ALTERNATIVE:"warning-alternative",WARNING_MUTED:"warning-muted",WARNING_INVERSE:"warning-inverse",WARNING_DISABLED:"warning-disabled",SUCCESS_DEFAULT:"success-default",SUCCESS_ALTERNATIVE:"success-alternative",SUCCESS_MUTED:"success-muted",SUCCESS_INVERSE:"success-inverse",SUCCESS_DISABLED:"success-disabled",INFO_DEFAULT:"info-default",INFO_ALTERNATIVE:"info-alternative",INFO_MUTED:"info-muted",INFO_INVERSE:"info-inverse",INFO_DISABLED:"info-disabled",MAINNET:"mainnet",GOERLI:"goerli",SEPOLIA:"sepolia",LOCALHOST:"localhost",TRANSPARENT:"transparent",INHERIT:"inherit"};n.COLORS=r;const s=(0,a.pick)(r,["BACKGROUND_DEFAULT","BACKGROUND_ALTERNATIVE","OVERLAY_DEFAULT","PRIMARY_DEFAULT","PRIMARY_ALTERNATIVE","PRIMARY_MUTED","ERROR_DEFAULT","ERROR_ALTERNATIVE","ERROR_MUTED","WARNING_DEFAULT","WARNING_ALTERNATIVE","WARNING_MUTED","SUCCESS_DEFAULT","SUCCESS_ALTERNATIVE","SUCCESS_MUTED","INFO_DEFAULT","INFO_ALTERNATIVE","INFO_MUTED","MAINNET","GOERLI","SEPOLIA","TRANSPARENT","LOCALHOST"]);n.BACKGROUND_COLORS=s;const o=(0,a.pick)(r,["BORDER_DEFAULT","BORDER_MUTED","PRIMARY_DEFAULT","PRIMARY_ALTERNATIVE","PRIMARY_MUTED","ERROR_DEFAULT","ERROR_ALTERNATIVE","ERROR_MUTED","WARNING_DEFAULT","WARNING_ALTERNATIVE","WARNING_MUTED","SUCCESS_DEFAULT","SUCCESS_ALTERNATIVE","SUCCESS_MUTED","INFO_DEFAULT","INFO_ALTERNATIVE","INFO_MUTED","MAINNET","GOERLI","SEPOLIA","TRANSPARENT","LOCALHOST"]);n.BORDER_COLORS=o;const i=(0,a.pick)(r,["TEXT_DEFAULT","TEXT_ALTERNATIVE","TEXT_MUTED","OVERLAY_INVERSE","PRIMARY_DEFAULT","PRIMARY_INVERSE","ERROR_DEFAULT","ERROR_INVERSE","SUCCESS_DEFAULT","SUCCESS_INVERSE","WARNING_DEFAULT","WARNING_INVERSE","INFO_DEFAULT","INFO_INVERSE","INHERIT"]);n.TEXT_COLORS=i;const c=(0,a.pick)(r,["ICON_DEFAULT","ICON_ALTERNATIVE","ICON_MUTED","OVERLAY_INVERSE","PRIMARY_DEFAULT","PRIMARY_INVERSE","ERROR_DEFAULT","ERROR_INVERSE","SUCCESS_DEFAULT","SUCCESS_INVERSE","WARNING_DEFAULT","WARNING_INVERSE","INFO_DEFAULT","INFO_INVERSE","INHERIT"]);n.ICON_COLORS=c;n.TYPOGRAPHY={H1:"h1",H2:"h2",H3:"h3",H4:"h4",H5:"h5",H6:"h6",H7:"h7",H8:"h8",H9:"h9",Paragraph:"p",Span:"span"};n.TEXT={DISPLAY_MD:"display-md",HEADING_LG:"heading-lg",HEADING_MD:"heading-md",HEADING_SM:"heading-sm",BODY_LG_MEDIUM:"body-lg-medium",BODY_MD:"body-md",BODY_MD_BOLD:"body-md-bold",BODY_SM:"body-sm",BODY_SM_BOLD:"body-sm-bold",BODY_XS:"body-xs",INHERIT:"inherit"};const u="none",d={XXS:"xxs",XS:"xs",SM:"sm",MD:"md",LG:"lg",XL:"xl",AUTO:"auto",NONE:u};n.SIZES=d;const l={DASHED:"dashed",SOLID:"solid",DOTTED:"dotted",DOUBLE:"double",NONE:u};n.BORDER_STYLE=l;const E={XS:d.XS,SM:d.SM,MD:d.MD,LG:d.LG,XL:d.XL,NONE:u,PILL:"pill",FULL:"full"};n.BORDER_RADIUS=E;const T="flex-end",f="flex-start",m="center",h={FLEX_START:f,FLEX_END:T,CENTER:m,BASELINE:"baseline",STRETCH:"stretch"};n.ALIGN_ITEMS=h;const p={FLEX_START:f,FLEX_END:T,CENTER:m,SPACE_AROUND:"space-around",SPACE_BETWEEN:"space-between",SPACE_EVENLY:"space-evenly"};n.JUSTIFY_CONTENT=p;n.FLEX_DIRECTION={ROW:"row",ROW_REVERSE:"row-reverse",COLUMN:"column",COLUMN_REVERSE:"column-reverse"};n.FLEX_WRAP={WRAP:"wrap",WRAP_REVERSE:"wrap-reverse",NO_WRAP:"nowrap"};n.DISPLAY={BLOCK:"block",FLEX:"flex",GRID:"grid",INLINE_BLOCK:"inline-block",INLINE:"inline",INLINE_FLEX:"inline-flex",INLINE_GRID:"inline-grid",LIST_ITEM:"list-item",NONE:"none"};const g={HALF:"1/2",ONE_THIRD:"1/3",TWO_THIRDS:"2/3",ONE_FOURTH:"1/4",TWO_FOURTHS:"2/4",THREE_FOURTHS:"3/4",ONE_FIFTH:"1/5",TWO_FIFTHS:"2/5",THREE_FIFTHS:"3/5",FOUR_FIFTHS:"4/5",ONE_SIXTH:"1/6",TWO_SIXTHS:"2/6",THREE_SIXTHS:"3/6",FOUR_SIXTHS:"4/6",FIVE_SIXTHS:"5/6",ONE_TWELFTH:"1/12",TWO_TWELFTHS:"2/12",THREE_TWELFTHS:"3/12",FOUR_TWELFTHS:"4/12",FIVE_TWELFTHS:"5/12",SIX_TWELFTHS:"6/12",SEVEN_TWELFTHS:"7/12",EIGHT_TWELFTHS:"8/12",NINE_TWELFTHS:"9/12",TEN_TWELFTHS:"10/12",ELEVEN_TWELFTHS:"11/12"};n.FRACTIONS=g;const _={...g,SCREEN:"screen",MAX:"max",MIN:"min",FULL:"full"};n.BLOCK_SIZES=_;n.TEXT_ALIGN={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify",END:"end"};n.TEXT_TRANSFORM={UPPERCASE:"uppercase",LOWERCASE:"lowercase",CAPITALIZE:"capitalize"};n.FONT_WEIGHT={BOLD:"bold",MEDIUM:"medium",NORMAL:"normal"};n.OVERFLOW_WRAP={BREAK_WORD:"break-word",ANYWHERE:"anywhere",NORMAL:"normal"};n.FONT_STYLE={ITALIC:"italic",NORMAL:"normal"};n.SEVERITIES={DANGER:"danger",WARNING:"warning",INFO:"info",SUCCESS:"success"};n.RESIZE={NONE:"none",BOTH:"both",HORIZONTAL:"horizontal",VERTICAL:"vertical",INITIAL:"initial",INHERIT:"inherit"};n.BREAKPOINTS=["base","sm","md","lg"]}}},{package:"$root$"}],[6034,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UNSENDABLE_ASSET_ERROR_KEY=n.TRANSACTION_ERROR_KEY=n.INVALID_ASSET_TYPE=n.INSUFFICIENT_FUNDS_FOR_GAS_ERROR_KEY=n.INSUFFICIENT_FUNDS_ERROR_KEY=n.GAS_PRICE_FETCH_FAILURE_ERROR_KEY=n.GAS_PRICE_EXCESSIVE_ERROR_KEY=n.GAS_LIMIT_TOO_LOW_ERROR_KEY=n.ETH_GAS_PRICE_FETCH_WARNING_KEY=void 0;n.INSUFFICIENT_FUNDS_ERROR_KEY="insufficientFunds";n.GAS_LIMIT_TOO_LOW_ERROR_KEY="gasLimitTooLow";n.TRANSACTION_ERROR_KEY="transactionError";n.ETH_GAS_PRICE_FETCH_WARNING_KEY="ethGasPriceFetchWarning";n.GAS_PRICE_FETCH_FAILURE_ERROR_KEY="gasPriceFetchFailed";n.GAS_PRICE_EXCESSIVE_ERROR_KEY="gasPriceExcessive";n.UNSENDABLE_ASSET_ERROR_KEY="unsendableAsset";n.INSUFFICIENT_FUNDS_FOR_GAS_ERROR_KEY="insufficientFundsForGas";n.INVALID_ASSET_TYPE="invalidAssetType"}}},{package:"$root$"}],[6037,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VIEW_QUOTE_ROUTE=n.UNLOCK_ROUTE=n.TOKEN_DETAILS=n.SWAPS_ROUTE=n.SWAPS_MAINTENANCE_ROUTE=n.SWAPS_ERROR_ROUTE=n.SNAPS_VIEW_ROUTE=n.SNAPS_LIST_ROUTE=n.SMART_TRANSACTION_STATUS_ROUTE=n.SIGNATURE_REQUEST_PATH=n.SETTINGS_ROUTE=n.SEND_ROUTE=n.SECURITY_ROUTE=n.REVEAL_SEED_ROUTE=n.RESTORE_VAULT_ROUTE=n.PATH_NAME_MAP=n.ONBOARDING_WELCOME_ROUTE=n.ONBOARDING_UNLOCK_ROUTE=n.ONBOARDING_SECURE_YOUR_WALLET_ROUTE=n.ONBOARDING_ROUTE=n.ONBOARDING_REVIEW_SRP_ROUTE=n.ONBOARDING_PRIVACY_SETTINGS_ROUTE=n.ONBOARDING_PIN_EXTENSION_ROUTE=n.ONBOARDING_METAMETRICS=n.ONBOARDING_IMPORT_WITH_SRP_ROUTE=n.ONBOARDING_IMPORT_MOBILE_ROUTE=n.ONBOARDING_HELP_US_IMPROVE_ROUTE=n.ONBOARDING_CREATE_PASSWORD_ROUTE=n.ONBOARDING_CONFIRM_SRP_ROUTE=n.ONBOARDING_COMPLETION_ROUTE=n.NEW_ACCOUNT_ROUTE=n.NETWORKS_ROUTE=n.NETWORKS_FORM_ROUTE=n.MOBILE_SYNC_ROUTE=n.LOCK_ROUTE=n.LOADING_QUOTES_ROUTE=n.INITIALIZE_WELCOME_ROUTE=n.INITIALIZE_UNLOCK_ROUTE=n.INITIALIZE_SELECT_ACTION_ROUTE=n.INITIALIZE_SEED_PHRASE_ROUTE=n.INITIALIZE_SEED_PHRASE_INTRO_ROUTE=n.INITIALIZE_ROUTE=n.INITIALIZE_METAMETRICS_OPT_IN_ROUTE=n.INITIALIZE_IMPORT_WITH_SEED_PHRASE_ROUTE=n.INITIALIZE_END_OF_FLOW_ROUTE=n.INITIALIZE_CREATE_PASSWORD_ROUTE=n.INITIALIZE_CONFIRM_SEED_PHRASE_ROUTE=n.INITIALIZE_BACKUP_SEED_PHRASE_ROUTE=n.IMPORT_TOKEN_ROUTE=n.IMPORT_ACCOUNT_ROUTE=n.GENERAL_ROUTE=n.EXPERIMENTAL_ROUTE=n.ENCRYPTION_PUBLIC_KEY_REQUEST_PATH=n.DEFAULT_ROUTE=n.DECRYPT_MESSAGE_REQUEST_PATH=n.CONTACT_VIEW_ROUTE=n.CONTACT_LIST_ROUTE=n.CONTACT_EDIT_ROUTE=n.CONTACT_ADD_ROUTE=n.CONNECT_ROUTE=n.CONNECT_HARDWARE_ROUTE=n.CONNECT_CONFIRM_PERMISSIONS_ROUTE=n.CONNECTED_ROUTE=n.CONNECTED_ACCOUNTS_ROUTE=n.CONFIRM_TRANSFER_FROM_PATH=n.CONFIRM_TRANSACTION_ROUTE=n.CONFIRM_TOKEN_METHOD_PATH=n.CONFIRM_SET_APPROVAL_FOR_ALL_PATH=n.CONFIRM_SEND_TOKEN_PATH=n.CONFIRM_SEND_ETHER_PATH=n.CONFIRM_SAFE_TRANSFER_FROM_PATH=n.CONFIRM_IMPORT_TOKEN_ROUTE=n.CONFIRM_DEPLOY_CONTRACT_PATH=n.CONFIRM_APPROVE_PATH=n.CONFIRM_ADD_SUGGESTED_TOKEN_ROUTE=n.CONFIRMATION_V_NEXT_ROUTE=n.BUILD_QUOTE_ROUTE=n.AWAITING_SWAP_ROUTE=n.AWAITING_SIGNATURES_ROUTE=n.ASSET_ROUTE=n.ALERTS_ROUTE=n.ADVANCED_ROUTE=n.ADD_POPULAR_CUSTOM_NETWORK=n.ADD_NETWORK_ROUTE=n.ADD_COLLECTIBLE_ROUTE=n.ABOUT_US_ROUTE=void 0;n.DEFAULT_ROUTE="/";const a="/unlock";n.UNLOCK_ROUTE=a;const r="/lock";n.LOCK_ROUTE=r;const s="/asset";n.ASSET_ROUTE=s;const o="/settings";n.SETTINGS_ROUTE=o;const i="/settings/general";n.GENERAL_ROUTE=i;const c="/settings/advanced";n.ADVANCED_ROUTE=c;const u="/settings/experimental";n.EXPERIMENTAL_ROUTE=u;const d="/settings/security";n.SECURITY_ROUTE=d;const l="/settings/about-us";n.ABOUT_US_ROUTE=l;const E="/settings/alerts";n.ALERTS_ROUTE=E;const T="/settings/networks";n.NETWORKS_ROUTE=T;const f="/settings/networks/form";n.NETWORKS_FORM_ROUTE=f;const m="/settings/networks/add-network";n.ADD_NETWORK_ROUTE=m;const h="/settings/networks/add-popular-custom-network";n.ADD_POPULAR_CUSTOM_NETWORK=h;n.SNAPS_LIST_ROUTE="/settings/snaps-list";n.SNAPS_VIEW_ROUTE="/settings/snaps-view";const p="/settings/contact-list";n.CONTACT_LIST_ROUTE=p;const g="/settings/contact-list/edit-contact";n.CONTACT_EDIT_ROUTE=g;const _="/settings/contact-list/add-contact";n.CONTACT_ADD_ROUTE=_;const S="/settings/contact-list/view-contact";n.CONTACT_VIEW_ROUTE=S;const A="/seed";n.REVEAL_SEED_ROUTE=A;const R="/mobile-sync";n.MOBILE_SYNC_ROUTE=R;const I="/restore-vault";n.RESTORE_VAULT_ROUTE=I;const N="/import-token";n.IMPORT_TOKEN_ROUTE=N;const O="/confirm-import-token";n.CONFIRM_IMPORT_TOKEN_ROUTE=O;const v="/confirm-add-suggested-token";n.CONFIRM_ADD_SUGGESTED_TOKEN_ROUTE=v;const C="/new-account";n.NEW_ACCOUNT_ROUTE=C;const y="/new-account/import";n.IMPORT_ACCOUNT_ROUTE=y;const k="/new-account/connect";n.CONNECT_HARDWARE_ROUTE=k;const P="/send";n.SEND_ROUTE=P;const w="/token-details";n.TOKEN_DETAILS=w;const D="/connect";n.CONNECT_ROUTE=D;const b="/confirm-permissions";n.CONNECT_CONFIRM_PERMISSIONS_ROUTE=b;const M="/connected";n.CONNECTED_ROUTE=M;const L="/connected/accounts";n.CONNECTED_ACCOUNTS_ROUTE=L;n.SWAPS_ROUTE="/swaps";const U="/swaps/build-quote";n.BUILD_QUOTE_ROUTE=U;const F="/swaps/view-quote";n.VIEW_QUOTE_ROUTE=F;const x="/swaps/loading-quotes";n.LOADING_QUOTES_ROUTE=x;n.AWAITING_SIGNATURES_ROUTE="/swaps/awaiting-signatures";n.SMART_TRANSACTION_STATUS_ROUTE="/swaps/smart-transaction-status";const B="/swaps/awaiting-swap";n.AWAITING_SWAP_ROUTE=B;const G="/swaps/swaps-error";n.SWAPS_ERROR_ROUTE=G;n.SWAPS_MAINTENANCE_ROUTE="/swaps/maintenance";n.ADD_COLLECTIBLE_ROUTE="/add-collectible";const H="/initialize";n.INITIALIZE_ROUTE=H;const W="/initialize/welcome";n.INITIALIZE_WELCOME_ROUTE=W;const Y="/initialize/unlock";n.INITIALIZE_UNLOCK_ROUTE=Y;const j="/initialize/create-password";n.INITIALIZE_CREATE_PASSWORD_ROUTE=j;const K="/initialize/create-password/import-with-seed-phrase";n.INITIALIZE_IMPORT_WITH_SEED_PHRASE_ROUTE=K;const V="/initialize/select-action";n.INITIALIZE_SELECT_ACTION_ROUTE=V;const $="/initialize/seed-phrase";n.INITIALIZE_SEED_PHRASE_ROUTE=$;const q="/initialize/backup-seed-phrase";n.INITIALIZE_BACKUP_SEED_PHRASE_ROUTE=q;const X="/initialize/seed-phrase-intro";n.INITIALIZE_SEED_PHRASE_INTRO_ROUTE=X;const z="/initialize/end-of-flow";n.INITIALIZE_END_OF_FLOW_ROUTE=z;const Q="/initialize/seed-phrase/confirm";n.INITIALIZE_CONFIRM_SEED_PHRASE_ROUTE=Q;const Z="/initialize/metametrics-opt-in";n.INITIALIZE_METAMETRICS_OPT_IN_ROUTE=Z;n.ONBOARDING_ROUTE="/onboarding";n.ONBOARDING_REVIEW_SRP_ROUTE="/onboarding/review-recovery-phrase";n.ONBOARDING_CONFIRM_SRP_ROUTE="/onboarding/confirm-recovery-phrase";n.ONBOARDING_CREATE_PASSWORD_ROUTE="/onboarding/create-password";n.ONBOARDING_COMPLETION_ROUTE="/onboarding/completion";n.ONBOARDING_UNLOCK_ROUTE="/onboarding/unlock";n.ONBOARDING_HELP_US_IMPROVE_ROUTE="/onboarding/help-us-improve";n.ONBOARDING_IMPORT_WITH_SRP_ROUTE="/onboarding/import-with-recovery-phrase";n.ONBOARDING_IMPORT_MOBILE_ROUTE="/onboarding/import-mobile";n.ONBOARDING_SECURE_YOUR_WALLET_ROUTE="/onboarding/secure-your-wallet";n.ONBOARDING_PRIVACY_SETTINGS_ROUTE="/onboarding/privacy-settings";n.ONBOARDING_PIN_EXTENSION_ROUTE="/onboarding/pin-extension";n.ONBOARDING_WELCOME_ROUTE="/onboarding/welcome";n.ONBOARDING_METAMETRICS="/onboarding/metametrics";const J="/confirm-transaction";n.CONFIRM_TRANSACTION_ROUTE=J;const ee="/send-ether";n.CONFIRM_SEND_ETHER_PATH=ee;const te="/send-token";n.CONFIRM_SEND_TOKEN_PATH=te;const ne="/deploy-contract";n.CONFIRM_DEPLOY_CONTRACT_PATH=ne;const ae="/approve";n.CONFIRM_APPROVE_PATH=ae;const re="/set-approval-for-all";n.CONFIRM_SET_APPROVAL_FOR_ALL_PATH=re;const se="/transfer-from";n.CONFIRM_TRANSFER_FROM_PATH=se;const oe="/safe-transfer-from";n.CONFIRM_SAFE_TRANSFER_FROM_PATH=oe;const ie="/token-method";n.CONFIRM_TOKEN_METHOD_PATH=ie;const ce="/signature-request";n.SIGNATURE_REQUEST_PATH=ce;const ue="/decrypt-message-request";n.DECRYPT_MESSAGE_REQUEST_PATH=ue;const de="/encryption-public-key-request";n.ENCRYPTION_PUBLIC_KEY_REQUEST_PATH=de;const le="/confirmation";n.CONFIRMATION_V_NEXT_ROUTE=le;const Ee={"/":"Home",[a]:"Unlock Page",[r]:"Lock Page","/asset/:asset/:id":"Asset Page",[o]:"Settings Page",[i]:"General Settings Page",[c]:"Advanced Settings Page",[u]:"Experimental Settings Page",[d]:"Security Settings Page",[l]:"About Us Page",[E]:"Alerts Settings Page",[T]:"Network Settings Page",[f]:"Network Settings Page Form",[m]:"Add Network From Settings Page Form",[h]:"Add Network From A List Of Popular Custom Networks",[p]:"Contact List Settings Page",[`${g}/:address`]:"Edit Contact Settings Page",[_]:"Add Contact Settings Page",[`${S}/:address`]:"View Contact Settings Page",[A]:"Reveal Secret Recovery Phrase Page",[R]:"Sync With Mobile Page",[I]:"Restore Vault Page",[N]:"Import Token Page",[O]:"Confirm Import Token Page",[v]:"Confirm Add Suggested Token Page",[C]:"New Account Page",[y]:"Import Account Page",[k]:"Connect Hardware Wallet Page",[P]:"Send Page","/token-details/:address":"Token Details Page","/connect/:id":"Connect To Site Confirmation Page","/connect/:id/confirm-permissions":"Grant Connected Site Permissions Confirmation Page",[M]:"Sites Connected To This Account Page",[L]:"Accounts Connected To This Site Page","/confirm-transaction/:id":"Confirmation Root Page",[J]:"Confirmation Root Page",[le]:"New Confirmation Page","/confirm-transaction/:id/token-method":"Confirm Token Method Transaction Page","/confirm-transaction/:id/send-ether":"Confirm Send Ether Transaction Page","/confirm-transaction/:id/send-token":"Confirm Send Token Transaction Page","/confirm-transaction/:id/deploy-contract":"Confirm Deploy Contract Transaction Page","/confirm-transaction/:id/approve":"Confirm Approve Transaction Page","/confirm-transaction/:id/set-approval-for-all":"Confirm Set Approval For All Transaction Page","/confirm-transaction/:id/transfer-from":"Confirm Transfer From Transaction Page","/confirm-transaction/:id/safe-transfer-from":"Confirm Safe Transfer From Transaction Page","/confirm-transaction/:id/signature-request":"Signature Request Page","/confirm-transaction/:id/decrypt-message-request":"Decrypt Message Request Page","/confirm-transaction/:id/encryption-public-key-request":"Encryption Public Key Request Page",[H]:"Initialization Page",[W]:"Install Welcome Page",[Y]:"Initialization Unlock page",[j]:"Initialization Create Password Page",[K]:"Initialization Import Account With Secret Recovery Phrase Page",[V]:"Initialization Choose Restore or New Account Page",[$]:"Initialization Secret Recovery Phrase Page",[q]:"Initialization Backup Secret Recovery Phrase Page",[X]:"Initialization Secret Recovery Phrase Intro Page",[z]:"End of Initialization Page",[Q]:"Initialization Confirm Secret Recovery Phrase Page",[Z]:"MetaMetrics Opt In Page",[U]:"Swaps Build Quote Page",[F]:"Swaps View Quotes Page",[x]:"Swaps Loading Quotes Page",[B]:"Swaps Awaiting Swaps Page",[G]:"Swaps Error Page"};n.PATH_NAME_MAP=Ee}}},{package:"$root$"}],[6039,{"../../../shared/constants/transaction":5410},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TOKEN_CATEGORY_HASH=n.PRIORITY_STATUS_HASH=n.PENDING_STATUS_HASH=void 0;var a=e("../../../shared/constants/transaction");const r={[a.TRANSACTION_STATUSES.UNAPPROVED]:!0,[a.TRANSACTION_STATUSES.APPROVED]:!0,[a.TRANSACTION_STATUSES.SUBMITTED]:!0,[a.TRANSACTION_STATUSES.PENDING]:!0};n.PENDING_STATUS_HASH=r;const s={...r,[a.TRANSACTION_STATUSES.CONFIRMED]:!0};n.PRIORITY_STATUS_HASH=s;const o={[a.TRANSACTION_TYPES.TOKEN_METHOD_APPROVE]:!0,[a.TRANSACTION_TYPES.TOKEN_METHOD_SET_APPROVAL_FOR_ALL]:!0,[a.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER]:!0,[a.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM]:!0};n.TOKEN_CATEGORY_HASH=o}}},{package:"$root$"}],[6040,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a={ADD_CUSTOM_TOKENS:"https://metamask.zendesk.com/hc/en-us/articles/360015489031",ADD_MISSING_ACCOUNTS:"https://metamask.zendesk.com/hc/en-us/articles/360015489271",BASIC_SAFETY:"https://metamask.zendesk.com/hc/en-us/articles/360015489591-Basic-Safety-Tips",CUSTOMIZE_NONCE:"https://metamask.zendesk.com/hc/en-us/articles/7417499333531-How-to-customize-a-transaction-nonce",HARDWARE_CONNECTION:"https://metamask.zendesk.com/hc/en-us/articles/360020394612-How-to-connect-a-Trezor-or-Ledger-Hardware-Wallet",IMPORT_ACCOUNTS:"https://metamask.zendesk.com/hc/en-us/articles/360015489331",IMPORTED_ACCOUNTS:"https://metamask.zendesk.com/hc/en-us/articles/360015289932",INFURA_BLOCKAGE:"https://metamask.zendesk.com/hc/en-us/articles/360059386712",LEGACY_WEB3:"https://metamask.zendesk.com/hc/en-us/articles/360053147012",NFT_TOKENS:"https://metamask.zendesk.com/hc/en-us/articles/360058238591-NFT-tokens-in-MetaMask-wallet",PASSWORD_ARTICLE:"https://metamask.zendesk.com/hc/en-us/articles/4404722782107",SECRET_RECOVERY_PHRASE:"https://metamask.zendesk.com/hc/en-us/articles/360060826432-What-is-a-Secret-Recovery-Phrase-and-how-to-keep-your-crypto-wallet-secure",SPEEDUP_CANCEL:"https://metamask.zendesk.com/hc/en-us/articles/360015489251-How-to-speed-up-or-cancel-a-pending-transaction",TOKEN_SAFETY_PRACTICES:"https://metamask.zendesk.com/hc/en-us/articles/4403988839451",UNKNOWN_NETWORK:"https://metamask.zendesk.com/hc/en-us/articles/4417500466971",USER_GUIDE_CUSTOM_NETWORKS:"https://metamask.zendesk.com/hc/en-us/articles/4404424659995",USER_GUIDE_DAPPS:"https://metamask.zendesk.com/hc/en-us/articles/4405506066331-User-guide-Dapps",USER_GUIDE_GAS:"https://metamask.zendesk.com/hc/en-us/articles/4404600179227-User-Guide-Gas",VERIFY_CUSTOM_NETWORK:"https://metamask.zendesk.com/hc/en-us/articles/360057142392"};n.default=a}}},{package:"$root$"}],[6050,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBuildSpecificAsset=function(e){if(!a.main||!Object.keys(a.main).includes(e))return console.error(`Cannot find asset "${e}" for build "main", returning main build asset.`),a.main[e];return a.main[e]},n.isBeta=function(){return!1};const a={main:{foxMeshJson:undefined}}}}},{package:"$root$"}],[6052,{"../../../app/scripts/lib/util":87,"../../../shared/modules/conversion.utils":5422,"../../selectors":6437,"bignumber.js":1706,"currency-formatter":1944,"currency-formatter/currencies":1943},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addEth=function(...e){return e.reduce(((e,t)=>(0,c.addCurrencies)(e,t,{toNumericBase:"dec",numberOfDecimals:6,aBase:10,bBase:10})))},n.addFiat=function(...e){return e.reduce(((e,t)=>(0,c.addCurrencies)(e,t,{toNumericBase:"dec",numberOfDecimals:2,aBase:10,bBase:10})))},n.areDappSuggestedAndTxParamGasFeesTheSame=function(e={}){const{txParams:t,dappSuggestedGasFees:n}=e,{gasPrice:a,maxFeePerGas:r,maxPriorityFeePerGas:s}=t||{},{gasPrice:o,maxFeePerGas:i,maxPriorityFeePerGas:c}=n||{},u=!o&&!i&&!c;if(!a&&!r&&!s||u)return!1;const d=a&&a===o,l=[r,s].every((e=>e===o)),E=r&&r===i&&s===c;return d||l||E},n.convertTokenToFiat=function({value:e,fromCurrency:t="ETH",toCurrency:n,conversionRate:a,contractExchangeRate:r}){const s=a*r;return(0,c.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"dec",fromCurrency:t,toCurrency:n,numberOfDecimals:2,conversionRate:s})},n.formatCurrency=function(e,t){const n=t.toUpperCase();return r.default.find((e=>e.code===n))?a.default.format(Number(e),{code:n,style:"currency"}):e},n.getHexGasTotal=function({gasLimit:e,gasPrice:t}){return(0,o.addHexPrefix)((0,c.multiplyCurrencies)(e||"0x0",t||"0x0",{toNumericBase:"hex",multiplicandBase:16,multiplierBase:16}))},n.getTransactionFee=function({value:e,fromCurrency:t="ETH",toCurrency:n,conversionRate:a,numberOfDecimals:r}){return(0,c.conversionUtil)(e,{fromNumericBase:"BN",toNumericBase:"dec",fromDenomination:"WEI",fromCurrency:t,toCurrency:n,numberOfDecimals:r,conversionRate:a})},n.getValueFromWeiHex=function({value:e,fromCurrency:t="ETH",toCurrency:n,conversionRate:a,numberOfDecimals:r,toDenomination:s}){return(0,c.conversionUtil)(e,{fromNumericBase:"hex",toNumericBase:"dec",fromCurrency:t,toCurrency:n,numberOfDecimals:r,fromDenomination:"WEI",toDenomination:s,conversionRate:a})},n.hasUnconfirmedTransactions=function(e){return(0,i.unconfirmedTransactionsCountSelector)(e)>0},n.hexGreaterThan=function(e,t){return(0,c.conversionGreaterThan)({value:e,fromNumericBase:"hex"},{value:t,fromNumericBase:"hex"})},n.increaseLastGasPrice=function(e){return(0,o.addHexPrefix)((0,c.multiplyCurrencies)(e||"0x0",1.1,{multiplicandBase:16,multiplierBase:10,toNumericBase:"hex"}))},n.roundExponential=function(e){const t=new s.default(e);return t.e>20?t.toPrecision(4):e};var a=u(e("currency-formatter")),r=u(e("currency-formatter/currencies")),s=u(e("bignumber.js")),o=e("../../../app/scripts/lib/util"),i=e("../../selectors"),c=e("../../../shared/modules/conversion.utils");function u(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$"}],[6053,{"../../../app/scripts/lib/util":87,"../../../shared/modules/conversion.utils":5422,"../constants/common":6031,"./confirm-tx.util":6052},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addHexWEIsToDec=function(e,t){return(0,s.addCurrencies)(e,t,{aBase:16,bBase:16,fromDenomination:"WEI",numberOfDecimals:6})},n.addHexes=u,n.bnToHex=function(e){return(0,r.addHexPrefix)(e.toString(16))},n.decETHToDecWEI=function(e){return(0,s.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"dec",fromDenomination:"ETH",toDenomination:"WEI"})},n.decEthToConvertedCurrency=c,n.decGWEIToHexWEI=function(e){return(0,s.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"hex",fromDenomination:"GWEI",toDenomination:"WEI"})},n.decWEIToDecETH=function(e){return(0,s.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"dec",fromDenomination:"WEI",toDenomination:"ETH"})},n.getEthConversionFromWeiHex=function({value:e,fromCurrency:t=a.ETH,conversionRate:n,numberOfDecimals:r=6}){const s=[t,a.GWEI,a.WEI];let o;for(let a=0;a<s.length;a++){const c=i({value:e,conversionRate:n,fromCurrency:t,toCurrency:t,numberOfDecimals:r,toDenomination:s[a]});if("0"!==c||a===s.length-1){o=`${c} ${s[a]}`;break}}return o},n.getValueFromWeiHex=i,n.getWeiHexFromDecimalValue=function({value:e,fromCurrency:t,conversionRate:n,fromDenomination:r,invertConversionRate:o}){return(0,s.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"hex",toCurrency:a.ETH,fromCurrency:t,conversionRate:n,invertConversionRate:o,fromDenomination:r,toDenomination:a.WEI})},n.hexWEIToDecETH=function(e){return(0,s.conversionUtil)(e,{fromNumericBase:"hex",toNumericBase:"dec",fromDenomination:"WEI",toDenomination:"ETH"})},n.subtractHexWEIsToDec=function(e,t){return(0,s.subtractCurrencies)(e,t,{aBase:16,bBase:16,fromDenomination:"WEI",numberOfDecimals:6})},n.subtractHexes=function(e,t){return(0,s.subtractCurrencies)(e,t,{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})},n.sumHexWEIs=d,n.sumHexWEIsToRenderableFiat=function(e,t,n){const a=l(e,t,n);return(0,o.formatCurrency)(a,t)},n.sumHexWEIsToUnformattedFiat=l;var a=e("../constants/common"),r=e("../../../app/scripts/lib/util"),s=e("../../../shared/modules/conversion.utils"),o=e("./confirm-tx.util");function i({value:e,fromCurrency:t=a.ETH,toCurrency:n,conversionRate:r,numberOfDecimals:o,toDenomination:i}){return(0,s.conversionUtil)(e,{fromNumericBase:"hex",toNumericBase:"dec",fromCurrency:t,toCurrency:n,numberOfDecimals:o,fromDenomination:a.WEI,toDenomination:i,conversionRate:r})}function c(e,t,n){return(0,s.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"dec",fromCurrency:"ETH",toCurrency:t,numberOfDecimals:2,conversionRate:n})}function u(e,t){return(0,s.addCurrencies)(e,t,{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})}function d(e){return e.filter(Boolean).reduce(u)}function l(e,t,n){return c(i({value:d(e),toCurrency:"ETH",numberOfDecimals:4}),t,n)}}}},{package:"$root$"}],[6055,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.formatETHFee=function(e,t="ETH"){return`${e} ${t}`}}}},{package:"$root$"}],[6058,{"../../../shared/modules/fetch-with-timeout":5423,"@sentry/browser":1293,loglevel:4778,react:5049},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.fetchLocale=async function(e){try{const t=await c(`./_locales/${e}/messages.json`);return await t.json()}catch(t){return r.default.error(`failed to fetch ${e} locale because of ${t}`),{}}},n.getMessage=void 0,n.loadRelativeTimeFormatLocaleData=async function(e){const t=e.split("_")[0];if(Intl.RelativeTimeFormat&&"function"==typeof Intl.RelativeTimeFormat.__addLocaleData&&!E.has(t)){const e=await async function(e){const t=await c(`./intl/${e}/relative-time-format-data.json`);return await t.json()}(t);Intl.RelativeTimeFormat.__addLocaleData(e)}};var a=i(e("react")),r=i(e("loglevel")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var i=r?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(a,s,i):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("@sentry/browser"));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function i(e){return e&&e.__esModule?e:{default:e}}const c=(0,i(e("../../../shared/modules/fetch-with-timeout")).default)(),u={},d={},l={};n.getMessage=(e,t,n,o)=>{if(!t)return null;if(!t[n])return"en"===e?d[n]||(d[n]=new Error(`Unable to find value of key "${n}" for locale "${e}"`),s.captureException(d[n]),r.default.error(d[n])):u[e]&&u[e][n]||(u[e]||(u[e]={}),u[e][n]=!0,r.default.warn(`Translator - Unable to find value of key "${n}" for locale "${e}"`)),null;let i=t[n].message;const c=Boolean(o&&o.length),E=c&&o.some((e=>null!==e&&("function"==typeof e||"object"==typeof e)));if(c){const t=i.split(/(\$\d)/gu).map((t=>{var a;const i=t.match(/\$(\d)/u);if(!i)return t;const c=Number(i[1])-1;if(!(null!==o[c]&&o[c]!==undefined||null!==(a=l[e])&&void 0!==a&&a[n])){l[e]||(l[e]={}),l[e][n]=!0;const t=new Error(`Insufficient number of substitutions for key "${n}" with locale "${e}"`);r.default.error(t),s.captureException(t)}return o[c]}));i=E?a.default.createElement("span",null," ",t," "):t.join("")}return i};const E=new Set}}},{package:"$root$"}],[6063,{"../../../shared/constants/network":5403},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.formatMoonpaySymbol=void 0;var a=e("../../../shared/constants/network");n.formatMoonpaySymbol=(e,t=a.CHAIN_IDS.MAINNET)=>{if(!e)return e;let n=e;var r;t===a.CHAIN_IDS.POLYGON||t===a.CHAIN_IDS.BSC?n=`${n}_${null===a.BUYABLE_CHAINS_MAP||void 0===a.BUYABLE_CHAINS_MAP||null===(r=a.BUYABLE_CHAINS_MAP[t])||void 0===r?void 0:r.network.toUpperCase()}`:t===a.CHAIN_IDS.AVALANCHE&&(n=`${n}_CCHAIN`);return n}}}},{package:"$root$"}],[6064,{"../../../../shared/modules/hexstring-utils":5425,"@ethereumjs/common":326,"@ethereumjs/tx":331,"ethereumjs-util":2178,lodash:4765},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=function(e){return{...(0,a.omit)(e.txParams,"gas"),gasLimit:e.txParams.gas}}(e),n=function(e){return s.default.forCustomChain(s.Chain.Mainnet,{chainId:new r.BN((0,i.stripHexPrefix)(e.chainId),16),networkId:new r.BN(e.metamaskNetworkId,10),defaultHardfork:s.Hardfork.SpuriousDragon})}(e);return o.TransactionFactory.fromTxData(t,{common:n})};var a=e("lodash"),r=e("ethereumjs-util"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("@ethereumjs/common")),o=e("@ethereumjs/tx"),i=e("../../../../shared/modules/hexstring-utils");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}}}},{package:"$root$"}],[6065,{"./buildUnserializedTransaction":6064,"@eth-optimism/contracts/dist/contract-defs":270,"@eth-optimism/contracts/dist/predeploys":271,ethers:2202},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=async function(e,t){var n;const a=function(e){const t=(0,s.getContractFactory)("OVM_GasPriceOracle").attach(o.predeploys.OVM_GasPriceOracle),n=JSON.parse(t.interface.format(r.utils.FormatTypes.json));return e.contract(n).at(t.address)}(e),c=(0,i.default)(t).serialize(),u=await a.getL1Fee(c);return null==u||null===(n=u[0])||void 0===n?void 0:n.toString(16)};var a,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("ethers")),s=e("@eth-optimism/contracts/dist/contract-defs"),o=e("@eth-optimism/contracts/dist/predeploys"),i=(a=e("./buildUnserializedTransaction"))&&a.__esModule?a:{default:a};function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}}}},{package:"$root$"}],[6068,{"../../../shared/constants/transaction":5410,"../../../shared/lib/metamask-controller-utils":5413,"../../../shared/lib/transactions-controller-utils":5417,"../../../shared/modules/conversion.utils":5422,"../../../shared/modules/string-utils":5432,"../../../shared/modules/transaction.utils":5434,"../../store/actions":6444,"./confirm-tx.util":6052,"./util":6071,loglevel:4778},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAssetDetails=async function(e,t,n,a){var s,E,T,f,m,h,p;const g=(0,c.parseStandardTokenTransactionData)(n);if(!g)throw new Error("Unable to detect valid token data");let A=null!==(s=null===(E=S(g))||void 0===E?void 0:E.toString())&&void 0!==s?s:(0,d.getTokenValueParam)(g);const R=_(g);let I;if(null!=a&&a.length&&A){const t=a.find((({address:t,tokenId:n})=>(0,i.isEqualCaseInsensitive)(e,t)&&n===A));if(t)return{toAddress:R,...t}}try{I=await(0,o.getTokenStandardAndDetails)(e,t,A)}catch(e){return r.default.warn(e),{toAddress:R,tokenId:A}}const N=g&&(null===(T=I)||void 0===T?void 0:T.decimals)&&(0,l.calcTokenAmount)((0,d.getTokenValueParam)(g),null===(f=I)||void 0===f?void 0:f.decimals).toString(10),O=(null===(m=I)||void 0===m?void 0:m.decimals)&&Number(null===(h=I.decimals)||void 0===h?void 0:h.toString(10));(null===(p=I)||void 0===p?void 0:p.standard)===u.ERC20&&(A=undefined);return{tokenAmount:N,toAddress:R,decimals:O,tokenId:A,...I}},n.getSymbolAndDecimals=g,n.getTokenAddressParam=_,n.getTokenApprovedParam=function(e={}){var t;return null==e||null===(t=e.args)||void 0===t?void 0:t._approved},n.getTokenFiatAmount=function(e,t,n,a,r,o=!0,i=!1){if(t<=0||!e||a===undefined)return undefined;const c=(0,s.multiplyCurrencies)(e,t,{multiplicandBase:10,multiplierBase:10}),u=(0,s.conversionUtil)(a,{fromNumericBase:"dec",fromCurrency:r,toCurrency:n.toUpperCase(),numberOfDecimals:2,conversionRate:c});let d;d=i?(0,T.formatCurrency)(u,n):o?`${(0,T.formatCurrency)(u,n)} ${n.toUpperCase()}`:u;return d},n.getTokenIdParam=S,n.getTokenMetadata=m,n.tokenInfoGetter=function(){const e={};return async(t,n)=>(e[t]||(e[t]=await g(t,n)),e[t])};var a,r=(a=e("loglevel"))&&a.__esModule?a:{default:a},s=e("../../../shared/modules/conversion.utils"),o=e("../../store/actions"),i=e("../../../shared/modules/string-utils"),c=e("../../../shared/modules/transaction.utils"),u=e("../../../shared/constants/transaction"),d=e("../../../shared/lib/metamask-controller-utils"),l=e("../../../shared/lib/transactions-controller-utils"),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("./util")),T=e("./confirm-tx.util");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function m(e,t){return e&&t[e.toLowerCase()]}async function h(e,t){let n=await async function(e){const t=E.getContractAtAddress(e);try{return(await t.symbol())[0]}catch(t){return r.default.warn(`symbol() call for token at address ${e} resulted in error:`,t),undefined}}(e);if(!n){const a=m(e,t);a&&(n=a.symbol)}return n}async function p(e,t){let n=await async function(e){const t=E.getContractAtAddress(e);try{const e=(await t.decimals())[0];return null==e?void 0:e.toString()}catch(t){return r.default.warn(`decimals() call for token at address ${e} resulted in error:`,t),undefined}}(e);if(!n||"0"===n){const r=m(e,t);var a;if(r)n=null===(a=r.decimals)||void 0===a?void 0:a.toString()}return n}async function g(e,t){let n,a;try{n=await h(e,t),a=await p(e,t)}catch(t){r.default.warn(`symbol() and decimal() calls for token at address ${e} resulted in error:`,t)}return{symbol:n||"",decimals:a}}function _(e={}){var t,n,a;const r=(null==e||null===(t=e.args)||void 0===t?void 0:t._to)||(null==e||null===(n=e.args)||void 0===n?void 0:n.to)||(null==e||null===(a=e.args)||void 0===a?void 0:a[0]);return null==r?void 0:r.toString().toLowerCase()}function S(e={}){var t,n,a,r,s;return null!==(t=null==e||null===(n=e.args)||void 0===n||null===(a=n._tokenId)||void 0===a?void 0:a.toString())&&void 0!==t?t:null==e||null===(r=e.args)||void 0===r||null===(s=r.id)||void 0===s?void 0:s.toString()}}}},{package:"$root$"}],[6069,{"../../../app/scripts/lib/util":87,"../../../shared/constants/transaction":5410,"../../../shared/lib/fetch-with-cache":5412,"../../../shared/modules/contract-utils":5421,"../../../shared/modules/conversion.utils":5422,"eth-method-registry":2095,loglevel:4778},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getFourBytePrefix=function(e=""){const t=(0,s.addHexPrefix)(e);return t.slice(0,10)},n.getLatestSubmittedTxWithNonce=function(e=[],t="0x0"){if(!e.length)return{};return e.reduce(((e,n)=>{const{submittedTime:a,txParams:{nonce:r}={}}=n;return r===t?e.submittedTime?a>e.submittedTime?n:e:n:e}),{})},n.getMethodDataAsync=async function(e){try{const t=await async function(e){const t=await(0,u.default)(`https://www.4byte.directory/api/v1/signatures/?hex_signature=${e}`,{referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors"});return t.results.sort(((e,t)=>new Date(e.created_at).getTime()<new Date(t.created_at).getTime()?-1:1)),t.results[0].text_signature}(e).catch((e=>(r.default.error(e),null)));if(l||(l=new a.MethodRegistry({provider:global.ethereumProvider})),!t)return{};const n=l.parse(t);return{name:n.name,params:n.args}}catch(e){return r.default.error(e),{}}},n.getStatusKey=function(e){const{txReceipt:{status:t}={},type:n,status:a}=e;if("0x0"===t)return o.TRANSACTION_STATUSES.FAILED;if(a===o.TRANSACTION_STATUSES.CONFIRMED&&n===o.TRANSACTION_TYPES.CANCEL)return o.TRANSACTION_GROUP_STATUSES.CANCELLED;return e.status},n.getTransactionTypeTitle=function(e,t,n="ETH"){switch(t){case o.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER:return e("transfer");case o.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM:return e("transferFrom");case o.TRANSACTION_TYPES.TOKEN_METHOD_SAFE_TRANSFER_FROM:return e("safeTransferFrom");case o.TRANSACTION_TYPES.TOKEN_METHOD_APPROVE:return e("approve");case o.TRANSACTION_TYPES.TOKEN_METHOD_SET_APPROVAL_FOR_ALL:return e("setApprovalForAll");case o.TRANSACTION_TYPES.SIMPLE_SEND:return e("sendingNativeAsset",[n]);case o.TRANSACTION_TYPES.CONTRACT_INTERACTION:return e("contractInteraction");case o.TRANSACTION_TYPES.DEPLOY_CONTRACT:return e("contractDeployment");case o.TRANSACTION_TYPES.SWAP:return e("swap");case o.TRANSACTION_TYPES.SWAP_APPROVAL:return e("swapApproval");default:throw new Error(`Unrecognized transaction type: ${t}`)}},n.isLegacyTransaction=function(e){return(null==e?void 0:e.type)===o.TRANSACTION_ENVELOPE_TYPES.LEGACY},n.isSmartContractAddress=async function(e){const{isContractAddress:t}=await(0,c.readAddressAsContract)(global.eth,e);return t},n.isTokenMethodAction=function(e){return[o.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,o.TRANSACTION_TYPES.TOKEN_METHOD_APPROVE,o.TRANSACTION_TYPES.TOKEN_METHOD_SET_APPROVAL_FOR_ALL,o.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM,o.TRANSACTION_TYPES.TOKEN_METHOD_SAFE_TRANSFER_FROM].includes(e)},n.sumHexes=function(...e){const t=e.reduce(((e,t)=>(0,i.addCurrencies)(e,t,{toNumericBase:"hex",aBase:16,bBase:16})));return(0,s.addHexPrefix)(t)};var a=e("eth-method-registry"),r=d(e("loglevel")),s=e("../../../app/scripts/lib/util"),o=e("../../../shared/constants/transaction"),i=e("../../../shared/modules/conversion.utils"),c=e("../../../shared/modules/contract-utils"),u=d(e("../../../shared/lib/fetch-with-cache"));function d(e){return e&&e.__esModule?e:{default:e}}let l}}},{package:"$root$"}],[6070,{"../../../shared/modules/transaction.utils":5434,"./util":6071,loglevel:4778},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n,a,i,c,u,d){r.default.debug("tx-helper called with params:"),r.default.debug({unapprovedTxs:e,unapprovedMsgs:t,personalMsgs:n,decryptMsgs:a,encryptionPublicKeyMsgs:i,typedMessages:c,network:u,chainId:d});const l=u?(0,o.valuesFor)(e).filter((e=>(0,s.transactionMatchesNetwork)(e,d,u))):(0,o.valuesFor)(e);r.default.debug(`tx helper found ${l.length} unapproved txs`);const E=(0,o.valuesFor)(t);r.default.debug(`tx helper found ${E.length} unsigned messages`);let T=l.concat(E);const f=(0,o.valuesFor)(n);r.default.debug(`tx helper found ${f.length} unsigned personal messages`),T=T.concat(f);const m=(0,o.valuesFor)(a);r.default.debug(`tx helper found ${m.length} decrypt requests`),T=T.concat(m);const h=(0,o.valuesFor)(i);r.default.debug(`tx helper found ${h.length} encryptionPublicKey requests`),T=T.concat(h);const p=(0,o.valuesFor)(c);return r.default.debug(`tx helper found ${p.length} unsigned typed messages`),T=T.concat(p),T=T.sort(((e,t)=>e.time-t.time)),T};var a,r=(a=e("loglevel"))&&a.__esModule?a:{default:a},s=e("../../../shared/modules/transaction.utils"),o=e("./util")}}},{package:"$root$"}],[6071,{"../../../shared/constants/labels":5401,"../../../shared/constants/network":5403,"../../../shared/modules/conversion.utils":5422,"../../../shared/modules/hexstring-utils":5425,"@metamask/assets-controllers":1e3,"@metamask/slip44":1244,"bignumber.js":1706,"ethereumjs-util":2178,"human-standard-token-abi":4523,luxon:4781,"punycode/punycode":4886},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addressSummary=function(e,t=10,n=4,a=!0){if(!e)return"";let r=(0,l.toChecksumHexAddress)(e);a||(r=(0,l.stripHexPrefix)(r));return r?`${r.slice(0,t)}...${r.slice(r.length-n)}`:"..."},n.bnGreaterThan=function(e,t){if(null===e||e===undefined||null===t||t===undefined)return null;return new s.default(e,10).gt(t,10)},n.bnGreaterThanEqualTo=function(e,t){if(null===e||e===undefined||null===t||t===undefined)return null;return new s.default(e,10).gte(t,10)},n.bnLessThan=function(e,t){if(null===e||e===undefined||null===t||t===undefined)return null;return new s.default(e,10).lt(t,10)},n.bnLessThanEqualTo=function(e,t){if(null===e||e===undefined||null===t||t===undefined)return null;return new s.default(e,10).lte(t,10)},n.checkExistingAddresses=function(e,t=[]){if(!e)return!1;return t.some((t=>t.address.toLowerCase()===e.toLowerCase()))},n.clearClipboard=function(){window.navigator.clipboard.writeText("")},n.coinTypeToProtocolName=function(e){var t;if("1"===String(e))return"Test Networks";return(null===(t=u.default[e])||void 0===t?void 0:t.name)||undefined},n.formatBalance=function(e,t,n=!0,a="ETH"){const r=n?p(e):e.split("."),s=r[0];let o=r[1],i="None";if(t===undefined)if("0"===s){if("0"!==o){const e=o.match(/^0*(.{2})/u);e&&(o=e[0]),i=`0.${o} ${a}`}}else i=`${s}.${o.slice(0,3)} ${a}`;else o+=Array(t).join("0"),i=`${s}.${o.slice(0,t)} ${a}`;return i},n.formatDate=function(e,t="M/d/y 'at' T"){if(!e)return"";return i.DateTime.fromMillis(e).toFormat(t)},n.formatDateWithYearContext=function(e,t="MMM d",n="MMM d, y"){if(!e)return"";const a=i.DateTime.fromMillis(e),r=i.DateTime.local();return a.toFormat(r.year===a.year?t:n)},n.getAccountByAddress=function(e=[],t){return e.find((({address:e})=>e===t))},n.getAssetImageURL=function(e,t){if(!e||!t||"string"!=typeof e)return"";if(e.startsWith("ipfs://"))return(0,c.getFormattedIpfsUrl)(t,e,!0);return e},n.getContractAtAddress=function(e){return global.eth.contract(r.default).at(e)},n.getRandomFileName=function(){let e="";const t=[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"],n=Math.floor(7*Math.random()+6);for(let a=0;a<n;a++)e+=t[Math.floor(Math.random()*t.length)];return e},n.getURL=_,n.getURLHost=function(e){var t;return(null===(t=_(e))||void 0===t?void 0:t.host)||""},n.getURLHostName=function(e){var t;return(null===(t=_(e))||void 0===t?void 0:t.hostname)||""},n.isDefaultMetaMaskChain=function(e){if(!e||e===d.CHAIN_IDS.MAINNET||e===d.CHAIN_IDS.GOERLI||e===d.CHAIN_IDS.SEPOLIA||e===d.CHAIN_IDS.LOCALHOST)return!0;return!1},n.isExtensionUrl=function(e){const t=["chrome-extension:","moz-extension:"];if("string"==typeof e)for(const n of t)if(e.startsWith(n))return!0;if(null!=e&&e.protocol)return t.includes(e.protocol);return!1},n.isNullish=function(e){return null===e||e===undefined},n.isOriginContractAddress=function(e,t){if(!e||!t)return!1;return e.toLowerCase()===t.toLowerCase()},n.isValidDomainName=function(e){return null!==a.default.toASCII(e).toLowerCase().match(/^(?:[a-z0-9](?:[-a-z0-9]*[a-z0-9])?\.)+[a-z0-9][-a-z0-9]*[a-z0-9]$/u)},n.numericBalance=h,n.parseBalance=p,n.roundToDecimalPlacesRemovingExtraZeroes=function(e,t){if(e===undefined||null===e)return"";return T.toBigNumber.dec(T.toBigNumber.dec(e).toFixed(t)).toNumber()},n.sanitizeMessage=void 0,n.shortenAddress=function(e=""){if(e.length<E.TRUNCATED_NAME_CHAR_LIMIT)return e;return`${e.slice(0,E.TRUNCATED_ADDRESS_START_CHARS)}...${e.slice(-E.TRUNCATED_ADDRESS_END_CHARS)}`},n.stripHttpSchemes=function(e){return e.replace(/^https?:\/\//u,"")},n.stripHttpsScheme=g,n.stripHttpsSchemeWithoutPort=function(e){if(_(e).port)return e;return g(e)},n.toHumanReadableTime=void 0,n.valuesFor=function(e){if(!e)return[];return Object.keys(e).map((function(t){return e[t]}))};var a=m(e("punycode/punycode")),r=m(e("human-standard-token-abi")),s=m(e("bignumber.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("ethereumjs-util")),i=e("luxon"),c=e("@metamask/assets-controllers"),u=m(e("@metamask/slip44")),d=e("../../../shared/constants/network"),l=e("../../../shared/modules/hexstring-utils"),E=e("../../../shared/constants/labels"),T=e("../../../shared/modules/conversion.utils");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function m(e){return e&&e.__esModule?e:{default:e}}function h(e){if(!e)return new o.BN(0,16);const t=(0,l.stripHexPrefix)(e);return new o.BN(t,16)}function p(e){let t;const n=h(e),a=n.toString(),r=a.length>18?a.slice(0,a.length-18):"0";return t=`000000000000000000${n}`.slice(-18).replace(/0+$/u,""),""===t&&(t="0"),[r,t]}function g(e){return e.replace(/^https:\/\//u,"")}function _(e){try{return new URL(e)}catch(e){return""}}n.toHumanReadableTime=(e,t)=>{if(t===undefined||null===t)return"";const n=Math.ceil(t/1e3);return n<=90?e("gasTimingSecondsShort",[n]):n<=5400?e("gasTimingMinutesShort",[Math.ceil(n/60)]):e("gasTimingHoursShort",[Math.ceil(n/3600)])};const S=(()=>{const e=Array.from(new Array(32)).map(((e,t)=>"int"+8*(t+1))),t=Array.from(new Array(32)).map(((e,t)=>"uint"+8*(t+1))),n=Array.from(new Array(32)).map(((e,t)=>`bytes${t+1}`)),a=Array.from(new Array(32)).map(((e,t)=>"fixed"+8*(t+1))),r=Array.from(new Array(32)).map(((e,t)=>"ufixed"+8*(t+1))),s=Array.from(new Array(80)).map(((e,t)=>a.map((e=>`${e}x${t+1}`)))),o=Array.from(new Array(80)).map(((e,t)=>r.map((e=>`${e}x${t+1}`))));return["bool","address","string","bytes","int","uint","fixed","ufixed",...e,...t,...n,...s.flat(),...o.flat()]})(),A=(e,t,n)=>{if(!n)throw new Error("Invalid types definition");const a=t&&null!==t.match(/\[[[0-9]*\]*/u);var r;if(a)return e.map((e=>A(e,(e=>e.replace(/\[[[0-9]*\]/u,""))(t),n)));if(r=t,S.includes(r))return e;const s=a?(e=>e.replace(/\[[[0-9]*\]*/gu,""))(t):t,o=n[s];if(!o)throw new Error("Invalid primary type definition");const i={};return Object.keys(e).forEach((t=>{const a=Object.values(o).find((e=>e.name===t));a&&(i[t]=A(e[t],a.type,n))})),i};n.sanitizeMessage=A}}},{package:"$root$"}],[6165,{"../../../../shared/constants/network":5403,"../../../../shared/lib/fetch-with-cache":5412,"../../../helpers/constants/design-system":6033,"../../../helpers/constants/routes":6037,"../../../helpers/constants/zendesk-url":6040,"eth-rpc-errors":2103,react:5049},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=e("eth-rpc-errors"),r=d(e("react")),s=e("../../../../shared/constants/network"),o=e("../../../helpers/constants/design-system"),i=e("../../../helpers/constants/routes"),c=d(e("../../../helpers/constants/zendesk-url")),u=d(e("../../../../shared/lib/fetch-with-cache"));function d(e){return e&&e.__esModule?e:{default:e}}const l={id:"UNRECOGNIZED_CHAIN",severity:o.SEVERITIES.WARNING,content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"unrecognizedChain"}}}},E={id:"MISMATCHED_CHAIN_RECOMMENDATION",content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"mismatchedChainRecommendation",variables:[{element:"a",key:"mismatchedChainLink",props:{href:c.default.VERIFY_CUSTOM_NETWORK,target:"__blank",tabIndex:0},children:{element:"MetaMaskTranslation",props:{translationKey:"mismatchedChainLinkText"}}}]}}}},T={id:"MISMATCHED_NETWORK_NAME",severity:o.SEVERITIES.WARNING,content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"mismatchedNetworkName"}}}},f={id:"MISMATCHED_NETWORK_SYMBOL",severity:o.SEVERITIES.DANGER,content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"mismatchedNetworkSymbol"}}}},m={id:"MISMATCHED_NETWORK_RPC",severity:o.SEVERITIES.DANGER,content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"mismatchedRpcUrl"}}}};var h={getAlerts:async function(e){const t=[],n=(await(0,u.default)("https://chainid.network/chains.json")||[]).find((t=>t.chainId===parseInt(e.requestData.chainId,16)));if("metamask"===e.origin&&Boolean(n))return[];if(n){var a;n.name.toLowerCase()!==e.requestData.chainName.toLowerCase()&&t.push(T),(null===(a=n.nativeCurrency)||void 0===a?void 0:a.symbol)!==e.requestData.ticker&&t.push(f);const{origin:r}=new URL(e.requestData.rpcUrl);n.rpc.map((e=>new URL(e).origin)).includes(r)||t.push(m)}return n||t.push(l),t.length&&t.push(E),t},getValues:function(e,t,n,u){var d;const l="metamask"===e.origin;return{content:[{hide:!l,element:"Box",key:"network-box",props:{textAlign:o.TEXT_ALIGN.CENTER,display:o.DISPLAY.FLEX,justifyContent:o.JUSTIFY_CONTENT.CENTER,marginTop:4,marginBottom:2},children:[{element:"Chip",key:"network-chip",props:{label:e.requestData.chainName,backgroundColor:o.COLORS.BACKGROUND_ALTERNATIVE,leftIconUrl:e.requestData.imageUrl}}]},{element:"Typography",key:"title",children:t(l?"wantToAddThisNetwork":"addEthereumChainConfirmationTitle"),props:{variant:o.TYPOGRAPHY.H3,align:"center",fontWeight:"bold",boxProps:{margin:[0,0,4]}}},{element:"Typography",key:"description",children:t("addEthereumChainConfirmationDescription"),props:{variant:o.TYPOGRAPHY.H7,align:"center",boxProps:{margin:l?[0,8,4]:[0,0,4]}}},{element:"Typography",key:"only-add-networks-you-trust",children:[{element:"b",key:"bolded-text",props:{style:{display:l&&"-webkit-box"}},children:[`${t("addEthereumChainConfirmationRisks")} `,{hide:!l,element:"Tooltip",key:"tooltip-info",props:{position:"bottom",interactive:!0,trigger:"mouseenter",html:r.default.createElement("div",{style:{width:"180px",margin:"16px",textAlign:"left"}},t("someNetworksMayPoseSecurity")," ",r.default.createElement("a",{key:"zendesk_page_link",href:c.default.UNKNOWN_NETWORK,rel:"noreferrer",target:"_blank",style:{color:"var(--color-primary-default)"}},t("learnMoreUpperCase")))},children:[{element:"i",key:"info-circle",props:{className:"fas fa-info-circle",style:{marginLeft:"4px",color:"var(--color-icon-default)"}}}]}]},{element:"MetaMaskTranslation",key:"learn-about-risks",props:{translationKey:"addEthereumChainConfirmationRisksLearnMore",variables:[{element:"a",children:t("addEthereumChainConfirmationRisksLearnMoreLink"),key:"addEthereumChainConfirmationRisksLearnMoreLink",props:{href:c.default.USER_GUIDE_CUSTOM_NETWORKS,target:"__blank"}}]}}],props:{variant:o.TYPOGRAPHY.H7,boxProps:{margin:l?[0,8]:0,display:o.DISPLAY.FLEX,flexDirection:o.FLEX_DIRECTION.COLUMN,alignItems:o.ALIGN_ITEMS.CENTER}}},{element:"TruncatedDefinitionList",key:"network-details",props:{title:t("networkDetails"),tooltips:{[t("networkName")]:t("networkNameDefinition"),[t("networkURL")]:t("networkURLDefinition"),[t("chainId")]:t("chainIdDefinition"),[t("currencySymbol")]:t("currencySymbolDefinition"),[t("blockExplorerUrl")]:t("blockExplorerUrlDefinition")},dictionary:{[t("networkName")]:e.requestData.chainName,[t("networkURL")]:null!==(d=e.requestData.rpcUrl)&&void 0!==d&&d.includes(`/v3/${s.infuraProjectId}`)?e.requestData.rpcUrl.replace(`/v3/${s.infuraProjectId}`,""):e.requestData.rpcUrl,[t("chainId")]:parseInt(e.requestData.chainId,16),[t("currencySymbol")]:e.requestData.ticker,[t("blockExplorerUrl")]:e.requestData.blockExplorerUrl},prefaceKeys:[t("networkName"),t("networkURL"),t("chainId"),t("currencySymbol")]}}],cancelText:t("cancel"),submitText:t("approveButtonText"),onSubmit:async()=>{await n.resolvePendingApproval(e.id,e.requestData),l&&(n.addCustomNetwork(e.requestData),u.push(i.DEFAULT_ROUTE))},onCancel:()=>n.rejectPendingApproval(e.id,a.ethErrors.provider.userRejectedRequest().serialize()),networkDisplay:!l}},getState:function(e){return 1===parseInt(e.requestData.chainId,16)?{useWarningModal:!0}:{}}};n.default=h}}},{package:"$root$"}],[6166,{"../../../../shared/constants/app":5397,"../../../store/actions":6444,"./add-ethereum-chain":6165,"./switch-ethereum-chain":6167,lodash:4765},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TEMPLATED_CONFIRMATION_MESSAGE_TYPES=void 0,n.getTemplateAlerts=async function(e){var t;const n=null===(t=u[e.type])||void 0===t?void 0:t.getAlerts,a=n?await n(e):[];if(!Array.isArray(a))throw new Error(`Template alerts must be an array, received: ${a}`);if(a.some((e=>(null==e?void 0:e.id)===undefined)))throw new Error(`Template alert entries must be objects with an id key. Received: ${a}`);return a},n.getTemplateState=async function(e){var t,n;const a=null!==(t=null===(n=u[e.type])||void 0===n?void 0:n.getState)&&void 0!==t?t:E,r=await a(e);if("object"!=typeof r||Array.isArray(r))throw new Error(`Template state must be an object, received: ${r}`);if(null===r||r===undefined)return{};return r},n.getTemplateValues=function(e,t,n,r,o){var i;const c=null===(i=u[e.type])||void 0===i?void 0:i.getValues;if(!c)throw new Error(`MESSAGE_TYPE: '${e.type}' is not specified in approval templates`);const d=function(e){return{rejectPendingApproval:(...t)=>e((0,s.rejectPendingApproval)(...t)),resolvePendingApproval:(...t)=>e((0,s.resolvePendingApproval)(...t)),addCustomNetwork:(...t)=>e((0,s.addCustomNetwork)(...t))}}(n),E=c(e,t,d,r,o),T=(0,a.omit)(E,l),f=(0,a.pick)(E,l);if(T.length>0)throw new Error(`Received extraneous keys from ${e.type}.getValues. These keys are not passed to the confirmation page: ${Object.keys(T)}`);return f};var a=e("lodash"),r=e("../../../../shared/constants/app"),s=e("../../../store/actions"),o=c(e("./add-ethereum-chain")),i=c(e("./switch-ethereum-chain"));function c(e){return e&&e.__esModule?e:{default:e}}const u={[r.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN]:o.default,[r.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN]:i.default},d=Object.keys(u);n.TEMPLATED_CONFIRMATION_MESSAGE_TYPES=d;const l=["cancelText","content","onCancel","onSubmit","networkDisplay","submitText"];async function E(){return{}}}}},{package:"$root$"}],[6167,{"../../../helpers/constants/design-system":6033,"eth-rpc-errors":2103},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=e("eth-rpc-errors"),r=e("../../../helpers/constants/design-system");const s={id:"PENDING_TX_DROP_NOTICE",severity:r.SEVERITIES.WARNING,content:{element:"span",children:{element:"MetaMaskTranslation",props:{translationKey:"switchingNetworksCancelsPendingConfirmations"}}}};var o={getAlerts:async function(){return[s]},getValues:function(e,t,n){return{content:[{element:"Typography",key:"title",children:t("switchEthereumChainConfirmationTitle"),props:{variant:r.TYPOGRAPHY.H3,align:"center",fontWeight:"normal",boxProps:{margin:[0,0,2],padding:[0,4,0,4]}}},{element:"Typography",key:"description",children:t("switchEthereumChainConfirmationDescription"),props:{variant:r.TYPOGRAPHY.H7,color:r.COLORS.TEXT_ALTERNATIVE,align:"center",boxProps:{padding:[0,4,0,4]}}},{element:"Box",key:"status-box",props:{justifyContent:r.JUSTIFY_CONTENT.CENTER},children:{element:"ConfirmationNetworkSwitch",key:"network-being-switched",props:{newNetwork:{chainId:e.requestData.chainId,name:e.requestData.nickname}}}}],cancelText:t("cancel"),submitText:t("switchNetwork"),onSubmit:()=>n.resolvePendingApproval(e.id,e.requestData),onCancel:()=>n.rejectPendingApproval(e.id,a.ethErrors.provider.userRejectedRequest().serialize()),networkDisplay:!0}}};n.default=o}}},{package:"$root$"}],[6312,{"../../../app/scripts/lib/util":87,"../../../shared/constants/gas":5398,"../../../shared/modules/conversion.utils":5422},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TOKEN_TRANSFER_FUNCTION_SIGNATURE=n.REQUIRED_ERROR=n.RECIPIENT_TYPES=n.NEGATIVE_ETH_ERROR=n.MIN_GAS_TOTAL=n.MIN_GAS_PRICE_HEX=n.MIN_GAS_PRICE_GWEI=n.MIN_GAS_PRICE_DEC=n.MIN_GAS_LIMIT_DEC=n.MAX_GAS_LIMIT_DEC=n.KNOWN_RECIPIENT_ADDRESS_WARNING=n.INVALID_RECIPIENT_ADDRESS_NOT_ETH_NETWORK_ERROR=n.INVALID_RECIPIENT_ADDRESS_ERROR=n.INSUFFICIENT_TOKENS_ERROR=n.INSUFFICIENT_FUNDS_FOR_GAS_ERROR=n.INSUFFICIENT_FUNDS_ERROR=n.HIGH_FEE_WARNING_MULTIPLIER=n.ENS_UNKNOWN_ERROR=n.ENS_REGISTRATION_ERROR=n.ENS_NO_ADDRESS_FOR_NAME=n.ENS_NOT_SUPPORTED_ON_NETWORK=n.ENS_NOT_FOUND_ON_NETWORK=n.ENS_ILLEGAL_CHARACTER=n.CONTRACT_ADDRESS_ERROR=n.CONFUSING_ENS_ERROR=n.COLLECTIBLE_TRANSFER_FROM_FUNCTION_SIGNATURE=void 0;var a=e("../../../shared/modules/conversion.utils"),r=e("../../../app/scripts/lib/util"),s=e("../../../shared/constants/gas");n.MIN_GAS_PRICE_DEC="0";const o=parseInt("0",10).toString(16);n.MIN_GAS_PRICE_HEX=o;n.MIN_GAS_LIMIT_DEC="21000";n.MAX_GAS_LIMIT_DEC="7920027";n.HIGH_FEE_WARNING_MULTIPLIER=1.5;const i=(0,r.addHexPrefix)((0,a.conversionUtil)(o,{fromDenomination:"WEI",toDenomination:"GWEI",fromNumericBase:"hex",toNumericBase:"hex",numberOfDecimals:1}));n.MIN_GAS_PRICE_GWEI=i;const c=(0,a.multiplyCurrencies)(s.MIN_GAS_LIMIT_HEX,o,{toNumericBase:"hex",multiplicandBase:16,multiplierBase:16});n.MIN_GAS_TOTAL=c;n.TOKEN_TRANSFER_FUNCTION_SIGNATURE="0xa9059cbb";n.COLLECTIBLE_TRANSFER_FROM_FUNCTION_SIGNATURE="0x23b872dd";n.INSUFFICIENT_FUNDS_ERROR="insufficientFunds";n.INSUFFICIENT_FUNDS_FOR_GAS_ERROR="insufficientFundsForGas";n.INSUFFICIENT_TOKENS_ERROR="insufficientTokens";n.NEGATIVE_ETH_ERROR="negativeETH";n.INVALID_RECIPIENT_ADDRESS_ERROR="invalidAddressRecipient";n.INVALID_RECIPIENT_ADDRESS_NOT_ETH_NETWORK_ERROR="invalidAddressRecipientNotEthNetwork";n.REQUIRED_ERROR="required";n.KNOWN_RECIPIENT_ADDRESS_WARNING="knownAddressRecipient";n.CONTRACT_ADDRESS_ERROR="contractAddressError";n.CONFUSING_ENS_ERROR="confusingEnsDomain";n.ENS_NO_ADDRESS_FOR_NAME="noAddressForName";n.ENS_NOT_FOUND_ON_NETWORK="ensNotFoundOnCurrentNetwork";n.ENS_NOT_SUPPORTED_ON_NETWORK="ensNotSupportedOnNetwork";n.ENS_ILLEGAL_CHARACTER="ensIllegalCharacter";n.ENS_UNKNOWN_ERROR="ensUnknownError";n.ENS_REGISTRATION_ERROR="ensRegistrationError";n.RECIPIENT_TYPES={SMART_CONTRACT:"SMART_CONTRACT",NON_CONTRACT:"NON_CONTRACT"}}}},{package:"$root$"}],[6314,{"../../../app/scripts/lib/util":87,"../../../shared/constants/transaction":5410,"../../../shared/lib/transactions-controller-utils":5417,"../../../shared/modules/conversion.utils":5422,"./send.constants":6312,"ethereumjs-abi":2158},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addGasBuffer=function(e,t,n=1.5){const a=(0,s.multiplyCurrencies)(t,.9,{toNumericBase:"hex",multiplicandBase:16,multiplierBase:10,numberOfDecimals:"0"}),r=(0,s.multiplyCurrencies)(e,n,{toNumericBase:"hex",multiplicandBase:16,multiplierBase:10,numberOfDecimals:"0"});if((0,s.conversionGreaterThan)({value:e,fromNumericBase:"hex"},{value:a,fromNumericBase:"hex"}))return e;if((0,s.conversionLessThan)({value:r,fromNumericBase:"hex"},{value:a,fromNumericBase:"hex"}))return r;return a},n.ellipsify=function(e,t=6,n=4){return`${e.slice(0,t)}...${e.slice(-n)}`},n.generateERC20TransferData=d,n.generateERC721TransferData=l,n.getAssetTransferData=function({sendToken:e,fromAddress:t,toAddress:n,amount:a}){switch(e.standard){case i.ERC721:return l({toAddress:n,fromAddress:t,tokenId:e.tokenId});case i.ERC20:default:return d({toAddress:n,amount:a,sendToken:e})}},n.isBalanceSufficient=function({amount:e="0x0",balance:t="0x0",conversionRate:n=1,gasTotal:a="0x0",primaryCurrency:r}){const o=(0,s.addCurrencies)(e,a,{aBase:16,bBase:16,toNumericBase:"hex"});return(0,s.conversionGTE)({value:t,fromNumericBase:"hex",fromCurrency:r,conversionRate:n},{value:o,fromNumericBase:"hex",conversionRate:n,fromCurrency:r})},n.isTokenBalanceSufficient=function({amount:e="0x0",tokenBalance:t,decimals:n}){const a=(0,s.conversionUtil)(e,{fromNumericBase:"hex"});return(0,s.conversionGTE)({value:t,fromNumericBase:"hex"},{value:(0,c.calcTokenAmount)(a,n)})};var a,r=(a=e("ethereumjs-abi"))&&a.__esModule?a:{default:a},s=e("../../../shared/modules/conversion.utils"),o=e("../../../app/scripts/lib/util"),i=e("../../../shared/constants/transaction"),c=e("../../../shared/lib/transactions-controller-utils"),u=e("./send.constants");function d({toAddress:e="0x0",amount:t="0x0",sendToken:n}){return n?u.TOKEN_TRANSFER_FUNCTION_SIGNATURE+Array.prototype.map.call(r.default.rawEncode(["address","uint256"],[(0,o.addHexPrefix)(e),(0,o.addHexPrefix)(t)]),(e=>`00${e.toString(16)}`.slice(-2))).join(""):undefined}function l({toAddress:e="0x0",fromAddress:t="0x0",tokenId:n}){return n?u.COLLECTIBLE_TRANSFER_FROM_FUNCTION_SIGNATURE+Array.prototype.map.call(r.default.rawEncode(["address","address","uint256"],[(0,o.addHexPrefix)(t),(0,o.addHexPrefix)(e),n]),(e=>`00${e.toString(16)}`.slice(-2))).join(""):undefined}}}},{package:"$root$"}],[6422,{"../../../shared/constants/network":5403,"../../../shared/constants/swaps":5407,"../../../shared/lib/fetch-with-cache":5412,"../../../shared/lib/swaps-utils":5415,"../../../shared/lib/transactions-controller-utils":5417,"../../../shared/modules/hexstring-utils":5425,"../../../shared/modules/swaps.utils":5433,"../../helpers/utils/confirm-tx.util":6052,"../../helpers/utils/conversions.util":6053,"../../helpers/utils/transactions.util":6069,"bignumber.js":1706,"human-standard-token-abi":4523},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.countDecimals=void 0,n.fetchAggregatorMetadata=async function(e){const t=(0,T.getBaseApi)("aggregatorMetadata",e),n=await(0,d.default)(t,{method:"GET",headers:g},{cacheRefreshTime:h}),a={};for(const e in n)(0,T.validateData)(A,n[e],t)&&(a[e]=n[e]);return a},n.fetchSwapsFeatureFlags=async function(){const e=s.SWAPS_API_V2_BASE_URL;return await(0,d.default)(`${e}/featureFlags`,{method:"GET",headers:g},{cacheRefreshTime:6e5})},n.fetchSwapsGasPrices=async function(e){const t=(0,T.getBaseApi)("gasPrices",e),n=await(0,d.default)(t,{method:"GET",headers:g},{cacheRefreshTime:3e4});if(!(0,T.validateData)(I,n,t))throw new Error(`${t} response is invalid`);const{SafeGasPrice:a,ProposeGasPrice:r,FastGasPrice:s}=n;return{safeLow:a,average:r,fast:s}},n.fetchToken=async function(e,t){const n=(0,T.getBaseApi)("token",t);return await(0,d.default)(`${n}?address=${e}`,{method:"GET",headers:g},{cacheRefreshTime:h})},n.fetchTokenBalance=async function(e,t){const n=global.eth.contract(r.default).at(e),a=n?n.balanceOf(t):Promise.resolve();return await a},n.fetchTokenPrice=async function(e){var t;const n=`contract_addresses=${e}&vs_currencies=eth`,a=await(0,d.default)(`https://api.coingecko.com/api/v3/simple/token_price/ethereum?${n}`,{method:"GET"},{cacheRefreshTime:6e4});return a&&(null===(t=a[e])||void 0===t?void 0:t.eth)},n.fetchTokens=async function(e){const t=(0,T.getBaseApi)("tokens",e),n=await(0,d.default)(t,{method:"GET",headers:g},{cacheRefreshTime:h});return[s.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[e],...n.filter((n=>(0,T.validateData)(_,n,t,false)&&!((0,o.isSwapsDefaultTokenSymbol)(n.symbol,e)||(0,o.isSwapsDefaultTokenAddress)(n.address,e))))]},n.fetchTopAssets=async function(e){const t=(0,T.getBaseApi)("topAssets",e),n=await(0,d.default)(t,{method:"GET",headers:g},{cacheRefreshTime:h})||[];return n.reduce(((e,n,a)=>(0,T.validateData)(S,n,t)?{...e,[n.address]:{index:String(a)}}:e),{})},n.formatSwapsValueForDisplay=v,n.getNetworkNameByChainId=n.getFeeForSmartTransaction=void 0,n.getRenderableNetworkFeesForQuote=O,n.parseSmartTransactionsError=n.isContractAddressValid=n.getTranslatedStxErrorMessage=n.getSwapsLivenessForNetwork=void 0,n.quotesToRenderableData=function(e,t,n,r,s,i,c,u,d,l){return Object.values(e).map((e=>{const{destinationAmount:T=0,sourceAmount:f=0,sourceTokenInfo:m,destinationTokenInfo:h,slippage:p,aggType:g,aggregator:_,gasEstimateWithRefund:S,averageGas:A,fee:R,trade:I}=e,C=(0,E.calcTokenAmount)(f,m.decimals).toString(10),y=(0,E.calcTokenAmount)(T,h.decimals).toPrecision(8);let k=null,P=null,w=null,D=null;({feeInFiat:k,feeInEth:P,rawNetworkFees:w,rawEthFee:D}=O({tradeGas:S||(0,E.decimalToHex)(A||8e5),approveGas:s,gasPrice:t,currentCurrency:r,conversionRate:n,tradeValue:I.value,sourceSymbol:m.symbol,sourceAmount:f,chainId:c,multiLayerL1FeeTotal:l})),u&&({feeInFiat:k,feeInEth:P}=N({chainId:c,currentCurrency:r,conversionRate:n,nativeCurrencySymbol:d,estimatedFeeInWeiDec:u.feeEstimate}));const b=new a.default(100-p).div(100),M=new a.default(y).times(b).toFixed(6),L=i[h.address],U=(0,o.isSwapsDefaultTokenSymbol)(h.symbol,c)?(0,E.calcTokenAmount)(T,h.decimals).minus(D,10):new a.default(L||0,10).times((0,E.calcTokenAmount)(T,h.decimals),10).minus(D,10);let F,x=p;return"AGG"===g?F="swapAggregator":"RFQ"===g?(F="swapRequestForQuotation",x=0):F="DEX"===g?"swapDecentralizedExchange":"CONTRACT"===g?"swapDirectContract":"swapUnknown",{aggId:_,amountReceiving:`${y} ${h.symbol}`,destinationTokenDecimals:h.decimals,destinationTokenSymbol:h.symbol,destinationTokenValue:v(y),destinationIconUrl:h.iconUrl,isBestQuote:e.isBestQuote,liquiditySourceKey:F,feeInEth:P,detailedNetworkFees:`${P} (${k})`,networkFees:k,quoteSource:g,rawNetworkFees:w,slippage:x,sourceTokenDecimals:m.decimals,sourceTokenSymbol:m.symbol,sourceTokenValue:C,sourceTokenIconUrl:m.iconUrl,ethValueOfTrade:U,minimumAmountReceived:M,metaMaskFee:R}}))},n.stxErrorTypes=n.showRemainingTimeInMinAndSec=void 0;var a=m(e("bignumber.js")),r=m(e("human-standard-token-abi")),s=e("../../../shared/constants/swaps"),o=e("../../../shared/modules/swaps.utils"),i=e("../../../shared/constants/network"),c=e("../../helpers/utils/conversions.util"),u=e("../../helpers/utils/confirm-tx.util"),d=m(e("../../../shared/lib/fetch-with-cache")),l=e("../../../shared/modules/hexstring-utils"),E=e("../../../shared/lib/transactions-controller-utils"),T=e("../../../shared/lib/swaps-utils"),f=e("../../helpers/utils/transactions.util");function m(e){return e&&e.__esModule?e:{default:e}}const h=3e5,p="usd",g={"X-Client-Id":s.SWAPS_CLIENT_ID},_=[{property:"address",type:"string",validator:e=>(0,l.isValidHexAddress)(e,{allowNonPrefixed:!1})},{property:"symbol",type:"string",validator:e=>(0,T.truthyString)(e)&&e.length<=12},{property:"decimals",type:"string|number",validator:e=>Number(e)>=0&&Number(e)<=36}],S=_.slice(0,2),A=[{property:"color",type:"string",validator:e=>Boolean(e.match(/^#[A-Fa-f0-9]+$/u))},{property:"title",type:"string",validator:T.truthyString},{property:"icon",type:"string",validator:e=>Boolean(e.match(/^data:image/u))}],R=e=>!isNaN(e)&&e.match(/^[.0-9]+$/u)&&!isNaN(parseFloat(e)),I=[{property:"SafeGasPrice",type:"string",validator:R},{property:"ProposeGasPrice",type:"string",validator:R},{property:"FastGasPrice",type:"string",validator:R}];const N=({chainId:e,currentCurrency:t,conversionRate:n,USDConversionRate:a,nativeCurrencySymbol:r,feeInWeiDec:o})=>{const d=(0,E.decimalToHex)(o),l=(0,c.getValueFromWeiHex)({value:d,toDenomination:i.CURRENCY_SYMBOLS.ETH,numberOfDecimals:5}),T=(0,c.getValueFromWeiHex)({value:d,toCurrency:t,conversionRate:n,numberOfDecimals:2});let f;f=t===p?T:(0,c.getValueFromWeiHex)({value:d,toCurrency:p,conversionRate:a,numberOfDecimals:2});return{feeInUsd:f,feeInFiat:(0,u.formatCurrency)(T,t),feeInEth:`${l} ${r||s.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[e].symbol}`,rawEthFee:l}};function O({tradeGas:e,approveGas:t,gasPrice:n,currentCurrency:r,conversionRate:i,USDConversionRate:d,tradeValue:l,sourceSymbol:T,sourceAmount:m,chainId:h,nativeCurrencySymbol:g,multiLayerL1FeeTotal:_}){const S=new a.default(e||"0x0",16).plus(t||"0x0",16).toString(16);let A=(0,E.calcGasTotal)(S,n);null!==_&&(A=(0,f.sumHexes)(A||"0x0",_||"0x0"));const R=new a.default(l,16).minus((0,o.isSwapsDefaultTokenSymbol)(T,h)?m:0,10).toString(16),I=new a.default(A,16).plus(R,16).toString(16),N=(0,c.getValueFromWeiHex)({value:I,toDenomination:"ETH",numberOfDecimals:5}),O=(0,c.getValueFromWeiHex)({value:I,toCurrency:r,conversionRate:i,numberOfDecimals:2}),v=(0,u.formatCurrency)(O,r);let C;C=r===p?O:(0,c.getValueFromWeiHex)({value:I,toCurrency:p,conversionRate:d,numberOfDecimals:2});return{rawNetworkFees:O,feeInUsd:C,rawEthFee:N,feeInFiat:v,feeInEth:`${N} ${g||s.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[h].symbol}`,nonGasFee:R}}function v(e){let t=(0,E.toPrecisionWithoutTrailingZeros)(e,12);return t.match(/e[+-]/u)&&(t=new a.default(t).toFixed()),t}n.getFeeForSmartTransaction=N;n.isContractAddressValid=(e,t=i.CHAIN_IDS.MAINNET)=>!(!e||!s.ALLOWED_CONTRACT_ADDRESSES[t])&&s.ALLOWED_CONTRACT_ADDRESSES[t].some((t=>e.toLowerCase()===t.toLowerCase()));const C=e=>{switch(e){case i.CHAIN_IDS.MAINNET:return s.ETHEREUM;case i.CHAIN_IDS.BSC:return s.BSC;case i.CHAIN_IDS.POLYGON:return s.POLYGON;case i.CHAIN_IDS.GOERLI:return s.GOERLI;case i.CHAIN_IDS.AVALANCHE:return s.AVALANCHE;case i.CHAIN_IDS.OPTIMISM:return s.OPTIMISM;case i.CHAIN_IDS.ARBITRUM:return s.ARBITRUM;default:return""}};n.getNetworkNameByChainId=C;n.getSwapsLivenessForNetwork=(e={},t)=>{const n=C(t);if([i.CHAIN_IDS.LOCALHOST,i.CHAIN_IDS.GOERLI].includes(t))return{swapsFeatureIsLive:!0};if(!e[n])return{swapsFeatureIsLive:!1};return e[n].extensionActive?{swapsFeatureIsLive:!0}:{swapsFeatureIsLive:e[n].fallbackToV1}};n.countDecimals=e=>{var t;return e&&Math.floor(e)!==e&&(null===(t=e.toString().split(".")[1])||void 0===t?void 0:t.length)||0};n.showRemainingTimeInMinAndSec=e=>{if(!Number.isInteger(e))return"0:00";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`};const y={UNAVAILABLE:"unavailable",NOT_ENOUGH_FUNDS:"not_enough_funds",REGULAR_TX_IN_PROGRESS:"regular_tx_pending"};n.stxErrorTypes=y;n.getTranslatedStxErrorMessage=(e,t)=>{switch(e){case y.UNAVAILABLE:case y.REGULAR_TX_IN_PROGRESS:return t("stxErrorUnavailable");case y.NOT_ENOUGH_FUNDS:return t("stxErrorNotEnoughFunds");default:return t("stxErrorUnavailable")}};n.parseSmartTransactionsError=e=>{const t=e.slice(12);return JSON.parse(t.trim())}}}},{package:"$root$"}],[6434,{".":6437,"../../shared/constants/gas":5398,"../../shared/constants/transaction":5410,"../../shared/lib/transactions-controller-utils":5417,"../../shared/modules/gas.utils":5424,"../../shared/modules/string-utils":5432,"../../shared/modules/transaction.utils":5434,"../ducks/metamask/metamask":6025,"../helpers/utils/confirm-tx.util":6052,"../helpers/utils/conversions.util":6053,"../helpers/utils/transactions.util":6069,"../helpers/utils/tx-helper":6070,"./custom-gas":6435,"./selectors":6440,reselect:5074},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unconfirmedTransactionsListSelector=n.unconfirmedTransactionsHashSelector=n.unconfirmedTransactionsCountSelector=n.unconfirmedMessagesHashSelector=n.txDataSelector=n.transactionFeeSelector=n.tokenAddressSelector=n.sendTokenTokenAmountAndToAddressSelector=n.currentCurrencySelector=n.conversionRateSelector=n.contractExchangeRateSelector=void 0;var a,r=e("reselect"),s=(a=e("../helpers/utils/tx-helper"))&&a.__esModule?a:{default:a},o=e("../helpers/utils/confirm-tx.util"),i=e("../helpers/utils/transactions.util"),c=e("../../shared/modules/transaction.utils"),u=e("../ducks/metamask/metamask"),d=e("../../shared/constants/transaction"),l=e("../helpers/utils/conversions.util"),E=e("../../shared/constants/gas"),T=e("../../shared/modules/gas.utils"),f=e("../../shared/modules/string-utils"),m=e("../../shared/lib/transactions-controller-utils"),h=e("./custom-gas"),p=e("./selectors"),g=e(".");const _=e=>e.metamask.unapprovedTxs,S=e=>e.metamask.unapprovedMsgs,A=e=>e.metamask.unapprovedPersonalMsgs,R=e=>e.metamask.unapprovedDecryptMsgs,I=e=>e.metamask.unapprovedEncryptionPublicKeyMsgs,N=e=>e.metamask.unapprovedTypedMessages,O=(0,r.createSelector)(_,S,A,R,I,N,p.deprecatedGetCurrentNetworkId,p.getCurrentChainId,((e={},t={},n={},a={},r={},o={},i,c)=>(0,s.default)(e,t,n,a,r,o,i,c)||[]));n.unconfirmedTransactionsListSelector=O;const v=(0,r.createSelector)(_,S,A,R,I,N,p.deprecatedGetCurrentNetworkId,p.getCurrentChainId,((e={},t={},n={},a={},r={},s={},o,i)=>({...Object.keys(e).reduce(((t,n)=>{const a={...t};return(0,c.transactionMatchesNetwork)(e[n],i,o)&&(a[n]=e[n]),a}),{}),...t,...n,...a,...r,...s})));n.unconfirmedTransactionsHashSelector=v;const C=(0,r.createSelector)(S,A,R,I,N,((e={},t={},n={},a={},r={})=>({...e,...t,...n,...a,...r})));n.unconfirmedMessagesHashSelector=C;const y=(0,r.createSelector)(_,(e=>e.metamask.unapprovedMsgCount),(e=>e.metamask.unapprovedPersonalMsgCount),(e=>e.metamask.unapprovedDecryptMsgCount),(e=>e.metamask.unapprovedEncryptionPublicKeyMsgCount),(e=>e.metamask.unapprovedTypedMessagesCount),p.deprecatedGetCurrentNetworkId,p.getCurrentChainId,((e={},t=0,n=0,a=0,r=0,s=0,o,i)=>Object.keys(e).filter((t=>(0,c.transactionMatchesNetwork)(e[t],i,o))).length+s+t+n+a+r));n.unconfirmedTransactionsCountSelector=y;const k=e=>e.metamask.currentCurrency;n.currentCurrencySelector=k;const P=e=>e.metamask.conversionRate;n.conversionRateSelector=P;const w=e=>e.confirmTransaction.txData;n.txDataSelector=w;const D=(0,r.createSelector)((e=>e.confirmTransaction.tokenProps),(e=>e&&e.decimals)),b=(0,r.createSelector)((e=>e.confirmTransaction.tokenData),(e=>e&&e.args||[])),M=(0,r.createSelector)(w,(e=>e&&e.txParams||{})),L=(0,r.createSelector)(M,(e=>e&&e.to));n.tokenAddressSelector=L;const U=(0,r.createSelector)(b,D,((e,t)=>{let n="",a="0";if(e&&e.length){n=e._to;let r=e._value.toString();t&&(r=(0,m.calcTokenAmount)(r,t).toFixed()),a=(0,o.roundExponential)(r)}return{toAddress:n,tokenAmount:a}}));n.sendTokenTokenAmountAndToAddressSelector=U;const F=(0,r.createSelector)((e=>e.metamask.contractExchangeRates),L,((e,t)=>e[Object.keys(e).find((e=>(0,f.isEqualCaseInsensitive)(e,t)))]));n.contractExchangeRateSelector=F;n.transactionFeeSelector=function(e,t){var n,a,r,s,c,f,m,p;const _=k(e),S=P(e),A=(0,u.getNativeCurrency)(e),R=(0,u.getGasFeeEstimates)(e)||{},I=(0,u.getGasEstimateType)(e),N=(0,g.checkNetworkAndAccountSupports1559)(e),O={gasLimit:null!==(n=null===(a=t.txParams)||void 0===a?void 0:a.gas)&&void 0!==n?n:"0x0"};if(N){var v;const{gasPrice:e="0"}=R,n=R[t.userFeeLevel]||{};if((null===(v=t.txParams)||void 0===v?void 0:v.type)===d.TRANSACTION_ENVELOPE_TYPES.LEGACY){var C,y;O.gasPrice=null!==(C=null===(y=t.txParams)||void 0===y?void 0:y.gasPrice)&&void 0!==C?C:(0,l.decGWEIToHexWEI)(e)}else{var w,D,b,M;const{suggestedMaxPriorityFeePerGas:a,suggestedMaxFeePerGas:r}=n;O.maxFeePerGas=null===(w=t.txParams)||void 0===w||!w.maxFeePerGas||t.userFeeLevel!==E.CUSTOM_GAS_ESTIMATE&&r?(0,l.decGWEIToHexWEI)(r||e):null===(D=t.txParams)||void 0===D?void 0:D.maxFeePerGas,O.maxPriorityFeePerGas=null===(b=t.txParams)||void 0===b||!b.maxPriorityFeePerGas||t.userFeeLevel!==E.CUSTOM_GAS_ESTIMATE&&a?a&&(0,l.decGWEIToHexWEI)(a)||O.maxFeePerGas:null===(M=t.txParams)||void 0===M?void 0:M.maxPriorityFeePerGas,O.baseFeePerGas=(0,l.decGWEIToHexWEI)(R.estimatedBaseFee)}}else switch(I){case E.GAS_ESTIMATE_TYPES.NONE:O.gasPrice=null!==(r=null===(s=t.txParams)||void 0===s?void 0:s.gasPrice)&&void 0!==r?r:"0x0";break;case E.GAS_ESTIMATE_TYPES.ETH_GASPRICE:O.gasPrice=null!==(c=null===(f=t.txParams)||void 0===f?void 0:f.gasPrice)&&void 0!==c?c:(0,l.decGWEIToHexWEI)(R.gasPrice);break;case E.GAS_ESTIMATE_TYPES.LEGACY:O.gasPrice=null!==(m=null===(p=t.txParams)||void 0===p?void 0:p.gasPrice)&&void 0!==m?m:(0,h.getAveragePriceEstimateInHexWEI)(e);case E.GAS_ESTIMATE_TYPES.FEE_MARKET:}const{txParams:{value:L="0x0"}={}}=t,U=(0,o.getValueFromWeiHex)({value:L,fromCurrency:A,toCurrency:_,conversionRate:S,numberOfDecimals:2}),F=(0,o.getValueFromWeiHex)({value:L,fromCurrency:A,toCurrency:A,conversionRate:S,numberOfDecimals:6}),x=(0,T.getMinimumGasTotalInHexWei)(O),B=(0,T.getMaximumGasTotalInHexWei)(O),G=(0,o.getTransactionFee)({value:x,fromCurrency:A,toCurrency:_,numberOfDecimals:2,conversionRate:S}),H=(0,o.getTransactionFee)({value:B,fromCurrency:A,toCurrency:_,numberOfDecimals:2,conversionRate:S}),W=(0,o.getTransactionFee)({value:x,fromCurrency:A,toCurrency:A,numberOfDecimals:6,conversionRate:S});return{hexTransactionAmount:L,fiatTransactionAmount:U,ethTransactionAmount:F,hexMinimumTransactionFee:x,fiatMinimumTransactionFee:G,hexMaximumTransactionFee:B,fiatMaximumTransactionFee:H,ethTransactionFee:W,fiatTransactionTotal:(0,o.addFiat)(G,U),ethTransactionTotal:(0,o.addEth)(W,F),hexTransactionTotal:(0,i.sumHexes)(L,x),gasEstimationObject:O}}}}},{package:"$root$"}],[6435,{".":6437,"../../app/scripts/lib/util":87,"../../shared/constants/gas":5398,"../../shared/lib/transactions-controller-utils":5417,"../../shared/modules/conversion.utils":5422,"../ducks/metamask/metamask":6025,"../ducks/send":6027,"../helpers/utils/confirm-tx.util":6052,"../helpers/utils/conversions.util":6053,"../helpers/utils/formatters":6055},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.basicPriceEstimateToETHTotal=p,n.getAverageEstimate=m,n.getAveragePriceEstimateInHexWEI=function(e){return _(m(e))},n.getBasicGasEstimateLoadingStatus=function(e){return!1===S(e)},n.getCustomGasLimit=function(e){return e.gas.customData.limit},n.getCustomGasPrice=T,n.getDefaultActiveButtonIndex=function(e,t,n){return e.map((({priceInHexWei:e})=>e)).lastIndexOf((0,a.addHexPrefix)(t||n))},n.getFastPriceEstimate=h,n.getFastPriceEstimateInHexWEI=function(e){return _(h(e)||"0x0")},n.getGasPriceInHexWei=_,n.getIsCustomNetworkGasPriceFetched=function(e){return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&!(0,E.getIsMainnet)(e)},n.getIsEthGasPriceFetched=function(e){return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&(0,E.getIsMainnet)(e)},n.getIsGasEstimatesFetched=S,n.getNoGasPriceFetched=function(e){return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.NONE},n.getRenderableConvertedCurrencyFee=function(e,t,n,a){const i=p((0,r.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"hex"}),t),c=(0,o.decEthToConvertedCurrency)(i,n,a);return(0,s.formatCurrency)(c,n)},n.getRenderableEthFee=function(e,t,n=9,a="ETH"){const s=p((0,r.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"hex"}),t,n);return(0,i.formatETHFee)(s,a)},n.getSafeLowEstimate=f,n.isCustomPriceExcessive=function(e,t=!1){const n=t?(0,c.getGasPrice)(e):T(e),a=h(e);if(!n||!a)return!1;return(0,r.conversionGreaterThan)({value:n,fromNumericBase:"hex",fromDenomination:"WEI",toDenomination:"GWEI"},{fromNumericBase:"dec",value:Math.floor(1.5*a)})},n.isCustomPriceSafe=function(e){const t=f(e),n=T(e);if(!n)return!0;if(!t)return!1;return(0,r.conversionGreaterThan)({value:n,fromNumericBase:"hex",fromDenomination:"WEI",toDenomination:"GWEI"},{value:t,fromNumericBase:"dec"})},n.isCustomPriceSafeForCustomNetwork=function(e){const t=m(e),n=T(e);if(!n)return!0;if(!t)return!1;return(0,r.conversionGreaterThan)({value:n,fromNumericBase:"hex",fromDenomination:"WEI",toDenomination:"GWEI"},{value:t,fromNumericBase:"dec"})},n.priceEstimateToWei=g;var a=e("../../app/scripts/lib/util"),r=e("../../shared/modules/conversion.utils"),s=e("../helpers/utils/confirm-tx.util"),o=e("../helpers/utils/conversions.util"),i=e("../helpers/utils/formatters"),c=e("../ducks/send"),u=e("../../shared/constants/gas"),d=e("../ducks/metamask/metamask"),l=e("../../shared/lib/transactions-controller-utils"),E=e(".");function T(e){return e.gas.customData.price}function f(e){const t=(0,d.getGasFeeEstimates)(e);return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.LEGACY?null==t?void 0:t.low:null}function m(e){const t=(0,d.getGasFeeEstimates)(e);return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.LEGACY?null==t?void 0:t.medium:null}function h(e){const t=(0,d.getGasFeeEstimates)(e);return(0,d.getGasEstimateType)(e)===u.GAS_ESTIMATE_TYPES.LEGACY?null==t?void 0:t.high:null}function p(e,t,n=9){return(0,r.conversionUtil)((0,l.calcGasTotal)(t,e),{fromNumericBase:"hex",toNumericBase:"dec",fromDenomination:"GWEI",numberOfDecimals:n})}function g(e){return(0,r.conversionUtil)(e,{fromNumericBase:"hex",toNumericBase:"hex",fromDenomination:"GWEI",toDenomination:"WEI",numberOfDecimals:9})}function _(e){const t=(0,r.conversionUtil)(e,{fromNumericBase:"dec",toNumericBase:"hex"});return(0,a.addHexPrefix)(g(t))}function S(e){const t=(0,d.getGasEstimateType)(e);return!(0,d.isEIP1559Network)(e)&&t!==u.GAS_ESTIMATE_TYPES.NONE}}}},{package:"$root$"}],[6436,{"../helpers/constants/routes":6037},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getFirstTimeFlowType=void 0,n.getFirstTimeFlowTypeRoute=function(e){const{firstTimeFlowType:t}=e.metamask;let n;n="create"===t?a.ONBOARDING_CREATE_PASSWORD_ROUTE:"import"===t?a.ONBOARDING_IMPORT_WITH_SRP_ROUTE:a.DEFAULT_ROUTE;return n},n.getOnboardingInitiator=void 0;var a=e("../helpers/constants/routes");n.getFirstTimeFlowType=e=>e.metamask.firstTimeFlowType;n.getOnboardingInitiator=e=>{const{onboardingTabs:t}=e.metamask;if(!t||1!==Object.keys(t).length)return null;const n=Object.keys(t)[0];return{location:n,tabId:t[n]}}}}},{package:"$root$"}],[6437,{"./confirm-transaction":6434,"./custom-gas":6435,"./first-time-flow":6436,"./metametrics":6438,"./permissions":6439,"./selectors":6440,"./transactions":6441},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=e("./confirm-transaction");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))}));var r=e("./custom-gas");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=e("./first-time-flow");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===s[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=e("./metametrics");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===o[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}}))}));var i=e("./permissions");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))}));var c=e("./selectors");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===c[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return c[e]}}))}));var u=e("./transactions");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===u[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}}))}))}}},{package:"$root$"}],[6438,{reselect:5074},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.selectMatchingFragment=n.selectFragments=n.selectFragmentBySuccessEvent=n.selectFragmentById=void 0;var a=e("reselect");const r=e=>e.metamask.fragments;n.selectFragments=r;const s=(0,a.createSelector)(r,((e,t)=>t),((e,t)=>t.persist?Object.values(e).find((e=>e.successEvent===t.successEvent)):undefined));n.selectFragmentBySuccessEvent=s;const o=(0,a.createSelector)(r,((e,t)=>t),((e,t)=>t&&null!=e&&e[t]?e[t]:undefined));n.selectFragmentById=o;const i=(0,a.createSelector)(((e,t)=>s(e,t.fragmentOptions)),((e,t)=>o(e,t.existingId)),((e,t)=>null!=t?t:e));n.selectMatchingFragment=i}}},{package:"$root$"}],[6439,{".":6437,"../../shared/constants/permissions":5404},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.activeTabHasPermissions=function(e){var t;const{activeTab:n,metamask:a}=e,{subjects:r={}}=a;return Boolean(Object.keys((null===(t=r[n.origin])||void 0===t?void 0:t.permissions)||{}).length>0)},n.getAccountToConnectToActiveTab=function(e){const t=(0,r.getSelectedAddress)(e),n=i(e),{metamask:{identities:a}}=e,s=Object.keys(a).length;if(n.length&&n.length!==s&&-1===n.findIndex((e=>e===t)))return a[t];return undefined},n.getAddressConnectedSubjectMap=function(e){const t=(0,r.getSubjectMetadata)(e),n=c(e),a={};return Object.keys(n).forEach((e=>{const{iconUrl:r,name:s}=t[e]||{};n[e].forEach((t=>{const n=s||e;a[t]=a[t]?{...a[t],[e]:{iconUrl:r,name:n}}:{[e]:{iconUrl:r,name:n}}}))})),a},n.getConnectedSubjectsForSelectedAddress=function(e){const{selectedAddress:t}=e.metamask,n=s(e),a=(0,r.getSubjectMetadata)(e),o=[];return Object.entries(n).forEach((([e,n])=>{if(!u(n).includes(t))return;const{extensionId:r,name:s,iconUrl:i}=a[e]||{};o.push({extensionId:r,origin:e,name:s,iconUrl:i})})),o},n.getFirstPermissionRequest=function(e){const t=E(e);return t&&t[0]?t[0]:null},n.getLastConnectedInfo=function(e){const{permissionHistory:t={}}=e.metamask;return Object.keys(t).reduce(((e,n)=>(t[n].eth_accounts&&(e[n]=JSON.parse(JSON.stringify(t[n].eth_accounts))),e)),{})},n.getOrderedConnectedAccountsForActiveTab=function(e){var t,n;const{activeTab:a,metamask:{permissionHistory:s}}=e,o=null===(t=s[a.origin])||void 0===t||null===(n=t.eth_accounts)||void 0===n?void 0:n.accounts,c=(0,r.getMetaMaskAccountsOrdered)(e),u=i(e);return c.filter((e=>u.includes(e.address))).map((e=>({...e,lastActive:null==o?void 0:o[e.address]}))).sort((({lastSelected:e},{lastSelected:t})=>e===t?0:e===undefined?1:t===undefined?-1:t-e))},n.getPermissionSubjects=s,n.getPermissions=function(e,t){var n;return null===(n=s(e)[t])||void 0===n?void 0:n.permissions},n.getPermissionsForActiveTab=function(e){var t,n;const{activeTab:a,metamask:r}=e,{subjects:s={}}=r,o=null!==(t=null===(n=s[a.origin])||void 0===n?void 0:n.permissions)&&void 0!==t?t:{};return Object.keys(o).map((e=>({key:e,value:o[e]})))},n.getPermissionsRequests=E,n.getPermittedAccounts=o,n.getPermittedAccountsByOrigin=c,n.getPermittedAccountsForCurrentTab=i,n.getSubjectsWithPermission=function(e,t){const n=s(e),a=[];return Object.entries(n).forEach((([n,{permissions:s}])=>{if(s[t]){const{extensionId:t,name:s,iconUrl:o}=(0,r.getTargetSubjectMetadata)(e,n)||{};a.push({extensionId:t,origin:n,name:s,iconUrl:o})}})),a};var a=e("../../shared/constants/permissions"),r=e(".");function s(e){return e.metamask.subjects||{}}function o(e,t){return l(d(function(e,t){var n;return t&&(null===(n=e.metamask.subjects)||void 0===n?void 0:n[t])}(e,t)))}function i(e){return o(e,(0,r.getOriginOfCurrentTab)(e))}function c(e){const t=s(e);return Object.keys(t).reduce(((e,n)=>{const a=u(t[n]);return a.length>0&&(e[n]=a),e}),{})}function u(e){return l(d(e))}function d(e={}){var t;return(null===(t=e.permissions)||void 0===t?void 0:t.eth_accounts)||{}}function l(e){const t=function(e={}){return Array.isArray(e.caveats)&&e.caveats.find((e=>e.type===a.CaveatTypes.restrictReturnedAccounts))}(e);return t&&Array.isArray(t.value)?t.value:[]}function E(e){return Object.values(e.metamask.pendingApprovals).filter((({type:e})=>"wallet_requestPermissions"===e)).map((({requestData:e})=>e))}}}},{package:"$root$"}],[6440,{"../../app/scripts/lib/util":87,"../../shared/constants/app":5397,"../../shared/constants/hardware-wallets":5399,"../../shared/constants/keyrings":5400,"../../shared/constants/labels":5401,"../../shared/constants/network":5403,"../../shared/constants/swaps":5407,"../../shared/constants/time":5408,"../../shared/constants/tokens":5409,"../../shared/constants/transaction":5410,"../../shared/lib/metamask-controller-utils":5413,"../../shared/modules/hexstring-utils":5425,"../../shared/modules/string-utils":5432,"../ducks/app/app":6017,"../ducks/metamask/metamask":6025,"../helpers/utils/conversions.util":6053,"../helpers/utils/moonpay":6063,"../helpers/utils/util":6071,"../pages/confirmation/templates":6166,lodash:4765,reselect:5074},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.accountsWithSendEtherInfoSelector=Y,n.checkNetworkAndAccountSupports1559=function(e){const t=(0,g.isEIP1559Network)(e);return t&&true},n.checkNetworkOrAccountNotSupports1559=function(e){const t=(0,g.isNotEIP1559Network)(e);return t||!1},n.deprecatedGetCurrentNetworkId=y,n.doesAddressRequireLedgerHidConnection=function(e,t){const n=(0,g.isAddressLedger)(e,t),a=(0,g.getLedgerTransportType)(e)===c.LEDGER_TRANSPORT_TYPES.WEBHID,r=(0,_.getLedgerWebHidConnectedStatus)(e)!==c.WEBHID_CONNECTED_STATUSES.CONNECTED,s=(0,_.getLedgerTransportStatus)(e)!==c.TRANSPORT_STATES.VERIFIED;return n&&a&&(r||s)},n.getAccountName=function(e,t){const n=Object.values(e).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))));return n&&""!==n.name?n.name:""},n.getAccountType=function(e){const t=O(e);switch(t&&t.type){case i.KEYRING_TYPES.TREZOR:case i.KEYRING_TYPES.LEDGER:case i.KEYRING_TYPES.LATTICE:return"hardware";case i.KEYRING_TYPES.IMPORTED:return"imported";default:return"default"}},n.getAccountsWithLabels=function(e){return F(e).map((({address:e,name:t,balance:n})=>({address:e,addressLabel:`${t.length<d.TRUNCATED_NAME_CHAR_LIMIT?t:`${t.slice(0,d.TRUNCATED_NAME_CHAR_LIMIT-1)}...`} (${(0,E.shortenAddress)(e)})`,label:t,balance:n})))},n.getAddressBook=H,n.getAddressBookEntry=W,n.getAddressBookEntryOrAccountName=function(e,t){const n=W(e,t)||Object.values(e.metamask.identities).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))));return n&&""!==n.name?n.name:t},n.getAdvancedGasFeeValues=function(e){return e.metamask.advancedGasFee},n.getAdvancedInlineGasShown=function(e){return Boolean(e.metamask.featureFlags.advancedInlineGas)},n.getAllAccountsOnNetworkAreEmpty=function(e){var t;const n=null!==(t=U(e))&&void 0!==t?t:{},a=Object.values(n).every((e=>"0x0"===e||"0x00"===e)),r=0===D(e);return a&&r},n.getAppIsLoading=function(e){return e.appState.isLoading},n.getBlockExplorerLinkText=function(e,t=!1){const n=fe(e),a=Z(e);let r={firstPart:"addBlockExplorer",secondPart:""};a.blockExplorerUrl?r=t?{firstPart:"blockExplorerView",secondPart:(0,E.getURLHostName)(a.blockExplorerUrl)}:{firstPart:"viewinExplorer",secondPart:"blockExplorerAccountAction"}:!1===n&&(r=t?{firstPart:"etherscanViewOn",secondPart:""}:{firstPart:"viewOnEtherscan",secondPart:"blockExplorerAccountAction"});return r},n.getCurrentAccountWithSendEtherInfo=j,n.getCurrentChainId=N,n.getCurrentCurrency=function(e){return e.metamask.currentCurrency},n.getCurrentEthBalance=K,n.getCurrentKeyring=O,n.getCurrentQRHardwareState=function(e){const{qrHardware:t}=e.metamask;return t||{}},n.getCustomNonceValue=function(e){return String(e.metamask.customNonceValue)},n.getCustomTokenAmount=function(e){return e.appState.customTokenAmount},n.getDetectedTokensInCurrentNetwork=function(e){return e.metamask.detectedTokens},n.getEIP1559V2Enabled=function(e){return e.metamask.eip1559V2Enabled},n.getEnsResolutionByAddress=function(e,t){if(e.metamask.ensResolutionsByAddress[t])return e.metamask.ensResolutionsByAddress[t];const n=W(e,t)||Object.values(e.metamask.identities).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))));return(null==n?void 0:n.name)||""},n.getFeatureFlags=function(e){return e.metamask.featureFlags},n.getFrequentRpcListDetail=function(e){return e.metamask.frequentRpcListDetail},n.getFullTxData=void 0,n.getGasIsLoading=function(e){return e.appState.gasIsLoading},n.getHardwareWalletType=function(e){const t=O(e);return C(e)?t.type:undefined},n.getInfuraBlocked=function(e){return Boolean(e.metamask.infuraBlocked)},n.getIpfsGateway=function(e){return e.metamask.ipfsGateway},n.getIsAdvancedGasFeeDefault=function(e){const{advancedGasFee:t}=e.metamask;return Boolean(null==t?void 0:t.maxBaseFee)&&Boolean(null==t?void 0:t.priorityFee)},n.getIsBuyableChain=function(e){const t=N(e);return Object.keys(o.BUYABLE_CHAINS_MAP).includes(t)},n.getIsBuyableCoinbasePayChain=function(e){var t;const n=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(t=o.BUYABLE_CHAINS_MAP[n])||void 0===t?void 0:t.coinbasePayCurrencies)},n.getIsBuyableCoinbasePayToken=function(e,t){var n,a;const r=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(n=o.BUYABLE_CHAINS_MAP[r])||void 0===n||null===(a=n.coinbasePayCurrencies)||void 0===a?void 0:a.includes(t))},n.getIsBuyableMoonPayChain=function(e){var t;const n=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(t=o.BUYABLE_CHAINS_MAP[n])||void 0===t?void 0:t.moonPay)},n.getIsBuyableMoonpayToken=function(e,t){var n,a,r;const s=N(e),i=(0,R.formatMoonpaySymbol)(t,s);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(n=o.BUYABLE_CHAINS_MAP[s])||void 0===n||null===(a=n.moonPay)||void 0===a||null===(r=a.showOnlyCurrencies)||void 0===r?void 0:r.includes(i))},n.getIsBuyableTransakChain=function(e){var t;const n=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(t=o.BUYABLE_CHAINS_MAP[n])||void 0===t?void 0:t.transakCurrencies)},n.getIsBuyableTransakToken=function(e,t){var n,a;const r=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(n=o.BUYABLE_CHAINS_MAP[r])||void 0===n||null===(a=n.transakCurrencies)||void 0===a?void 0:a.includes(t))},n.getIsBuyableWyreChain=function(e){var t;const n=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(t=o.BUYABLE_CHAINS_MAP[n])||void 0===t?void 0:t.wyre)},n.getIsBuyableWyreToken=function(e,t){var n,a;const r=N(e);return Boolean(null===o.BUYABLE_CHAINS_MAP||void 0===o.BUYABLE_CHAINS_MAP||null===(n=o.BUYABLE_CHAINS_MAP[r])||void 0===n||null===(a=n.wyre)||void 0===a?void 0:a.currencies.includes(t))},n.getIsCustomNetwork=fe,n.getIsDynamicTokenListAvailable=Ee,n.getIsImprovedTokenAllowanceEnabled=function(e){return e.metamask.improvedTokenAllowanceEnabled},n.getIsMainnet=q,n.getIsMultiLayerFeeNetwork=function(e){return le(e)},n.getIsNetworkUsed=function(e){const t=N(e),{usedNetworks:n}=e.metamask;return Boolean(n[t])},n.getIsNonStandardEthChain=function(e){return!(q(e)||X(e))},n.getIsOptimism=le,n.getIsSwapsChain=function(e){const t=N(e);return l.ALLOWED_PROD_SWAPS_CHAIN_IDS.includes(t)},n.getIsTestnet=X,n.getIsTokenDetectionInactiveOnMainnet=Te,n.getIsTokenDetectionSupported=function(e){const t=ce(e),n=Ee(e);return t&&n},n.getIsTransactionSecurityCheckEnabled=function(e){return e.metamask.transactionSecurityCheckEnabled},n.getIstokenDetectionInactiveOnNonMainnetSupportedNetwork=function(e){const t=ce(e),n=q(e);return Ee(e)&&!t&&!n},n.getKnownMethodData=function(e,t){if(!t)return null;const n=(0,s.addHexPrefix)(t).slice(0,10),{knownMethodData:a}=e.metamask;return a&&a[n]},n.getMetaMaskAccountsOrdered=n.getMetaMaskAccountsConnected=n.getMetaMaskAccounts=n.getMemoizedMetadataContractName=n.getMemoizedMetaMaskIdentities=n.getMemoizedAddressBook=void 0,n.getMetaMaskAccountsRaw=L,n.getMetaMaskCachedBalances=U,n.getMetaMaskIdentities=M,n.getMetaMaskKeyrings=b,n.getMetadataContractName=function(e,t){const n=ue(e),a=Object.values(n).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))));return a&&""!==a.name?a.name:""},n.getMetricsNetworkIdentifier=function(e){const{provider:t}=e.metamask;return t.type===o.NETWORK_TYPES.RPC?t.rpcUrl:t.type},n.getNativeCurrencyImage=function(e){var t;const n=null===(t=(0,g.getNativeCurrency)(e))||void 0===t?void 0:t.toUpperCase();return o.NATIVE_CURRENCY_TOKEN_IMAGE_MAP[n]},n.getNetworkIdentifier=function(e){const{metamask:{provider:{type:t,nickname:n,rpcUrl:a}}}=e;return n||a||t},n.getNetworkSupportsSettingGasFees=function(e){return!le(e)},n.getNetworksTabSelectedRpcUrl=function(e){return e.appState.networksTabSelectedRpcUrl},n.getNewCollectibleAddedMessage=function(e){return e.appState.newCollectibleAddedMessage},n.getNewNetworkAdded=function(e){return e.appState.newNetworkAdded},n.getNewTokensImported=function(e){return e.appState.newTokensImported},n.getNextSuggestedNonce=function(e){return Number(e.metamask.nextNonce)},n.getNumberOfAccounts=function(e){return Object.keys(e.metamask.accounts).length},n.getNumberOfTokens=D,n.getOpenSeaEnabled=function(e){return Boolean(e.metamask.openSeaEnabled)},n.getOriginOfCurrentTab=function(e){return e.activeTab.origin},n.getParticipateInMetaMetrics=function(e){return Boolean(e.metamask.participateInMetaMetrics)},n.getPreferences=z,n.getProvider=de,n.getRpcPrefsForCurrentProvider=Z,n.getSelectedAccount=G,n.getSelectedAccountCachedBalance=B,n.getSelectedAddress=P,n.getSelectedIdentity=w,n.getShouldHideZeroBalanceTokens=function(e){const{hideZeroBalanceTokens:t}=z(e);return t},n.getShouldShowFiat=function(e){const t=q(e),n=fe(e),a=(0,g.getConversionRate)(e),r=me(e),{showFiatInTestnets:s}=z(e);return Boolean((t||n||s)&&r&&a)},n.getShouldShowSeedPhraseReminder=function(e){var t;const{tokens:n,seedPhraseBackedUp:a,dismissSeedBackUpReminder:r}=e.metamask,s=null!==(t=K(e))&&void 0!==t?t:0;return!1===a&&(parseInt(s,16)>0||n.length>0)&&!1===r},n.getShowBetaHeader=function(e){return e.metamask.showBetaHeader},n.getShowPortfolioTooltip=function(e){return e.metamask.showPortfolioTooltip},n.getShowRecoveryPhraseReminder=function(e){const{recoveryPhraseReminderLastShown:t,recoveryPhraseReminderHasBeenShown:n}=e.metamask,a=(new Date).getTime(),r=n?90*p.DAY:2*p.DAY;return a-t>=r},n.getShowTestNetworks=function(e){const{showTestNetworks:t}=z(e);return Boolean(t)},n.getShowWhatsNewPopup=function(e){return e.appState.showWhatsNewPopup},n.getSortedAnnouncementsToShow=function(e){const t=Object.values(e.metamask.announcements),n=function(e){const t=O(e),n=(null==t?void 0:t.type)===i.KEYRING_TYPES.LEDGER,a=window.navigator.hid!==undefined,r=(0,g.getLedgerTransportType)(e)===c.LEDGER_TRANSPORT_TYPES.LIVE;return{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:a&&n&&r,9:!1,10:!1,11:!1,12:!1,13:!1,14:!1,15:!1,16:!0,17:!0}}(e),a=t.filter((e=>!e.isShown&&n[e.id]));return a.sort(((e,t)=>new Date(t.date)-new Date(e.date)))},n.getSubjectMetadata=Q,n.getSuggestedAssets=function(e){return e.metamask.suggestedAssets},n.getSwapsDefaultToken=function(e){const t=G(e),{balance:n}=t,a=N(e);return{...l.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[a],balance:(0,A.hexToDecimal)(n),string:(0,T.getValueFromWeiHex)({value:n,numberOfDecimals:4,toDenomination:"ETH"})}},n.getTargetAccount=function(e,t){return k(e)[t]},n.getTargetAccountWithSendEtherInfo=function(e,t){const n=Y(e);return(0,E.getAccountByAddress)(n,t)},n.getTargetSubjectMetadata=function(e,t){return Q(e)[t]},n.getTheme=function(e){return e.metamask.theme},n.getTokenExchangeRates=n.getTokenDetectionSupportNetworkByChainId=void 0,n.getTokenList=ue,n.getTotalUnapprovedCount=function(e){const{unapprovedMsgCount:t=0,unapprovedPersonalMsgCount:n=0,unapprovedDecryptMsgCount:a=0,unapprovedEncryptionPublicKeyMsgCount:r=0,unapprovedTypedMessagesCount:s=0,pendingApprovalCount:o=0}=e.metamask;return t+n+a+r+s+V(e)+o+function(e){const{suggestedAssets:t=[]}=e.metamask;return t.length}(e)},n.getTotalUnapprovedMessagesCount=function(e){const{unapprovedMsgCount:t=0,unapprovedPersonalMsgCount:n=0,unapprovedDecryptMsgCount:a=0,unapprovedEncryptionPublicKeyMsgCount:r=0,unapprovedTypedMessagesCount:s=0}=e.metamask;return t+n+a+r+s},n.getTxData=n.getTransaction=void 0,n.getUSDConversionRate=function(e){return e.metamask.usdConversionRate},n.getUnapprovedConfirmations=$,n.getUnapprovedTemplatedConfirmations=function(e){return $(e).filter((e=>f.TEMPLATED_CONFIRMATION_MESSAGE_TYPES.includes(e.type)))},n.getUnapprovedTransactions=n.getUnapprovedTransaction=void 0,n.getUnapprovedTxCount=V,n.getUseCurrencyRateCheck=me,n.getUseNftDetection=function(e){return Boolean(e.metamask.useNftDetection)},n.getUseNonceField=function(e){return Boolean(e.metamask.useNonceField)},n.getUseTokenDetection=ce,n.getWeb3ShimUsageStateForOrigin=function(e,t){return e.metamask.web3ShimUsageOrigins[t]},n.hasUnsignedQRHardwareMessage=function(e){const{type:t,msgParams:n}=e.confirmTransaction.txData;if(!t||!n)return!1;const{from:a}=n,{keyrings:r}=e.metamask,s=r.find((e=>e.type===i.KEYRING_TYPES.QR));if(!s)return!1;switch(t){case u.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA:case u.MESSAGE_TYPE.ETH_SIGN:case u.MESSAGE_TYPE.PERSONAL_SIGN:return Boolean(s.accounts.find((e=>e.toLowerCase()===a.toLowerCase())));default:return!1}},n.hasUnsignedQRHardwareTransaction=function(e){const{txParams:t}=e.confirmTransaction.txData;if(!t)return!1;const{from:n}=t,{keyrings:a}=e.metamask,r=a.find((e=>e.type===i.KEYRING_TYPES.QR));if(!r)return!1;return Boolean(r.accounts.find((e=>e.toLowerCase()===n.toLowerCase())))},n.isBalanceCached=function(e){const t=e.metamask.accounts[P(e)].balance,n=B(e);return Boolean(!t&&n)},n.isCurrentProviderCustom=function(e){const t=de(e);return t.type===o.NETWORK_TYPES.RPC&&!Object.values(o.CHAIN_IDS).includes(t.chainId)},n.isEIP1559Account=v,n.isHardwareWallet=C,n.isNetworkLoading=function(e){return"loading"===e.metamask.network};var a=e("reselect"),r=e("lodash"),s=e("../../app/scripts/lib/util"),o=e("../../shared/constants/network"),i=e("../../shared/constants/keyrings"),c=e("../../shared/constants/hardware-wallets"),u=e("../../shared/constants/app"),d=e("../../shared/constants/labels"),l=e("../../shared/constants/swaps"),E=e("../helpers/utils/util"),T=e("../helpers/utils/conversions.util"),f=e("../pages/confirmation/templates"),m=e("../../shared/constants/tokens"),h=e("../../shared/modules/hexstring-utils"),p=e("../../shared/constants/time"),g=e("../ducks/metamask/metamask"),_=e("../ducks/app/app"),S=e("../../shared/modules/string-utils"),A=e("../../shared/lib/metamask-controller-utils"),R=e("../helpers/utils/moonpay"),I=e("../../shared/constants/transaction");function N(e){const{chainId:t}=e.metamask.provider;return t}function O(e){const t=w(e);if(!t)return null;return(0,g.findKeyringForAddress)(e,t.address)}function v(){return!0}function C(e){var t;const n=O(e);return Boolean(null==n||null===(t=n.type)||void 0===t?void 0:t.includes("Hardware"))}function y(e){return e.metamask.network}const k=(0,a.createSelector)(L,U,((e,t)=>Object.entries(e).reduce(((e,[n,a])=>null===a.balance||a.balance===undefined?{...e,[n]:{...a,balance:t&&t[n]}}:{...e,[n]:a}),{})));function P(e){return e.metamask.selectedAddress}function w(e){const t=P(e),{identities:n}=e.metamask;return n[t]}function D(e){const{tokens:t}=e.metamask;return t?t.length:0}function b(e){return e.metamask.keyrings}function M(e){return e.metamask.identities}function L(e){return e.metamask.accounts}function U(e){var t;const n=N(e),a=y(e);return null!==(t=e.metamask.cachedBalances[n])&&void 0!==t?t:e.metamask.cachedBalances[a]}n.getMetaMaskAccounts=k;const F=(0,a.createSelector)(b,M,k,((e,t,n)=>e.reduce(((e,t)=>e.concat(t.accounts)),[]).filter((e=>Boolean(t[e]))).map((e=>({...t[e],...n[e]})))));n.getMetaMaskAccountsOrdered=F;const x=(0,a.createSelector)(F,(e=>e.map((({address:e})=>e.toLowerCase()))));function B(e){const t=U(e),n=P(e);return t&&t[n]}function G(e){return k(e)[P(e)]}n.getMetaMaskAccountsConnected=x;function H(e){const t=N(e);return e.metamask.addressBook[t]?Object.values(e.metamask.addressBook[t]):[]}function W(e,t){return H(e).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))))}function Y(e){const t=k(e),n=M(e);return Object.entries(n).map((([e,n])=>({...n,...t[e]})))}function j(e){const t=P(e),n=Y(e);return(0,E.getAccountByAddress)(n,t)}function K(e){var t;return null===(t=j(e))||void 0===t?void 0:t.balance}function V(e){const{unapprovedTxs:t={}}=e.metamask;return Object.keys(t).length}function $(e){const{pendingApprovals:t}=e.metamask;return Object.values(t)}function q(e){return N(e)===o.CHAIN_IDS.MAINNET}function X(e){const t=N(e);return o.TEST_CHAINS.includes(t)}function z({metamask:e}){return e.preferences}function Q(e){return e.metamask.subjectMetadata}function Z(e){const{frequentRpcListDetail:t,provider:n}=e.metamask,a=t.find((e=>e.rpcUrl===n.rpcUrl)),{rpcPrefs:r={}}=a||{};return r}n.getTokenExchangeRates=e=>e.metamask.contractExchangeRates;const J=(0,a.createSelectorCreator)(a.defaultMemoize,r.isEqual),ee=J(M,(e=>e));n.getMemoizedMetaMaskIdentities=ee;const te=J(H,(e=>e));n.getMemoizedAddressBook=te;const ne=J(ue,((e,t)=>t),((e,t)=>{const n=Object.values(e).find((e=>(0,S.isEqualCaseInsensitive)(e.address,(0,h.toChecksumHexAddress)(t))));return n&&""!==n.name?n.name:""}));n.getMemoizedMetadataContractName=ne;const ae=e=>e.metamask.unapprovedTxs;n.getUnapprovedTransactions=ae;const re=e=>e.confirmTransaction.txData;n.getTxData=re;const se=J(ae,((e,t)=>t),((e,t)=>Object.values(e).find((({id:e})=>e===t))||{}));n.getUnapprovedTransaction=se;const oe=J((e=>e.metamask.currentNetworkTxList),((e,t)=>t),((e,t)=>Object.values(e).find((({id:e})=>e===t))||{}));n.getTransaction=oe;const ie=J(re,((e,t,n)=>n===I.TRANSACTION_STATUSES.UNAPPROVED?se(e,t):oe(e,t)),((e,t,n,a)=>a),((e,t,n)=>{let a={...e,...t};return t&&t.simulationFails&&(e.simulationFails=t.simulationFails),n&&(a={...a,txParams:{...a.txParams,data:n}}),a}));function ce(e){return Boolean(e.metamask.useTokenDetection)}function ue(e){return Te(e)?m.STATIC_MAINNET_TOKEN_LIST:e.metamask.tokenList}function de(e){return e.metamask.provider}function le(e){return N(e)===o.CHAIN_IDS.OPTIMISM||N(e)===o.CHAIN_IDS.OPTIMISM_TESTNET}n.getFullTxData=ie;function Ee(e){const t=N(e);return[o.CHAIN_IDS.MAINNET,o.CHAIN_IDS.BSC,o.CHAIN_IDS.POLYGON,o.CHAIN_IDS.AVALANCHE].includes(t)}function Te(e){const t=q(e);return!ce(e)&&t}function fe(e){const t=N(e);return!o.CHAIN_ID_TO_RPC_URL_MAP[t]}function me(e){return Boolean(e.metamask.useCurrencyRateCheck)}n.getTokenDetectionSupportNetworkByChainId=e=>{switch(N(e)){case o.CHAIN_IDS.MAINNET:return o.MAINNET_DISPLAY_NAME;case o.CHAIN_IDS.BSC:return o.BSC_DISPLAY_NAME;case o.CHAIN_IDS.POLYGON:return o.POLYGON_DISPLAY_NAME;case o.CHAIN_IDS.AVALANCHE:return o.AVALANCHE_DISPLAY_NAME;default:return""}}}}},{package:"$root$"}],[6441,{"../../shared/constants/transaction":5410,"../../shared/lib/metamask-controller-utils":5413,"../../shared/modules/transaction.utils":5434,"../helpers/constants/transactions":6039,"../helpers/utils/tx-helper":6070,"./selectors":6440,reselect:5074},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unapprovedTypedMessagesSelector=n.unapprovedPersonalMsgsSelector=n.unapprovedMsgsSelector=n.unapprovedMessagesSelector=n.unapprovedEncryptionPublicKeyMsgsSelector=n.unapprovedDecryptMsgsSelector=n.transactionsSelector=n.transactionSubSelector=n.submittedPendingTransactionsSelector=n.smartTransactionsListSelector=n.selectedAddressTxListSelector=n.nonceSortedTransactionsSelector=n.nonceSortedPendingTransactionsSelector=n.nonceSortedCompletedTransactionsSelector=n.incomingTxListSelector=n.currentNetworkTxListSelector=void 0;var a,r=e("reselect"),s=e("../helpers/constants/transactions"),o=(a=e("../helpers/utils/tx-helper"))&&a.__esModule?a:{default:a},i=e("../../shared/constants/transaction"),c=e("../../shared/modules/transaction.utils"),u=e("../../shared/lib/metamask-controller-utils"),d=e("./selectors");const l=[i.TRANSACTION_TYPES.CANCEL,i.TRANSACTION_TYPES.RETRY],E=e=>{const{showIncomingTransactions:t}=e.metamask.featureFlags;if(!t)return[];const{network:n,provider:{chainId:a}}=e.metamask,r=(0,d.getSelectedAddress)(e);return Object.values(e.metamask.incomingTransactions).filter((e=>e.txParams.to===r&&(0,c.transactionMatchesNetwork)(e,a,n)))};n.incomingTxListSelector=E;const T=e=>e.metamask.unapprovedMsgs;n.unapprovedMsgsSelector=T;const f=e=>e.metamask.currentNetworkTxList;n.currentNetworkTxListSelector=f;const m=e=>e.metamask.unapprovedPersonalMsgs;n.unapprovedPersonalMsgsSelector=m;const h=e=>e.metamask.unapprovedDecryptMsgs;n.unapprovedDecryptMsgsSelector=h;const p=e=>e.metamask.unapprovedEncryptionPublicKeyMsgs;n.unapprovedEncryptionPublicKeyMsgsSelector=p;const g=e=>e.metamask.unapprovedTypedMessages;n.unapprovedTypedMessagesSelector=g;const _=e=>{var t,n,a;return null===(t=e.metamask.smartTransactionsState)||void 0===t||null===(n=t.smartTransactions)||void 0===n||null===(a=n[(0,d.getCurrentChainId)(e)])||void 0===a?void 0:a.filter((e=>!e.confirmed)).map((e=>{var t;return{...e,transactionType:i.TRANSACTION_TYPES.SMART,status:null!==(t=e.status)&&void 0!==t&&t.startsWith("cancelled")?i.SMART_TRANSACTION_STATUSES.CANCELLED:e.status}}))};n.smartTransactionsListSelector=_;const S=(0,r.createSelector)(d.getSelectedAddress,f,_,((e,t=[],n=[])=>t.filter((({txParams:t})=>t.from===e)).concat(n)));n.selectedAddressTxListSelector=S;const A=(0,r.createSelector)(T,m,h,p,g,d.deprecatedGetCurrentNetworkId,d.getCurrentChainId,((e={},t={},n={},a={},r={},s,i)=>(0,o.default)({},e,t,n,a,r,s,i)||[]));n.unapprovedMessagesSelector=A;const R=(0,r.createSelector)(A,E,((e=[],t=[])=>e.concat(t)));n.transactionSubSelector=R;const I=(0,r.createSelector)(R,S,((e=[],t=[])=>t.concat(e).sort(((e,t)=>t.time-e.time))));n.transactionsSelector=I;const N=(e,t)=>{const{primaryTransaction:{time:n}={}}=t;let a=e.length;for(let t=0;t<e.length;t++){const r=e[t],{primaryTransaction:{time:s}={}}=r;if(s>n){a=t;break}}e.splice(a,0,t)},O=(0,r.createSelector)(I,((e=[])=>{const t=[],n=[],a=[],r={};e.forEach((e=>{const{txParams:{nonce:o}={},status:c,type:d,time:E,txReceipt:T}=e;if(void 0===o||d===i.TRANSACTION_TYPES.INCOMING){const a={transactions:[e],initialTransaction:e,primaryTransaction:e,hasRetried:!1,hasCancelled:!1,nonce:o};d===i.TRANSACTION_TYPES.INCOMING?n.push(a):N(t,a)}else if(o in r){var f,m,h;const t=r[o];((e,t)=>{const{time:n}=t;let a=e.length;for(let t=0;t<e.length;t++)if(e[t].time>n){a=t;break}e.splice(a,0,t)})(t.transactions,e);const{primaryTransaction:{time:n=0}={},initialTransaction:{time:a=0}={}}=t,u={isOnChainFailure:"0x0"===(null==T?void 0:T.status),isEphemeral:c===i.TRANSACTION_STATUSES.FAILED&&"0x0"!==(null==T?void 0:T.status),isRetryOrCancel:l.includes(d),occurredAfterPrimary:E>n,hasPriorityStatus:c in s.PRIORITY_STATUS_HASH,isConfirmed:c===i.TRANSACTION_STATUSES.CONFIRMED,occurredBeforeInitial:E<a,isValidRetry:d===i.TRANSACTION_TYPES.RETRY&&(c in s.PRIORITY_STATUS_HASH||c===i.TRANSACTION_STATUSES.DROPPED),isValidCancel:d===i.TRANSACTION_TYPES.CANCEL&&(c in s.PRIORITY_STATUS_HASH||c===i.TRANSACTION_STATUSES.DROPPED)};u.eligibleForInitial=!u.isRetryOrCancel&&!u.isEphemeral,u.shouldBePrimary=u.isConfirmed||u.isOnChainFailure;const p={isEphemeral:t.primaryTransaction.status===i.TRANSACTION_STATUSES.FAILED&&"0x0"!==(null===(f=t.primaryTransaction)||void 0===f||null===(m=f.txReceipt)||void 0===m?void 0:m.status)},g={isEphemeral:t.initialTransaction.status===i.TRANSACTION_STATUSES.FAILED&&"0x0"!==(null===(h=t.initialTransaction.txReceipt)||void 0===h?void 0:h.status)};(u.shouldBePrimary||p.isEphemeral||u.occurredAfterPrimary&&u.hasPriorityStatus)&&(t.primaryTransaction=e),(u.occurredBeforeInitial&&u.eligibleForInitial||g.isEphemeral&&u.eligibleForInitial)&&(t.initialTransaction=e),u.isValidRetry&&(t.hasRetried=!0),u.isValidCancel&&(t.hasCancelled=!0)}else r[o]={nonce:o,transactions:[e],initialTransaction:e,primaryTransaction:e,hasRetried:e.type===i.TRANSACTION_TYPES.RETRY&&(e.status in s.PRIORITY_STATUS_HASH||e.status===i.TRANSACTION_STATUSES.DROPPED),hasCancelled:e.type===i.TRANSACTION_TYPES.CANCEL&&(e.status in s.PRIORITY_STATUS_HASH||e.status===i.TRANSACTION_STATUSES.DROPPED)},((e,t)=>{let n=e.length;for(let a=0;a<e.length;a++){const r=e[a];if(Number((0,u.hexToDecimal)(r))>Number((0,u.hexToDecimal)(t))){n=a;break}}e.splice(n,0,t)})(a,o)}));const o=a.map((e=>r[e]));return((e,t)=>{t.forEach((t=>{N(e,t)}))})(o,n),t.concat(o).map((e=>{var t;if(l.includes(null===(t=e.initialTransaction)||void 0===t?void 0:t.type)){const t=e.transactions.find((e=>!l.includes(e.type)));if(t)return{...e,initialTransaction:t}}return e}))}));n.nonceSortedTransactionsSelector=O;const v=(0,r.createSelector)(O,((e=[])=>e.filter((({primaryTransaction:e})=>e.status in s.PENDING_STATUS_HASH))));n.nonceSortedPendingTransactionsSelector=v;const C=(0,r.createSelector)(O,((e=[])=>e.filter((({primaryTransaction:e})=>!(e.status in s.PENDING_STATUS_HASH))).reverse()));n.nonceSortedCompletedTransactionsSelector=C;const y=(0,r.createSelector)(I,((e=[])=>e.filter((e=>e.status===i.TRANSACTION_STATUSES.SUBMITTED))));n.submittedPendingTransactionsSelector=y}}},{package:"$root$"}],[6442,{"../../../shared/modules/mv3.utils":5426,pify:4865},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n._setBackgroundConnection=async function(e){o=e,i=(0,r.default)(o),s.isManifestV3&&(E&&console.warn("_setBackgroundConnection called while a queue was processing and not disconnected yet"),async function(){if(E)return;E=!0;try{for(;o.connectionStream.readable&&c.length>0;){const e=c.shift();await l({action:e,disconnectSideeffect:()=>c.unshift(e)})}}catch(e){console.error(e)}E=!1}())},n.callBackgroundMethod=void 0,n.dropQueue=function(e){e||c.forEach((({reject:e})=>e(Error("Background operation cancelled while waiting for connection."))));c.length=0},n.generateActionId=void 0,n.submitRequestToBackground=function(e,t=[],n=u()){if(s.isManifestV3)return new Promise(((a,r)=>{d({actionId:n,request:{method:e,args:t},resolve:a,reject:r})}));return i[e](...t)};var a,r=(a=e("pify"))&&a.__esModule?a:{default:a},s=e("../../../shared/modules/mv3.utils");let o=null,i=null;const c=[],u=()=>Date.now()+Math.random();n.generateActionId=u;const d=e=>{c.some((t=>t.actionId===e.actionId))||(o.connectionStream.readable?l({action:e,disconnectSideeffect:()=>c.push(e)}):c.push(e))};async function l({action:e,disconnectSideeffect:t}){const{request:{method:n,args:a},resolve:r,reject:s}=e;try{r(await i[n](...a))}catch(n){o.DisconnectError&&n instanceof o.DisconnectError?t(e):s(n)}}n.callBackgroundMethod=(e,t=[],n,a=u())=>{if(s.isManifestV3){d({actionId:a,request:{method:e,args:t},resolve:e=>n(null,e),reject:e=>n(e)})}else o[e](...t,n)};let E=!1}}},{package:"$root$"}],[6443,{},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UPDATE_TRANSACTION_PARAMS=n.UPDATE_PREFERENCES=n.UPDATE_METAMASK_STATE=n.UPDATE_FEATURE_FLAGS=n.UPDATE_CUSTOM_NONCE=n.UNLOCK_SUCCEEDED=n.UNLOCK_IN_PROGRESS=n.UNLOCK_FAILED=n.TRANSACTION_ERROR=n.TOGGLE_GAS_LOADING_ANIMATION=n.TOGGLE_CURRENCY_INPUT_SWITCH=n.TOGGLE_ACCOUNT_MENU=n.SHOW_SEND_TOKEN_PAGE=n.SHOW_PRIVATE_KEY=n.SHOW_LOADING=n.SHOW_CONF_TX_PAGE=n.SHOW_ACCOUNT_DETAIL=n.SHOW_ACCOUNTS_PAGE=n.SET_WEBHID_CONNECTED_STATUS=n.SET_USE_NONCEFIELD=n.SET_USE_BLOCKIE=n.SET_SMART_TRANSACTIONS_ERROR=n.SET_SELECTED_SETTINGS_RPC_URL=n.SET_RPC_TARGET=n.SET_REQUEST_ACCOUNT_TABS=n.SET_PROVIDER_TYPE=n.SET_PENDING_TOKENS=n.SET_PARTICIPATE_IN_METAMETRICS=n.SET_OPEN_METAMASK_TAB_IDS=n.SET_NEXT_NONCE=n.SET_NEW_TOKENS_IMPORTED=n.SET_NEW_NETWORK_ADDED=n.SET_NEW_CUSTOM_NETWORK_ADDED=n.SET_NEW_COLLECTIBLE_ADDED_MESSAGE=n.SET_MOUSE_USER_STATE=n.SET_LEDGER_TRANSPORT_STATUS=n.SET_IPFS_GATEWAY=n.SET_HARDWARE_WALLET_DEFAULT_HD_PATH=n.SET_FIRST_TIME_FLOW_TYPE=n.SET_CUSTOM_TOKEN_AMOUNT=n.SET_CURRENT_WINDOW_TAB=n.SET_CURRENT_LOCALE=n.SET_ACCOUNT_LABEL=n.SELECTED_ADDRESS_CHANGED=n.SELECTED_ACCOUNT_CHANGED=n.QR_CODE_DETECTED=n.PORTFOLIO_TOOLTIP_WAS_SHOWN_IN_THIS_SESSION=n.ONBOARDED_IN_THIS_UI_SESSION=n.NETWORK_DROPDOWN_OPEN=n.NETWORK_DROPDOWN_CLOSE=n.MODAL_OPEN=n.MODAL_CLOSE=n.LOCK_METAMASK=n.LOADING_TOKEN_PARAMS_STARTED=n.LOADING_TOKEN_PARAMS_FINISHED=n.LOADING_METHOD_DATA_STARTED=n.LOADING_METHOD_DATA_FINISHED=n.HIDE_WHATS_NEW_POPUP=n.HIDE_WARNING=n.HIDE_LOADING=n.GO_HOME=n.GAS_FEE_ESTIMATES_UPDATED=n.FORGOT_PASSWORD=n.DISPLAY_WARNING=n.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE=n.COMPLETE_ONBOARDING=n.COMPLETED_TX=n.CLOSE_WELCOME_SCREEN=n.CLEAR_PENDING_TOKENS=n.CLEAR_ACCOUNT_DETAILS=n.CHAIN_CHANGED=n.CAPTURE_SINGLE_EXCEPTION=n.BUY=n.ALERT_OPEN=n.ALERT_CLOSE=n.ADDRESS_BOOK_UPDATED=n.ACCOUNT_CHANGED=void 0;n.GO_HOME="GO_HOME";n.MODAL_OPEN="UI_MODAL_OPEN";n.MODAL_CLOSE="UI_MODAL_CLOSE";n.ALERT_OPEN="UI_ALERT_OPEN";n.ALERT_CLOSE="UI_ALERT_CLOSE";n.QR_CODE_DETECTED="UI_QR_CODE_DETECTED";n.NETWORK_DROPDOWN_OPEN="UI_NETWORK_DROPDOWN_OPEN";n.NETWORK_DROPDOWN_CLOSE="UI_NETWORK_DROPDOWN_CLOSE";n.UPDATE_METAMASK_STATE="UPDATE_METAMASK_STATE";n.SELECTED_ADDRESS_CHANGED="SELECTED_ADDRESS_CHANGED";n.SELECTED_ACCOUNT_CHANGED="SELECTED_ACCOUNT_CHANGED";n.ACCOUNT_CHANGED="ACCOUNT_CHANGED";n.CHAIN_CHANGED="CHAIN_CHANGED";n.ADDRESS_BOOK_UPDATED="ADDRESS_BOOK_UPDATED";n.GAS_FEE_ESTIMATES_UPDATED="GAS_FEE_ESTIMATES_UPDATED";n.FORGOT_PASSWORD="FORGOT_PASSWORD";n.CLOSE_WELCOME_SCREEN="CLOSE_WELCOME_SCREEN";n.UNLOCK_IN_PROGRESS="UNLOCK_IN_PROGRESS";n.UNLOCK_FAILED="UNLOCK_FAILED";n.UNLOCK_SUCCEEDED="UNLOCK_SUCCEEDED";n.LOCK_METAMASK="LOCK_METAMASK";n.DISPLAY_WARNING="DISPLAY_WARNING";n.HIDE_WARNING="HIDE_WARNING";n.CAPTURE_SINGLE_EXCEPTION="CAPTURE_SINGLE_EXCEPTION";n.SHOW_ACCOUNT_DETAIL="SHOW_ACCOUNT_DETAIL";n.SHOW_ACCOUNTS_PAGE="SHOW_ACCOUNTS_PAGE";n.SHOW_CONF_TX_PAGE="SHOW_CONF_TX_PAGE";n.SHOW_SEND_TOKEN_PAGE="SHOW_SEND_TOKEN_PAGE";n.SHOW_PRIVATE_KEY="SHOW_PRIVATE_KEY";n.SET_ACCOUNT_LABEL="SET_ACCOUNT_LABEL";n.CLEAR_ACCOUNT_DETAILS="CLEAR_ACCOUNT_DETAILS";n.COMPLETED_TX="COMPLETED_TX";n.TRANSACTION_ERROR="TRANSACTION_ERROR";n.UPDATE_TRANSACTION_PARAMS="UPDATE_TRANSACTION_PARAMS";n.SET_NEXT_NONCE="SET_NEXT_NONCE";n.SET_RPC_TARGET="SET_RPC_TARGET";n.SET_PROVIDER_TYPE="SET_PROVIDER_TYPE";n.SET_HARDWARE_WALLET_DEFAULT_HD_PATH="SET_HARDWARE_WALLET_DEFAULT_HD_PATH";n.SHOW_LOADING="SHOW_LOADING_INDICATION";n.HIDE_LOADING="HIDE_LOADING_INDICATION";n.BUY="BUY";n.TOGGLE_ACCOUNT_MENU="TOGGLE_ACCOUNT_MENU";n.SET_USE_BLOCKIE="SET_USE_BLOCKIE";n.SET_USE_NONCEFIELD="SET_USE_NONCEFIELD";n.UPDATE_CUSTOM_NONCE="UPDATE_CUSTOM_NONCE";n.SET_IPFS_GATEWAY="SET_IPFS_GATEWAY";n.SET_PARTICIPATE_IN_METAMETRICS="SET_PARTICIPATE_IN_METAMETRICS";n.SET_CURRENT_LOCALE="SET_CURRENT_LOCALE";n.UPDATE_FEATURE_FLAGS="UPDATE_FEATURE_FLAGS";n.UPDATE_PREFERENCES="UPDATE_PREFERENCES";n.COMPLETE_ONBOARDING="COMPLETE_ONBOARDING";n.ONBOARDED_IN_THIS_UI_SESSION="ONBOARDED_IN_THIS_UI_SESSION";n.SET_MOUSE_USER_STATE="SET_MOUSE_USER_STATE";n.SET_WEBHID_CONNECTED_STATUS="SET_WEBHID_CONNECTED_STATUS";n.SET_LEDGER_TRANSPORT_STATUS="SET_LEDGER_TRANSPORT_STATUS";n.SET_PENDING_TOKENS="SET_PENDING_TOKENS";n.CLEAR_PENDING_TOKENS="CLEAR_PENDING_TOKENS";n.SET_FIRST_TIME_FLOW_TYPE="SET_FIRST_TIME_FLOW_TYPE";n.SET_SELECTED_SETTINGS_RPC_URL="SET_SELECTED_SETTINGS_RPC_URL";n.SET_NEW_NETWORK_ADDED="SET_NEW_NETWORK_ADDED";n.SET_NEW_COLLECTIBLE_ADDED_MESSAGE="SET_NEW_COLLECTIBLE_ADDED_MESSAGE";n.SET_NEW_CUSTOM_NETWORK_ADDED="SET_NEW_CUSTOM_NETWORK_ADDED";n.LOADING_METHOD_DATA_STARTED="LOADING_METHOD_DATA_STARTED";n.LOADING_METHOD_DATA_FINISHED="LOADING_METHOD_DATA_FINISHED";n.LOADING_TOKEN_PARAMS_STARTED="LOADING_TOKEN_PARAMS_STARTED";n.LOADING_TOKEN_PARAMS_FINISHED="LOADING_TOKEN_PARAMS_FINISHED";n.SET_REQUEST_ACCOUNT_TABS="SET_REQUEST_ACCOUNT_TABS";n.SET_CURRENT_WINDOW_TAB="SET_CURRENT_WINDOW_TAB";n.SET_OPEN_METAMASK_TAB_IDS="SET_OPEN_METAMASK_TAB_IDS";n.HIDE_WHATS_NEW_POPUP="HIDE_WHATS_NEW_POPUP";n.PORTFOLIO_TOOLTIP_WAS_SHOWN_IN_THIS_SESSION="PORTFOLIO_TOOLTIP_WAS_SHOWN_IN_THIS_SESSION";n.TOGGLE_GAS_LOADING_ANIMATION="TOGGLE_GAS_LOADING_ANIMATION";n.SET_SMART_TRANSACTIONS_ERROR="SET_SMART_TRANSACTIONS_ERROR";n.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE="DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE";n.TOGGLE_CURRENCY_INPUT_SWITCH="TOGGLE_CURRENCY_INPUT_SWITCH";n.SET_NEW_TOKENS_IMPORTED="SET_NEW_TOKENS_IMPORTED";n.SET_CUSTOM_TOKEN_AMOUNT="SET_CUSTOM_TOKEN_AMOUNT"}}},{package:"$root$"}],[6444,{"../../app/scripts/lib/buy-url":43,"../../app/scripts/lib/util":87,"../../shared/constants/app":5397,"../../shared/constants/hardware-wallets":5399,"../../shared/constants/metametrics":5402,"../../shared/lib/switch-direction":5416,"../../shared/lib/transactions-controller-utils":5417,"../../shared/modules/hexstring-utils":5425,"../../shared/modules/string-utils":5432,"../ducks/alerts/unconnected-account":6016,"../ducks/app/app":6017,"../ducks/metamask/metamask":6025,"../ducks/send":6027,"../helpers/utils/confirm-tx.util":6052,"../helpers/utils/i18n-helper":6058,"../helpers/utils/transactions.util":6069,"../helpers/utils/tx-helper":6070,"../pages/swaps/swaps.util":6422,"../selectors":6437,"./action-queue":6442,"./actionConstants":6443,"@sentry/browser":1293,buffer:1797,lodash:4765,loglevel:4778},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.acceptWatchAsset=function(e){return async t=>{t(Z());try{await(0,v.submitRequestToBackground)("acceptWatchAsset",[e]),await oe(t)}catch(e){return a.default.error(e),void t(ee(e.message))}finally{t(J())}t(Q())}},n.addCustomNetwork=function(e){return async t=>{try{t((0,R.setNewCustomNetworkAdded)(e)),await(0,v.submitRequestToBackground)("addCustomNetwork",[e,(0,v.generateActionId)()])}catch(e){a.default.error(e),t(ee("Had a problem changing networks!"))}}},n.addDetectedTokens=function(e){return async t=>{try{await(0,v.submitRequestToBackground)("addDetectedTokens",[e])}catch(e){a.default.error(e)}finally{await oe(t)}}},n.addImportedTokens=function(e){return async t=>{try{await(0,v.submitRequestToBackground)("addImportedTokens",[e])}catch(e){a.default.error(e)}finally{await oe(t)}}},n.addNewAccount=function(){return a.default.debug("background.addNewAccount"),async(e,t)=>{const n=t().metamask.identities;let a;e(Z());try{const{identities:t}=await(0,v.submitRequestToBackground)("addNewAccount",[Object.keys(n).length]);a=t}catch(t){throw e(ee(t.message)),t}finally{e(J())}const r=Object.keys(a).find((e=>!n[e]));return await oe(e),r}},n.addNft=function(e,t,n){return async r=>{if(!e)throw new Error("MetaMask - Cannot add collectible without address");if(!t)throw new Error("MetaMask - Cannot add collectible without tokenID");n||r(Z());try{await(0,v.submitRequestToBackground)("addNft",[e,t])}catch(e){a.default.error(e),r(ee(e.message))}finally{await oe(r),r(J())}}},n.addNftVerifyOwnership=function(e,t,n){return async r=>{if(!e)throw new Error("MetaMask - Cannot add collectible without address");if(!t)throw new Error("MetaMask - Cannot add collectible without tokenID");n||r(Z());try{await(0,v.submitRequestToBackground)("addNftVerifyOwnership",[e,t])}catch(e){if(e.message.includes("This collectible is not owned by the user")||e.message.includes("Unable to verify ownership."))throw e;a.default.error(e),r(ee(e.message))}finally{await oe(r),r(J())}}},n.addPermittedAccount=function(e,t){return async n=>{await new Promise(((n,a)=>{(0,v.callBackgroundMethod)("addPermittedAccount",[e,t],(e=>{e?a(e):n()}))})),await oe(n)}},n.addPollingTokenToAppState=async function(e){return(0,v.submitRequestToBackground)("addPollingTokenToAppState",[e,u.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,E.getEnvironmentType)()]])},n.addToAddressBook=function(e,t="",n=""){return a.default.debug("background.addToAddressBook"),async(r,s)=>{const{chainId:o}=s().metamask.provider;let i;try{i=await(0,v.submitRequestToBackground)("setAddressBook",[(0,p.toChecksumHexAddress)(e),t,o,n])}catch(e){throw a.default.error(e),r(ee("Address book failed to update")),e}i||r(ee("Address book failed to update"))}},n.addToken=q,n.addTokens=function(e){return t=>Array.isArray(e)?Promise.all(e.map((({address:e,symbol:n,decimals:a})=>t(q(e,n,a))))):Promise.all(Object.entries(e).map((([e,{address:n,symbol:a,decimals:r}])=>t(q(n,a,r)))))},n.addUnapprovedTransaction=async function(e,t){a.default.debug("background.addUnapprovedTransaction");const n=(0,v.generateActionId)();return await(0,v.submitRequestToBackground)("addUnapprovedTransaction",[e,u.ORIGIN_METAMASK,t,undefined,n],n)},n.addUnapprovedTransactionAndRouteToConfirmationPage=function(e,t,n){return async r=>{const s=(0,v.generateActionId)();try{a.default.debug("background.addUnapprovedTransaction");const o=await(0,v.submitRequestToBackground)("addUnapprovedTransaction",[e,u.ORIGIN_METAMASK,t,n,s],s);return r($()),o}catch(e){r(J()),r(ee(e.message))}return null}},n.approvePermissionsRequest=function(e){return t=>{(0,v.callBackgroundMethod)("approvePermissionsRequest",[e],(e=>{e&&t(ee(e.message))}))}},n.attemptLedgerTransportCreation=async function(){return await(0,v.submitRequestToBackground)("attemptLedgerTransportCreation")},n.backupUserData=async function(){let e;try{e=await(0,v.submitRequestToBackground)("backupUserData")}catch(e){throw a.default.error(e.message),e}return e},n.buy=function(e){return async t=>{const n=await(0,o.default)(e);n&&(global.platform.openTab({url:n}),t({type:O.BUY}))}},n.cancelDecryptMsg=function(e){return async t=>{let n;t(Z());try{n=await(0,v.submitRequestToBackground)("cancelDecryptMessage",[e.id])}finally{t(J())}return t(j(n)),t(U(e.id)),t(Q()),e}},n.cancelEncryptionPublicKeyMsg=function(e){return async t=>{let n;t(Z());try{n=await(0,v.submitRequestToBackground)("cancelEncryptionPublicKey",[e.id])}finally{t(J())}return t(j(n)),t(U(e.id)),t(Q()),e}},n.cancelMsg=function(e){return async t=>{let n;t(Z());try{n=await(0,v.submitRequestToBackground)("cancelMessage",[e.id])}finally{t(J())}return t(j(n)),t(U(e.id)),t(Q()),e}},n.cancelMsgs=function(e){return async t=>{t(Z());try{const n=e.map((e=>e)),a=e.map((({id:e,type:t})=>new Promise(((n,a)=>{switch(t){case u.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA:return void(0,v.callBackgroundMethod)("cancelTypedMessage",[e],(e=>{e?a(e):n()}));case u.MESSAGE_TYPE.PERSONAL_SIGN:return void(0,v.callBackgroundMethod)("cancelPersonalMessage",[e],(e=>{e?a(e):n()}));case u.MESSAGE_TYPE.ETH_DECRYPT:return void(0,v.callBackgroundMethod)("cancelDecryptMessage",[e],(e=>{e?a(e):n()}));case u.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY:return void(0,v.callBackgroundMethod)("cancelEncryptionPublicKey",[e],(e=>{e?a(e):n()}));case u.MESSAGE_TYPE.ETH_SIGN:return void(0,v.callBackgroundMethod)("cancelMessage",[e],(e=>{e?a(e):n()}));default:a(new Error(`MetaMask Message Signature: Unknown message type: ${e}`))}}))));await Promise.all(a);const r=await L();t(j(r)),n.forEach((e=>{t(U(e))}))}catch(e){a.default.error(e)}finally{(0,E.getEnvironmentType)()===u.ENVIRONMENT_TYPE_NOTIFICATION?me():t(J())}}},n.cancelPersonalMsg=function(e){return async t=>{let n;t(Z());try{n=await(0,v.submitRequestToBackground)("cancelPersonalMessage",[e.id])}finally{t(J())}return t(j(n)),t(U(e.id)),t(Q()),e}},n.cancelQRHardwareSignRequest=function(){return async e=>{e(J()),await(0,v.submitRequestToBackground)("cancelQRHardwareSignRequest")}},n.cancelSmartTransaction=function(e){return async t=>{try{await(0,v.submitRequestToBackground)("cancelSmartTransaction",[e])}catch(e){if(a.default.error(e),e.message.startsWith("Fetch error:")){const n=(0,S.parseSmartTransactionsError)(e.message);t({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:n})}throw e}}},n.cancelSyncQRHardware=function(){return async e=>{e(J()),await(0,v.submitRequestToBackground)("cancelSyncQRHardware")}},n.cancelTx=function(e,t=!0){return n=>(t&&n(Z()),new Promise(((t,n)=>{const a=(0,v.generateActionId)();(0,v.callBackgroundMethod)("cancelTransaction",[e.id,a],(e=>{e?n(e):t()}))})).then((()=>L())).then((e=>n(j(e)))).then((()=>(n((0,f.resetSendState)()),n(U(e.id)),n(J()),n(Q()),e))).catch((e=>{throw n(J()),e})))},n.cancelTxs=function(e){return async t=>{t(Z());try{const n=e.map((({id:e})=>e)),a=n.map((e=>new Promise(((t,n)=>{const a=(0,v.generateActionId)();(0,v.callBackgroundMethod)("cancelTransaction",[e,a],(e=>{e?n(e):t()}))}))));await Promise.all(a);const r=await L();t(j(r)),t((0,f.resetSendState)()),n.forEach((e=>{t(U(e))}))}finally{(0,E.getEnvironmentType)()===u.ENVIRONMENT_TYPE_NOTIFICATION?me():t(J())}}},n.cancelTypedMsg=function(e){return async t=>{let n;t(Z());try{n=await(0,v.submitRequestToBackground)("cancelTypedMessage",[e.id])}finally{t(J())}return t(j(n)),t(U(e.id)),t(Q()),e}},n.captureSingleException=function(e){return async(t,n)=>{const{singleExceptions:a}=n().appState;e in a||(t({type:O.CAPTURE_SINGLE_EXCEPTION,value:e}),(0,r.captureException)(Error(e)))}},n.checkAndUpdateAllNftsOwnershipStatus=async function(){await(0,v.submitRequestToBackground)("checkAndUpdateAllNftsOwnershipStatus")},n.checkAndUpdateSingleNftOwnershipStatus=async function(e){await(0,v.submitRequestToBackground)("checkAndUpdateSingleNftOwnershipStatus",[e,!1])},n.checkHardwareStatus=function(e,t){return a.default.debug("background.checkHardwareStatus",e,t),async n=>{let r;n(Z());try{r=await(0,v.submitRequestToBackground)("checkHardwareStatus",[e,t])}catch(e){throw a.default.error(e),n(ee(e.message)),e}finally{n(J())}return await oe(n),r}},n.clearAccountDetails=function(){return{type:O.CLEAR_ACCOUNT_DETAILS}},n.clearPendingTokens=function(){return{type:O.CLEAR_PENDING_TOKENS}},n.clearSmartTransactionFees=function(){(0,v.submitRequestToBackground)("clearSmartTransactionFees")},n.clearSwapsQuotes=function(){return async e=>{await(0,v.submitRequestToBackground)("clearSwapsQuotes"),await oe(e)}},n.closeCurrentNotificationWindow=Q,n.closeNotificationPopup=me,n.closeWelcomeScreen=function(){return{type:O.CLOSE_WELCOME_SCREEN}},n.completeOnboarding=se,n.completedTx=U,n.connectHardware=function(e,t,n,r){return a.default.debug("background.connectHardware",e,t,n),async(o,i)=>{const{ledgerTransportType:c}=i().metamask;let u;o(Z(`Looking for your ${(0,s.capitalize)(e)}...`));try{if(e===g.DEVICE_NAMES.LEDGER&&await(0,v.submitRequestToBackground)("establishLedgerTransportPreference"),e===g.DEVICE_NAMES.LEDGER&&c===g.LEDGER_TRANSPORT_TYPES.WEBHID){const e=await window.navigator.hid.requestDevice({filters:[{vendorId:g.LEDGER_USB_VENDOR_ID}]});if(!e.some((e=>e.vendorId===Number(g.LEDGER_USB_VENDOR_ID))))throw new Error(r("ledgerWebHIDNotConnectedErrorMessage"))}u=await(0,v.submitRequestToBackground)("connectHardware",[e,t,n])}catch(t){throw a.default.error(t),e===g.DEVICE_NAMES.LEDGER&&c===g.LEDGER_TRANSPORT_TYPES.WEBHID&&t.message.match("Failed to open the device")?(o(ee(r("ledgerDeviceOpenFailureMessage"))),new Error(r("ledgerDeviceOpenFailureMessage"))):(e!==g.DEVICE_NAMES.QR&&o(ee(t.message)),t)}finally{o(J())}return await oe(o),u}},n.createCancelTransaction=function(e,t,n){let r;return a.default.debug("background.cancelTransaction"),a=>{const s=(0,v.generateActionId)();return new Promise(((o,i)=>{(0,v.callBackgroundMethod)("createCancelTransaction",[e,t,{...n,actionId:s}],((e,t)=>{if(e)return a(ee(e.message)),void i(e);const{currentNetworkTxList:n}=t,{id:s}=n[n.length-1];r=s,o(t)}),s)})).then((e=>a(j(e)))).then((()=>r))}},n.createEventFragment=function(e){const t=(0,v.generateActionId)();return(0,v.submitRequestToBackground)("createEventFragment",[{...e,actionId:t}])},n.createNewVault=w,n.createNewVaultAndGetSeedPhrase=function(e){return async t=>{t(Z());try{await w(e);return await b()}catch(e){throw t(ee(e.message)),new Error(e.message)}finally{t(J())}}},n.createNewVaultAndRestore=function(e,n){return r=>{r(Z()),a.default.debug("background.createNewVaultAndRestore");const s=Array.from(t.from(n,"utf8").values());let o;return new Promise(((t,n)=>{(0,v.callBackgroundMethod)("createNewVaultAndRestore",[e,s],((e,a)=>{e?n(e):(o=a,t())}))})).then((()=>r(B()))).then((()=>(r(V()),r(J()),o))).catch((e=>(r(ee(e.message)),r(J()),Promise.reject(e))))}},n.createRetryTransaction=function(e,t){let n;return a=>new Promise(((r,s)=>{const o=(0,v.generateActionId)();(0,v.callBackgroundMethod)("createSpeedUpTransaction",[e,t,{actionId:o}],((e,t)=>{if(e)return a(ee(e.message)),void s(e);const{currentNetworkTxList:o}=t;n=o[o.length-1],r(t)}))})).then((e=>a(j(e)))).then((()=>n))},n.createSpeedUpTransaction=function(e,t,n){let r;return a.default.debug("background.createSpeedUpTransaction"),a=>{const s=(0,v.generateActionId)();return new Promise(((o,i)=>{(0,v.callBackgroundMethod)("createSpeedUpTransaction",[e,t,{...n,actionId:s}],((e,t)=>{if(e)return a(ee(e.message)),void i(e);const{currentNetworkTxList:n}=t;r=n[n.length-1],o(t)}),s)})).then((e=>a(j(e)))).then((()=>r))}},n.createTransactionEventFragment=function(e,t){const n=(0,v.generateActionId)();return(0,v.submitRequestToBackground)("createTransactionEventFragment",[e,t,n])},n.customSwapsGasParamsUpdated=function(e,t){return async n=>{await(0,v.submitRequestToBackground)("setSwapsTxGasPrice",[t]),await(0,v.submitRequestToBackground)("setSwapsTxGasLimit",[e,!0]),await oe(n)}},n.decryptMsg=function(e){return a.default.debug("action - decryptMsg"),async t=>{let n;t(Z()),a.default.debug("actions calling background.decryptMessage");try{n=await(0,v.submitRequestToBackground)("decryptMessage",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}return t(j(n)),t(U(e.metamaskId)),t(Q()),e}},n.decryptMsgInline=function(e){return a.default.debug("action - decryptMsgInline"),async t=>{let n;a.default.debug("actions calling background.decryptMessageInline");try{n=await(0,v.submitRequestToBackground)("decryptMessageInline",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}return t(j(n)),n.unapprovedDecryptMsgs[e.metamaskId]}},n.delRpcTarget=function(e){return t=>(a.default.debug(`background.delRpcTarget: ${e}`),new Promise(((n,r)=>{(0,v.callBackgroundMethod)("delCustomRpc",[e],(e=>{if(e)return a.default.error(e),t(ee("Had a problem removing network!")),void r(e);n()}))})))},n.detectNewTokens=async function(){return(0,v.submitRequestToBackground)("detectNewTokens")},n.detectNfts=function(){return async e=>{e(Z()),a.default.debug("background.detectNfts"),await(0,v.submitRequestToBackground)("detectNfts"),e(J()),await oe(e)}},n.disconnectGasFeeEstimatePoller=function(e){return(0,v.submitRequestToBackground)("disconnectGasFeeEstimatePoller",[e])},n.dismissSmartTransactionsErrorMessage=function(){return{type:O.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE}},n.displayWarning=ee,n.editRpc=function(e,t,n,r="ETH",s,o){return async i=>{a.default.debug(`background.delRpcTarget: ${e}`);try{(0,v.submitRequestToBackground)("delCustomRpc",[e])}catch(e){return a.default.error(e),void i(ee("Had a problem removing network!"))}try{await(0,v.submitRequestToBackground)("updateAndSetCustomRpc",[t,n,r,s||t,o])}catch(e){return a.default.error(e),void i(ee("Had a problem changing networks!"))}i({type:O.SET_RPC_TARGET,value:t})}},n.encryptionPublicKeyMsg=function(e){return a.default.debug("action - encryptionPublicKeyMsg"),async t=>{let n;t(Z()),a.default.debug("actions calling background.encryptionPublicKey");try{n=await(0,v.submitRequestToBackground)("encryptionPublicKey",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}return t(j(n)),t(U(e.metamaskId)),t(Q()),e}},n.estimateGas=function(e){return(0,v.submitRequestToBackground)("estimateGas",[e])},n.exportAccount=function(e,t){return function(n){return n(Z()),a.default.debug("background.verifyPassword"),new Promise(((r,s)=>{(0,v.callBackgroundMethod)("verifyPassword",[e],(function(e){if(e)return a.default.error("Error in verifying password."),n(J()),n(ee("Incorrect Password.")),void s(e);a.default.debug("background.exportAccount"),(0,v.callBackgroundMethod)("exportAccount",[t],(function(e,t){if(n(J()),e)return a.default.error(e),n(ee("Had a problem exporting the account.")),void s(e);n(te(t)),r(t)}))}))}))}},n.exportAccounts=function(e,t){return function(n){return a.default.debug("background.verifyPassword"),new Promise(((r,s)=>{(0,v.callBackgroundMethod)("verifyPassword",[e],(function(e){if(e)return a.default.error("Error in submitting password."),void s(e);a.default.debug("background.exportAccounts");const o=t.map((e=>new Promise(((t,r)=>(0,v.callBackgroundMethod)("exportAccount",[e],(function(e,s){if(e)return a.default.error(e),n(ee("Had a problem exporting the account.")),void r(e);t(s)}))))));r(Promise.all(o))}))}))}},n.fetchAndSetQuotes=function(e,t){return async n=>{const[a,r]=await(0,v.submitRequestToBackground)("fetchAndSetQuotes",[e,t]);return await oe(n),[a,r]}},n.fetchInfoToSync=function(){return e=>(a.default.debug("background.fetchInfoToSync"),new Promise(((t,n)=>{(0,v.callBackgroundMethod)("fetchInfoToSync",[],((a,r)=>{if(a)return e(ee(a.message)),void n(a);t(r)}))})))},n.fetchSmartTransactionFees=function(e,t){return async n=>{t&&(t.value="0x0");try{const a=await await(0,v.submitRequestToBackground)("fetchSmartTransactionFees",[e,t]);return n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:null}),a}catch(e){if(a.default.error(e),e.message.startsWith("Fetch error:")){const t=(0,S.parseSmartTransactionsError)(e.message);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}throw e}}},n.fetchSmartTransactionsLiveness=function(){return async()=>{try{await(0,v.submitRequestToBackground)("fetchSmartTransactionsLiveness")}catch(e){a.default.error(e)}}},n.finalizeEventFragment=function(e,t){return(0,v.submitRequestToBackground)("finalizeEventFragment",[e,t])},n.forceUpdateMetamaskState=oe,n.forgetDevice=function(e){return a.default.debug("background.forgetDevice",e),async t=>{t(Z());try{await(0,v.submitRequestToBackground)("forgetDevice",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}await oe(t)}},n.forgotPassword=G,n.getBalancesInSingleCall=async function(e){return await(0,v.submitRequestToBackground)("getBalancesInSingleCall",[e])},n.getContractMethodData=function(e=""){return(t,n)=>{const r=(0,E.addHexPrefix)(e).slice(0,10);if(r.length<10)return Promise.resolve({});const{knownMethodData:s}=n().metamask;return s&&s[r]&&0!==Object.keys(s[r]).length?Promise.resolve(s[r]):(t(ue()),a.default.debug("loadingMethodData"),(0,i.getMethodDataAsync)(r).then((({name:e,params:n})=>(t(de()),(0,v.callBackgroundMethod)("addKnownMethodData",[r,{name:e,params:n}],(e=>{e&&t(ee(e.message))})),{name:e,params:n}))))}},n.getCurrentWindowTab=function(){return async e=>{e(fe(await global.platform.currentTab()))}},n.getGasFeeEstimatesAndStartPolling=function(){return(0,v.submitRequestToBackground)("getGasFeeEstimatesAndStartPolling")},n.getGasFeeTimeEstimate=function(e,t){return(0,v.submitRequestToBackground)("getGasFeeTimeEstimate",[e,t])},n.getNextNonce=function(){return async(e,t)=>{const n=t().metamask.selectedAddress;let a;try{a=await(0,v.submitRequestToBackground)("getNextNonce",[n])}catch(t){throw e(ee(t.message)),t}return e(le(a)),a}},n.getOpenMetamaskTabsIds=function(){return async e=>{e(Te(await(0,v.submitRequestToBackground)("getOpenMetamaskTabsIds")))}},n.getRequestAccountTabIds=function(){return async e=>{e(Ee(await(0,v.submitRequestToBackground)("getRequestAccountTabIds")))}},n.getTokenStandardAndDetails=async function(e,t,n){return await(0,v.submitRequestToBackground)("getTokenStandardAndDetails",[e,t,n])},n.getTransactions=async function(e={}){return await(0,v.submitRequestToBackground)("getTransactions",[e])},n.goHome=k,n.hideAlert=function(){return{type:O.ALERT_CLOSE}},n.hideBetaHeader=function(){return(0,v.submitRequestToBackground)("setShowBetaHeader",[!1])},n.hideLoadingIndication=J,n.hideModal=function(e){return{type:O.MODAL_CLOSE,payload:e}},n.hideNetworkDropdown=function(){return{type:O.NETWORK_DROPDOWN_CLOSE}},n.hidePortfolioTooltip=function(){return(0,v.submitRequestToBackground)("setShowPortfolioTooltip",[!1])},n.hideTestNetMessage=function(){return(0,v.submitRequestToBackground)("setShowTestnetMessageInDropdown",[!1])},n.hideWarning=function(){return{type:O.HIDE_WARNING}},n.ignoreTokens=function({tokensToIgnore:e,dontShowLoadingIndicator:t=!1}){const n=Array.isArray(e)?e:[e];return async e=>{t||e(Z());try{await(0,v.submitRequestToBackground)("ignoreTokens",[n])}catch(t){a.default.error(t),e(ee(t.message))}finally{await oe(e),e(J())}}},n.importNewAccount=function(e,t){return async n=>{let r;n(Z("This may take a while, please be patient."));try{a.default.debug("background.importAccountWithStrategy"),await(0,v.submitRequestToBackground)("importAccountWithStrategy",[e,t]),a.default.debug("background.getState"),r=await(0,v.submitRequestToBackground)("getState")}catch(e){throw n(ee(e.message)),e}finally{n(J())}return n(j(r)),r.selectedAddress&&n({type:O.SHOW_ACCOUNT_DETAIL,value:r.selectedAddress}),r}},n.isNftOwner=async function(e,t,n){return await(0,v.submitRequestToBackground)("isNftOwner",[e,t,n])},n.loadingMethodDataFinished=de,n.loadingMethodDataStarted=ue,n.loadingTokenParamsFinished=function(){return{type:O.LOADING_TOKEN_PARAMS_FINISHED}},n.loadingTokenParamsStarted=function(){return{type:O.LOADING_TOKEN_PARAMS_STARTED}},n.lockMetamask=function(){return a.default.debug("background.setLocked"),e=>(e(Z()),new Promise(((e,t)=>{(0,v.callBackgroundMethod)("setLocked",[],(n=>{n?t(n):e()}))})).then((()=>L())).catch((t=>(e(ee(t.message)),Promise.reject(t)))).then((t=>{e(j(t)),e(J()),e({type:O.LOCK_METAMASK})})).catch((()=>{e(J()),e({type:O.LOCK_METAMASK})})))},n.markPasswordForgotten=function(){return async e=>{try{await new Promise(((e,t)=>{(0,v.callBackgroundMethod)("markPasswordForgotten",[],(n=>{n?t(n):e()}))}))}finally{e(J()),e(G()),await oe(e)}}},n.qrCodeDetected=function(e){return async t=>{await t({type:O.QR_CODE_DETECTED,value:e}),t((0,f.computeEstimatedGasLimit)())}},n.rejectPendingApproval=function(e,t){return async n=>{await(0,v.submitRequestToBackground)("rejectPendingApproval",[e,t]);const{pendingApprovals:a}=await oe(n);0===Object.values(a).length&&n(Q())}},n.rejectPermissionsRequest=function(e){return t=>new Promise(((n,a)=>{(0,v.callBackgroundMethod)("rejectPermissionsRequest",[e],(e=>{if(e)return t(ee(e.message)),void a(e);oe(t).then(n).catch(a)}))}))},n.rejectWatchAsset=function(e){return async t=>{t(Z());try{await(0,v.submitRequestToBackground)("rejectWatchAsset",[e]),await oe(t)}catch(e){return a.default.error(e),void t(ee(e.message))}finally{t(J())}t(Q())}},n.removeAccount=function(e){return async t=>{t(Z());try{await new Promise(((t,n)=>{(0,v.callBackgroundMethod)("removeAccount",[e],((e,a)=>{e?n(e):t(a)}))})),await oe(t)}catch(e){throw t(ee(e.message)),e}finally{t(J())}a.default.info(`Account removed: ${e}`),t(V())}},n.removeAndIgnoreNft=function(e,t,n){return async r=>{if(!e)throw new Error("MetaMask - Cannot ignore collectible without address");if(!t)throw new Error("MetaMask - Cannot ignore collectible without tokenID");n||r(Z());try{await(0,v.submitRequestToBackground)("removeAndIgnoreNft",[e,t])}catch(e){a.default.error(e),r(ee(e.message))}finally{await oe(r),r(J())}}},n.removeFromAddressBook=function(e,t){return a.default.debug("background.removeFromAddressBook"),async()=>{await(0,v.submitRequestToBackground)("removeFromAddressBook",[e,(0,p.toChecksumHexAddress)(t)])}},n.removeNft=function(e,t,n){return async r=>{if(!e)throw new Error("MetaMask - Cannot remove collectible without address");if(!t)throw new Error("MetaMask - Cannot remove collectible without tokenID");n||r(Z());try{await(0,v.submitRequestToBackground)("removeNft",[e,t])}catch(e){a.default.error(e),r(ee(e.message))}finally{await oe(r),r(J())}}},n.removePermissionsFor=function(e){return t=>{(0,v.callBackgroundMethod)("removePermissionsFor",[e],(e=>{e&&t(ee(e.message))}))}},n.removePermittedAccount=function(e,t){return async n=>{await new Promise(((n,a)=>{(0,v.callBackgroundMethod)("removePermittedAccount",[e,t],(e=>{e?a(e):n()}))})),await oe(n)}},n.removePollingTokenFromAppState=async function(e){return(0,v.submitRequestToBackground)("removePollingTokenFromAppState",[e,u.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,E.getEnvironmentType)()]])},n.requestAccountsPermissionWithId=function(e){return async t=>{const n=await(0,v.submitRequestToBackground)("requestAccountsPermissionWithId",[e]);return await oe(t),n}},n.requestAddNetworkApproval=function(e,t){return async n=>{try{await(0,v.submitRequestToBackground)("requestAddNetworkApproval",[e,t])}catch(e){a.default.error(e),n(ee("Had a problem changing networks!"))}}},n.requestRevealSeedWords=function(e){return async t=>{t(Z()),a.default.debug("background.verifyPassword");try{await D(e);return await b()}catch(e){throw t(ee(e.message)),e}finally{t(J())}}},n.resetAccount=function(){return e=>(e(Z()),new Promise(((t,n)=>{(0,v.callBackgroundMethod)("resetAccount",[],((r,s)=>{if(e(J()),r)return e(ee(r.message)),void n(r);a.default.info(`Transaction history reset for ${s}`),e(V()),t(s)}))})))},n.resetBackgroundSwapsState=function(){return async e=>{const t=await(0,v.submitRequestToBackground)("resetSwapsState");return await oe(e),t}},n.resetSwapsPostFetchState=function(){return async e=>{await(0,v.submitRequestToBackground)("resetPostFetchState"),await oe(e)}},n.resolvePendingApproval=function(e,t){return async n=>{await(0,v.submitRequestToBackground)("resolvePendingApproval",[e,t]);const{pendingApprovals:a}=await oe(n);0===Object.values(a).length&&n(Q())}},n.restoreUserData=async function(e){try{await(0,v.submitRequestToBackground)("restoreUserData",[e])}catch(e){throw a.default.error(e.message),e}return!0},n.rollbackToPreviousProvider=function(){return async e=>{try{await(0,v.submitRequestToBackground)("rollbackToPreviousProvider")}catch(t){a.default.error(t),e(ee("Had a problem changing networks!"))}}},n.safeRefetchQuotes=function(){return async e=>{await(0,v.submitRequestToBackground)("safeRefetchQuotes"),await oe(e)}},n.setAccountLabel=function(e,t){return n=>(n(Z()),a.default.debug("background.setAccountLabel"),new Promise(((a,r)=>{(0,v.callBackgroundMethod)("setAccountLabel",[e,t],(s=>{if(n(J()),s)return n(ee(s.message)),void r(s);n({type:O.SET_ACCOUNT_LABEL,value:{account:e,label:t}}),a(e)}))})))},n.setAdvancedGasFee=function(e){return t=>{t(Z()),a.default.debug("background.setAdvancedGasFee"),(0,v.callBackgroundMethod)("setAdvancedGasFee",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setAlertEnabledness=async function(e,t){await(0,v.submitRequestToBackground)("setAlertEnabledness",[e,t])},n.setApproveTxId=function(e){return async t=>{await(0,v.submitRequestToBackground)("setApproveTxId",[e]),await oe(t)}},n.setAutoLockTimeLimit=function(e){return ae("autoLockTimeLimit",e)},n.setBackgroundSwapRouteState=function(e){return async t=>{await(0,v.submitRequestToBackground)("setBackgroundSwapRouteState",[e]),await oe(t)}},n.setCollectiblesDetectionNoticeDismissed=function(){return(0,v.submitRequestToBackground)("setCollectiblesDetectionNoticeDismissed",[!0])},n.setCompletedOnboarding=function(){return async e=>{e(Z());try{await(0,v.submitRequestToBackground)("completeOnboarding"),e(se())}catch(t){throw e(ee(t.message)),t}finally{e(J())}}},n.setConnectedStatusPopoverHasBeenShown=function(){return()=>{(0,v.callBackgroundMethod)("setConnectedStatusPopoverHasBeenShown",[],(e=>{if(e)throw new Error(e.message)}))}},n.setCurrentCurrency=function(e){return async t=>{t(Z()),a.default.debug("background.setCurrentCurrency");try{await(0,v.submitRequestToBackground)("setCurrentCurrency",[e]),await oe(t)}catch(e){return a.default.error(e),void t(ee(e.message))}finally{t(J())}}},n.setCurrentLocale=ce,n.setCurrentWindowTab=fe,n.setCustomApproveTxData=function(e){return async t=>{await(0,v.submitRequestToBackground)("setCustomApproveTxData",[e]),await oe(t)}},n.setDefaultHomeActiveTabName=function(e){return async t=>{await(0,v.submitRequestToBackground)("setDefaultHomeActiveTabName",[e]),await oe(t)}},n.setDismissSeedBackUpReminder=function(e){return async t=>{t(Z()),await(0,v.submitRequestToBackground)("setDismissSeedBackUpReminder",[e]),t(J())}},n.setEIP1559V2Enabled=function(e){return async t=>{t(Z()),a.default.debug("background.setEIP1559V2Enabled");try{await(0,v.submitRequestToBackground)("setEIP1559V2Enabled",[e])}finally{t(J())}}},n.setEnableEIP1559V2NoticeDismissed=function(){return(0,v.submitRequestToBackground)("setEnableEIP1559V2NoticeDismissed",[!0])},n.setFeatureFlag=function(e,t,n){return a=>(a(Z()),new Promise(((r,s)=>{(0,v.callBackgroundMethod)("setFeatureFlag",[e,t],((e,t)=>{if(a(J()),e)return a(ee(e.message)),void s(e);a(ne(t)),n&&a(z({name:n})),r(t)}))})))},n.setFirstTimeFlowType=function(e){return t=>{a.default.debug("background.setFirstTimeFlowType"),(0,v.callBackgroundMethod)("setFirstTimeFlowType",[e],(e=>{e&&t(ee(e.message))})),t({type:O.SET_FIRST_TIME_FLOW_TYPE,value:e})}},n.setFirstTimeUsedNetwork=function(e){return(0,v.submitRequestToBackground)("setFirstTimeUsedNetwork",[e])},n.setHardwareWalletDefaultHdPath=function({device:e,path:t}){return{type:O.SET_HARDWARE_WALLET_DEFAULT_HD_PATH,value:{device:e,path:t}}},n.setHideZeroBalanceTokens=function(e){return ae("hideZeroBalanceTokens",e)},n.setImprovedTokenAllowanceEnabled=function(e){return async()=>{try{await(0,v.submitRequestToBackground)("setImprovedTokenAllowanceEnabled",[e])}catch(e){a.default.error(e)}}},n.setInitialGasEstimate=function(e){return async t=>{await(0,v.submitRequestToBackground)("setInitialGasEstimate",[e]),await oe(t)}},n.setIpfsGateway=function(e){return t=>{a.default.debug("background.setIpfsGateway"),(0,v.callBackgroundMethod)("setIpfsGateway",[e],(n=>{t(n?ee(n.message):{type:O.SET_IPFS_GATEWAY,value:e})}))}},n.setLastActiveTime=function(){return e=>{(0,v.callBackgroundMethod)("setLastActiveTime",[],(t=>{t&&e(ee(t.message))}))}},n.setLedgerTransportPreference=function(e){return async t=>{t(Z()),await(0,v.submitRequestToBackground)("setLedgerTransportPreference",[e]),t(J())}},n.setMouseUserState=function(e){return{type:O.SET_MOUSE_USER_STATE,value:e}},n.setNewCollectibleAddedMessage=function(e){return{type:O.SET_NEW_COLLECTIBLE_ADDED_MESSAGE,value:e}},n.setNewNetworkAdded=function(e){return{type:O.SET_NEW_NETWORK_ADDED,value:e}},n.setNewTokensImported=function(e){return{type:O.SET_NEW_TOKENS_IMPORTED,value:e}},n.setNextNonce=le,n.setOpenMetamaskTabsIDs=Te,n.setOpenSeaEnabled=function(e){return t=>{t(Z()),a.default.debug("background.setOpenSeaEnabled"),(0,v.callBackgroundMethod)("setOpenSeaEnabled",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setParticipateInMetaMetrics=function(e){return t=>(a.default.debug("background.setParticipateInMetaMetrics"),new Promise(((n,r)=>{(0,v.callBackgroundMethod)("setParticipateInMetaMetrics",[e],((s,o)=>{if(a.default.debug(s),s)return t(ee(s.message)),void r(s);t({type:O.SET_PARTICIPATE_IN_METAMETRICS,value:e}),n([e,o])}))})))},n.setPendingTokens=function(e){const{customToken:t={},selectedTokens:n={},tokenAddressList:a=[]}=e,{address:r,symbol:s,decimals:o}=t,i=r&&s&&o>=0<=36?{...n,[r]:{...t,isCustom:!0}}:n;return Object.keys(i).forEach((e=>{i[e].unlisted=!a.find((t=>(0,A.isEqualCaseInsensitive)(t,e)))})),{type:O.SET_PENDING_TOKENS,payload:i}},n.setPreference=ae,n.setProviderType=function(e){return async t=>{a.default.debug("background.setProviderType",e);try{await(0,v.submitRequestToBackground)("setProviderType",[e])}catch(e){return a.default.error(e),void t(ee("Had a problem changing networks!"))}t(X(e))}},n.setRecoveryPhraseReminderHasBeenShown=function(){return()=>{(0,v.callBackgroundMethod)("setRecoveryPhraseReminderHasBeenShown",[],(e=>{if(e)throw new Error(e.message)}))}},n.setRecoveryPhraseReminderLastShown=function(e){return()=>{(0,v.callBackgroundMethod)("setRecoveryPhraseReminderLastShown",[e],(e=>{if(e)throw new Error(e.message)}))}},n.setRequestAccountTabIds=Ee,n.setRpcTarget=function(e,t,n="ETH",r){return async s=>{a.default.debug(`background.setRpcTarget: ${e} ${t} ${n} ${r}`);try{await(0,v.submitRequestToBackground)("setCustomRpc",[e,t,n,r||e])}catch(e){a.default.error(e),s(ee("Had a problem changing networks!"))}}},n.setSeedPhraseBackedUp=function(e){return t=>(a.default.debug("background.setSeedPhraseBackedUp"),new Promise(((n,a)=>{(0,v.callBackgroundMethod)("setSeedPhraseBackedUp",[e],(e=>{if(e)return t(ee(e.message)),void a(e);oe(t).then(n).catch(a)}))})))},n.setSelectedAddress=function(e){return async t=>{t(Z()),a.default.debug("background.setSelectedAddress");try{await K(e)}catch(e){return void t(ee(e.message))}finally{t(J())}}},n.setSelectedQuoteAggId=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSelectedQuoteAggId",[e]),await oe(t)}},n.setSelectedSettingsRpcUrl=function(e){return{type:O.SET_SELECTED_SETTINGS_RPC_URL,value:e}},n.setShowFiatConversionOnTestnetsPreference=function(e){return ae("showFiatInTestnets",e)},n.setShowTestNetworks=function(e){return ae("showTestNetworks",e)},n.setSmartTransactionsOptInStatus=async function(e,t){he({actionId:(0,v.generateActionId)(),event:"STX OptIn",category:_.EVENT.CATEGORIES.SWAPS,sensitiveProperties:{stx_enabled:!0,current_stx_enabled:!0,stx_user_opt_in:e,stx_prev_user_opt_in:t}}),await(0,v.submitRequestToBackground)("setSmartTransactionsOptInStatus",[e])},n.setSmartTransactionsRefreshInterval=function(e){return async()=>{try{await(0,v.submitRequestToBackground)("setStatusRefreshInterval",[e])}catch(e){a.default.error(e)}}},n.setSwapsErrorKey=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsErrorKey",[e]),await oe(t)}},n.setSwapsFeatureFlags=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsFeatureFlags",[e]),await oe(t)}},n.setSwapsLiveness=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsLiveness",[e]),await oe(t)}},n.setSwapsQuotesPollingLimitEnabled=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsQuotesPollingLimitEnabled",[e]),await oe(t)}},n.setSwapsTokens=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsTokens",[e]),await oe(t)}},n.setSwapsTxGasLimit=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsTxGasLimit",[e,!0]),await oe(t)}},n.setSwapsTxGasPrice=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsTxGasPrice",[e]),await oe(t)}},n.setTheme=function(e){return async t=>{t(Z()),a.default.debug("background.setTheme");try{await(0,v.submitRequestToBackground)("setTheme",[e])}finally{t(J())}}},n.setTradeTxId=function(e){return async t=>{await(0,v.submitRequestToBackground)("setTradeTxId",[e]),await oe(t)}},n.setTransactionSecurityCheckEnabled=function(e){return async()=>{try{await(0,v.submitRequestToBackground)("setTransactionSecurityCheckEnabled",[e])}catch(e){a.default.error(e)}}},n.setUnconnectedAccountAlertShown=pe,n.setUseBlockie=function(e){return t=>{t(Z()),a.default.debug("background.setUseBlockie"),(0,v.callBackgroundMethod)("setUseBlockie",[e],(e=>{t(J()),e&&t(ee(e.message))})),t({type:O.SET_USE_BLOCKIE,value:e})}},n.setUseCurrencyRateCheck=function(e){return t=>{t(Z()),a.default.debug("background.setUseCurrencyRateCheck"),(0,v.callBackgroundMethod)("setUseCurrencyRateCheck",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setUseMultiAccountBalanceChecker=function(e){return t=>{t(Z()),a.default.debug("background.setUseMultiAccountBalanceChecker"),(0,v.callBackgroundMethod)("setUseMultiAccountBalanceChecker",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setUseNativeCurrencyAsPrimaryCurrencyPreference=function(e){return ae("useNativeCurrencyAsPrimaryCurrency",e)},n.setUseNftDetection=function(e){return t=>{t(Z()),a.default.debug("background.setUseNftDetection"),(0,v.callBackgroundMethod)("setUseNftDetection",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setUseNonceField=function(e){return async t=>{t(Z()),a.default.debug("background.setUseNonceField");try{await(0,v.submitRequestToBackground)("setUseNonceField",[e])}catch(e){t(ee(e.message))}t(J()),t({type:O.SET_USE_NONCEFIELD,value:e})}},n.setUsePhishDetect=function(e){return t=>{t(Z()),a.default.debug("background.setUsePhishDetect"),(0,v.callBackgroundMethod)("setUsePhishDetect",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setUseTokenDetection=function(e){return t=>{t(Z()),a.default.debug("background.setUseTokenDetection"),(0,v.callBackgroundMethod)("setUseTokenDetection",[e],(e=>{t(J()),e&&t(ee(e.message))}))}},n.setWeb3ShimUsageAlertDismissed=async function(e){await(0,v.submitRequestToBackground)("setWeb3ShimUsageAlertDismissed",[e])},n.showAccountDetail=function(e){return async(t,n)=>{t(Z()),a.default.debug("background.setSelectedAddress");const r=n(),s=(0,h.getUnconnectedAccountAlertEnabledness)(r),o=r.activeTab.origin,i=(0,T.getSelectedAddress)(r),c=(0,T.getPermittedAccountsForCurrentTab)(r),u=Boolean(o)&&c.includes(i),d=Boolean(o)&&c.includes(e),l=u&&!d;try{await K(e),await oe(t)}catch(e){return void t(ee(e.message))}finally{t(J())}t({type:O.SHOW_ACCOUNT_DETAIL,value:e}),s&&l&&(t((0,m.switchedToUnconnectedAccount)()),await pe(o))}},n.showAccountsPage=V,n.showAlert=function(e){return{type:O.ALERT_OPEN,value:e}},n.showConfTxPage=$,n.showLoadingIndication=Z,n.showModal=z,n.showNetworkDropdown=function(){return{type:O.NETWORK_DROPDOWN_OPEN}},n.showPrivateKey=te,n.showQrScanner=function(){return e=>{e(z({name:"QR_SCANNER"}))}},n.showSendTokenPage=function(){return{type:O.SHOW_SEND_TOKEN_PAGE}},n.signAndSendSmartTransaction=function({unsignedTransaction:e,smartTransactionFees:t}){return async n=>{const r=await ge(e,t.fees),s=await ge(e,t.cancelFees,!0);try{return(await(0,v.submitRequestToBackground)("submitSignedTransactions",[{signedTransactions:r,signedCanceledTransactions:s,txParams:e}])).uuid}catch(e){if(a.default.error(e),e.message.startsWith("Fetch error:")){const t=(0,S.parseSmartTransactionsError)(e.message);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}throw e}}},n.signMsg=function(e){return a.default.debug("action - signMsg"),async t=>{let n;t(Z()),a.default.debug("actions calling background.signMessage");try{n=await(0,v.submitRequestToBackground)("signMessage",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}return t(j(n)),t(U(e.metamaskId)),t(Q()),e}},n.signPersonalMsg=function(e){return a.default.debug("action - signPersonalMsg"),async t=>{let n;t(Z()),a.default.debug("actions calling background.signPersonalMessage");try{n=await(0,v.submitRequestToBackground)("signPersonalMessage",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}return t(j(n)),t(U(e.metamaskId)),t(Q()),e}},n.signTypedMsg=function(e){return a.default.debug("action - signTypedMsg"),async t=>{let n;t(Z()),a.default.debug("actions calling background.signTypedMessage");try{n=await(0,v.submitRequestToBackground)("signTypedMessage",[e])}catch(e){throw a.default.error(e),t(ee(e.message)),e}finally{t(J())}return t(j(n)),t(U(e.metamaskId)),t(Q()),e}},n.stopPollingForQuotes=function(){return async e=>{await(0,v.submitRequestToBackground)("stopPollingForQuotes"),await oe(e)}},n.submitPassword=P,n.submitQRHardwareCryptoAccount=async function(e){await(0,v.submitRequestToBackground)("submitQRHardwareCryptoAccount",[e])},n.submitQRHardwareCryptoHDKey=async function(e){await(0,v.submitRequestToBackground)("submitQRHardwareCryptoHDKey",[e])},n.submitQRHardwareSignature=async function(e,t){await(0,v.submitRequestToBackground)("submitQRHardwareSignature",[e,t])},n.toggleAccountMenu=function(){return{type:O.TOGGLE_ACCOUNT_MENU}},n.trackMetaMetricsEvent=he,n.trackMetaMetricsPage=function(e,t){return(0,v.submitRequestToBackground)("trackMetaMetricsPage",[{...e,actionId:(0,v.generateActionId)()},t])},n.tryReverseResolveAddress=function(e){return()=>new Promise((t=>{(0,v.callBackgroundMethod)("tryReverseResolveAddress",[e],(e=>{e&&a.default.error(e),t()}))}))},n.tryUnlockMetamask=function(e){return t=>(t(Z()),t(H()),a.default.debug("background.submitPassword"),new Promise(((t,n)=>{(0,v.callBackgroundMethod)("submitPassword",[e],(e=>{e?n(e):t()}))})).then((()=>(t(Y()),oe(t)))).then((()=>{t(J())})).catch((e=>(t(W(e.message)),t(J()),Promise.reject(e)))))},n.txError=x,n.unMarkPasswordForgotten=B,n.unlockAndGetSeedPhrase=function(e){return async t=>{t(Z());try{await P(e);const n=await b();return await oe(t),n}catch(e){throw t(ee(e.message)),new Error(e.message)}finally{t(J())}}},n.unlockFailed=W,n.unlockHardwareWalletAccounts=function(e,t,n,r){return a.default.debug("background.unlockHardwareWalletAccount",e,t,n,r),async s=>{s(Z());for(const o of e)try{await(0,v.submitRequestToBackground)("unlockHardwareWalletAccount",[o,t,n,r])}catch(e){throw a.default.error(e),s(ee(e.message)),s(J()),e}return s(J()),undefined}},n.unlockInProgress=H,n.unlockSucceeded=Y,n.updateAndApproveTx=function(e,t){return n=>(!t&&n(Z()),new Promise(((t,r)=>{const s=(0,v.generateActionId)();(0,v.callBackgroundMethod)("updateAndApproveTransaction",[e,s],(s=>{if(n(F(e.id,e.txParams)),n((0,f.resetSendState)()),s)return n(x(s)),n(k()),a.default.error(s.message),void r(s);t(e)}))})).then((()=>L())).then((e=>n(j(e)))).then((()=>(n((0,f.resetSendState)()),n(U(e.id)),n(J()),n(M("")),n(Q()),e))).catch((e=>(n(J()),Promise.reject(e)))))},n.updateAndSetCustomRpc=function(e,t,n="ETH",r,s){return async o=>{a.default.debug(`background.updateAndSetCustomRpc: ${e} ${t} ${n} ${r}`);try{await(0,v.submitRequestToBackground)("updateAndSetCustomRpc",[e,t,n,r||e,s])}catch(e){return a.default.error(e),void o(ee("Had a problem changing networks!"))}o({type:O.SET_RPC_TARGET,value:e})}},n.updateCollectibleDropDownState=function(e){return async t=>{await(0,v.submitRequestToBackground)("updateCollectibleDropDownState",[e]),await oe(t)}},n.updateCurrentLocale=ie,n.updateCustomNonce=M,n.updateCustomSwapsEIP1559GasParams=function({gasLimit:e,maxFeePerGas:t,maxPriorityFeePerGas:n}){return async a=>{await Promise.all([(0,v.submitRequestToBackground)("setSwapsTxGasLimit",[e]),(0,v.submitRequestToBackground)("setSwapsTxMaxFeePerGas",[t]),(0,v.submitRequestToBackground)("setSwapsTxMaxFeePriorityPerGas",[n])]),await oe(a)}},n.updateEditableParams=function(e,t){return async n=>{let r;try{r=await(0,v.submitRequestToBackground)("updateEditableParams",[e,t])}catch(e){throw n(x(e)),a.default.error(e.message),e}return await oe(n),r}},n.updateEventFragment=function(e,t){return(0,v.submitRequestToBackground)("updateEventFragment",[e,t])},n.updateFeatureFlags=ne,n.updateMetamaskState=j,n.updatePreferences=re,n.updatePreviousGasParams=function(e,t){return async n=>{let r;try{r=await(0,v.submitRequestToBackground)("updatePreviousGasParams",[e,t])}catch(e){throw n(x(e)),a.default.error(e.message),e}return r}},n.updateProviderType=X,n.updateSmartTransaction=function(e,t){return async n=>{try{await(0,v.submitRequestToBackground)("updateSmartTransaction",[{uuid:e,...t}])}catch(e){if(a.default.error(e),e.message.startsWith("Fetch error:")){const t=(0,S.parseSmartTransactionsError)(e.message);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}throw e}}},n.updateSwapApprovalTransaction=function(e,t){return async n=>{let r;try{r=await(0,v.submitRequestToBackground)("updateSwapApprovalTransaction",[e,t])}catch(e){throw n(x(e)),a.default.error(e.message),e}return r}},n.updateSwapTransaction=function(e,t){return async n=>{let r;try{r=await(0,v.submitRequestToBackground)("updateSwapTransaction",[e,t])}catch(e){throw n(x(e)),a.default.error(e.message),e}return r}},n.updateSwapsUserFeeLevel=function(e){return async t=>{await(0,v.submitRequestToBackground)("setSwapsUserFeeLevel",[e]),await oe(t)}},n.updateTokenType=async function(e){let t={};try{t=await(0,v.submitRequestToBackground)("updateTokenType",[e])}catch(e){a.default.error(e)}return t},n.updateTransaction=function(e,t){return async n=>{!t&&n(Z());try{await(0,v.submitRequestToBackground)("updateTransaction",[e])}catch(t){throw n(F(e.id,e.txParams)),n(J()),n(x(t)),n(k()),a.default.error(t.message),t}try{n(F(e.id,e.txParams));return n(j(await L())),n($({id:e.id})),e}finally{n(J())}}},n.updateTransactionGasFees=function(e,t){return async n=>{let r;try{r=await(0,v.submitRequestToBackground)("updateTransactionGasFees",[e,t])}catch(e){throw n(x(e)),a.default.error(e.message),e}return r}},n.updateTransactionParams=F,n.updateTransactionSendFlowHistory=function(e,t,n){return async r=>{let s;try{s=await(0,v.submitRequestToBackground)("updateTransactionSendFlowHistory",[e,t,n])}catch(e){throw r(x(e)),a.default.error(e.message),e}return s}},n.updateViewedNotifications=function(e){return(0,v.submitRequestToBackground)("updateViewedNotifications",[e])},n.verifyPassword=D,n.verifySeedPhrase=b;var a=y(e("loglevel")),r=e("@sentry/browser"),s=e("lodash"),o=y(e("../../app/scripts/lib/buy-url")),i=e("../helpers/utils/transactions.util"),c=y(e("../../shared/lib/switch-direction")),u=e("../../shared/constants/app"),d=e("../helpers/utils/confirm-tx.util"),l=y(e("../helpers/utils/tx-helper")),E=e("../../app/scripts/lib/util"),T=e("../selectors"),f=e("../ducks/send"),m=e("../ducks/alerts/unconnected-account"),h=e("../ducks/metamask/metamask"),p=e("../../shared/modules/hexstring-utils"),g=e("../../shared/constants/hardware-wallets"),_=e("../../shared/constants/metametrics"),S=e("../pages/swaps/swaps.util"),A=e("../../shared/modules/string-utils"),R=e("../ducks/app/app"),I=e("../../shared/lib/transactions-controller-utils"),N=e("../helpers/utils/i18n-helper"),O=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=C(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("./actionConstants")),v=e("./action-queue");function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(C=function(e){return e?n:t})(e)}function y(e){return e&&e.__esModule?e:{default:e}}function k(){return{type:O.GO_HOME}}function P(e){return new Promise(((t,n)=>{(0,v.callBackgroundMethod)("submitPassword",[e],(e=>{e?n(e):t()}))}))}function w(e){return new Promise(((t,n)=>{(0,v.callBackgroundMethod)("createNewVaultAndKeychain",[e],(e=>{e?n(e):t(!0)}))}))}function D(e){return new Promise(((t,n)=>{(0,v.callBackgroundMethod)("verifyPassword",[e],(e=>{e?n(e):t(!0)}))}))}async function b(){const e=await(0,v.submitRequestToBackground)("verifySeedPhrase");return t.from(e).toString("utf8")}function M(e){return{type:O.UPDATE_CUSTOM_NONCE,value:e}}const L=()=>(a.default.debug("background.getState"),new Promise(((e,t)=>{(0,v.callBackgroundMethod)("getState",[],((n,a)=>{n?t(n):e(a)}))})));function U(e){return(t,n)=>{const a=n(),{unapprovedTxs:r,unapprovedMsgs:s,unapprovedPersonalMsgs:o,unapprovedTypedMessages:i,network:c,provider:{chainId:u}}=a.metamask,d=(0,l.default)(r,s,o,i,c,u).filter((t=>t.id!==e));t({type:O.COMPLETED_TX,value:{id:e,unconfirmedActionsCount:d.length}})}}function F(e,t){return{type:O.UPDATE_TRANSACTION_PARAMS,id:e,value:t}}function x(e){return{type:O.TRANSACTION_ERROR,message:e.message}}function B(){return e=>new Promise((t=>{(0,v.callBackgroundMethod)("unMarkPasswordForgotten",[],(()=>{e(G(!1)),t()}))})).then((()=>oe(e)))}function G(e=!0){return{type:O.FORGOT_PASSWORD,value:e}}function H(){return{type:O.UNLOCK_IN_PROGRESS}}function W(e){return{type:O.UNLOCK_FAILED,value:e}}function Y(e){return{type:O.UNLOCK_SUCCEEDED,value:e}}function j(e){return(t,n)=>{var a,r,o,i;const{metamask:c}=n(),{currentLocale:u,selectedAddress:d,provider:l}=c,{currentLocale:E,selectedAddress:m,provider:h}=e;u&&E&&u!==E&&t(ie(E)),d!==m&&t({type:O.SELECTED_ADDRESS_CHANGED});const p=null!==(a=null===(r=e.addressBook)||void 0===r?void 0:r[null==h?void 0:h.chainId])&&void 0!==a?a:{},g=null!==(o=null===(i=c.addressBook)||void 0===i?void 0:i[null==l?void 0:l.chainId])&&void 0!==o?o:{},_=(0,T.getMetaMaskAccounts)({metamask:e}),S=(0,T.getMetaMaskAccounts)({metamask:c}),A=_[m],R=_[d];Object.entries(S).forEach((([e,n])=>{(0,s.isEqual)(n,_[e])||t({type:O.ACCOUNT_CHANGED,payload:{account:_[e]}})})),!1===(0,s.isEqual)(R,A)&&t({type:O.SELECTED_ACCOUNT_CHANGED,payload:{account:A}}),!1===(0,s.isEqual)(g,p)&&t({type:O.ADDRESS_BOOK_UPDATED,payload:{addressBook:p}}),!1===(0,s.isEqual)(c.gasFeeEstimates,e.gasFeeEstimates)&&t({type:O.GAS_FEE_ESTIMATES_UPDATED,payload:{gasFeeEstimates:e.gasFeeEstimates,gasEstimateType:e.gasEstimateType}}),t({type:O.UPDATE_METAMASK_STATE,value:e}),l.chainId!==h.chainId&&(t({type:O.CHAIN_CHANGED,payload:h.chainId}),t((0,f.initializeSendState)({chainHasChanged:!0})))}}async function K(e){a.default.debug("background.setSelectedAddress"),await(0,v.submitRequestToBackground)("setSelectedAddress",[e])}function V(){return{type:O.SHOW_ACCOUNTS_PAGE}}function $({id:e}={}){return{type:O.SHOW_CONF_TX_PAGE,id:e}}function q(e,t,n,r,s){return async o=>{if(!e)throw new Error("MetaMask - Cannot add token without address");s||o(Z());try{await(0,v.submitRequestToBackground)("addToken",[e,t,n,r])}catch(e){a.default.error(e),o(ee(e.message))}finally{await oe(o),o(J())}}}function X(e){return{type:O.SET_PROVIDER_TYPE,value:e}}function z(e){return{type:O.MODAL_OPEN,payload:e}}function Q(){return(e,t)=>{(0,E.getEnvironmentType)()!==u.ENVIRONMENT_TYPE_NOTIFICATION||(0,d.hasUnconfirmedTransactions)(t())||me()}}function Z(e){return{type:O.SHOW_LOADING,value:e}}function J(){return{type:O.HIDE_LOADING}}function ee(e){return{type:O.DISPLAY_WARNING,value:e}}function te(e){return{type:O.SHOW_PRIVATE_KEY,value:e}}function ne(e){return{type:O.UPDATE_FEATURE_FLAGS,value:e}}function ae(e,t){return n=>(n(Z()),new Promise(((a,r)=>{(0,v.callBackgroundMethod)("setPreference",[e,t],((e,t)=>{if(n(J()),e)return n(ee(e.message)),void r(e);n(re(t)),a(t)}))})))}function re(e){return{type:O.UPDATE_PREFERENCES,value:e}}function se(){return{type:O.COMPLETE_ONBOARDING}}async function oe(e){let t;a.default.debug("background.getState");try{t=await(0,v.submitRequestToBackground)("getState")}catch(t){throw e(ee(t.message)),t}return e(j(t)),t}function ie(e){return async t=>{t(Z());try{await(0,N.loadRelativeTimeFormatLocaleData)(e);const n=await(0,N.fetchLocale)(e),a=await(0,v.submitRequestToBackground)("setCurrentLocale",[e]);await(0,c.default)(a),t(ce(e,n))}catch(e){return void t(ee(e.message))}finally{t(J())}}}function ce(e,t){return{type:O.SET_CURRENT_LOCALE,value:{locale:e,messages:t}}}function ue(){return{type:O.LOADING_METHOD_DATA_STARTED}}function de(){return{type:O.LOADING_METHOD_DATA_FINISHED}}function le(e){return{type:O.SET_NEXT_NONCE,value:e}}function Ee(e){return{type:O.SET_REQUEST_ACCOUNT_TABS,value:e}}function Te(e){return{type:O.SET_OPEN_METAMASK_TAB_IDS,value:e}}function fe(e){return{type:O.SET_CURRENT_WINDOW_TAB,value:e}}async function me(){await(0,v.submitRequestToBackground)("markNotificationPopupAsAutomaticallyClosed"),global.platform.closeCurrentWindow()}function he(e,t){return(0,v.submitRequestToBackground)("trackMetaMetricsEvent",[{...e,actionId:(0,v.generateActionId)()},t])}async function pe(e){await(0,v.submitRequestToBackground)("setUnconnectedAccountAlertShown",[e])}const ge=async(e,t,n)=>{const a=t.map((t=>{const a={...e,maxFeePerGas:(0,I.decimalToHex)(t.maxFeePerGas),maxPriorityFeePerGas:(0,I.decimalToHex)(t.maxPriorityFeePerGas),gas:n?(0,I.decimalToHex)(21e3):e.gas,value:e.value};return n&&(a.to=a.from,a.data="0x"),a}));return await(0,v.submitRequestToBackground)("approveTransactionsWithSameNonce",[a])}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$"}],[83,{"@sentry/utils":1357},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FilterEvents=void 0;var a=e("@sentry/utils");function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s{constructor({getMetaMetricsEnabled:e}){r(this,"name",s.id),r(this,"getMetaMetricsEnabled",void 0),this.getMetaMetricsEnabled=e}setupOnce(e,t){e((e=>{const n=t().getIntegration(s);return n&&!n.getMetaMetricsEnabled()?(a.logger.warn("Event dropped due to MetaMetrics setting."),null):e}))}}n.FilterEvents=s,r(s,"id","FilterEvents")}}},{package:"$root$"}],[84,{"../../../shared/constants/app":5397,"./extractEthjsErrorMessage":59,"./sentry-filter-events":83,"@sentry/browser":1293,"@sentry/integrations":1336,_process:4870},function(){with(this)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.SENTRY_STATE=n.ERROR_URL_ALLOWLIST=void 0,n.default=function({release:e,getState:t}){if(!e)throw new Error("Missing release");const n=l===o.BuildType.main?d:"production-main";let a;console.log(`Setting up Sentry Remote Error Reporting for '${n}': SENTRY_DSN`),a="https://3567c198f8a8412082d32655da2961d0@sentry.io/273505";return r.init({dsn:a,debug:false,environment:n,integrations:[new i.FilterEvents({getMetaMetricsEnabled:function(){if(!t)return!1;{var e,n;const a=t();if(null==a||null===(e=a.store)||void 0===e||null===(n=e.metamask)||void 0===n||!n.participateInMetaMetrics)return!1}return!0}}),new s.Dedupe,new s.ExtraErrorData],release:e,beforeSend:e=>m(e,t),beforeBreadcrumb(e){if(!t)return null;{var n,a,r,s;const o=t();if(Object.values(o).length&&(null==o||null===(n=o.store)||void 0===n||null===(a=n.metamask)||void 0===a||!a.participateInMetaMetrics||null==o||null===(r=o.store)||void 0===r||null===(s=r.metamask)||void 0===s||!s.completedOnboarding||"ui.input"===(null==e?void 0:e.category)))return null}return f(e)}}),r},n.removeUrlsFromBreadCrumb=f,n.rewriteReport=m;var a,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}a.default=e,n&&n.set(e,a);return a}(e("@sentry/browser")),s=e("@sentry/integrations"),o=e("../../../shared/constants/app"),i=e("./sentry-filter-events"),c=(a=e("./extractEthjsErrorMessage"))&&a.__esModule?a:{default:a};function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}const d="production",l=(t.env.SENTRY_DSN_DEV,"main"),E={CRYPTOCOMPARE:"cryptocompare.com",COINGECKO:"coingecko.com",ETHERSCAN:"etherscan.io",CODEFI:"codefi.network",SEGMENT:"segment.io"};n.ERROR_URL_ALLOWLIST=E;function T(e){return e.match(/^(chrome-extension|moz-extension):\/\//u)?e:""}function f(e){var t,n,a;return null!=e&&null!==(t=e.data)&&void 0!==t&&t.url&&(e.data.url=T(e.data.url)),null!=e&&null!==(n=e.data)&&void 0!==n&&n.to&&(e.data.to=T(e.data.to)),null!=e&&null!==(a=e.data)&&void 0!==a&&a.from&&(e.data.from=T(e.data.from)),e}function m(e,t){try{if(function(e){h(e,(e=>{let t=(0,c.default)(e);return 0===t.indexOf("Transaction Failed: known transaction")&&(t="Transaction Failed: known transaction"),t}))}(e),function(e){h(e,(e=>{let t=e;const n=/(([-.+a-zA-Z]+:\/\/)|(www\.))\S+[@:.]\S+/gu;return(t.match(n)||[]).forEach((e=>{try{const n=new URL(e),{hostname:a}=n;Object.values(E).some((e=>a===e||a.endsWith(`.${e}`)))||(t=t.replace(e,"**"))}catch(n){t=t.replace(e,"**")}})),t}))}(e),function(e){h(e,(e=>e.replace(/0x[A-Fa-f0-9]{40}/u,"0x**")))}(e),function(e){e.request.url=p(e.request.url),e.exception&&e.exception.values&&e.exception.values.forEach((e=>{e.stacktrace&&e.stacktrace.frames.forEach((e=>{e.filename=p(e.filename)}))}))}(e),t){const n=t();e.extra||(e.extra={}),e.extra.appState=n}}catch(e){console.warn(e)}return e}function h(e,t){"string"==typeof e.message&&(e.message=t(e.message)),e.exception&&e.exception.values&&e.exception.values.forEach((e=>{"string"==typeof e.value&&(e.value=t(e.value))}))}function p(e){const t=null==e?void 0:e.split(globalThis.location.origin)[1];if(!t)return e;return`metamask${t}`}n.SENTRY_STATE={gas:!0,history:!0,metamask:{alertEnabledness:!0,completedOnboarding:!0,connectedStatusPopoverHasBeenShown:!0,conversionDate:!0,conversionRate:!0,currentBlockGasLimit:!0,currentCurrency:!0,currentLocale:!0,customNonceValue:!0,defaultHomeActiveTabName:!0,featureFlags:!0,firstTimeFlowType:!0,forgottenPassword:!0,incomingTxLastFetchedBlockByChainId:!0,ipfsGateway:!0,isAccountMenuOpen:!0,isInitialized:!0,isUnlocked:!0,metaMetricsId:!0,nativeCurrency:!0,network:!0,nextNonce:!0,participateInMetaMetrics:!0,preferences:!0,provider:{nickname:!0,ticker:!0,type:!0},seedPhraseBackedUp:!0,unapprovedDecryptMsgCount:!0,unapprovedEncryptionPublicKeyMsgCount:!0,unapprovedMsgCount:!0,unapprovedPersonalMsgCount:!0,unapprovedTypedMessagesCount:!0,useBlockie:!0,useNonceField:!0,usePhishDetect:!0,welcomeScreenSeen:!0},unconnectedAccount:!0}}).call(this)}).call(this,e("_process"))}}},{package:"$root$"}],[85,{"../../../shared/constants/app":5397,"obj-multiplex":4838,pump:4885},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setupMultiplex=function(e){const t=new a.default;return t.ignoreStream(s.EXTENSION_MESSAGES.CONNECTION_READY),t.ignoreStream("ACK_KEEP_ALIVE_MESSAGE"),t.ignoreStream("WORKER_KEEP_ALIVE_MESSAGE"),(0,r.default)(e,t,e,(e=>{e&&console.error(e)})),t};var a=o(e("obj-multiplex")),r=o(e("pump")),s=e("../../../shared/constants/app");function o(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$"}],[87,{"../../../shared/constants/app":5397,"../../../shared/constants/network":5403,"../../../shared/modules/hexstring-utils":5425,"bn.js":1753,lodash:4765,"webextension-polyfill":5375},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BnMultiplyByFraction=function(e,t,n){const a=new r.default(t),s=new r.default(n);return e.mul(a).div(s)},n.addHexPrefix=void 0,n.addUrlProtocolPrefix=function(e){if(!e.match(/(^http:\/\/)|(^https:\/\/)/u))return`https://${e}`;return e},n.bnToHex=function(e){return l(e.toString(16))},n.checkAlarmExists=function(e,t){return e.some((e=>e.name===t))},n.checkForError=function(){const{lastError:e}=a.default.runtime;if(!e)return undefined;if(e.stack&&e.message)return e;return new Error(e.message)},n.deferredPromise=function(){let e,t;return{promise:new Promise(((n,a)=>{e=n,t=a})),resolve:e,reject:t}},n.generateRandomId=void 0,n.getChainType=function(e){if(e===o.CHAIN_IDS.MAINNET)return"mainnet";if(o.TEST_CHAINS.includes(e))return"testnet";return"custom"},n.getPlatform=n.getEnvironmentType=void 0,n.hexToBn=function(e){return new r.default((0,c.stripHexPrefix)(e),16)},n.isValidDate=void 0,n.previousValueComparator=function(e,t){let n,a=!0;return r=>{try{return a?(a=!1,e(null!=t?t:r,r)):e(n,r)}finally{n=r}}};var a=u(e("webextension-polyfill")),r=u(e("bn.js")),s=e("lodash"),o=e("../../../shared/constants/network"),i=e("../../../shared/constants/app"),c=e("../../../shared/modules/hexstring-utils");function u(e){return e&&e.__esModule?e:{default:e}}const d=(0,s.memoize)((e=>{const t=new URL(e);return"/popup.html"===t.pathname?i.ENVIRONMENT_TYPE_POPUP:["/home.html"].includes(t.pathname)?i.ENVIRONMENT_TYPE_FULLSCREEN:"/notification.html"===t.pathname?i.ENVIRONMENT_TYPE_NOTIFICATION:i.ENVIRONMENT_TYPE_BACKGROUND}));n.getEnvironmentType=(e=window.location.href)=>d(e);n.getPlatform=()=>{const{navigator:e}=window,{userAgent:t}=e;return t.includes("Firefox")?i.PLATFORM_FIREFOX:"brave"in e?i.PLATFORM_BRAVE:t.includes("Edg/")?i.PLATFORM_EDGE:t.includes("OPR")?i.PLATFORM_OPERA:i.PLATFORM_CHROME};const l=e=>"string"!=typeof e||e.match(/^-?0x/u)?e:e.match(/^-?0X/u)?e.replace("0X","0x"):e.startsWith("-")?e.replace("-","-0x"):`0x${e}`;n.addHexPrefix=l;const E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";n.generateRandomId=()=>{let e="";const t=E.length;for(let n=0;n<20;n++)e+=E.charAt(Math.floor(Math.random()*t));return e};n.isValidDate=e=>e instanceof Date&&!isNaN(e)}}},{package:"$root$"}],[985,{"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"async-mutex":1539,"eth-query":2099},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountTrackerController=void 0;const s=r(e("eth-query")),o=e("async-mutex"),i=e("@metamask/base-controller"),c=e("@metamask/controller-utils");class u extends i.BaseController{constructor({onPreferencesStateChange:e,getIdentities:t},n,r){super(n,r),this.mutex=new o.Mutex,this.name="AccountTrackerController",this.refresh=()=>a(this,void 0,void 0,(function*(){this.syncAccounts();const e=Object.assign({},this.state.accounts);for(const t in e)yield(0,c.safelyExecuteWithTimeout)((()=>a(this,void 0,void 0,(function*(){const n=yield(0,c.query)(this.ethQuery,"getBalance",[t]);e[t]={balance:(0,c.BNToHex)(n)}}))));this.update({accounts:e})})),this.defaultConfig={interval:1e4},this.defaultState={accounts:{}},this.initialize(),this.getIdentities=t,e((()=>{this.refresh()})),this.poll()}syncAccounts(){const{accounts:e}=this.state,t=Object.keys(this.getIdentities()),n=Object.keys(e),a=t.filter((e=>-1===n.indexOf(e))),r=n.filter((e=>-1===t.indexOf(e)));a.forEach((t=>{e[t]={balance:"0x0"}})),r.forEach((t=>{delete e[t]})),this.update({accounts:Object.assign({},e)})}set provider(e){this.ethQuery=new s.default(e)}get provider(){throw new Error("Property only used for setting")}poll(e){return a(this,void 0,void 0,(function*(){const t=yield this.mutex.acquire();e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield this.refresh(),this.handle=setTimeout((()=>{t(),this.poll(this.config.interval)}),this.config.interval)}))}syncBalanceWithAddresses(e){return a(this,void 0,void 0,(function*(){return yield Promise.all(e.map((e=>(0,c.safelyExecuteWithTimeout)((()=>a(this,void 0,void 0,(function*(){const t=yield(0,c.query)(this.ethQuery,"getBalance",[e]);return[e,t]}))))))).then((e=>e.reduce(((e,t)=>{if(!t)return e;const[n,a]=t;return Object.assign(Object.assign({},e),{[n]:{balance:a}})}),{})))}))}}n.AccountTrackerController=u,n.default=u}}},{package:"@metamask/assets-controllers"}],[986,{"./Standards/ERC20Standard":990,"./Standards/NftStandards/ERC1155/ERC1155Standard":991,"./Standards/NftStandards/ERC721/ERC721Standard":992,"./assetsUtil":998,"@ethersproject/contracts":394,"@ethersproject/providers":433,"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"single-call-balance-checker-abi":5151},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AssetsContractController=n.MISSING_PROVIDER_ERROR=n.SINGLE_CALL_BALANCES_ADDRESS_BY_CHAINID=void 0;const s=r(e("single-call-balance-checker-abi")),o=e("@ethersproject/contracts"),i=e("@ethersproject/providers"),c=e("@metamask/base-controller"),u=e("@metamask/controller-utils"),d=e("./assetsUtil"),l=e("./Standards/NftStandards/ERC721/ERC721Standard"),E=e("./Standards/NftStandards/ERC1155/ERC1155Standard"),T=e("./Standards/ERC20Standard");n.SINGLE_CALL_BALANCES_ADDRESS_BY_CHAINID={[d.SupportedTokenDetectionNetworks.mainnet]:"0xb1f8e55c7f64d203c1400b9d8555d050f94adf39",[d.SupportedTokenDetectionNetworks.bsc]:"0x2352c63A83f9Fd126af8676146721Fa00924d7e4",[d.SupportedTokenDetectionNetworks.polygon]:"0x2352c63A83f9Fd126af8676146721Fa00924d7e4",[d.SupportedTokenDetectionNetworks.avax]:"0xD023D153a0DFa485130ECFdE2FAA7e612EF94818"},n.MISSING_PROVIDER_ERROR="AssetsContractController failed to set the provider correctly. A provider must be set for this method to be available";class f extends c.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t},n,a){super(n,a),this.name="AssetsContractController",this.defaultConfig={provider:undefined,ipfsGateway:u.IPFS_DEFAULT_GATEWAY_URL,chainId:d.SupportedTokenDetectionNetworks.mainnet},this.initialize(),e((({ipfsGateway:e})=>{this.configure({ipfsGateway:e})})),t((e=>{this.config.chainId!==e.providerConfig.chainId&&this.configure({chainId:e.providerConfig.chainId})}))}set provider(e){this._provider=new i.Web3Provider(e),this.erc721Standard=new l.ERC721Standard(this._provider),this.erc1155Standard=new E.ERC1155Standard(this._provider),this.erc20Standard=new T.ERC20Standard(this._provider)}get provider(){throw new Error("Property only used for setting")}getERC20BalanceOf(e,t){return a(this,void 0,void 0,(function*(){if(!this.erc20Standard)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc20Standard.getBalanceOf(e,t)}))}getERC20TokenDecimals(e){return a(this,void 0,void 0,(function*(){if(this.erc20Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return yield this.erc20Standard.getTokenDecimals(e)}))}getERC721NftTokenId(e,t,a){if(this.erc721Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc721Standard.getNftTokenId(e,t,a)}getTokenStandardAndDetails(e,t,r){return a(this,void 0,void 0,(function*(){if(this.erc721Standard===undefined||this.erc1155Standard===undefined||this.erc20Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);const{ipfsGateway:a}=this.config;try{return Object.assign({},yield this.erc721Standard.getDetails(e,a,r))}catch(e){}try{return Object.assign({},yield this.erc1155Standard.getDetails(e,a,r))}catch(e){}try{return Object.assign({},yield this.erc20Standard.getDetails(e,t))}catch(e){}throw new Error("Unable to determine contract standard")}))}getERC721TokenURI(e,t){return a(this,void 0,void 0,(function*(){if(this.erc721Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc721Standard.getTokenURI(e,t)}))}getERC721AssetName(e){return a(this,void 0,void 0,(function*(){if(this.erc721Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc721Standard.getAssetName(e)}))}getERC721AssetSymbol(e){return a(this,void 0,void 0,(function*(){if(this.erc721Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc721Standard.getAssetSymbol(e)}))}getERC721OwnerOf(e,t){return a(this,void 0,void 0,(function*(){if(this.erc721Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc721Standard.getOwnerOf(e,t)}))}getERC1155TokenURI(e,t){return a(this,void 0,void 0,(function*(){if(this.erc1155Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return this.erc1155Standard.getTokenURI(e,t)}))}getERC1155BalanceOf(e,t,r){return a(this,void 0,void 0,(function*(){if(this.erc1155Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return yield this.erc1155Standard.getBalanceOf(t,e,r)}))}transferSingleERC1155(e,t,r,s,o){return a(this,void 0,void 0,(function*(){if(this.erc1155Standard===undefined)throw new Error(n.MISSING_PROVIDER_ERROR);return yield this.erc1155Standard.transferSingle(e,t,r,s,o)}))}getBalancesInSingleCall(e,t){return a(this,void 0,void 0,(function*(){if(!(this.config.chainId in n.SINGLE_CALL_BALANCES_ADDRESS_BY_CHAINID))return{};const a=n.SINGLE_CALL_BALANCES_ADDRESS_BY_CHAINID[this.config.chainId],r=new o.Contract(a,s.default,this._provider),i=yield r.balances([e],t),c={};return i.length>0&&t.forEach(((e,t)=>{const n=i[t];"0"!==String(n)&&(c[e]=n)})),c}))}}n.AssetsContractController=f,n.default=f}}},{package:"@metamask/assets-controllers"}],[987,{"./crypto-compare":999,"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"async-mutex":1539},function(){with(this)return function(){"use strict";return function(e,t,n){var a,r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},s=this&&this.__classPrivateFieldSet||function(e,t,n,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(e,n):r?r.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.CurrencyRateController=void 0;const i=e("async-mutex"),c=e("@metamask/base-controller"),u=e("@metamask/controller-utils"),d=e("./crypto-compare"),l={conversionDate:{persist:!0,anonymous:!0},conversionRate:{persist:!0,anonymous:!0},currentCurrency:{persist:!0,anonymous:!0},nativeCurrency:{persist:!0,anonymous:!0},pendingCurrentCurrency:{persist:!1,anonymous:!0},pendingNativeCurrency:{persist:!1,anonymous:!0},usdConversionRate:{persist:!0,anonymous:!0}},E={conversionDate:0,conversionRate:0,currentCurrency:"usd",nativeCurrency:"ETH",pendingCurrentCurrency:null,pendingNativeCurrency:null,usdConversionRate:null};class T extends c.BaseControllerV2{constructor({includeUsdRate:e=!1,interval:t=18e4,messenger:n,state:r,fetchExchangeRate:o=d.fetchExchangeRate}){super({name:"CurrencyRateController",metadata:l,messenger:n,state:Object.assign(Object.assign({},E),r)}),this.mutex=new i.Mutex,a.set(this,void 0),this.includeUsdRate=e,this.intervalDelay=t,this.fetchExchangeRate=o,s(this,a,!1,"f")}start(){return r(this,void 0,void 0,(function*(){s(this,a,!0,"f"),yield this.startPolling()}))}stop(){s(this,a,!1,"f"),this.stopPolling()}destroy(){super.destroy(),this.stopPolling()}setCurrentCurrency(e){return r(this,void 0,void 0,(function*(){this.update((t=>{t.pendingCurrentCurrency=e})),yield this.updateExchangeRate()}))}setNativeCurrency(e){return r(this,void 0,void 0,(function*(){this.update((t=>{t.pendingNativeCurrency=e})),yield this.updateExchangeRate()}))}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(){return r(this,void 0,void 0,(function*(){this.stopPolling(),yield(0,u.safelyExecute)((()=>r(this,void 0,void 0,(function*(){return yield this.updateExchangeRate()})))),this.intervalId=setInterval((()=>r(this,void 0,void 0,(function*(){yield(0,u.safelyExecute)((()=>r(this,void 0,void 0,(function*(){return yield this.updateExchangeRate()}))))}))),this.intervalDelay)}))}updateExchangeRate(){return r(this,void 0,void 0,(function*(){if(!o(this,a,"f"))return console.info("[CurrencyRateController] Not updating exchange rate since network requests have been disabled"),this.state;const e=yield this.mutex.acquire(),{currentCurrency:t,nativeCurrency:n,pendingCurrentCurrency:r,pendingNativeCurrency:s}=this.state;let i=null,c=null,d=null;const l=null!=r?r:t,E=null!=s?s:n,T=Object.values(u.TESTNET_TICKER_SYMBOLS).includes(E)?u.FALL_BACK_VS_CURRENCY:E;try{if(l&&E&&""!==l&&""!==E){const e=yield this.fetchExchangeRate(l,T,this.includeUsdRate);c=e.conversionRate,d=e.usdConversionRate,i=Date.now()/1e3}}catch(e){if(!(e instanceof Error&&e.message.includes("market does not exist for this coin pair")))throw e}finally{try{this.update((()=>({conversionDate:i,conversionRate:c,nativeCurrency:E,currentCurrency:l,pendingCurrentCurrency:null,pendingNativeCurrency:null,usdConversionRate:d})))}finally{e()}}return this.state}))}}n.CurrencyRateController=T,a=new WeakMap,n.default=T}}},{package:"@metamask/assets-controllers"}],[988,{"./assetsUtil":998,"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"async-mutex":1539,"ethereumjs-util":2178,events:1798},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.NftController=void 0;const r=e("events"),s=e("ethereumjs-util"),o=e("async-mutex"),i=e("@metamask/base-controller"),c=e("@metamask/controller-utils"),u=e("./assetsUtil"),d="allNfts",l="allNftContracts";class E extends i.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,getERC721AssetName:n,getERC721AssetSymbol:a,getERC721TokenURI:s,getERC721OwnerOf:i,getERC1155BalanceOf:u,getERC1155TokenURI:d,onNftAdded:l},E,T){super(E,T),this.mutex=new o.Mutex,this.hub=new r.EventEmitter,this.name="NftController",this.defaultConfig={networkType:c.MAINNET,selectedAddress:"",chainId:"",ipfsGateway:c.IPFS_DEFAULT_GATEWAY_URL,openSeaEnabled:!1,useIPFSSubdomains:!0},this.defaultState={allNftContracts:{},allNfts:{},ignoredNfts:[]},this.initialize(),this.getERC721AssetName=n,this.getERC721AssetSymbol=a,this.getERC721TokenURI=s,this.getERC721OwnerOf=i,this.getERC1155BalanceOf=u,this.getERC1155TokenURI=d,this.onNftAdded=l,e((({selectedAddress:e,ipfsGateway:t,openSeaEnabled:n})=>{this.configure({selectedAddress:e,ipfsGateway:t,openSeaEnabled:n})})),t((({providerConfig:e})=>{const{chainId:t}=e;this.configure({chainId:t})}))}getNftApi({contractAddress:e,tokenId:t,useProxy:n}){const{chainId:a}=this.config;return a===c.RINKEBY_CHAIN_ID?`${c.OPENSEA_TEST_API_URL}/asset/${e}/${t}`:n?`${c.OPENSEA_PROXY_URL}/asset/${e}/${t}`:`${c.OPENSEA_API_URL}/asset/${e}/${t}`}getNftContractInformationApi({contractAddress:e,useProxy:t}){const{chainId:n}=this.config;return n===c.RINKEBY_CHAIN_ID?`${c.OPENSEA_TEST_API_URL}/asset_contract/${e}`:t?`${c.OPENSEA_PROXY_URL}/asset_contract/${e}`:`${c.OPENSEA_API_URL}/asset_contract/${e}`}updateNestedNftState(e,t,{userAddress:n,chainId:a}={userAddress:this.config.selectedAddress,chainId:this.config.chainId}){const{[t]:r}=this.state,s=r[n],o=Object.assign(Object.assign({},s),{[a]:e}),i=Object.assign(Object.assign({},r),{[n]:o});this.update({[t]:i})}getNftInformationFromApi(e,t){return a(this,void 0,void 0,(function*(){let n=yield(0,c.fetchWithErrorHandling)({url:this.getNftApi({contractAddress:e,tokenId:t,useProxy:!0})});if(!n&&this.openSeaApiKey&&(n=yield(0,c.fetchWithErrorHandling)({url:this.getNftApi({contractAddress:e,tokenId:t,useProxy:!1}),options:{headers:{"X-API-KEY":this.openSeaApiKey}},errorCodesToCatch:[403]})),!n)return{name:null,description:null,image:null,standard:null};const{num_sales:a,background_color:r,image_url:s,image_preview_url:o,image_thumbnail_url:i,image_original_url:u,animation_url:d,animation_original_url:l,name:E,description:T,external_link:f,creator:m,last_sale:h,asset_contract:{schema_name:p}}=n;return Object.assign({},{name:E||null},{description:T||null},{image:s||null},m&&{creator:m},a&&{numberOfSales:a},r&&{backgroundColor:r},o&&{imagePreview:o},i&&{imageThumbnail:i},u&&{imageOriginal:u},d&&{animation:d},l&&{animationOriginal:l},f&&{externalLink:f},h&&{lastSale:h},p&&{standard:p})}))}getNftInformationFromTokenURI(e,t){return a(this,void 0,void 0,(function*(){const{ipfsGateway:n,useIPFSSubdomains:a}=this.config,r=yield this.getNftURIAndStandard(e,t);let s=r[0];const o=r[1];s.startsWith("ipfs://")&&(s=(0,u.getFormattedIpfsUrl)(n,s,a));try{const e=yield(0,c.handleFetch)(s);return{image:e[Object.prototype.hasOwnProperty.call(e,"image")?"image":"image_url"],name:e.name,description:e.description,standard:o,favorite:!1}}catch(e){return{image:null,name:null,description:null,standard:o||null,favorite:!1}}}))}getNftURIAndStandard(e,t){return a(this,void 0,void 0,(function*(){try{return[yield this.getERC721TokenURI(e,t),c.ERC721]}catch(e){}try{const n=yield this.getERC1155TokenURI(e,t);if(!n.includes("{id}"))return[n,c.ERC1155];const a=(0,s.stripHexPrefix)((0,c.BNToHex)(new s.BN(t))).padStart(64,"0").toLowerCase();return[n.replace("{id}",a),c.ERC1155]}catch(e){}return["",""]}))}getNftInformation(e,t){var n,r,s,o,i,u,d,l;return a(this,void 0,void 0,(function*(){const E=yield(0,c.safelyExecute)((()=>a(this,void 0,void 0,(function*(){return yield this.getNftInformationFromTokenURI(e,t)}))));let T;return this.config.openSeaEnabled&&(T=yield(0,c.safelyExecute)((()=>a(this,void 0,void 0,(function*(){return yield this.getNftInformationFromApi(e,t)}))))),Object.assign(Object.assign({},T),{name:null!==(r=null!==(n=E.name)&&void 0!==n?n:null==T?void 0:T.name)&&void 0!==r?r:null,description:null!==(o=null!==(s=E.description)&&void 0!==s?s:null==T?void 0:T.description)&&void 0!==o?o:null,image:null!==(u=null!==(i=E.image)&&void 0!==i?i:null==T?void 0:T.image)&&void 0!==u?u:null,standard:null!==(l=null!==(d=E.standard)&&void 0!==d?d:null==T?void 0:T.standard)&&void 0!==l?l:null})}))}getNftContractInformationFromApi(e){return a(this,void 0,void 0,(function*(){let t=yield(0,c.fetchWithErrorHandling)({url:this.getNftContractInformationApi({contractAddress:e,useProxy:!0})});return t||(this.openSeaApiKey&&(t=yield(0,c.fetchWithErrorHandling)({url:this.getNftContractInformationApi({contractAddress:e,useProxy:!1}),options:{headers:{"X-API-KEY":this.openSeaApiKey}},errorCodesToCatch:[403]}),t)?t:{address:e,asset_contract_type:null,created_date:null,schema_name:null,symbol:null,total_supply:null,description:null,external_link:null,collection:{name:null,image_url:null}})}))}getNftContractInformationFromContract(e){return a(this,void 0,void 0,(function*(){return{collection:{name:yield this.getERC721AssetName(e)},symbol:yield this.getERC721AssetSymbol(e),address:e}}))}getNftContractInformation(e){return a(this,void 0,void 0,(function*(){const t=yield(0,c.safelyExecute)((()=>a(this,void 0,void 0,(function*(){return yield this.getNftContractInformationFromContract(e)}))));let n;return this.config.openSeaEnabled&&(n=yield(0,c.safelyExecute)((()=>a(this,void 0,void 0,(function*(){return yield this.getNftContractInformationFromApi(e)}))))),t||n?Object.assign(Object.assign(Object.assign({},n),t),{collection:Object.assign(Object.assign({image_url:null},null==n?void 0:n.collection),null==t?void 0:t.collection)}):{address:e,asset_contract_type:null,created_date:null,schema_name:null,symbol:null,total_supply:null,description:null,external_link:null,collection:{name:null,image_url:null}}}))}addIndividualNft(e,t,n,r,s){var o;return a(this,void 0,void 0,(function*(){const a=yield this.mutex.acquire();try{e=(0,c.toChecksumHexAddress)(e);const{allNfts:i}=this.state;let l,E;s?(l=s.chainId,E=s.userAddress):(l=this.config.chainId,E=this.config.selectedAddress);const T=(null===(o=i[E])||void 0===o?void 0:o[l])||[],f=T.find((n=>n.address.toLowerCase()===e.toLowerCase()&&n.tokenId===t));if(f){if(!(0,u.compareNftMetadata)(n,f))return T;{const n=T.findIndex((n=>n.address.toLowerCase()===e.toLowerCase()&&n.tokenId===t));-1!==n&&T.splice(n,1)}}const m=Object.assign({address:e,tokenId:t,favorite:(null==f?void 0:f.favorite)||!1,isCurrentlyOwned:!0},n),h=[...T,m];return this.updateNestedNftState(h,d,{chainId:l,userAddress:E}),this.onNftAdded&&this.onNftAdded({address:e,symbol:r.symbol,tokenId:t.toString(),standard:n.standard,source:s?"detected":"custom"}),h}finally{a()}}))}addNftContract(e,t){var n;return a(this,void 0,void 0,(function*(){const a=yield this.mutex.acquire();try{e=(0,c.toChecksumHexAddress)(e);const{allNftContracts:r}=this.state;let s,o;t?(s=t.chainId,o=t.userAddress):(s=this.config.chainId,o=this.config.selectedAddress);const i=(null===(n=r[o])||void 0===n?void 0:n[s])||[];if(i.find((t=>t.address.toLowerCase()===e.toLowerCase())))return i;const u=yield this.getNftContractInformation(e),{asset_contract_type:d,created_date:E,schema_name:T,symbol:f,total_supply:m,description:h,external_link:p,collection:{name:g,image_url:_}}=u;if(t&&!g||0===Object.keys(u).length)return i;const S=Object.assign({},{address:e},h&&{description:h},g&&{name:g},_&&{logo:_},f&&{symbol:f},null!=m&&{totalSupply:m},d&&{assetContractType:d},E&&{createdDate:E},T&&{schemaName:T},p&&{externalLink:p}),A=[...i,S];return this.updateNestedNftState(A,l,{chainId:s,userAddress:o}),A}finally{a()}}))}removeAndIgnoreIndividualNft(e,t){var n;e=(0,c.toChecksumHexAddress)(e);const{allNfts:a,ignoredNfts:r}=this.state,{chainId:s,selectedAddress:o}=this.config,i=[...r],u=((null===(n=a[o])||void 0===n?void 0:n[s])||[]).filter((n=>{if(n.address.toLowerCase()===e.toLowerCase()&&n.tokenId===t){return!i.find((n=>n.address===e&&n.tokenId===t))&&i.push(n),!1}return!0}));this.updateNestedNftState(u,d),this.update({ignoredNfts:i})}removeIndividualNft(e,t){var n;e=(0,c.toChecksumHexAddress)(e);const{allNfts:a}=this.state,{chainId:r,selectedAddress:s}=this.config,o=((null===(n=a[s])||void 0===n?void 0:n[r])||[]).filter((n=>!(n.address.toLowerCase()===e.toLowerCase()&&n.tokenId===t)));this.updateNestedNftState(o,d)}removeNftContract(e){var t;e=(0,c.toChecksumHexAddress)(e);const{allNftContracts:n}=this.state,{chainId:a,selectedAddress:r}=this.config,s=((null===(t=n[r])||void 0===t?void 0:t[a])||[]).filter((t=>!(t.address.toLowerCase()===e.toLowerCase())));return this.updateNestedNftState(s,l),s}setApiKey(e){this.openSeaApiKey=e}isNftOwner(e,t,n){return a(this,void 0,void 0,(function*(){try{const a=yield this.getERC721OwnerOf(t,n);return e.toLowerCase()===a.toLowerCase()}catch(e){}try{return!(yield this.getERC1155BalanceOf(e,t,n)).isZero()}catch(e){}throw new Error("Unable to verify ownership. Probably because the standard is not supported or the chain is incorrect.")}))}addNftVerifyOwnership(e,t){return a(this,void 0,void 0,(function*(){const{selectedAddress:n}=this.config;if(!(yield this.isNftOwner(n,e,t)))throw new Error("This NFT is not owned by the user");yield this.addNft(e,t)}))}addNft(e,t,n,r){return a(this,void 0,void 0,(function*(){e=(0,c.toChecksumHexAddress)(e);const a=yield this.addNftContract(e,r);n=n||(yield this.getNftInformation(e,t));const s=a.find((t=>t.address.toLowerCase()===e.toLowerCase()));s&&(yield this.addIndividualNft(e,t,n,s,r))}))}removeNft(e,t){var n;e=(0,c.toChecksumHexAddress)(e),this.removeIndividualNft(e,t);const{allNfts:a}=this.state,{chainId:r,selectedAddress:s}=this.config;((null===(n=a[s])||void 0===n?void 0:n[r])||[]).find((t=>t.address.toLowerCase()===e.toLowerCase()))||this.removeNftContract(e)}removeAndIgnoreNft(e,t){var n;e=(0,c.toChecksumHexAddress)(e),this.removeAndIgnoreIndividualNft(e,t);const{allNfts:a}=this.state,{chainId:r,selectedAddress:s}=this.config;((null===(n=a[s])||void 0===n?void 0:n[r])||[]).find((t=>t.address.toLowerCase()===e.toLowerCase()))||this.removeNftContract(e)}clearIgnoredNfts(){this.update({ignoredNfts:[]})}checkAndUpdateSingleNftOwnershipStatus(e,t,{userAddress:n,chainId:r}={userAddress:this.config.selectedAddress,chainId:this.config.chainId}){var s;return a(this,void 0,void 0,(function*(){const{address:a,tokenId:o}=e;let i=e.isCurrentlyOwned;try{i=yield this.isNftOwner(n,a,o)}catch(e){if(!(e instanceof Error&&e.message.includes("Unable to verify ownership")))throw e}if(e.isCurrentlyOwned=i,!0===t)return e;const{allNfts:c}=this.state,u=(null===(s=c[n])||void 0===s?void 0:s[r])||[],l=u.find((e=>e.tokenId===o&&e.address.toLowerCase()===a.toLowerCase()));return l&&(l.isCurrentlyOwned=i,this.updateNestedNftState(u,d,{userAddress:n,chainId:r})),e}))}checkAndUpdateAllNftsOwnershipStatus(){var e;return a(this,void 0,void 0,(function*(){const{allNfts:t}=this.state,{chainId:n,selectedAddress:r}=this.config,s=(null===(e=t[r])||void 0===e?void 0:e[n])||[],o=yield Promise.all(s.map((e=>a(this,void 0,void 0,(function*(){var t;return null!==(t=yield this.checkAndUpdateSingleNftOwnershipStatus(e,!0))&&void 0!==t?t:e})))));this.updateNestedNftState(o,d)}))}updateNftFavoriteStatus(e,t,n){var a;const{allNfts:r}=this.state,{chainId:s,selectedAddress:o}=this.config,i=(null===(a=r[o])||void 0===a?void 0:a[s])||[],c=i.findIndex((n=>n.address===e&&n.tokenId===t));if(-1===c)return;const u=Object.assign(Object.assign({},i[c]),{favorite:n});i[c]=u,this.updateNestedNftState(i,d)}findNftByAddressAndTokenId(e,t,n,a){var r;const{allNfts:s}=this.state,o=(null===(r=s[n])||void 0===r?void 0:r[a])||[],i=o.findIndex((n=>n.address.toLowerCase()===e.toLowerCase()&&n.tokenId===t));return-1===i?null:{nft:o[i],index:i}}updateNft(e,t,n,a){var r;const{allNfts:s}=this.state,o=(null===(r=s[n])||void 0===r?void 0:r[a])||[],i=this.findNftByAddressAndTokenId(e.address,e.tokenId,n,a);if(!i)return;const c=Object.assign(Object.assign({},e),t),u=[...o.slice(0,i.index),c,...o.slice(i.index+1)];this.updateNestedNftState(u,d)}resetNftTransactionStatusByTransactionId(e,t,n){var a;const{allNfts:r}=this.state,s=(null===(a=r[t])||void 0===a?void 0:a[n])||[],o=s.findIndex((t=>t.transactionId===e));if(-1===o)return!1;const i=Object.assign(Object.assign({},s[o]),{transactionId:undefined}),c=[...s.slice(0,o),i,...s.slice(o+1)];return this.updateNestedNftState(c,d),!0}}n.NftController=E,n.default=E}}},{package:"@metamask/assets-controllers"}],[989,{"@metamask/base-controller":1007,"@metamask/controller-utils":1024},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.NftDetectionController=void 0;const r=e("@metamask/base-controller"),s=e("@metamask/controller-utils");class o extends r.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,getOpenSeaApiKey:n,addNft:a,getNftState:r},o,i){super(o,i),this.name="NftDetectionController",this.isMainnet=()=>this.config.networkType===s.MAINNET,this.defaultConfig={interval:18e4,networkType:s.MAINNET,chainId:"1",selectedAddress:"",disabled:!0},this.initialize(),this.getNftState=r,e((({selectedAddress:e,useNftDetection:t})=>{const{selectedAddress:n,disabled:a}=this.config;e===n&&!t===a||this.configure({selectedAddress:e,disabled:!t}),t!==undefined&&(t?this.start():this.stop())})),t((({providerConfig:e})=>{this.configure({networkType:e.type,chainId:e.chainId})})),this.getOpenSeaApiKey=n,this.addNft=a}getOwnerNftApi({address:e,offset:t,useProxy:n}){return n?`${s.OPENSEA_PROXY_URL}/assets?owner=${e}&offset=${t}&limit=50`:`${s.OPENSEA_API_URL}/assets?owner=${e}&offset=${t}&limit=50`}getOwnerNfts(e){var t;return a(this,void 0,void 0,(function*(){let n,a=[];const r=this.getOpenSeaApiKey();let o=0,i=!1;do{if(n=yield(0,s.fetchWithErrorHandling)({url:this.getOwnerNftApi({address:e,offset:o,useProxy:!0}),timeout:15e3}),r&&!n&&(n=yield(0,s.fetchWithErrorHandling)({url:this.getOwnerNftApi({address:e,offset:o,useProxy:!1}),options:{headers:{"X-API-KEY":r}},timeout:15e3,errorCodesToCatch:[403]})),!n)return a;0!==(null===(t=null==n?void 0:n.assets)||void 0===t?void 0:t.length)?a=[...a,...n.assets]:i=!0,o+=50}while(!i);return a}))}start(){return a(this,void 0,void 0,(function*(){this.isMainnet()&&!this.disabled&&(yield this.startPolling())}))}stop(){this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(e){return a(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.stopPolling(),yield this.detectNfts(),this.intervalId=setInterval((()=>a(this,void 0,void 0,(function*(){yield this.detectNfts()}))),this.config.interval)}))}detectNfts(){return a(this,void 0,void 0,(function*(){if(!this.isMainnet()||this.disabled)return;const{selectedAddress:e,chainId:t}=this.config;if(!e)return;const n=(yield this.getOwnerNfts(e)).map((n=>a(this,void 0,void 0,(function*(){const{token_id:a,num_sales:r,background_color:o,image_url:i,image_preview_url:c,image_thumbnail_url:u,image_original_url:d,animation_url:l,animation_original_url:E,name:T,description:f,external_link:m,creator:h,asset_contract:{address:p,schema_name:g},last_sale:_}=n;let S;const{ignoredNfts:A}=this.getNftState();if(A.length&&(S=A.find((e=>e.address===(0,s.toChecksumHexAddress)(p)&&e.tokenId===a))),!S){const n=Object.assign({},{name:T},h&&{creator:h},f&&{description:f},i&&{image:i},r&&{numberOfSales:r},o&&{backgroundColor:o},c&&{imagePreview:c},u&&{imageThumbnail:u},d&&{imageOriginal:d},l&&{animation:l},E&&{animationOriginal:E},g&&{standard:g},m&&{externalLink:m},_&&{lastSale:_});yield this.addNft(p,a,n,{userAddress:e,chainId:t})}}))));yield Promise.all(n)}))}}n.NftDetectionController=o,n.default=o}}},{package:"@metamask/assets-controllers"}],[990,{"../assetsUtil":998,"@ethersproject/abi":370,"@ethersproject/contracts":394,"@metamask/controller-utils":1024,"@metamask/metamask-eth-abis":1211,"ethereumjs-util":2178},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.ERC20Standard=void 0;const r=e("@ethersproject/contracts"),s=e("@metamask/metamask-eth-abis"),o=e("ethereumjs-util"),i=e("@ethersproject/abi"),c=e("@metamask/controller-utils"),u=e("../assetsUtil");n.ERC20Standard=class{constructor(e){this.provider=e}getBalanceOf(e,t){return a(this,void 0,void 0,(function*(){const n=new r.Contract(e,s.abiERC20,this.provider),a=yield n.balanceOf(t);return(0,u.ethersBigNumberToBN)(a)}))}getTokenDecimals(e){return a(this,void 0,void 0,(function*(){const t=new r.Contract(e,s.abiERC20,this.provider);try{return(yield t.decimals()).toString()}catch(e){if(e.message.includes("call revert exception"))throw new Error("Failed to parse token decimals");throw e}}))}getTokenSymbol(e){return a(this,void 0,void 0,(function*(){const t={to:e,data:"0x95d89b41"},n=yield this.provider.call(t),a=new i.AbiCoder;try{const e=a.decode(["string"],n)[0];if((null==e?void 0:e.length)>0)return e}catch(e){}try{const e=(0,o.toUtf8)(n);if(e.length>0)return e}catch(e){}throw new Error("Failed to parse token symbol")}))}getDetails(e,t){return a(this,void 0,void 0,(function*(){const[n,a]=yield Promise.all([this.getTokenDecimals(e),this.getTokenSymbol(e)]);let r;return t&&(r=yield this.getBalanceOf(e,t)),{decimals:n,symbol:a,balance:r,standard:c.ERC20}}))}}}}},{package:"@metamask/assets-controllers"}],[991,{"../../../assetsUtil":998,"@ethersproject/contracts":394,"@metamask/controller-utils":1024,"@metamask/metamask-eth-abis":1211},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.ERC1155Standard=void 0;const r=e("@metamask/metamask-eth-abis"),s=e("@ethersproject/contracts"),o=e("@metamask/controller-utils"),i=e("../../../assetsUtil");n.ERC1155Standard=class{constructor(e){this.contractSupportsURIMetadataInterface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC1155_METADATA_URI_INTERFACE_ID)})),this.contractSupportsTokenReceiverInterface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC1155_TOKEN_RECEIVER_INTERFACE_ID)})),this.contractSupportsBase1155Interface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC1155_INTERFACE_ID)})),this.getTokenURI=(e,t)=>a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC1155,this.provider).uri(t)})),this.getBalanceOf=(e,t,n)=>a(this,void 0,void 0,(function*(){const a=new s.Contract(e,r.abiERC1155,this.provider),o=yield a.balanceOf(t,n);return(0,i.ethersBigNumberToBN)(o)})),this.transferSingle=(e,t,n,o,i)=>a(this,void 0,void 0,(function*(){const a=new s.Contract(e,r.abiERC1155,this.provider);return new Promise(((r,s)=>{a.transferSingle(e,t,n,o,i,((e,t)=>{e?s(e):r(t)}))}))})),this.contractSupportsInterface=(e,t)=>a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC1155,this.provider).supportsInterface(t)})),this.getDetails=(e,t,n)=>a(this,void 0,void 0,(function*(){if(!(yield this.contractSupportsBase1155Interface(e)))throw new Error("This isn't a valid ERC1155 contract");let a,r;if(n){a=yield this.getTokenURI(e,n),a.startsWith("ipfs://")&&(a=(0,i.getFormattedIpfsUrl)(t,a,!0));try{const e=yield(0,o.timeoutFetch)(a),n=yield e.json();r=null==n?void 0:n.image,(null==r?void 0:r.startsWith("ipfs://"))&&(r=(0,i.getFormattedIpfsUrl)(t,r,!0))}catch(e){}}return{standard:o.ERC1155,tokenURI:a,image:r}})),this.provider=e}}}}},{package:"@metamask/assets-controllers"}],[992,{"../../../assetsUtil":998,"@ethersproject/contracts":394,"@metamask/controller-utils":1024,"@metamask/metamask-eth-abis":1211},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.ERC721Standard=void 0;const r=e("@metamask/metamask-eth-abis"),s=e("@ethersproject/contracts"),o=e("@metamask/controller-utils"),i=e("../../../assetsUtil");n.ERC721Standard=class{constructor(e){this.contractSupportsMetadataInterface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC721_METADATA_INTERFACE_ID)})),this.contractSupportsEnumerableInterface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC721_ENUMERABLE_INTERFACE_ID)})),this.contractSupportsBase721Interface=e=>a(this,void 0,void 0,(function*(){return this.contractSupportsInterface(e,o.ERC721_INTERFACE_ID)})),this.getNftTokenId=(e,t,n)=>a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC721,this.provider).tokenOfOwnerByIndex(t,n)})),this.getTokenURI=(e,t)=>a(this,void 0,void 0,(function*(){const n=new s.Contract(e,r.abiERC721,this.provider);if(!(yield this.contractSupportsMetadataInterface(e)))throw new Error("Contract does not support ERC721 metadata interface.");return n.tokenURI(t)})),this.getAssetName=e=>a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC721,this.provider).name()})),this.getAssetSymbol=e=>a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC721,this.provider).symbol()})),this.contractSupportsInterface=(e,t)=>a(this,void 0,void 0,(function*(){const n=new s.Contract(e,r.abiERC721,this.provider);try{return yield n.supportsInterface(t)}catch(e){if(e.message.includes("call revert exception"))return!1;throw e}})),this.getDetails=(e,t,n)=>a(this,void 0,void 0,(function*(){if(!(yield this.contractSupportsBase721Interface(e)))throw new Error("This isn't a valid ERC721 contract");let a,r,s,c;try{s=yield this.getAssetSymbol(e)}catch(e){}try{c=yield this.getAssetName(e)}catch(e){}if(n)try{a=yield this.getTokenURI(e,n),a.startsWith("ipfs://")&&(a=(0,i.getFormattedIpfsUrl)(t,a,!0));const s=yield(0,o.timeoutFetch)(a),c=yield s.json();r=null==c?void 0:c.image,(null==r?void 0:r.startsWith("ipfs://"))&&(r=(0,i.getFormattedIpfsUrl)(t,r,!0))}catch(e){}return{standard:o.ERC721,tokenURI:a,symbol:s,name:c,image:r}})),this.provider=e}getOwnerOf(e,t){return a(this,void 0,void 0,(function*(){return new s.Contract(e,r.abiERC721,this.provider).ownerOf(t)}))}}}}},{package:"@metamask/assets-controllers"}],[993,{"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"ethereumjs-util":2178},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.TokenBalancesController=n.BN=void 0;const r=e("ethereumjs-util");Object.defineProperty(n,"BN",{enumerable:!0,get:function(){return r.BN}});const s=e("@metamask/base-controller"),o=e("@metamask/controller-utils");class i extends s.BaseController{constructor({onTokensStateChange:e,getSelectedAddress:t,getERC20BalanceOf:n},a,r){super(a,r),this.name="TokenBalancesController",this.defaultConfig={interval:18e4,tokens:[]},this.defaultState={contractBalances:{}},this.initialize(),e((({tokens:e,detectedTokens:t})=>{this.configure({tokens:[...e,...t]}),this.updateBalances()})),this.getSelectedAddress=t,this.getERC20BalanceOf=n,this.poll()}poll(e){return a(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield(0,o.safelyExecute)((()=>this.updateBalances())),this.handle=setTimeout((()=>{this.poll(this.config.interval)}),this.config.interval)}))}updateBalances(){return a(this,void 0,void 0,(function*(){if(this.disabled)return;const{tokens:e}=this.config,t={};for(const n in e){const{address:a}=e[n];try{t[a]=yield this.getERC20BalanceOf(a,this.getSelectedAddress()),e[n].balanceError=null}catch(s){t[a]=new r.BN(0),e[n].balanceError=s}}this.update({contractBalances:t})}))}}n.TokenBalancesController=i,n.default=i}}},{package:"@metamask/assets-controllers"}],[994,{"./assetsUtil":998,"@metamask/base-controller":1007,"@metamask/controller-utils":1024},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.TokenDetectionController=void 0;const r=e("@metamask/base-controller"),s=e("@metamask/controller-utils"),o=e("./assetsUtil");class i extends r.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,onTokenListStateChange:n,getBalancesInSingleCall:a,addDetectedTokens:r,getTokenListState:s,getTokensState:i,getNetworkState:c,getPreferencesState:u},d,l){const{providerConfig:{chainId:E}}=c(),{useTokenDetection:T}=u();super(d,l),this.name="TokenDetectionController",this.defaultConfig=Object.assign({interval:18e4,selectedAddress:"",disabled:!0,chainId:E,isDetectionEnabledFromPreferences:T,isDetectionEnabledForNetwork:(0,o.isTokenDetectionSupportedForNetwork)(E)},d),this.initialize(),this.getTokensState=i,this.getTokenListState=s,this.addDetectedTokens=r,this.getBalancesInSingleCall=a,n((({tokenList:e})=>{Object.keys(e).length&&this.detectTokens()})),e((({selectedAddress:e,useTokenDetection:t})=>{const{selectedAddress:n,isDetectionEnabledFromPreferences:a}=this.config,r=e!==n,s=a!==t;this.configure({isDetectionEnabledFromPreferences:t,selectedAddress:e}),t&&(r||s)&&this.detectTokens()})),t((({providerConfig:{chainId:e}})=>{const{chainId:t}=this.config,n=(0,o.isTokenDetectionSupportedForNetwork)(e),a=t!==e;this.configure({chainId:e,isDetectionEnabledForNetwork:n}),n&&a&&this.detectTokens()}))}start(){return a(this,void 0,void 0,(function*(){this.configure({disabled:!1}),yield this.startPolling()}))}stop(){this.configure({disabled:!0}),this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(e){return a(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.stopPolling(),yield this.detectTokens(),this.intervalId=setInterval((()=>a(this,void 0,void 0,(function*(){yield this.detectTokens()}))),this.config.interval)}))}detectTokens(){return a(this,void 0,void 0,(function*(){const{disabled:e,isDetectionEnabledForNetwork:t,isDetectionEnabledFromPreferences:n}=this.config;if(e||!t||!n)return;const{tokens:r}=this.getTokensState(),{selectedAddress:o,chainId:i}=this.config,c=r.map((e=>e.address.toLowerCase())),{tokenList:u}=this.getTokenListState(),d=[];for(const e in u)c.includes(e)||d.push(e);const l=[];if(l[0]=d.slice(0,1e3),l[1]=d.slice(1e3,d.length-1),o)for(const e of l){if(0===e.length)break;yield(0,s.safelyExecute)((()=>a(this,void 0,void 0,(function*(){const t=yield this.getBalancesInSingleCall(o,e),n=[];for(const e in t){let t;const{ignoredTokens:a}=this.getTokensState();a.length&&(t=a.find((t=>t===(0,s.toChecksumHexAddress)(e))));const r=Object.keys(u).find((t=>t.toLowerCase()===e.toLowerCase()))||"";if(t===undefined){const{decimals:t,symbol:a,aggregators:s,iconUrl:o}=u[r];n.push({address:e,decimals:t,symbol:a,aggregators:s,image:o,isERC721:!1})}}n.length&&(yield this.addDetectedTokens(n,{selectedAddress:o,chainId:i}))}))))}}))}}n.TokenDetectionController=i,n.default=i}}},{package:"@metamask/assets-controllers"}],[995,{"./assetsUtil":998,"./token-service":1001,"@metamask/base-controller":1007,"@metamask/controller-utils":1024,"abort-controller":1490,"async-mutex":1539},function(){with(this)return function(){"use strict";return function(e,t,n){var a,r,s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},o=this&&this.__classPrivateFieldGet||function(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.TokenListController=void 0;const i=e("async-mutex"),c=e("abort-controller"),u=e("@metamask/base-controller"),d=e("@metamask/controller-utils"),l=e("./assetsUtil"),E=e("./token-service"),T={tokenList:{persist:!0,anonymous:!0},tokensChainsCache:{persist:!0,anonymous:!0},preventPollingOnNetworkRestart:{persist:!0,anonymous:!0}},f={tokenList:{},tokensChainsCache:{},preventPollingOnNetworkRestart:!1};class m extends u.BaseControllerV2{constructor({chainId:e,preventPollingOnNetworkRestart:t=!1,onNetworkStateChange:n,interval:u=864e5,cacheRefreshThreshold:d=864e5,messenger:l,state:E}){super({name:"TokenListController",metadata:T,messenger:l,state:Object.assign(Object.assign({},f),E)}),a.add(this),this.mutex=new i.Mutex,this.intervalDelay=u,this.cacheRefreshThreshold=d,this.chainId=e,this.updatePreventPollingOnNetworkRestart(t),this.abortController=new c.AbortController,n?n((e=>s(this,void 0,void 0,(function*(){"providerConfig"in e?yield o(this,a,"m",r).call(this,e.providerConfig):yield o(this,a,"m",r).call(this,e)})))):this.messagingSystem.subscribe("NetworkController:providerConfigChange",(e=>s(this,void 0,void 0,(function*(){yield o(this,a,"m",r).call(this,e)}))))}start(){return s(this,void 0,void 0,(function*(){(0,l.isTokenListSupportedForNetwork)(this.chainId)&&(yield this.startPolling())}))}restart(){return s(this,void 0,void 0,(function*(){this.stopPolling(),yield this.startPolling()}))}stop(){this.stopPolling()}destroy(){super.destroy(),this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId)}startPolling(){return s(this,void 0,void 0,(function*(){yield(0,d.safelyExecute)((()=>this.fetchTokenList())),this.intervalId=setInterval((()=>s(this,void 0,void 0,(function*(){yield(0,d.safelyExecute)((()=>this.fetchTokenList()))}))),this.intervalDelay)}))}fetchTokenList(){var e;return s(this,void 0,void 0,(function*(){const t=yield this.mutex.acquire();try{const{tokensChainsCache:n}=this.state;let a={};const r=yield(0,d.safelyExecute)((()=>this.fetchFromCache()));if(r)a=Object.assign({},r);else{const t=yield(0,d.safelyExecute)((()=>(0,E.fetchTokenList)(this.chainId,this.abortController.signal)));if(!t)return a=Object.assign({},(null===(e=n[this.chainId])||void 0===e?void 0:e.data)||{}),void this.update((()=>Object.assign(Object.assign({},this.state),{tokenList:a,tokensChainsCache:n})));const r=t.filter((e=>e.occurrences&&e.occurrences>=3&&"0x0000000000000000000000000000000000000000"!==e.address)),s=r.map((e=>e.symbol)),o=[...new Set(s.filter(((e,t)=>s.indexOf(e)!==t)))],i=r.filter((e=>!o.includes(e.symbol)));for(const e of i){const t=Object.assign(Object.assign({},e),{aggregators:(0,l.formatAggregatorNames)(e.aggregators),iconUrl:(0,l.formatIconUrlWithProxy)({chainId:this.chainId,tokenAddress:e.address})});a[e.address]=t}}const s=Object.assign(Object.assign({},n),{[this.chainId]:{timestamp:Date.now(),data:a}});this.update((()=>Object.assign(Object.assign({},this.state),{tokenList:a,tokensChainsCache:s})))}finally{t()}}))}fetchFromCache(){return s(this,void 0,void 0,(function*(){const{tokensChainsCache:e}=this.state,t=e[this.chainId],n=Date.now();return(null==t?void 0:t.data)&&n-(null==t?void 0:t.timestamp)<this.cacheRefreshThreshold?t.data:null}))}clearingTokenListData(){this.update((()=>Object.assign(Object.assign({},this.state),{tokenList:{},tokensChainsCache:{}})))}updatePreventPollingOnNetworkRestart(e){this.update((()=>Object.assign(Object.assign({},this.state),{preventPollingOnNetworkRestart:e})))}}n.TokenListController=m,a=new WeakSet,r=function(e){return s(this,void 0,void 0,(function*(){this.chainId!==e.chainId&&(this.abortController.abort(),this.abortController=new c.AbortController,this.chainId=e.chainId,this.state.preventPollingOnNetworkRestart?this.clearingTokenListData():(this.update((()=>{var e;return Object.assign(Object.assign({},this.state),{tokenList:(null===(e=this.state.tokensChainsCache[this.chainId])||void 0===e?void 0:e.data)||{}})})),yield this.restart()))}))},n.default=m}}},{package:"@metamask/assets-controllers"}],[996,{"./crypto-compare":999,"@metamask/base-controller":1007,"@metamask/controller-utils":1024},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.TokenRatesController=void 0;const r=e("@metamask/base-controller"),s=e("@metamask/controller-utils"),o=e("./crypto-compare"),i={BASE_URL:"https://api.coingecko.com/api/v3",getTokenPriceURL(e,t){return`${this.BASE_URL}/simple/token_price/${e}?${t}`},getPlatformsURL(){return`${this.BASE_URL}/asset_platforms`},getSupportedVsCurrencies(){return`${this.BASE_URL}/simple/supported_vs_currencies`}};function c(e,t){var n;if(!t)return null;const a=null!==(n=t.find((({chain_identifier:t})=>null!==t&&String(t)===e)))&&void 0!==n?n:null;return(null==a?void 0:a.id)||null}class u extends r.BaseController{constructor({onTokensStateChange:e,onCurrencyRateStateChange:t,onNetworkStateChange:n},a,r){super(a,r),this.tokenList=[],this.supportedChains={timestamp:0,data:null},this.supportedVsCurrencies={timestamp:0,data:[]},this.name="TokenRatesController",this.defaultConfig={disabled:!1,interval:18e4,nativeCurrency:"eth",chainId:"",tokens:[],threshold:216e5},this.defaultState={contractExchangeRates:{}},this.initialize(),(null==a?void 0:a.disabled)&&this.configure({disabled:!0},!1,!1),e((({tokens:e,detectedTokens:t})=>{this.configure({tokens:[...e,...t]})})),t((e=>{this.configure({nativeCurrency:e.nativeCurrency})})),n((({providerConfig:e})=>{const{chainId:t}=e;this.update({contractExchangeRates:{}}),this.configure({chainId:t})})),this.poll()}poll(e){return a(this,void 0,void 0,(function*(){e&&this.configure({interval:e},!1,!1),this.handle&&clearTimeout(this.handle),yield(0,s.safelyExecute)((()=>this.updateExchangeRates())),this.handle=setTimeout((()=>{this.poll(this.config.interval)}),this.config.interval)}))}set chainId(e){!this.disabled&&(0,s.safelyExecute)((()=>this.updateExchangeRates()))}get chainId(){throw new Error("Property only used for setting")}set tokens(e){this.tokenList=e,!this.disabled&&(0,s.safelyExecute)((()=>this.updateExchangeRates()))}get tokens(){throw new Error("Property only used for setting")}fetchExchangeRate(e,t){return a(this,void 0,void 0,(function*(){const n=`contract_addresses=${this.tokenList.map((e=>e.address)).join(",")}&vs_currencies=${t.toLowerCase()}`;return(0,s.handleFetch)(i.getTokenPriceURL(e,n))}))}checkIsSupportedVsCurrency(e){return a(this,void 0,void 0,(function*(){const{threshold:t}=this.config,{timestamp:n,data:a}=this.supportedVsCurrencies;if(Date.now()-n>t){const t=yield(0,s.handleFetch)(i.getSupportedVsCurrencies());return this.supportedVsCurrencies={data:t,timestamp:Date.now()},t.includes(e.toLowerCase())}return a.includes(e.toLowerCase())}))}getChainSlug(){return a(this,void 0,void 0,(function*(){const{threshold:e,chainId:t}=this.config,{data:n,timestamp:a}=this.supportedChains;if(Date.now()-a>e){const e=yield(0,s.handleFetch)(i.getPlatformsURL());return this.supportedChains={data:e,timestamp:Date.now()},c(t,e)}return c(t,n)}))}updateExchangeRates(){return a(this,void 0,void 0,(function*(){if(0===this.tokenList.length||this.disabled)return;const e=yield this.getChainSlug();let t={};if(e){const{nativeCurrency:n}=this.config;t=yield this.fetchAndMapExchangeRates(n,e)}else this.tokenList.forEach((e=>{const n=(0,s.toChecksumHexAddress)(e.address);t[n]=undefined}));this.update({contractExchangeRates:t})}))}fetchAndMapExchangeRates(e,t){return a(this,void 0,void 0,(function*(){const n={};if(yield this.checkIsSupportedVsCurrency(e)){const a=yield this.fetchExchangeRate(t,e);this.tokenList.forEach((t=>{const r=a[t.address.toLowerCase()];n[(0,s.toChecksumHexAddress)(t.address)]=r?r[e.toLowerCase()]:0}))}else{let a,r=0;try{[a,{conversionRate:r}]=yield Promise.all([this.fetchExchangeRate(t,s.FALL_BACK_VS_CURRENCY),(0,o.fetchExchangeRate)(e,s.FALL_BACK_VS_CURRENCY,!1)])}catch(e){if(e instanceof Error&&e.message.includes("market does not exist for this coin pair"))return{};throw e}for(const[e,t]of Object.entries(a)){const a=t[s.FALL_BACK_VS_CURRENCY.toLowerCase()];n[(0,s.toChecksumHexAddress)(e)]=a*r}}return n}))}}n.TokenRatesController=u,n.default=u}}},{package:"@metamask/assets-controllers"}],[997,{"./assetsUtil":998,"./token-service":1001,"@ethersproject/contracts":394,"@ethersproject/providers":433,"@metamask/base-controller":1007,"@metamask/contract-metadata":1003,"@metamask/controller-utils":1024,"@metamask/metamask-eth-abis":1211,"abort-controller":1490,"async-mutex":1539,events:1798,uuid:5247},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TokensController=void 0;const s=e("events"),o=r(e("@metamask/contract-metadata")),i=e("@metamask/metamask-eth-abis"),c=e("uuid"),u=e("async-mutex"),d=e("@ethersproject/contracts"),l=e("@ethersproject/providers"),E=e("abort-controller"),T=e("@metamask/base-controller"),f=e("@metamask/controller-utils"),m=e("./assetsUtil"),h=e("./token-service");var p;!function(e){e.accepted="accepted",e.failed="failed",e.pending="pending",e.rejected="rejected"}(p||(p={}));class g extends T.BaseController{constructor({onPreferencesStateChange:e,onNetworkStateChange:t,config:n,state:a}){super(n,a),this.mutex=new u.Mutex,this.hub=new s.EventEmitter,this.name="TokensController",this.defaultConfig=Object.assign({networkType:f.MAINNET,selectedAddress:"",chainId:"",provider:undefined},n),this.defaultState=Object.assign({tokens:[],ignoredTokens:[],detectedTokens:[],allTokens:{},allIgnoredTokens:{},allDetectedTokens:{},suggestedAssets:[]},a),this.initialize(),this.abortController=new E.AbortController,e((({selectedAddress:e})=>{var t,n,a;const{allTokens:r,allIgnoredTokens:s,allDetectedTokens:o}=this.state,{chainId:i}=this.config;this.configure({selectedAddress:e}),this.update({tokens:(null===(t=r[i])||void 0===t?void 0:t[e])||[],ignoredTokens:(null===(n=s[i])||void 0===n?void 0:n[e])||[],detectedTokens:(null===(a=o[i])||void 0===a?void 0:a[e])||[]})})),t((({providerConfig:e})=>{var t,n,a;const{allTokens:r,allIgnoredTokens:s,allDetectedTokens:o}=this.state,{selectedAddress:i}=this.config,{chainId:c}=e;this.abortController.abort(),this.abortController=new E.AbortController,this.configure({chainId:c}),this.ethersProvider=this._instantiateNewEthersProvider(),this.update({tokens:(null===(t=r[c])||void 0===t?void 0:t[i])||[],ignoredTokens:(null===(n=s[c])||void 0===n?void 0:n[i])||[],detectedTokens:(null===(a=o[c])||void 0===a?void 0:a[i])||[]})}))}failSuggestedAsset(e,t){const n=Object.assign(Object.assign({},e),{status:p.failed,error:t});this.hub.emit(`${e.id}:finished`,n)}fetchTokenMetadata(e){return a(this,void 0,void 0,(function*(){try{return yield(0,h.fetchTokenMetadata)(this.config.chainId,e,this.abortController.signal)}catch(e){if(e instanceof Error&&e.message.includes(h.TOKEN_METADATA_NO_SUPPORT_ERROR))return undefined;throw e}}))}_instantiateNewEthersProvider(){var e;return new l.Web3Provider(null===(e=this.config)||void 0===e?void 0:e.provider)}addToken(e,t,n,r){return a(this,void 0,void 0,(function*(){const a=this.config.chainId,s=yield this.mutex.acquire();try{e=(0,f.toChecksumHexAddress)(e);const{tokens:o,ignoredTokens:i,detectedTokens:c}=this.state,u=[...o],[d,l]=yield Promise.all([this._detectIsERC721(e),this.fetchTokenMetadata(e)]);if(a!==this.config.chainId)throw new Error("TokensController Error: Switched networks while adding token");const E={address:e,symbol:t,decimals:n,image:r||(0,m.formatIconUrlWithProxy)({chainId:this.config.chainId,tokenAddress:e}),isERC721:d,aggregators:(0,m.formatAggregatorNames)((null==l?void 0:l.aggregators)||[])},T=u.find((t=>t.address.toLowerCase()===e.toLowerCase()));if(T){const e=u.indexOf(T);u[e]=E}else u.push(E);const h=i.filter((t=>t.toLowerCase()!==e.toLowerCase())),p=c.filter((t=>t.address.toLowerCase()!==e.toLowerCase())),{newAllTokens:g,newAllIgnoredTokens:_,newAllDetectedTokens:S}=this._getNewAllTokensState({newTokens:u,newIgnoredTokens:h,newDetectedTokens:p});return this.update({tokens:u,ignoredTokens:h,detectedTokens:p,allTokens:g,allIgnoredTokens:_,allDetectedTokens:S}),u}finally{s()}}))}addTokens(e){return a(this,void 0,void 0,(function*(){const t=yield this.mutex.acquire(),{tokens:n,detectedTokens:a,ignoredTokens:r}=this.state,s={},o=n.reduce(((e,t)=>(e[t.address]=t,e)),{});try{e.forEach((e=>{const{address:t,symbol:n,decimals:a,image:r,aggregators:i}=e,c={address:(0,f.toChecksumHexAddress)(t),symbol:n,decimals:a,image:r,aggregators:i};return o[t]=c,s[t.toLowerCase()]=!0,c}));const n=Object.values(o),i=a.filter((e=>!s[e.address.toLowerCase()])),c=r.filter((e=>!o[e.toLowerCase()])),{newAllTokens:u,newAllDetectedTokens:d,newAllIgnoredTokens:l}=this._getNewAllTokensState({newTokens:n,newDetectedTokens:i,newIgnoredTokens:c});this.update({tokens:n,allTokens:u,detectedTokens:i,allDetectedTokens:d,ignoredTokens:c,allIgnoredTokens:l})}finally{t()}}))}ignoreTokens(e){const{ignoredTokens:t,detectedTokens:n,tokens:a}=this.state,r={};let s=[...t];const o=e.map((e=>{const t=(0,f.toChecksumHexAddress)(e);return r[e.toLowerCase()]=!0,t}));s=[...t,...o];const i=n.filter((e=>!r[e.address.toLowerCase()])),c=a.filter((e=>!r[e.address.toLowerCase()])),{newAllIgnoredTokens:u,newAllDetectedTokens:d,newAllTokens:l}=this._getNewAllTokensState({newIgnoredTokens:s,newDetectedTokens:i,newTokens:c});this.update({ignoredTokens:s,tokens:c,detectedTokens:i,allIgnoredTokens:u,allDetectedTokens:d,allTokens:l})}addDetectedTokens(e,t){var n;return a(this,void 0,void 0,(function*(){const a=yield this.mutex.acquire(),{tokens:r,detectedTokens:s,ignoredTokens:o}=this.state,i=[...r];let c=[...s];try{e.forEach((e=>{const{address:t,symbol:n,decimals:a,image:r,aggregators:s,isERC721:u}=e,d=(0,f.toChecksumHexAddress)(t),l={address:d,symbol:n,decimals:a,image:r,isERC721:u,aggregators:s},E=i.find((e=>e.address.toLowerCase()===d.toLowerCase()));if(E){const e=i.indexOf(E);i[e]=l}else{if(-1===o.indexOf(t)){const e=c.find((e=>e.address.toLowerCase()===d.toLowerCase()));if(e){const t=c.indexOf(e);c[t]=l}else c.push(l)}}}));const{selectedAddress:r,chainId:s}=t||{},{newAllTokens:u,newAllDetectedTokens:d}=this._getNewAllTokensState({newTokens:i,newDetectedTokens:c,detectionAddress:r,detectionChainId:s}),{chainId:l,selectedAddress:E}=this.config;c=(null===(n=null==d?void 0:d[l])||void 0===n?void 0:n[E])||[],this.update({tokens:i,allTokens:u,detectedTokens:c,allDetectedTokens:d})}finally{a()}}))}updateTokenType(e){return a(this,void 0,void 0,(function*(){const t=yield this._detectIsERC721(e),{tokens:n}=this.state,a=n.findIndex((t=>t.address.toLowerCase()===e.toLowerCase()));return n[a].isERC721=t,this.update({tokens:n}),n[a]}))}_detectIsERC721(e){var t,n;return a(this,void 0,void 0,(function*(){const a=(0,f.toChecksumHexAddress)(e);if(!0===(null===(t=o.default[a])||void 0===t?void 0:t.erc721))return Promise.resolve(!0);if(!0===(null===(n=o.default[a])||void 0===n?void 0:n.erc20))return Promise.resolve(!1);const r=this._createEthersContract(e,i.abiERC721,this.ethersProvider);try{return yield r.supportsInterface(f.ERC721_INTERFACE_ID)}catch(e){return!1}}))}_createEthersContract(e,t,n){return new d.Contract(e,t,n)}_generateRandomId(){return(0,c.v1)()}watchAsset(e,t){return a(this,void 0,void 0,(function*(){const n={asset:e,id:this._generateRandomId(),status:p.pending,time:Date.now(),type:t};try{if("ERC20"!==t)throw new Error(`Asset of type ${t} not supported`);(0,m.validateTokenToWatch)(e)}catch(e){return this.failSuggestedAsset(n,e),Promise.reject(e)}const a=new Promise(((e,t)=>{this.hub.once(`${n.id}:finished`,(n=>{switch(n.status){case p.accepted:return e(n.asset.address);case p.rejected:return t(new Error("User rejected to watch the asset."));case p.failed:return t(new Error(n.error.message));default:return t(new Error(`Unknown status: ${n.status}`))}}))})),{suggestedAssets:r}=this.state;return r.push(n),this.update({suggestedAssets:[...r]}),this.hub.emit("pendingSuggestedAsset",n),{result:a,suggestedAssetMeta:n}}))}acceptWatchAsset(e){return a(this,void 0,void 0,(function*(){const{suggestedAssets:t}=this.state,n=t.findIndex((({id:t})=>e===t)),a=t[n];try{if("ERC20"!==a.type)throw new Error(`Asset of type ${a.type} not supported`);{const{address:e,symbol:t,decimals:n,image:r}=a.asset;yield this.addToken(e,t,n,r),a.status=p.accepted,this.hub.emit(`${a.id}:finished`,a)}}catch(e){this.failSuggestedAsset(a,e)}const r=t.filter((({id:t})=>t!==e));this.update({suggestedAssets:[...r]})}))}rejectWatchAsset(e){const{suggestedAssets:t}=this.state,n=t.findIndex((({id:t})=>e===t)),a=t[n];if(!a)return;a.status=p.rejected,this.hub.emit(`${a.id}:finished`,a);const r=t.filter((({id:t})=>t!==e));this.update({suggestedAssets:[...r]})}_getNewAllTokensState(e){const{newTokens:t,newIgnoredTokens:n,newDetectedTokens:a,detectionAddress:r,detectionChainId:s}=e,{allTokens:o,allIgnoredTokens:i,allDetectedTokens:c}=this.state,{chainId:u,selectedAddress:d}=this.config,l=null!=r?r:d,E=null!=s?s:u;let T=o;if((null==t?void 0:t.length)||t&&o&&o[E]&&o[E][l]){const e=o[E],n=Object.assign(Object.assign({},e),{[l]:t});T=Object.assign(Object.assign({},o),{[E]:n})}let f=i;if((null==n?void 0:n.length)||n&&i&&i[E]&&i[E][l]){const e=i[E],t=Object.assign(Object.assign({},e),{[l]:n});f=Object.assign(Object.assign({},i),{[E]:t})}let m=c;if((null==a?void 0:a.length)||a&&c&&c[E]&&c[E][l]){const e=c[E],t=Object.assign(Object.assign({},e),{[l]:a});m=Object.assign(Object.assign({},c),{[E]:t})}return{newAllTokens:T,newAllIgnoredTokens:f,newAllDetectedTokens:m}}clearIgnoredTokens(){this.update({ignoredTokens:[],allIgnoredTokens:{}})}}n.TokensController=g,n.default=g}}},{package:"@metamask/assets-controllers"}],[998,{"@metamask/controller-utils":1024,"eth-rpc-errors":2103,"ethereumjs-util":2178,"multiformats/cid":4815},function(){with(this)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ethersBigNumberToBN=n.addUrlProtocolPrefix=n.getFormattedIpfsUrl=n.getIpfsCIDv1AndPath=n.removeIpfsProtocolPrefix=n.isTokenListSupportedForNetwork=n.isTokenDetectionSupportedForNetwork=n.SupportedTokenDetectionNetworks=n.validateTokenToWatch=n.formatIconUrlWithProxy=n.formatAggregatorNames=n.compareNftMetadata=void 0;const a=e("eth-rpc-errors"),r=e("multiformats/cid"),s=e("@metamask/controller-utils"),o=e("ethereumjs-util");n.compareNftMetadata=function(e,t){return["image","backgroundColor","imagePreview","imageThumbnail","imageOriginal","animation","animationOriginal","externalLink"].reduce(((n,a)=>e[a]&&e[a]!==t[a]?n+1:n),0)>0};const i={aave:"Aave",bancor:"Bancor",cmc:"CMC",cryptocom:"Crypto.com",coinGecko:"CoinGecko",oneInch:"1inch",paraswap:"Paraswap",pmm:"PMM",zapper:"Zapper",zerion:"Zerion",zeroEx:"0x",synthetix:"Synthetix",yearn:"Yearn",apeswap:"ApeSwap",binanceDex:"BinanceDex",pancakeTop100:"PancakeTop100",pancakeExtended:"PancakeExtended",balancer:"Balancer",quickswap:"QuickSwap",matcha:"Matcha",pangolinDex:"PangolinDex",pangolinDexStableCoin:"PangolinDexStableCoin",pangolinDexAvaxBridge:"PangolinDexAvaxBridge",traderJoe:"TraderJoe",airswapLight:"AirswapLight",kleros:"Kleros"};n.formatAggregatorNames=e=>e.map((e=>i[e]||`${e[0].toUpperCase()}${e.substring(1,e.length)}`));var c;function u(e){return Object.values(c).includes(e)}function d(e){if(e.startsWith("ipfs://ipfs/"))return e.replace("ipfs://ipfs/","");if(e.startsWith("ipfs://"))return e.replace("ipfs://","");throw new Error("this method should not be used with non ipfs urls")}function l(e){const t=d(e),n=t.indexOf("/"),a=-1!==n?t.substring(0,n):t,s=-1!==n?t.substring(n):undefined;return{cid:r.CID.parse(a).toV1().toString(),path:s}}function E(e){return e.match(/(^http:\/\/)|(^https:\/\/)/u)?e:`https://${e}`}n.formatIconUrlWithProxy=({chainId:e,tokenAddress:t})=>`https://static.metaswap.codefi.network/api/v1/tokenIcons/${(0,s.convertHexToDecimal)(e).toString()}/${t.toLowerCase()}.png`,n.validateTokenToWatch=function(e){const{address:t,symbol:n,decimals:r}=e;if(!t||!n||void 0===r)throw a.ethErrors.rpc.invalidParams("Must specify address, symbol, and decimals.");if("string"!=typeof n)throw a.ethErrors.rpc.invalidParams("Invalid symbol: not a string.");if(n.length>11)throw a.ethErrors.rpc.invalidParams(`Invalid symbol "${n}": longer than 11 characters.`);const o=parseInt(r,10);if(isNaN(o)||o>36||o<0)throw a.ethErrors.rpc.invalidParams(`Invalid decimals "${r}": must be 0 <= 36.`);if(!(0,s.isValidHexAddress)(t))throw a.ethErrors.rpc.invalidParams(`Invalid address "${t}".`)},function(e){e.mainnet="1",e.bsc="56",e.polygon="137",e.avax="43114"}(c=n.SupportedTokenDetectionNetworks||(n.SupportedTokenDetectionNetworks={})),n.isTokenDetectionSupportedForNetwork=u,n.isTokenListSupportedForNetwork=function(e){const t=(0,s.convertHexToDecimal)(e).toString();return u(t)||t===s.GANACHE_CHAIN_ID},n.removeIpfsProtocolPrefix=d,n.getIpfsCIDv1AndPath=l,n.getFormattedIpfsUrl=function(e,t,n){const{host:a,protocol:r,origin:s}=new URL(E(e));if(n){const{cid:e,path:n}=l(t);return`${r}//${e}.ipfs.${a}${null!=n?n:""}`}return`${s}/ipfs/${d(t)}`},n.addUrlProtocolPrefix=E,n.ethersBigNumberToBN=function(e){return new o.BN((0,o.stripHexPrefix)(e.toHexString()),"hex")}}}},{package:"@metamask/assets-controllers"}],[999,{"@metamask/controller-utils":1024},function(){with(this)return function(){"use strict";return function(e,t,n){var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function i(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.fetchExchangeRate=void 0;const r=e("@metamask/controller-utils");n.fetchExchangeRate=function(e,t,n){return a(this,void 0,void 0,(function*(){const a=yield(0,r.handleFetch)(function(e,t,n){return`https://min-api.cryptocompare.com/data/price?fsym=${t.toUpperCase()}&tsyms=${e.toUpperCase()}`+(n&&"USD"!==e.toUpperCase()?",USD":"")}(e,t,n));if("Error"===a.Response)throw new Error(a.Message);const s=Number(a[e.toUpperCase()]),o=Number(a.USD);if(!Number.isFinite(s))throw new Error(`Invalid response for ${e.toUpperCase()}: ${a[e.toUpperCase()]}`);if(n&&!Number.isFinite(o))throw new Error(`Invalid response for usdConversionRate: ${a.USD}`);return{conversionRate:s,usdConversionRate:o}}))}}}},{package:"@metamask/assets-controllers"}]],[],{});
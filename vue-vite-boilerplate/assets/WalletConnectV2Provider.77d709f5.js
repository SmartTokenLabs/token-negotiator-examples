import{b as Ae,g as mc,d as vc,r as wc,f as no,t as Ec,e as Dc,h as Ht,i as Wi,j as so,k as Sc,l as Oc,m as Ic,n as xc,p as Pc}from"./index.163d4220.js";var di,Pn;function Tc(){if(Pn)return di;Pn=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}di=e;function e(t,i,n){var l=n&&n.stringify||r,g=1;if(typeof t=="object"&&t!==null){var p=i.length+g;if(p===1)return t;var b=new Array(p);b[0]=l(t);for(var S=1;S<p;S++)b[S]=l(i[S]);return b.join(" ")}if(typeof t!="string")return t;var x=i.length;if(x===0)return t;for(var A="",j=1-g,N=-1,C=t&&t.length||0,q=0;q<C;){if(t.charCodeAt(q)===37&&q+1<C){switch(N=N>-1?N:0,t.charCodeAt(q+1)){case 100:case 102:if(j>=x||i[j]==null)break;N<q&&(A+=t.slice(N,q)),A+=Number(i[j]),N=q+2,q++;break;case 105:if(j>=x||i[j]==null)break;N<q&&(A+=t.slice(N,q)),A+=Math.floor(Number(i[j])),N=q+2,q++;break;case 79:case 111:case 106:if(j>=x||i[j]===void 0)break;N<q&&(A+=t.slice(N,q));var B=typeof i[j];if(B==="string"){A+="'"+i[j]+"'",N=q+2,q++;break}if(B==="function"){A+=i[j].name||"<anonymous>",N=q+2,q++;break}A+=l(i[j]),N=q+2,q++;break;case 115:if(j>=x)break;N<q&&(A+=t.slice(N,q)),A+=String(i[j]),N=q+2,q++;break;case 37:N<q&&(A+=t.slice(N,q)),A+="%",N=q+2,q++,j--;break}++j}++q}return N===-1?t:(N<C&&(A+=t.slice(N)),A)}return di}var pi,Tn;function oo(){if(Tn)return pi;Tn=1;const r=Tc();pi=n;const e=E().console||{},t={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:q,wrapResponseSerializer:q,wrapErrorSerializer:q,req:C,res:C,err:j};function i(y,o){return Array.isArray(y)?y.filter(function(H){return H!=="!stdSerializers.err"}):y===!0?Object.keys(o):!1}function n(y){y=y||{},y.browser=y.browser||{};const o=y.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const d=y.browser.write||e;y.browser.write&&(y.browser.asObject=!0);const H=y.serializers||{},s=i(y.browser.serialize,H);let h=y.browser.serialize;Array.isArray(y.browser.serialize)&&y.browser.serialize.indexOf("!stdSerializers.err")>-1&&(h=!1);const f=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),y.enabled===!1&&(y.level="silent");const _=y.level||"info",a=Object.create(d);a.log||(a.log=B),Object.defineProperty(a,"levelVal",{get:D}),Object.defineProperty(a,"level",{get:P,set:U});const c={transmit:o,serialize:s,asObject:y.browser.asObject,levels:f,timestamp:N(y)};a.levels=n.levels,a.level=_,a.setMaxListeners=a.getMaxListeners=a.emit=a.addListener=a.on=a.prependListener=a.once=a.prependOnceListener=a.removeListener=a.removeAllListeners=a.listeners=a.listenerCount=a.eventNames=a.write=a.flush=B,a.serializers=H,a._serialize=s,a._stdErrSerialize=h,a.child=w,o&&(a._logEvent=A());function D(){return this.level==="silent"?1/0:this.levels.values[this.level]}function P(){return this._level}function U(R){if(R!=="silent"&&!this.levels.values[R])throw Error("unknown level "+R);this._level=R,l(c,a,"error","log"),l(c,a,"fatal","error"),l(c,a,"warn","error"),l(c,a,"info","log"),l(c,a,"debug","log"),l(c,a,"trace","log")}function w(R,K){if(!R)throw new Error("missing bindings for child Pino");K=K||{},s&&R.serializers&&(K.serializers=R.serializers);const z=K.serializers;if(s&&z){var V=Object.assign({},H,z),X=y.browser.serialize===!0?Object.keys(V):s;delete R.serializers,b([R],X,V,this._stdErrSerialize)}function Y(ee){this._childLevel=(ee._childLevel|0)+1,this.error=S(ee,R,"error"),this.fatal=S(ee,R,"fatal"),this.warn=S(ee,R,"warn"),this.info=S(ee,R,"info"),this.debug=S(ee,R,"debug"),this.trace=S(ee,R,"trace"),V&&(this.serializers=V,this._serialize=X),o&&(this._logEvent=A([].concat(ee._logEvent.bindings,R)))}return Y.prototype=this,new Y(this)}return a}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=t,n.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:v,unixTime:I,isoTime:m});function l(y,o,d,H){const s=Object.getPrototypeOf(o);o[d]=o.levelVal>o.levels.values[d]?B:s[d]?s[d]:e[d]||e[H]||B,g(y,o,d)}function g(y,o,d){!y.transmit&&o[d]===B||(o[d]=function(H){return function(){const h=y.timestamp(),f=new Array(arguments.length),_=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var a=0;a<f.length;a++)f[a]=arguments[a];if(y.serialize&&!y.asObject&&b(f,this._serialize,this.serializers,this._stdErrSerialize),y.asObject?H.call(_,p(this,d,f,h)):H.apply(_,f),y.transmit){const c=y.transmit.level||o.level,D=n.levels.values[c],P=n.levels.values[d];if(P<D)return;x(this,{ts:h,methodLevel:d,methodValue:P,transmitLevel:c,transmitValue:n.levels.values[y.transmit.level||o.level],send:y.transmit.send,val:o.levelVal},f)}}}(o[d]))}function p(y,o,d,H){y._serialize&&b(d,y._serialize,y.serializers,y._stdErrSerialize);const s=d.slice();let h=s[0];const f={};H&&(f.time=H),f.level=n.levels.values[o];let _=(y._childLevel|0)+1;if(_<1&&(_=1),h!==null&&typeof h=="object"){for(;_--&&typeof s[0]=="object";)Object.assign(f,s.shift());h=s.length?r(s.shift(),s):void 0}else typeof h=="string"&&(h=r(s.shift(),s));return h!==void 0&&(f.msg=h),f}function b(y,o,d,H){for(const s in y)if(H&&y[s]instanceof Error)y[s]=n.stdSerializers.err(y[s]);else if(typeof y[s]=="object"&&!Array.isArray(y[s]))for(const h in y[s])o&&o.indexOf(h)>-1&&h in d&&(y[s][h]=d[h](y[s][h]))}function S(y,o,d){return function(){const H=new Array(1+arguments.length);H[0]=o;for(var s=1;s<H.length;s++)H[s]=arguments[s-1];return y[d].apply(this,H)}}function x(y,o,d){const H=o.send,s=o.ts,h=o.methodLevel,f=o.methodValue,_=o.val,a=y._logEvent.bindings;b(d,y._serialize||Object.keys(y.serializers),y.serializers,y._stdErrSerialize===void 0?!0:y._stdErrSerialize),y._logEvent.ts=s,y._logEvent.messages=d.filter(function(c){return a.indexOf(c)===-1}),y._logEvent.level.label=h,y._logEvent.level.value=f,H(h,y._logEvent,_),y._logEvent=A(a)}function A(y){return{ts:0,messages:[],bindings:y||[],level:{label:"",value:0}}}function j(y){const o={type:y.constructor.name,msg:y.message,stack:y.stack};for(const d in y)o[d]===void 0&&(o[d]=y[d]);return o}function N(y){return typeof y.timestamp=="function"?y.timestamp:y.timestamp===!1?W:v}function C(){return{}}function q(y){return y}function B(){}function W(){return!1}function v(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function E(){function y(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return y(self)||y(window)||y(this)||{}}}return pi}var Xr=oo(),st={exports:{}},nr=typeof Reflect=="object"?Reflect:null,An=nr&&typeof nr.apply=="function"?nr.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Vr;nr&&typeof nr.ownKeys=="function"?Vr=nr.ownKeys:Object.getOwnPropertySymbols?Vr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Vr=function(e){return Object.getOwnPropertyNames(e)};function Ac(r){console&&console.warn&&console.warn(r)}var ao=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}st.exports=Oe;st.exports.once=Fc;Oe.EventEmitter=Oe;Oe.prototype._events=void 0;Oe.prototype._eventsCount=0;Oe.prototype._maxListeners=void 0;var Nn=10;function Zr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return Nn},set:function(r){if(typeof r!="number"||r<0||ao(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Nn=r}});Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ao(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function co(r){return r._maxListeners===void 0?Oe.defaultMaxListeners:r._maxListeners}Oe.prototype.getMaxListeners=function(){return co(this)};Oe.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",l=this._events;if(l!==void 0)n=n&&l.error===void 0;else if(!n)return!1;if(n){var g;if(t.length>0&&(g=t[0]),g instanceof Error)throw g;var p=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw p.context=g,p}var b=l[e];if(b===void 0)return!1;if(typeof b=="function")An(b,this,t);else for(var S=b.length,x=po(b,S),i=0;i<S;++i)An(x[i],this,t);return!0};function uo(r,e,t,i){var n,l,g;if(Zr(t),l=r._events,l===void 0?(l=r._events=Object.create(null),r._eventsCount=0):(l.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),l=r._events),g=l[e]),g===void 0)g=l[e]=t,++r._eventsCount;else if(typeof g=="function"?g=l[e]=i?[t,g]:[g,t]:i?g.unshift(t):g.push(t),n=co(r),n>0&&g.length>n&&!g.warned){g.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=r,p.type=e,p.count=g.length,Ac(p)}return r}Oe.prototype.addListener=function(e,t){return uo(this,e,t,!1)};Oe.prototype.on=Oe.prototype.addListener;Oe.prototype.prependListener=function(e,t){return uo(this,e,t,!0)};function Nc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ho(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=Nc.bind(i);return n.listener=t,i.wrapFn=n,n}Oe.prototype.once=function(e,t){return Zr(t),this.on(e,ho(this,e,t)),this};Oe.prototype.prependOnceListener=function(e,t){return Zr(t),this.prependListener(e,ho(this,e,t)),this};Oe.prototype.removeListener=function(e,t){var i,n,l,g,p;if(Zr(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(l=-1,g=i.length-1;g>=0;g--)if(i[g]===t||i[g].listener===t){p=i[g].listener,l=g;break}if(l<0)return this;l===0?i.shift():Cc(i,l),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,p||t)}return this};Oe.prototype.off=Oe.prototype.removeListener;Oe.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var l=Object.keys(i),g;for(n=0;n<l.length;++n)g=l[n],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function fo(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?Rc(n):po(n,n.length)}Oe.prototype.listeners=function(e){return fo(this,e,!0)};Oe.prototype.rawListeners=function(e){return fo(this,e,!1)};Oe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):lo.call(r,e)};Oe.prototype.listenerCount=lo;function lo(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Vr(this._events):[]};function po(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function Cc(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Rc(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Fc(r,e){return new Promise(function(t,i){function n(g){r.removeListener(e,l),i(g)}function l(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}go(r,e,l,{once:!0}),e!=="error"&&Lc(r,n,{once:!0})})}function Lc(r,e,t){typeof r.on=="function"&&go(r,"error",e,t)}function go(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(l){i.once&&r.removeEventListener(e,n),t(l)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Qr={},ki={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,l,g,p,b,S,x,A,j,N,C,q,B,W,v,I,m,E,y,o;(function(d){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(s(H,s(r.exports)));function s(h,f){return h!==H&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(_,a){return h[_]=f?f(_,a):a}}})(function(d){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])};e=function(s,h){H(s,h);function f(){this.constructor=s}s.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)},t=Object.assign||function(s){for(var h,f=1,_=arguments.length;f<_;f++){h=arguments[f];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s},i=function(s,h){var f={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&h.indexOf(_)<0&&(f[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,_=Object.getOwnPropertySymbols(s);a<_.length;a++)h.indexOf(_[a])<0&&Object.prototype.propertyIsEnumerable.call(s,_[a])&&(f[_[a]]=s[_[a]]);return f},n=function(s,h,f,_){var a=arguments.length,c=a<3?h:_===null?_=Object.getOwnPropertyDescriptor(h,f):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,h,f,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(c=(a<3?D(c):a>3?D(h,f,c):D(h,f))||c);return a>3&&c&&Object.defineProperty(h,f,c),c},l=function(s,h){return function(f,_){h(f,_,s)}},g=function(s,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,h)},p=function(s,h,f,_){function a(c){return c instanceof f?c:new f(function(D){D(c)})}return new(f||(f=Promise))(function(c,D){function P(R){try{w(_.next(R))}catch(K){D(K)}}function U(R){try{w(_.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(P,U)}w((_=_.apply(s,h||[])).next())})},b=function(s,h){var f={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,a,c,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(w){return function(R){return U([w,R])}}function U(w){if(_)throw new TypeError("Generator is already executing.");for(;f;)try{if(_=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,a=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(c=f.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){f.label=w[1];break}if(w[0]===6&&f.label<c[1]){f.label=c[1],c=w;break}if(c&&f.label<c[2]){f.label=c[2],f.ops.push(w);break}c[2]&&f.ops.pop(),f.trys.pop();continue}w=h.call(s,f)}catch(R){w=[6,R],a=0}finally{_=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},o=function(s,h,f,_){_===void 0&&(_=f),s[_]=h[f]},S=function(s,h){for(var f in s)f!=="default"&&!h.hasOwnProperty(f)&&(h[f]=s[f])},x=function(s){var h=typeof Symbol=="function"&&Symbol.iterator,f=h&&s[h],_=0;if(f)return f.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,h){var f=typeof Symbol=="function"&&s[Symbol.iterator];if(!f)return s;var _=f.call(s),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=_.next()).done;)c.push(a.value)}catch(P){D={error:P}}finally{try{a&&!a.done&&(f=_.return)&&f.call(_)}finally{if(D)throw D.error}}return c},j=function(){for(var s=[],h=0;h<arguments.length;h++)s=s.concat(A(arguments[h]));return s},N=function(){for(var s=0,h=0,f=arguments.length;h<f;h++)s+=arguments[h].length;for(var _=Array(s),a=0,h=0;h<f;h++)for(var c=arguments[h],D=0,P=c.length;D<P;D++,a++)_[a]=c[D];return _},C=function(s){return this instanceof C?(this.v=s,this):new C(s)},q=function(s,h,f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=f.apply(s,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){_[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||P(z,V)})})}function P(z,V){try{U(_[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof C?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){P("next",z)}function R(z){P("throw",z)}function K(z,V){z(V),c.shift(),c.length&&P(c[0][0],c[0][1])}},B=function(s){var h,f;return h={},_("next"),_("throw",function(a){throw a}),_("return"),h[Symbol.iterator]=function(){return this},h;function _(a,c){h[a]=s[a]?function(D){return(f=!f)?{value:C(s[a](D)),done:a==="return"}:c?c(D):D}:c}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=s[Symbol.asyncIterator],f;return h?h.call(s):(s=typeof x=="function"?x(s):s[Symbol.iterator](),f={},_("next"),_("throw"),_("return"),f[Symbol.asyncIterator]=function(){return this},f);function _(c){f[c]=s[c]&&function(D){return new Promise(function(P,U){D=s[c](D),a(P,U,D.done,D.value)})}}function a(c,D,P,U){Promise.resolve(U).then(function(w){c({value:w,done:P})},D)}},v=function(s,h){return Object.defineProperty?Object.defineProperty(s,"raw",{value:h}):s.raw=h,s},I=function(s){if(s&&s.__esModule)return s;var h={};if(s!=null)for(var f in s)Object.hasOwnProperty.call(s,f)&&(h[f]=s[f]);return h.default=s,h},m=function(s){return s&&s.__esModule?s:{default:s}},E=function(s,h){if(!h.has(s))throw new TypeError("attempted to get private field on non-instance");return h.get(s)},y=function(s,h,f){if(!h.has(s))throw new TypeError("attempted to set private field on non-instance");return h.set(s,f),f},d("__extends",e),d("__assign",t),d("__rest",i),d("__decorate",n),d("__param",l),d("__metadata",g),d("__awaiter",p),d("__generator",b),d("__exportStar",S),d("__createBinding",o),d("__values",x),d("__read",A),d("__spread",j),d("__spreadArrays",N),d("__await",C),d("__asyncGenerator",q),d("__asyncDelegator",B),d("__asyncValues",W),d("__makeTemplateObject",v),d("__importStar",I),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(ki);var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function Uc(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}Sr.safeJsonParse=Uc;function jc(r){return typeof r=="string"?r:JSON.stringify(r,(e,t)=>typeof t>"u"?null:t)}Sr.safeJsonStringify=jc;var fr={exports:{}},Cn;function Mc(){return Cn||(Cn=1,function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ae<"u"&&Ae.localStorage?fr.exports=Ae.localStorage:typeof window<"u"&&window.localStorage?fr.exports=window.localStorage:fr.exports=new e}()),fr.exports}var gi={},lr={},Rn;function $c(){if(Rn)return lr;Rn=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.IKeyValueStorage=void 0;class r{}return lr.IKeyValueStorage=r,lr}var dr={},Fn;function Hc(){if(Fn)return dr;Fn=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.parseEntry=void 0;const r=Sr;function e(t){var i;return[t[0],r.safeJsonParse((i=t[1])!==null&&i!==void 0?i:"")]}return dr.parseEntry=e,dr}var Ln;function Bc(){return Ln||(Ln=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ki.exports;e.__exportStar($c(),r),e.__exportStar(Hc(),r)}(gi)),gi}Object.defineProperty(Qr,"__esModule",{value:!0});Qr.KeyValueStorage=void 0;const ir=ki.exports,Un=Sr,qc=ir.__importDefault(Mc()),zc=Bc();class yo{constructor(){this.localStorage=qc.default}getKeys(){return ir.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ir.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(zc.parseEntry)})}getItem(e){return ir.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return Un.safeJsonParse(t)})}setItem(e,t){return ir.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Un.safeJsonStringify(t))})}removeItem(e){return ir.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Qr.KeyValueStorage=yo;var Kc=Qr.default=yo,Or={},Ir={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,l,g,p,b,S,x,A,j,N,C,q,B,W,v,I,m,E,y,o;(function(d){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(s(H,s(r.exports)));function s(h,f){return h!==H&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(_,a){return h[_]=f?f(_,a):a}}})(function(d){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])};e=function(s,h){H(s,h);function f(){this.constructor=s}s.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)},t=Object.assign||function(s){for(var h,f=1,_=arguments.length;f<_;f++){h=arguments[f];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s},i=function(s,h){var f={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&h.indexOf(_)<0&&(f[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,_=Object.getOwnPropertySymbols(s);a<_.length;a++)h.indexOf(_[a])<0&&Object.prototype.propertyIsEnumerable.call(s,_[a])&&(f[_[a]]=s[_[a]]);return f},n=function(s,h,f,_){var a=arguments.length,c=a<3?h:_===null?_=Object.getOwnPropertyDescriptor(h,f):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,h,f,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(c=(a<3?D(c):a>3?D(h,f,c):D(h,f))||c);return a>3&&c&&Object.defineProperty(h,f,c),c},l=function(s,h){return function(f,_){h(f,_,s)}},g=function(s,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,h)},p=function(s,h,f,_){function a(c){return c instanceof f?c:new f(function(D){D(c)})}return new(f||(f=Promise))(function(c,D){function P(R){try{w(_.next(R))}catch(K){D(K)}}function U(R){try{w(_.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(P,U)}w((_=_.apply(s,h||[])).next())})},b=function(s,h){var f={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,a,c,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(w){return function(R){return U([w,R])}}function U(w){if(_)throw new TypeError("Generator is already executing.");for(;f;)try{if(_=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,a=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(c=f.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){f.label=w[1];break}if(w[0]===6&&f.label<c[1]){f.label=c[1],c=w;break}if(c&&f.label<c[2]){f.label=c[2],f.ops.push(w);break}c[2]&&f.ops.pop(),f.trys.pop();continue}w=h.call(s,f)}catch(R){w=[6,R],a=0}finally{_=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},o=function(s,h,f,_){_===void 0&&(_=f),s[_]=h[f]},S=function(s,h){for(var f in s)f!=="default"&&!h.hasOwnProperty(f)&&(h[f]=s[f])},x=function(s){var h=typeof Symbol=="function"&&Symbol.iterator,f=h&&s[h],_=0;if(f)return f.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,h){var f=typeof Symbol=="function"&&s[Symbol.iterator];if(!f)return s;var _=f.call(s),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=_.next()).done;)c.push(a.value)}catch(P){D={error:P}}finally{try{a&&!a.done&&(f=_.return)&&f.call(_)}finally{if(D)throw D.error}}return c},j=function(){for(var s=[],h=0;h<arguments.length;h++)s=s.concat(A(arguments[h]));return s},N=function(){for(var s=0,h=0,f=arguments.length;h<f;h++)s+=arguments[h].length;for(var _=Array(s),a=0,h=0;h<f;h++)for(var c=arguments[h],D=0,P=c.length;D<P;D++,a++)_[a]=c[D];return _},C=function(s){return this instanceof C?(this.v=s,this):new C(s)},q=function(s,h,f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=f.apply(s,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){_[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||P(z,V)})})}function P(z,V){try{U(_[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof C?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){P("next",z)}function R(z){P("throw",z)}function K(z,V){z(V),c.shift(),c.length&&P(c[0][0],c[0][1])}},B=function(s){var h,f;return h={},_("next"),_("throw",function(a){throw a}),_("return"),h[Symbol.iterator]=function(){return this},h;function _(a,c){h[a]=s[a]?function(D){return(f=!f)?{value:C(s[a](D)),done:a==="return"}:c?c(D):D}:c}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=s[Symbol.asyncIterator],f;return h?h.call(s):(s=typeof x=="function"?x(s):s[Symbol.iterator](),f={},_("next"),_("throw"),_("return"),f[Symbol.asyncIterator]=function(){return this},f);function _(c){f[c]=s[c]&&function(D){return new Promise(function(P,U){D=s[c](D),a(P,U,D.done,D.value)})}}function a(c,D,P,U){Promise.resolve(U).then(function(w){c({value:w,done:P})},D)}},v=function(s,h){return Object.defineProperty?Object.defineProperty(s,"raw",{value:h}):s.raw=h,s},I=function(s){if(s&&s.__esModule)return s;var h={};if(s!=null)for(var f in s)Object.hasOwnProperty.call(s,f)&&(h[f]=s[f]);return h.default=s,h},m=function(s){return s&&s.__esModule?s:{default:s}},E=function(s,h){if(!h.has(s))throw new TypeError("attempted to get private field on non-instance");return h.get(s)},y=function(s,h,f){if(!h.has(s))throw new TypeError("attempted to set private field on non-instance");return h.set(s,f),f},d("__extends",e),d("__assign",t),d("__rest",i),d("__decorate",n),d("__param",l),d("__metadata",g),d("__awaiter",p),d("__generator",b),d("__exportStar",S),d("__createBinding",o),d("__values",x),d("__read",A),d("__spread",j),d("__spreadArrays",N),d("__await",C),d("__asyncGenerator",q),d("__asyncDelegator",B),d("__asyncValues",W),d("__makeTemplateObject",v),d("__importStar",I),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(Ir);var pr={},te={},xr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,l,g,p,b,S,x,A,j,N,C,q,B,W,v,I,m,E,y,o;(function(d){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(s(H,s(r.exports)));function s(h,f){return h!==H&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(_,a){return h[_]=f?f(_,a):a}}})(function(d){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])};e=function(s,h){H(s,h);function f(){this.constructor=s}s.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)},t=Object.assign||function(s){for(var h,f=1,_=arguments.length;f<_;f++){h=arguments[f];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s},i=function(s,h){var f={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&h.indexOf(_)<0&&(f[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,_=Object.getOwnPropertySymbols(s);a<_.length;a++)h.indexOf(_[a])<0&&Object.prototype.propertyIsEnumerable.call(s,_[a])&&(f[_[a]]=s[_[a]]);return f},n=function(s,h,f,_){var a=arguments.length,c=a<3?h:_===null?_=Object.getOwnPropertyDescriptor(h,f):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,h,f,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(c=(a<3?D(c):a>3?D(h,f,c):D(h,f))||c);return a>3&&c&&Object.defineProperty(h,f,c),c},l=function(s,h){return function(f,_){h(f,_,s)}},g=function(s,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,h)},p=function(s,h,f,_){function a(c){return c instanceof f?c:new f(function(D){D(c)})}return new(f||(f=Promise))(function(c,D){function P(R){try{w(_.next(R))}catch(K){D(K)}}function U(R){try{w(_.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(P,U)}w((_=_.apply(s,h||[])).next())})},b=function(s,h){var f={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,a,c,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(w){return function(R){return U([w,R])}}function U(w){if(_)throw new TypeError("Generator is already executing.");for(;f;)try{if(_=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,a=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(c=f.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){f.label=w[1];break}if(w[0]===6&&f.label<c[1]){f.label=c[1],c=w;break}if(c&&f.label<c[2]){f.label=c[2],f.ops.push(w);break}c[2]&&f.ops.pop(),f.trys.pop();continue}w=h.call(s,f)}catch(R){w=[6,R],a=0}finally{_=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},o=function(s,h,f,_){_===void 0&&(_=f),s[_]=h[f]},S=function(s,h){for(var f in s)f!=="default"&&!h.hasOwnProperty(f)&&(h[f]=s[f])},x=function(s){var h=typeof Symbol=="function"&&Symbol.iterator,f=h&&s[h],_=0;if(f)return f.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,h){var f=typeof Symbol=="function"&&s[Symbol.iterator];if(!f)return s;var _=f.call(s),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=_.next()).done;)c.push(a.value)}catch(P){D={error:P}}finally{try{a&&!a.done&&(f=_.return)&&f.call(_)}finally{if(D)throw D.error}}return c},j=function(){for(var s=[],h=0;h<arguments.length;h++)s=s.concat(A(arguments[h]));return s},N=function(){for(var s=0,h=0,f=arguments.length;h<f;h++)s+=arguments[h].length;for(var _=Array(s),a=0,h=0;h<f;h++)for(var c=arguments[h],D=0,P=c.length;D<P;D++,a++)_[a]=c[D];return _},C=function(s){return this instanceof C?(this.v=s,this):new C(s)},q=function(s,h,f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=f.apply(s,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){_[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||P(z,V)})})}function P(z,V){try{U(_[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof C?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){P("next",z)}function R(z){P("throw",z)}function K(z,V){z(V),c.shift(),c.length&&P(c[0][0],c[0][1])}},B=function(s){var h,f;return h={},_("next"),_("throw",function(a){throw a}),_("return"),h[Symbol.iterator]=function(){return this},h;function _(a,c){h[a]=s[a]?function(D){return(f=!f)?{value:C(s[a](D)),done:a==="return"}:c?c(D):D}:c}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=s[Symbol.asyncIterator],f;return h?h.call(s):(s=typeof x=="function"?x(s):s[Symbol.iterator](),f={},_("next"),_("throw"),_("return"),f[Symbol.asyncIterator]=function(){return this},f);function _(c){f[c]=s[c]&&function(D){return new Promise(function(P,U){D=s[c](D),a(P,U,D.done,D.value)})}}function a(c,D,P,U){Promise.resolve(U).then(function(w){c({value:w,done:P})},D)}},v=function(s,h){return Object.defineProperty?Object.defineProperty(s,"raw",{value:h}):s.raw=h,s},I=function(s){if(s&&s.__esModule)return s;var h={};if(s!=null)for(var f in s)Object.hasOwnProperty.call(s,f)&&(h[f]=s[f]);return h.default=s,h},m=function(s){return s&&s.__esModule?s:{default:s}},E=function(s,h){if(!h.has(s))throw new TypeError("attempted to get private field on non-instance");return h.get(s)},y=function(s,h,f){if(!h.has(s))throw new TypeError("attempted to set private field on non-instance");return h.set(s,f),f},d("__extends",e),d("__assign",t),d("__rest",i),d("__decorate",n),d("__param",l),d("__metadata",g),d("__awaiter",p),d("__generator",b),d("__exportStar",S),d("__createBinding",o),d("__values",x),d("__read",A),d("__spread",j),d("__spreadArrays",N),d("__await",C),d("__asyncGenerator",q),d("__asyncDelegator",B),d("__asyncValues",W),d("__makeTemplateObject",v),d("__importStar",I),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(xr);var yi={},gr={},jn;function Vc(){if(jn)return gr;jn=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return gr.delay=r,gr}var Gt={},_i={},Wt={},Mn;function Gc(){return Mn||(Mn=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0,Wt.ONE_HUNDRED=100,Wt.ONE_THOUSAND=1e3),Wt}var bi={},$n;function Wc(){return $n||($n=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(bi)),bi}var Hn;function _o(){return Hn||(Hn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Gc(),r),e.__exportStar(Wc(),r)}(_i)),_i}var Bn;function kc(){if(Bn)return Gt;Bn=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.fromMiliseconds=Gt.toMiliseconds=void 0;const r=_o();function e(i){return i*r.ONE_THOUSAND}Gt.toMiliseconds=e;function t(i){return Math.floor(i/r.ONE_THOUSAND)}return Gt.fromMiliseconds=t,Gt}var qn;function Yc(){return qn||(qn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Vc(),r),e.__exportStar(kc(),r)}(yi)),yi}var rr={},zn;function Jc(){if(zn)return rr;zn=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const n=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:n})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return rr.Watch=r,rr.default=r,rr}var mi={},yr={},Kn;function Xc(){if(Kn)return yr;Kn=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.IWatch=void 0;class r{}return yr.IWatch=r,yr}var Vn;function Zc(){return Vn||(Vn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),xr.exports.__exportStar(Xc(),r)}(mi)),mi}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Yc(),r),e.__exportStar(Jc(),r),e.__exportStar(Zc(),r),e.__exportStar(_o(),r)})(te);var vi={},_r={};class Xt{}const Qc=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xt},Symbol.toStringTag,{value:"Module"})),eu=mc(Qc);var Gn;function tu(){if(Gn)return _r;Gn=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IHeartBeat=void 0;const r=eu;class e extends r.IEvents{constructor(i){super()}}return _r.IHeartBeat=e,_r}var Wn;function bo(){return Wn||(Wn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(tu(),r)}(vi)),vi}var wi={},kt={},kn;function ru(){if(kn)return kt;kn=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.HEARTBEAT_EVENTS=kt.HEARTBEAT_INTERVAL=void 0;const r=te;return kt.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,kt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},kt}var Yn;function mo(){return Yn||(Yn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(ru(),r)}(wi)),wi}var Jn;function iu(){if(Jn)return pr;Jn=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.HeartBeat=void 0;const r=Ir.exports,e=st.exports,t=te,i=bo(),n=mo();class l extends i.IHeartBeat{constructor(p){super(p),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=p?.interval||n.HEARTBEAT_INTERVAL}static init(p){return r.__awaiter(this,void 0,void 0,function*(){const b=new l(p);return yield b.init(),b})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,b){this.events.on(p,b)}once(p,b){this.events.once(p,b)}off(p,b){this.events.off(p,b)}removeListener(p,b){this.events.removeListener(p,b)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return pr.HeartBeat=l,pr}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ir.exports;e.__exportStar(iu(),r),e.__exportStar(bo(),r),e.__exportStar(mo(),r)})(Or);var Se={},vo={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,l,g,p,b,S,x,A,j,N,C,q,B,W,v,I,m,E,y,o;(function(d){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(s(H,s(r.exports)));function s(h,f){return h!==H&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(_,a){return h[_]=f?f(_,a):a}}})(function(d){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])};e=function(s,h){H(s,h);function f(){this.constructor=s}s.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)},t=Object.assign||function(s){for(var h,f=1,_=arguments.length;f<_;f++){h=arguments[f];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s},i=function(s,h){var f={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&h.indexOf(_)<0&&(f[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,_=Object.getOwnPropertySymbols(s);a<_.length;a++)h.indexOf(_[a])<0&&Object.prototype.propertyIsEnumerable.call(s,_[a])&&(f[_[a]]=s[_[a]]);return f},n=function(s,h,f,_){var a=arguments.length,c=a<3?h:_===null?_=Object.getOwnPropertyDescriptor(h,f):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,h,f,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(c=(a<3?D(c):a>3?D(h,f,c):D(h,f))||c);return a>3&&c&&Object.defineProperty(h,f,c),c},l=function(s,h){return function(f,_){h(f,_,s)}},g=function(s,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,h)},p=function(s,h,f,_){function a(c){return c instanceof f?c:new f(function(D){D(c)})}return new(f||(f=Promise))(function(c,D){function P(R){try{w(_.next(R))}catch(K){D(K)}}function U(R){try{w(_.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(P,U)}w((_=_.apply(s,h||[])).next())})},b=function(s,h){var f={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,a,c,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(w){return function(R){return U([w,R])}}function U(w){if(_)throw new TypeError("Generator is already executing.");for(;f;)try{if(_=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,a=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(c=f.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){f.label=w[1];break}if(w[0]===6&&f.label<c[1]){f.label=c[1],c=w;break}if(c&&f.label<c[2]){f.label=c[2],f.ops.push(w);break}c[2]&&f.ops.pop(),f.trys.pop();continue}w=h.call(s,f)}catch(R){w=[6,R],a=0}finally{_=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},o=function(s,h,f,_){_===void 0&&(_=f),s[_]=h[f]},S=function(s,h){for(var f in s)f!=="default"&&!h.hasOwnProperty(f)&&(h[f]=s[f])},x=function(s){var h=typeof Symbol=="function"&&Symbol.iterator,f=h&&s[h],_=0;if(f)return f.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,h){var f=typeof Symbol=="function"&&s[Symbol.iterator];if(!f)return s;var _=f.call(s),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=_.next()).done;)c.push(a.value)}catch(P){D={error:P}}finally{try{a&&!a.done&&(f=_.return)&&f.call(_)}finally{if(D)throw D.error}}return c},j=function(){for(var s=[],h=0;h<arguments.length;h++)s=s.concat(A(arguments[h]));return s},N=function(){for(var s=0,h=0,f=arguments.length;h<f;h++)s+=arguments[h].length;for(var _=Array(s),a=0,h=0;h<f;h++)for(var c=arguments[h],D=0,P=c.length;D<P;D++,a++)_[a]=c[D];return _},C=function(s){return this instanceof C?(this.v=s,this):new C(s)},q=function(s,h,f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=f.apply(s,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){_[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||P(z,V)})})}function P(z,V){try{U(_[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof C?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){P("next",z)}function R(z){P("throw",z)}function K(z,V){z(V),c.shift(),c.length&&P(c[0][0],c[0][1])}},B=function(s){var h,f;return h={},_("next"),_("throw",function(a){throw a}),_("return"),h[Symbol.iterator]=function(){return this},h;function _(a,c){h[a]=s[a]?function(D){return(f=!f)?{value:C(s[a](D)),done:a==="return"}:c?c(D):D}:c}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=s[Symbol.asyncIterator],f;return h?h.call(s):(s=typeof x=="function"?x(s):s[Symbol.iterator](),f={},_("next"),_("throw"),_("return"),f[Symbol.asyncIterator]=function(){return this},f);function _(c){f[c]=s[c]&&function(D){return new Promise(function(P,U){D=s[c](D),a(P,U,D.done,D.value)})}}function a(c,D,P,U){Promise.resolve(U).then(function(w){c({value:w,done:P})},D)}},v=function(s,h){return Object.defineProperty?Object.defineProperty(s,"raw",{value:h}):s.raw=h,s},I=function(s){if(s&&s.__esModule)return s;var h={};if(s!=null)for(var f in s)Object.hasOwnProperty.call(s,f)&&(h[f]=s[f]);return h.default=s,h},m=function(s){return s&&s.__esModule?s:{default:s}},E=function(s,h){if(!h.has(s))throw new TypeError("attempted to get private field on non-instance");return h.get(s)},y=function(s,h,f){if(!h.has(s))throw new TypeError("attempted to set private field on non-instance");return h.set(s,f),f},d("__extends",e),d("__assign",t),d("__rest",i),d("__decorate",n),d("__param",l),d("__metadata",g),d("__awaiter",p),d("__generator",b),d("__exportStar",S),d("__createBinding",o),d("__values",x),d("__read",A),d("__spread",j),d("__spreadArrays",N),d("__await",C),d("__asyncGenerator",q),d("__asyncDelegator",B),d("__asyncValues",W),d("__makeTemplateObject",v),d("__importStar",I),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(vo);var Yt={},Xn;function wo(){return Xn||(Xn=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PINO_CUSTOM_CONTEXT_KEY=Yt.PINO_LOGGER_DEFAULTS=void 0,Yt.PINO_LOGGER_DEFAULTS={level:"info"},Yt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Yt}var ot={},Zn;function nu(){if(Zn)return ot;Zn=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const r=wo();function e(p){return Object.assign(Object.assign({},p),{level:p?.level||r.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function t(p,b=r.PINO_CUSTOM_CONTEXT_KEY){return p[b]||""}ot.getBrowserLoggerContext=t;function i(p,b,S=r.PINO_CUSTOM_CONTEXT_KEY){return p[S]=b,p}ot.setBrowserLoggerContext=i;function n(p,b=r.PINO_CUSTOM_CONTEXT_KEY){let S="";return typeof p.bindings>"u"?S=t(p,b):S=p.bindings().context||"",S}ot.getLoggerContext=n;function l(p,b,S=r.PINO_CUSTOM_CONTEXT_KEY){const x=n(p,S);return x.trim()?`${x}/${b}`:b}ot.formatChildLoggerContext=l;function g(p,b,S=r.PINO_CUSTOM_CONTEXT_KEY){const x=l(p,b,S),A=p.child({context:x});return i(A,x,S)}return ot.generateChildLogger=g,ot}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;const e=vo.exports,t=e.__importDefault(oo());Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(wo(),r),e.__exportStar(nu(),r)})(Se);class su extends Xt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class ou extends Xt{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class au{constructor(e,t){this.logger=e,this.core=t}}class cu extends Xt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class uu extends Xt{constructor(e){super()}}class hu{constructor(e,t,i,n){this.core=e,this.logger=t,this.name=i}}class fu extends Xt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class lu extends Xt{constructor(e,t){super(),this.core=e,this.logger=t}}class du{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class pu{constructor(e){this.client=e}}function gu(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function yu(r){return typeof r=="string"?r:JSON.stringify(r)}var Yi={},sr={},ei={},ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.BrowserRandomSource=void 0;const Qn=65536;class _u{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=Qn)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Qn)));return t}}ti.BrowserRandomSource=_u;var ri={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function bu(r){for(var e=0;e<r.length;e++)r[e]=0;return r}pt.wipe=bu;Object.defineProperty(ri,"__esModule",{value:!0});ri.NodeRandomSource=void 0;const mu=pt;class vu{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof vc<"u"){const e=wc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=t[n];return(0,mu.wipe)(t),i}}ri.NodeRandomSource=vu;Object.defineProperty(ei,"__esModule",{value:!0});ei.SystemRandomSource=void 0;const wu=ti,Eu=ri;class Du{constructor(){if(this.isAvailable=!1,this.name="",this._source=new wu.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Eu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ei.SystemRandomSource=Du;var ne={},Eo={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(p,b){var S=p>>>16&65535,x=p&65535,A=b>>>16&65535,j=b&65535;return x*j+(S*j+x*A<<16>>>0)|0}r.mul=Math.imul||e;function t(p,b){return p+b|0}r.add=t;function i(p,b){return p-b|0}r.sub=i;function n(p,b){return p<<b|p>>>32-b}r.rotl=n;function l(p,b){return p<<32-b|p>>>b}r.rotr=l;function g(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p}r.isInteger=Number.isInteger||g,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(p){return r.isInteger(p)&&p>=-r.MAX_SAFE_INTEGER&&p<=r.MAX_SAFE_INTEGER}})(Eo);Object.defineProperty(ne,"__esModule",{value:!0});var Do=Eo;function Su(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}ne.readInt16BE=Su;function Ou(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}ne.readUint16BE=Ou;function Iu(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}ne.readInt16LE=Iu;function xu(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}ne.readUint16LE=xu;function So(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}ne.writeUint16BE=So;ne.writeInt16BE=So;function Oo(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}ne.writeUint16LE=Oo;ne.writeInt16LE=Oo;function Ai(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}ne.readInt32BE=Ai;function Ni(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}ne.readUint32BE=Ni;function Ci(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}ne.readInt32LE=Ci;function Ri(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}ne.readUint32LE=Ri;function Wr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}ne.writeUint32BE=Wr;ne.writeInt32BE=Wr;function kr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}ne.writeUint32LE=kr;ne.writeInt32LE=kr;function Pu(r,e){e===void 0&&(e=0);var t=Ai(r,e),i=Ai(r,e+4);return t*4294967296+i-(i>>31)*4294967296}ne.readInt64BE=Pu;function Tu(r,e){e===void 0&&(e=0);var t=Ni(r,e),i=Ni(r,e+4);return t*4294967296+i}ne.readUint64BE=Tu;function Au(r,e){e===void 0&&(e=0);var t=Ci(r,e),i=Ci(r,e+4);return i*4294967296+t-(t>>31)*4294967296}ne.readInt64LE=Au;function Nu(r,e){e===void 0&&(e=0);var t=Ri(r,e),i=Ri(r,e+4);return i*4294967296+t}ne.readUint64LE=Nu;function Io(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Wr(r/4294967296>>>0,e,t),Wr(r>>>0,e,t+4),e}ne.writeUint64BE=Io;ne.writeInt64BE=Io;function xo(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),kr(r>>>0,e,t),kr(r/4294967296>>>0,e,t+4),e}ne.writeUint64LE=xo;ne.writeInt64LE=xo;function Cu(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,l=r/8+t-1;l>=t;l--)i+=e[l]*n,n*=256;return i}ne.readUintBE=Cu;function Ru(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,l=t;l<t+r/8;l++)i+=e[l]*n,n*=256;return i}ne.readUintLE=Ru;function Fu(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Do.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,l=r/8+i-1;l>=i;l--)t[l]=e/n&255,n*=256;return t}ne.writeUintBE=Fu;function Lu(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Do.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,l=i;l<i+r/8;l++)t[l]=e/n&255,n*=256;return t}ne.writeUintLE=Lu;function Uu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}ne.readFloat32BE=Uu;function ju(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}ne.readFloat32LE=ju;function Mu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}ne.readFloat64BE=Mu;function $u(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}ne.readFloat64LE=$u;function Hu(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}ne.writeFloat32BE=Hu;function Bu(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}ne.writeFloat32LE=Bu;function qu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}ne.writeFloat64BE=qu;function zu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}ne.writeFloat64LE=zu;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=ei,t=ne,i=pt;r.defaultRandomSource=new e.SystemRandomSource;function n(S,x=r.defaultRandomSource){return x.randomBytes(S)}r.randomBytes=n;function l(S=r.defaultRandomSource){const x=n(4,S),A=(0,t.readUint32LE)(x);return(0,i.wipe)(x),A}r.randomUint32=l;const g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function p(S,x=g,A=r.defaultRandomSource){if(x.length<2)throw new Error("randomString charset is too short");if(x.length>256)throw new Error("randomString charset is too long");let j="";const N=x.length,C=256-256%N;for(;S>0;){const q=n(Math.ceil(S*256/C),A);for(let B=0;B<q.length&&S>0;B++){const W=q[B];W<C&&(j+=x.charAt(W%N),S--)}(0,i.wipe)(q)}return j}r.randomString=p;function b(S,x=g,A=r.defaultRandomSource){const j=Math.ceil(S/(Math.log(x.length)/Math.LN2));return p(j,x,A)}r.randomStringForEntropy=b})(sr);var Po={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ne,t=pt;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function p(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(b,S){if(S===void 0&&(S=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var x=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&S>0;)this._buffer[this._bufferLength++]=b[x++],S--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(x=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,x,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=b[x++],S--;return this},p.prototype.finish=function(b){if(!this._finished){var S=this._bytesHashed,x=this._bufferLength,A=S/536870912|0,j=S<<3,N=S%128<112?128:256;this._buffer[x]=128;for(var C=x+1;C<N-8;C++)this._buffer[C]=0;e.writeUint32BE(A,this._buffer,N-8),e.writeUint32BE(j,this._buffer,N-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,N),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)e.writeUint32BE(this._stateHi[C],b,C*8),e.writeUint32BE(this._stateLo[C],b,C*8+4);return this},p.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(b){t.wipe(b.stateHi),t.wipe(b.stateLo),b.buffer&&t.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},p}();r.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(p,b,S,x,A,j,N){for(var C=S[0],q=S[1],B=S[2],W=S[3],v=S[4],I=S[5],m=S[6],E=S[7],y=x[0],o=x[1],d=x[2],H=x[3],s=x[4],h=x[5],f=x[6],_=x[7],a,c,D,P,U,w,R,K;N>=128;){for(var z=0;z<16;z++){var V=8*z+j;p[z]=e.readUint32BE(A,V),b[z]=e.readUint32BE(A,V+4)}for(var z=0;z<80;z++){var X=C,Y=q,ee=B,$=W,M=v,F=I,u=m,T=E,k=y,Z=o,fe=d,_e=H,de=s,ve=h,Ue=f,Ce=_;if(a=E,c=_,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=(v>>>14|s<<32-14)^(v>>>18|s<<32-18)^(s>>>41-32|v<<32-(41-32)),c=(s>>>14|v<<32-14)^(s>>>18|v<<32-18)^(v>>>41-32|s<<32-(41-32)),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=v&I^~v&m,c=s&h^~s&f,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=n[z*2],c=n[z*2+1],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=p[z%16],c=b[z%16],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,D=R&65535|K<<16,P=U&65535|w<<16,a=D,c=P,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=(C>>>28|y<<32-28)^(y>>>34-32|C<<32-(34-32))^(y>>>39-32|C<<32-(39-32)),c=(y>>>28|C<<32-28)^(C>>>34-32|y<<32-(34-32))^(C>>>39-32|y<<32-(39-32)),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=C&q^C&B^q&B,c=y&o^y&d^o&d,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,T=R&65535|K<<16,Ce=U&65535|w<<16,a=$,c=_e,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=D,c=P,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,$=R&65535|K<<16,_e=U&65535|w<<16,q=X,B=Y,W=ee,v=$,I=M,m=F,E=u,C=T,o=k,d=Z,H=fe,s=_e,h=de,f=ve,_=Ue,y=Ce,z%16===15)for(var V=0;V<16;V++)a=p[V],c=b[V],U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=p[(V+9)%16],c=b[(V+9)%16],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,D=p[(V+1)%16],P=b[(V+1)%16],a=(D>>>1|P<<32-1)^(D>>>8|P<<32-8)^D>>>7,c=(P>>>1|D<<32-1)^(P>>>8|D<<32-8)^(P>>>7|D<<32-7),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,D=p[(V+14)%16],P=b[(V+14)%16],a=(D>>>19|P<<32-19)^(P>>>61-32|D<<32-(61-32))^D>>>6,c=(P>>>19|D<<32-19)^(D>>>61-32|P<<32-(61-32))^(P>>>6|D<<32-6),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,p[V]=R&65535|K<<16,b[V]=U&65535|w<<16}a=C,c=y,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[0],c=x[0],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[0]=C=R&65535|K<<16,x[0]=y=U&65535|w<<16,a=q,c=o,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[1],c=x[1],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[1]=q=R&65535|K<<16,x[1]=o=U&65535|w<<16,a=B,c=d,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[2],c=x[2],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[2]=B=R&65535|K<<16,x[2]=d=U&65535|w<<16,a=W,c=H,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[3],c=x[3],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[3]=W=R&65535|K<<16,x[3]=H=U&65535|w<<16,a=v,c=s,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[4],c=x[4],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[4]=v=R&65535|K<<16,x[4]=s=U&65535|w<<16,a=I,c=h,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[5],c=x[5],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[5]=I=R&65535|K<<16,x[5]=h=U&65535|w<<16,a=m,c=f,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[6],c=x[6],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[6]=m=R&65535|K<<16,x[6]=f=U&65535|w<<16,a=E,c=_,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[7],c=x[7],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[7]=E=R&65535|K<<16,x[7]=_=U&65535|w<<16,j+=128,N-=128}return j}function g(p){var b=new i;b.update(p);var S=b.digest();return b.clean(),S}r.hash=g})(Po);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=sr,t=Po,i=pt;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function n($){const M=new Float64Array(16);if($)for(let F=0;F<$.length;F++)M[F]=$[F];return M}const l=new Uint8Array(32);l[0]=9;const g=n(),p=n([1]),b=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),S=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),x=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function N($,M){for(let F=0;F<16;F++)$[F]=M[F]|0}function C($){let M=1;for(let F=0;F<16;F++){let u=$[F]+M+65535;M=Math.floor(u/65536),$[F]=u-M*65536}$[0]+=M-1+37*(M-1)}function q($,M,F){const u=~(F-1);for(let T=0;T<16;T++){const k=u&($[T]^M[T]);$[T]^=k,M[T]^=k}}function B($,M){const F=n(),u=n();for(let T=0;T<16;T++)u[T]=M[T];C(u),C(u),C(u);for(let T=0;T<2;T++){F[0]=u[0]-65517;for(let Z=1;Z<15;Z++)F[Z]=u[Z]-65535-(F[Z-1]>>16&1),F[Z-1]&=65535;F[15]=u[15]-32767-(F[14]>>16&1);const k=F[15]>>16&1;F[14]&=65535,q(u,F,1-k)}for(let T=0;T<16;T++)$[2*T]=u[T]&255,$[2*T+1]=u[T]>>8}function W($,M){let F=0;for(let u=0;u<32;u++)F|=$[u]^M[u];return(1&F-1>>>8)-1}function v($,M){const F=new Uint8Array(32),u=new Uint8Array(32);return B(F,$),B(u,M),W(F,u)}function I($){const M=new Uint8Array(32);return B(M,$),M[0]&1}function m($,M){for(let F=0;F<16;F++)$[F]=M[2*F]+(M[2*F+1]<<8);$[15]&=32767}function E($,M,F){for(let u=0;u<16;u++)$[u]=M[u]+F[u]}function y($,M,F){for(let u=0;u<16;u++)$[u]=M[u]-F[u]}function o($,M,F){let u,T,k=0,Z=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=0,pe=0,le=0,ue=0,ce=0,ae=0,oe=0,re=0,he=0,ge=0,ie=0,be=0,me=0,Ee=0,De=0,we=0,mt=0,Et=0,Ct=0,lt=0,qt=0,cr=0,Fr=0,Me=F[0],Re=F[1],$e=F[2],He=F[3],Be=F[4],Fe=F[5],Ke=F[6],Ve=F[7],Ge=F[8],We=F[9],ke=F[10],ze=F[11],qe=F[12],Te=F[13],Ye=F[14],Je=F[15];u=M[0],k+=u*Me,Z+=u*Re,fe+=u*$e,_e+=u*He,de+=u*Be,ve+=u*Fe,Ue+=u*Ke,Ce+=u*Ve,ye+=u*Ge,pe+=u*We,le+=u*ke,ue+=u*ze,ce+=u*qe,ae+=u*Te,oe+=u*Ye,re+=u*Je,u=M[1],Z+=u*Me,fe+=u*Re,_e+=u*$e,de+=u*He,ve+=u*Be,Ue+=u*Fe,Ce+=u*Ke,ye+=u*Ve,pe+=u*Ge,le+=u*We,ue+=u*ke,ce+=u*ze,ae+=u*qe,oe+=u*Te,re+=u*Ye,he+=u*Je,u=M[2],fe+=u*Me,_e+=u*Re,de+=u*$e,ve+=u*He,Ue+=u*Be,Ce+=u*Fe,ye+=u*Ke,pe+=u*Ve,le+=u*Ge,ue+=u*We,ce+=u*ke,ae+=u*ze,oe+=u*qe,re+=u*Te,he+=u*Ye,ge+=u*Je,u=M[3],_e+=u*Me,de+=u*Re,ve+=u*$e,Ue+=u*He,Ce+=u*Be,ye+=u*Fe,pe+=u*Ke,le+=u*Ve,ue+=u*Ge,ce+=u*We,ae+=u*ke,oe+=u*ze,re+=u*qe,he+=u*Te,ge+=u*Ye,ie+=u*Je,u=M[4],de+=u*Me,ve+=u*Re,Ue+=u*$e,Ce+=u*He,ye+=u*Be,pe+=u*Fe,le+=u*Ke,ue+=u*Ve,ce+=u*Ge,ae+=u*We,oe+=u*ke,re+=u*ze,he+=u*qe,ge+=u*Te,ie+=u*Ye,be+=u*Je,u=M[5],ve+=u*Me,Ue+=u*Re,Ce+=u*$e,ye+=u*He,pe+=u*Be,le+=u*Fe,ue+=u*Ke,ce+=u*Ve,ae+=u*Ge,oe+=u*We,re+=u*ke,he+=u*ze,ge+=u*qe,ie+=u*Te,be+=u*Ye,me+=u*Je,u=M[6],Ue+=u*Me,Ce+=u*Re,ye+=u*$e,pe+=u*He,le+=u*Be,ue+=u*Fe,ce+=u*Ke,ae+=u*Ve,oe+=u*Ge,re+=u*We,he+=u*ke,ge+=u*ze,ie+=u*qe,be+=u*Te,me+=u*Ye,Ee+=u*Je,u=M[7],Ce+=u*Me,ye+=u*Re,pe+=u*$e,le+=u*He,ue+=u*Be,ce+=u*Fe,ae+=u*Ke,oe+=u*Ve,re+=u*Ge,he+=u*We,ge+=u*ke,ie+=u*ze,be+=u*qe,me+=u*Te,Ee+=u*Ye,De+=u*Je,u=M[8],ye+=u*Me,pe+=u*Re,le+=u*$e,ue+=u*He,ce+=u*Be,ae+=u*Fe,oe+=u*Ke,re+=u*Ve,he+=u*Ge,ge+=u*We,ie+=u*ke,be+=u*ze,me+=u*qe,Ee+=u*Te,De+=u*Ye,we+=u*Je,u=M[9],pe+=u*Me,le+=u*Re,ue+=u*$e,ce+=u*He,ae+=u*Be,oe+=u*Fe,re+=u*Ke,he+=u*Ve,ge+=u*Ge,ie+=u*We,be+=u*ke,me+=u*ze,Ee+=u*qe,De+=u*Te,we+=u*Ye,mt+=u*Je,u=M[10],le+=u*Me,ue+=u*Re,ce+=u*$e,ae+=u*He,oe+=u*Be,re+=u*Fe,he+=u*Ke,ge+=u*Ve,ie+=u*Ge,be+=u*We,me+=u*ke,Ee+=u*ze,De+=u*qe,we+=u*Te,mt+=u*Ye,Et+=u*Je,u=M[11],ue+=u*Me,ce+=u*Re,ae+=u*$e,oe+=u*He,re+=u*Be,he+=u*Fe,ge+=u*Ke,ie+=u*Ve,be+=u*Ge,me+=u*We,Ee+=u*ke,De+=u*ze,we+=u*qe,mt+=u*Te,Et+=u*Ye,Ct+=u*Je,u=M[12],ce+=u*Me,ae+=u*Re,oe+=u*$e,re+=u*He,he+=u*Be,ge+=u*Fe,ie+=u*Ke,be+=u*Ve,me+=u*Ge,Ee+=u*We,De+=u*ke,we+=u*ze,mt+=u*qe,Et+=u*Te,Ct+=u*Ye,lt+=u*Je,u=M[13],ae+=u*Me,oe+=u*Re,re+=u*$e,he+=u*He,ge+=u*Be,ie+=u*Fe,be+=u*Ke,me+=u*Ve,Ee+=u*Ge,De+=u*We,we+=u*ke,mt+=u*ze,Et+=u*qe,Ct+=u*Te,lt+=u*Ye,qt+=u*Je,u=M[14],oe+=u*Me,re+=u*Re,he+=u*$e,ge+=u*He,ie+=u*Be,be+=u*Fe,me+=u*Ke,Ee+=u*Ve,De+=u*Ge,we+=u*We,mt+=u*ke,Et+=u*ze,Ct+=u*qe,lt+=u*Te,qt+=u*Ye,cr+=u*Je,u=M[15],re+=u*Me,he+=u*Re,ge+=u*$e,ie+=u*He,be+=u*Be,me+=u*Fe,Ee+=u*Ke,De+=u*Ve,we+=u*Ge,mt+=u*We,Et+=u*ke,Ct+=u*ze,lt+=u*qe,qt+=u*Te,cr+=u*Ye,Fr+=u*Je,k+=38*he,Z+=38*ge,fe+=38*ie,_e+=38*be,de+=38*me,ve+=38*Ee,Ue+=38*De,Ce+=38*we,ye+=38*mt,pe+=38*Et,le+=38*Ct,ue+=38*lt,ce+=38*qt,ae+=38*cr,oe+=38*Fr,T=1,u=k+T+65535,T=Math.floor(u/65536),k=u-T*65536,u=Z+T+65535,T=Math.floor(u/65536),Z=u-T*65536,u=fe+T+65535,T=Math.floor(u/65536),fe=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=de+T+65535,T=Math.floor(u/65536),de=u-T*65536,u=ve+T+65535,T=Math.floor(u/65536),ve=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=pe+T+65535,T=Math.floor(u/65536),pe=u-T*65536,u=le+T+65535,T=Math.floor(u/65536),le=u-T*65536,u=ue+T+65535,T=Math.floor(u/65536),ue=u-T*65536,u=ce+T+65535,T=Math.floor(u/65536),ce=u-T*65536,u=ae+T+65535,T=Math.floor(u/65536),ae=u-T*65536,u=oe+T+65535,T=Math.floor(u/65536),oe=u-T*65536,u=re+T+65535,T=Math.floor(u/65536),re=u-T*65536,k+=T-1+37*(T-1),T=1,u=k+T+65535,T=Math.floor(u/65536),k=u-T*65536,u=Z+T+65535,T=Math.floor(u/65536),Z=u-T*65536,u=fe+T+65535,T=Math.floor(u/65536),fe=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=de+T+65535,T=Math.floor(u/65536),de=u-T*65536,u=ve+T+65535,T=Math.floor(u/65536),ve=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=pe+T+65535,T=Math.floor(u/65536),pe=u-T*65536,u=le+T+65535,T=Math.floor(u/65536),le=u-T*65536,u=ue+T+65535,T=Math.floor(u/65536),ue=u-T*65536,u=ce+T+65535,T=Math.floor(u/65536),ce=u-T*65536,u=ae+T+65535,T=Math.floor(u/65536),ae=u-T*65536,u=oe+T+65535,T=Math.floor(u/65536),oe=u-T*65536,u=re+T+65535,T=Math.floor(u/65536),re=u-T*65536,k+=T-1+37*(T-1),$[0]=k,$[1]=Z,$[2]=fe,$[3]=_e,$[4]=de,$[5]=ve,$[6]=Ue,$[7]=Ce,$[8]=ye,$[9]=pe,$[10]=le,$[11]=ue,$[12]=ce,$[13]=ae,$[14]=oe,$[15]=re}function d($,M){o($,M,M)}function H($,M){const F=n();let u;for(u=0;u<16;u++)F[u]=M[u];for(u=253;u>=0;u--)d(F,F),u!==2&&u!==4&&o(F,F,M);for(u=0;u<16;u++)$[u]=F[u]}function s($,M){const F=n();let u;for(u=0;u<16;u++)F[u]=M[u];for(u=250;u>=0;u--)d(F,F),u!==1&&o(F,F,M);for(u=0;u<16;u++)$[u]=F[u]}function h($,M){const F=n(),u=n(),T=n(),k=n(),Z=n(),fe=n(),_e=n(),de=n(),ve=n();y(F,$[1],$[0]),y(ve,M[1],M[0]),o(F,F,ve),E(u,$[0],$[1]),E(ve,M[0],M[1]),o(u,u,ve),o(T,$[3],M[3]),o(T,T,S),o(k,$[2],M[2]),E(k,k,k),y(Z,u,F),y(fe,k,T),E(_e,k,T),E(de,u,F),o($[0],Z,fe),o($[1],de,_e),o($[2],_e,fe),o($[3],Z,de)}function f($,M,F){for(let u=0;u<4;u++)q($[u],M[u],F)}function _($,M){const F=n(),u=n(),T=n();H(T,M[2]),o(F,M[0],T),o(u,M[1],T),B($,u),$[31]^=I(F)<<7}function a($,M,F){N($[0],g),N($[1],p),N($[2],p),N($[3],g);for(let u=255;u>=0;--u){const T=F[u/8|0]>>(u&7)&1;f($,M,T),h(M,$),h($,$),f($,M,T)}}function c($,M){const F=[n(),n(),n(),n()];N(F[0],x),N(F[1],A),N(F[2],p),o(F[3],x,A),a($,F,M)}function D($){if($.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const M=(0,t.hash)($);M[0]&=248,M[31]&=127,M[31]|=64;const F=new Uint8Array(32),u=[n(),n(),n(),n()];c(u,M),_(F,u);const T=new Uint8Array(64);return T.set($),T.set(F,32),{publicKey:F,secretKey:T}}r.generateKeyPairFromSeed=D;function P($){const M=(0,e.randomBytes)(32,$),F=D(M);return(0,i.wipe)(M),F}r.generateKeyPair=P;function U($){if($.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array($.subarray(32))}r.extractPublicKeyFromSecretKey=U;const w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function R($,M){let F,u,T,k;for(u=63;u>=32;--u){for(F=0,T=u-32,k=u-12;T<k;++T)M[T]+=F-16*M[u]*w[T-(u-32)],F=Math.floor((M[T]+128)/256),M[T]-=F*256;M[T]+=F,M[u]=0}for(F=0,T=0;T<32;T++)M[T]+=F-(M[31]>>4)*w[T],F=M[T]>>8,M[T]&=255;for(T=0;T<32;T++)M[T]-=F*w[T];for(u=0;u<32;u++)M[u+1]+=M[u]>>8,$[u]=M[u]&255}function K($){const M=new Float64Array(64);for(let F=0;F<64;F++)M[F]=$[F];for(let F=0;F<64;F++)$[F]=0;R($,M)}function z($,M){const F=new Float64Array(64),u=[n(),n(),n(),n()],T=(0,t.hash)($.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const k=new Uint8Array(64);k.set(T.subarray(32),32);const Z=new t.SHA512;Z.update(k.subarray(32)),Z.update(M);const fe=Z.digest();Z.clean(),K(fe),c(u,fe),_(k,u),Z.reset(),Z.update(k.subarray(0,32)),Z.update($.subarray(32)),Z.update(M);const _e=Z.digest();K(_e);for(let de=0;de<32;de++)F[de]=fe[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)F[de+ve]+=_e[de]*T[ve];return R(k.subarray(32),F),k}r.sign=z;function V($,M){const F=n(),u=n(),T=n(),k=n(),Z=n(),fe=n(),_e=n();return N($[2],p),m($[1],M),d(T,$[1]),o(k,T,b),y(T,T,$[2]),E(k,$[2],k),d(Z,k),d(fe,Z),o(_e,fe,Z),o(F,_e,T),o(F,F,k),s(F,F),o(F,F,T),o(F,F,k),o(F,F,k),o($[0],F,k),d(u,$[0]),o(u,u,k),v(u,T)&&o($[0],$[0],j),d(u,$[0]),o(u,u,k),v(u,T)?-1:(I($[0])===M[31]>>7&&y($[0],g,$[0]),o($[3],$[0],$[1]),0)}function X($,M,F){const u=new Uint8Array(32),T=[n(),n(),n(),n()],k=[n(),n(),n(),n()];if(F.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(V(k,$))return!1;const Z=new t.SHA512;Z.update(F.subarray(0,32)),Z.update($),Z.update(M);const fe=Z.digest();return K(fe),a(T,k,fe),c(k,F.subarray(32)),h(T,k),_(u,T),!W(F,u)}r.verify=X;function Y($){let M=[n(),n(),n(),n()];if(V(M,$))throw new Error("Ed25519: invalid public key");let F=n(),u=n(),T=M[1];E(F,p,T),y(u,p,T),H(u,u),o(F,F,u);let k=new Uint8Array(32);return B(k,F),k}r.convertPublicKeyToX25519=Y;function ee($){const M=(0,t.hash)($.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const F=new Uint8Array(M.subarray(0,32));return(0,i.wipe)(M),F}r.convertSecretKeyToX25519=ee})(Yi);const Ku="EdDSA",Vu="JWT",To=".",Ao="base64url",Gu="utf8",Wu="utf8",ku=":",Yu="did",Ju="key",es="base58btc",Xu="z",Zu="K36",Qu=32;function No(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Fi(r,e){e||(e=r.reduce((n,l)=>n+l.length,0));const t=No(e);let i=0;for(const n of r)t.set(n,i),i+=n.length;return t}const eh=no({prefix:"\0",name:"identity",encode:r=>Ec(r),decode:r=>Dc(r)}),th=Object.freeze(Object.defineProperty({__proto__:null,identity:eh},Symbol.toStringTag,{value:"Module"})),rh=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ih=Object.freeze(Object.defineProperty({__proto__:null,base2:rh},Symbol.toStringTag,{value:"Module"})),nh=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),sh=Object.freeze(Object.defineProperty({__proto__:null,base8:nh},Symbol.toStringTag,{value:"Module"})),oh=Wi({prefix:"9",name:"base10",alphabet:"0123456789"}),ah=Object.freeze(Object.defineProperty({__proto__:null,base10:oh},Symbol.toStringTag,{value:"Module"})),ch=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),uh=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),hh=Object.freeze(Object.defineProperty({__proto__:null,base16:ch,base16upper:uh},Symbol.toStringTag,{value:"Module"})),fh=Wi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),lh=Wi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),dh=Object.freeze(Object.defineProperty({__proto__:null,base36:fh,base36upper:lh},Symbol.toStringTag,{value:"Module"})),ph=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gh=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yh=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_h=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),bh=Object.freeze(Object.defineProperty({__proto__:null,base64:ph,base64pad:gh,base64url:yh,base64urlpad:_h},Symbol.toStringTag,{value:"Module"})),Co=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),mh=Co.reduce((r,e,t)=>(r[t]=e,r),[]),vh=Co.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function wh(r){return r.reduce((e,t)=>(e+=mh[t],e),"")}function Eh(r){const e=[];for(const t of r){const i=vh[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const Dh=no({prefix:"\u{1F680}",name:"base256emoji",encode:wh,decode:Eh}),Sh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Dh},Symbol.toStringTag,{value:"Module"})),Ro=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Oh=so({name:"sha2-256",code:18,encode:Ro("SHA-256")}),Ih=so({name:"sha2-512",code:19,encode:Ro("SHA-512")}),xh=Object.freeze(Object.defineProperty({__proto__:null,sha256:Oh,sha512:Ih},Symbol.toStringTag,{value:"Module"})),Fo=0,Ph="identity",Lo=Sc,Th=r=>Oc(Fo,Lo(r)),Ah={code:Fo,name:Ph,encode:Lo,digest:Th},Nh=Object.freeze(Object.defineProperty({__proto__:null,identity:Ah},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ts={...th,...ih,...sh,...ah,...hh,...Ic,...dh,...xc,...bh,...Sh};({...xh,...Nh});function Uo(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const rs=Uo("utf8","u",r=>{const e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),Ei=Uo("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=No(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),jo={utf8:rs,"utf-8":rs,hex:ts.base16,latin1:Ei,ascii:Ei,binary:Ei,...ts};function ft(r,e="utf8"){const t=jo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function ut(r,e="utf8"){const t=jo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Ch(r){return typeof r=="string"?r:JSON.stringify(r)}function Yr(r){return ft(ut(Ch(r),Gu),Ao)}function Mo(r){const e=ut(Zu,es),t=Xu+ft(Fi([e,r]),es);return[Yu,Ju,t].join(ku)}function Rh(r){return ft(r,Ao)}function Fh(r){return ut([Yr(r.header),Yr(r.payload)].join(To),Wu)}function Lh(r){return[Yr(r.header),Yr(r.payload),Rh(r.signature)].join(To)}function is(r=sr.randomBytes(Qu)){return Yi.generateKeyPairFromSeed(r)}async function Uh(r,e,t,i,n=te.fromMiliseconds(Date.now())){const l={alg:Ku,typ:Vu},g=Mo(i.publicKey),p=n+t,b={iss:g,sub:r,aud:e,iat:n,exp:p},S=Fh({header:l,payload:b}),x=Yi.sign(i.secretKey,S);return Lh({header:l,payload:b,signature:x})}var Ji={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});var nt=ne,Li=pt,jh=20;function Mh(r,e,t){for(var i=1634760805,n=857760878,l=2036477234,g=1797285236,p=t[3]<<24|t[2]<<16|t[1]<<8|t[0],b=t[7]<<24|t[6]<<16|t[5]<<8|t[4],S=t[11]<<24|t[10]<<16|t[9]<<8|t[8],x=t[15]<<24|t[14]<<16|t[13]<<8|t[12],A=t[19]<<24|t[18]<<16|t[17]<<8|t[16],j=t[23]<<24|t[22]<<16|t[21]<<8|t[20],N=t[27]<<24|t[26]<<16|t[25]<<8|t[24],C=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],W=e[11]<<24|e[10]<<16|e[9]<<8|e[8],v=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=i,m=n,E=l,y=g,o=p,d=b,H=S,s=x,h=A,f=j,_=N,a=C,c=q,D=B,P=W,U=v,w=0;w<jh;w+=2)I=I+o|0,c^=I,c=c>>>32-16|c<<16,h=h+c|0,o^=h,o=o>>>32-12|o<<12,m=m+d|0,D^=m,D=D>>>32-16|D<<16,f=f+D|0,d^=f,d=d>>>32-12|d<<12,E=E+H|0,P^=E,P=P>>>32-16|P<<16,_=_+P|0,H^=_,H=H>>>32-12|H<<12,y=y+s|0,U^=y,U=U>>>32-16|U<<16,a=a+U|0,s^=a,s=s>>>32-12|s<<12,E=E+H|0,P^=E,P=P>>>32-8|P<<8,_=_+P|0,H^=_,H=H>>>32-7|H<<7,y=y+s|0,U^=y,U=U>>>32-8|U<<8,a=a+U|0,s^=a,s=s>>>32-7|s<<7,m=m+d|0,D^=m,D=D>>>32-8|D<<8,f=f+D|0,d^=f,d=d>>>32-7|d<<7,I=I+o|0,c^=I,c=c>>>32-8|c<<8,h=h+c|0,o^=h,o=o>>>32-7|o<<7,I=I+d|0,U^=I,U=U>>>32-16|U<<16,_=_+U|0,d^=_,d=d>>>32-12|d<<12,m=m+H|0,c^=m,c=c>>>32-16|c<<16,a=a+c|0,H^=a,H=H>>>32-12|H<<12,E=E+s|0,D^=E,D=D>>>32-16|D<<16,h=h+D|0,s^=h,s=s>>>32-12|s<<12,y=y+o|0,P^=y,P=P>>>32-16|P<<16,f=f+P|0,o^=f,o=o>>>32-12|o<<12,E=E+s|0,D^=E,D=D>>>32-8|D<<8,h=h+D|0,s^=h,s=s>>>32-7|s<<7,y=y+o|0,P^=y,P=P>>>32-8|P<<8,f=f+P|0,o^=f,o=o>>>32-7|o<<7,m=m+H|0,c^=m,c=c>>>32-8|c<<8,a=a+c|0,H^=a,H=H>>>32-7|H<<7,I=I+d|0,U^=I,U=U>>>32-8|U<<8,_=_+U|0,d^=_,d=d>>>32-7|d<<7;nt.writeUint32LE(I+i|0,r,0),nt.writeUint32LE(m+n|0,r,4),nt.writeUint32LE(E+l|0,r,8),nt.writeUint32LE(y+g|0,r,12),nt.writeUint32LE(o+p|0,r,16),nt.writeUint32LE(d+b|0,r,20),nt.writeUint32LE(H+S|0,r,24),nt.writeUint32LE(s+x|0,r,28),nt.writeUint32LE(h+A|0,r,32),nt.writeUint32LE(f+j|0,r,36),nt.writeUint32LE(_+N|0,r,40),nt.writeUint32LE(a+C|0,r,44),nt.writeUint32LE(c+q|0,r,48),nt.writeUint32LE(D+B|0,r,52),nt.writeUint32LE(P+W|0,r,56),nt.writeUint32LE(U+v|0,r,60)}function $o(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var l,g;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),g=l.length-e.length,l.set(e,g)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=e,g=n}for(var p=new Uint8Array(64),b=0;b<t.length;b+=64){Mh(p,l,r);for(var S=b;S<b+64&&S<t.length;S++)i[S]=t[S]^p[S-b];Hh(l,0,g)}return Li.wipe(p),n===0&&Li.wipe(l),i}ii.streamXOR=$o;function $h(r,e,t,i){return i===void 0&&(i=0),Li.wipe(t),$o(r,e,t,t,i)}ii.stream=$h;function Hh(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Ho={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});function Bh(r,e,t){return~(r-1)&e|r-1&t}Bt.select=Bh;function qh(r,e){return(r|0)-(e|0)-1>>>31&1}Bt.lessOrEqual=qh;function Bo(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}Bt.compare=Bo;function zh(r,e){return r.length===0||e.length===0?!1:Bo(r,e)!==0}Bt.equal=zh;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Bt,t=pt;r.DIGEST_LENGTH=16;var i=function(){function g(p){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var b=p[0]|p[1]<<8;this._r[0]=b&8191;var S=p[2]|p[3]<<8;this._r[1]=(b>>>13|S<<3)&8191;var x=p[4]|p[5]<<8;this._r[2]=(S>>>10|x<<6)&7939;var A=p[6]|p[7]<<8;this._r[3]=(x>>>7|A<<9)&8191;var j=p[8]|p[9]<<8;this._r[4]=(A>>>4|j<<12)&255,this._r[5]=j>>>1&8190;var N=p[10]|p[11]<<8;this._r[6]=(j>>>14|N<<2)&8191;var C=p[12]|p[13]<<8;this._r[7]=(N>>>11|C<<5)&8065;var q=p[14]|p[15]<<8;this._r[8]=(C>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=p[16]|p[17]<<8,this._pad[1]=p[18]|p[19]<<8,this._pad[2]=p[20]|p[21]<<8,this._pad[3]=p[22]|p[23]<<8,this._pad[4]=p[24]|p[25]<<8,this._pad[5]=p[26]|p[27]<<8,this._pad[6]=p[28]|p[29]<<8,this._pad[7]=p[30]|p[31]<<8}return g.prototype._blocks=function(p,b,S){for(var x=this._fin?0:2048,A=this._h[0],j=this._h[1],N=this._h[2],C=this._h[3],q=this._h[4],B=this._h[5],W=this._h[6],v=this._h[7],I=this._h[8],m=this._h[9],E=this._r[0],y=this._r[1],o=this._r[2],d=this._r[3],H=this._r[4],s=this._r[5],h=this._r[6],f=this._r[7],_=this._r[8],a=this._r[9];S>=16;){var c=p[b+0]|p[b+1]<<8;A+=c&8191;var D=p[b+2]|p[b+3]<<8;j+=(c>>>13|D<<3)&8191;var P=p[b+4]|p[b+5]<<8;N+=(D>>>10|P<<6)&8191;var U=p[b+6]|p[b+7]<<8;C+=(P>>>7|U<<9)&8191;var w=p[b+8]|p[b+9]<<8;q+=(U>>>4|w<<12)&8191,B+=w>>>1&8191;var R=p[b+10]|p[b+11]<<8;W+=(w>>>14|R<<2)&8191;var K=p[b+12]|p[b+13]<<8;v+=(R>>>11|K<<5)&8191;var z=p[b+14]|p[b+15]<<8;I+=(K>>>8|z<<8)&8191,m+=z>>>5|x;var V=0,X=V;X+=A*E,X+=j*(5*a),X+=N*(5*_),X+=C*(5*f),X+=q*(5*h),V=X>>>13,X&=8191,X+=B*(5*s),X+=W*(5*H),X+=v*(5*d),X+=I*(5*o),X+=m*(5*y),V+=X>>>13,X&=8191;var Y=V;Y+=A*y,Y+=j*E,Y+=N*(5*a),Y+=C*(5*_),Y+=q*(5*f),V=Y>>>13,Y&=8191,Y+=B*(5*h),Y+=W*(5*s),Y+=v*(5*H),Y+=I*(5*d),Y+=m*(5*o),V+=Y>>>13,Y&=8191;var ee=V;ee+=A*o,ee+=j*y,ee+=N*E,ee+=C*(5*a),ee+=q*(5*_),V=ee>>>13,ee&=8191,ee+=B*(5*f),ee+=W*(5*h),ee+=v*(5*s),ee+=I*(5*H),ee+=m*(5*d),V+=ee>>>13,ee&=8191;var $=V;$+=A*d,$+=j*o,$+=N*y,$+=C*E,$+=q*(5*a),V=$>>>13,$&=8191,$+=B*(5*_),$+=W*(5*f),$+=v*(5*h),$+=I*(5*s),$+=m*(5*H),V+=$>>>13,$&=8191;var M=V;M+=A*H,M+=j*d,M+=N*o,M+=C*y,M+=q*E,V=M>>>13,M&=8191,M+=B*(5*a),M+=W*(5*_),M+=v*(5*f),M+=I*(5*h),M+=m*(5*s),V+=M>>>13,M&=8191;var F=V;F+=A*s,F+=j*H,F+=N*d,F+=C*o,F+=q*y,V=F>>>13,F&=8191,F+=B*E,F+=W*(5*a),F+=v*(5*_),F+=I*(5*f),F+=m*(5*h),V+=F>>>13,F&=8191;var u=V;u+=A*h,u+=j*s,u+=N*H,u+=C*d,u+=q*o,V=u>>>13,u&=8191,u+=B*y,u+=W*E,u+=v*(5*a),u+=I*(5*_),u+=m*(5*f),V+=u>>>13,u&=8191;var T=V;T+=A*f,T+=j*h,T+=N*s,T+=C*H,T+=q*d,V=T>>>13,T&=8191,T+=B*o,T+=W*y,T+=v*E,T+=I*(5*a),T+=m*(5*_),V+=T>>>13,T&=8191;var k=V;k+=A*_,k+=j*f,k+=N*h,k+=C*s,k+=q*H,V=k>>>13,k&=8191,k+=B*d,k+=W*o,k+=v*y,k+=I*E,k+=m*(5*a),V+=k>>>13,k&=8191;var Z=V;Z+=A*a,Z+=j*_,Z+=N*f,Z+=C*h,Z+=q*s,V=Z>>>13,Z&=8191,Z+=B*H,Z+=W*d,Z+=v*o,Z+=I*y,Z+=m*E,V+=Z>>>13,Z&=8191,V=(V<<2)+V|0,V=V+X|0,X=V&8191,V=V>>>13,Y+=V,A=X,j=Y,N=ee,C=$,q=M,B=F,W=u,v=T,I=k,m=Z,b+=16,S-=16}this._h[0]=A,this._h[1]=j,this._h[2]=N,this._h[3]=C,this._h[4]=q,this._h[5]=B,this._h[6]=W,this._h[7]=v,this._h[8]=I,this._h[9]=m},g.prototype.finish=function(p,b){b===void 0&&(b=0);var S=new Uint16Array(10),x,A,j,N;if(this._leftover){for(N=this._leftover,this._buffer[N++]=1;N<16;N++)this._buffer[N]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(x=this._h[1]>>>13,this._h[1]&=8191,N=2;N<10;N++)this._h[N]+=x,x=this._h[N]>>>13,this._h[N]&=8191;for(this._h[0]+=x*5,x=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=x,x=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=x,S[0]=this._h[0]+5,x=S[0]>>>13,S[0]&=8191,N=1;N<10;N++)S[N]=this._h[N]+x,x=S[N]>>>13,S[N]&=8191;for(S[9]-=1<<13,A=(x^1)-1,N=0;N<10;N++)S[N]&=A;for(A=~A,N=0;N<10;N++)this._h[N]=this._h[N]&A|S[N];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,j=this._h[0]+this._pad[0],this._h[0]=j&65535,N=1;N<8;N++)j=(this._h[N]+this._pad[N]|0)+(j>>>16)|0,this._h[N]=j&65535;return p[b+0]=this._h[0]>>>0,p[b+1]=this._h[0]>>>8,p[b+2]=this._h[1]>>>0,p[b+3]=this._h[1]>>>8,p[b+4]=this._h[2]>>>0,p[b+5]=this._h[2]>>>8,p[b+6]=this._h[3]>>>0,p[b+7]=this._h[3]>>>8,p[b+8]=this._h[4]>>>0,p[b+9]=this._h[4]>>>8,p[b+10]=this._h[5]>>>0,p[b+11]=this._h[5]>>>8,p[b+12]=this._h[6]>>>0,p[b+13]=this._h[6]>>>8,p[b+14]=this._h[7]>>>0,p[b+15]=this._h[7]>>>8,this._finished=!0,this},g.prototype.update=function(p){var b=0,S=p.length,x;if(this._leftover){x=16-this._leftover,x>S&&(x=S);for(var A=0;A<x;A++)this._buffer[this._leftover+A]=p[b+A];if(S-=x,b+=x,this._leftover+=x,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(S>=16&&(x=S-S%16,this._blocks(p,b,x),b+=x,S-=x),S){for(var A=0;A<S;A++)this._buffer[this._leftover+A]=p[b+A];this._leftover+=S}return this},g.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var p=new Uint8Array(16);return this.finish(p),p},g.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},g}();r.Poly1305=i;function n(g,p){var b=new i(g);b.update(p);var S=b.digest();return b.clean(),S}r.oneTimeAuth=n;function l(g,p){return g.length!==r.DIGEST_LENGTH||p.length!==r.DIGEST_LENGTH?!1:e.equal(g,p)}r.equal=l})(Ho);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ii,t=Ho,i=pt,n=ne,l=Bt;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var g=new Uint8Array(16),p=function(){function b(S){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,S.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(S)}return b.prototype.seal=function(S,x,A,j){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var N=new Uint8Array(16);N.set(S,N.length-S.length);var C=new Uint8Array(32);e.stream(this._key,N,C,4);var q=x.length+this.tagLength,B;if(j){if(j.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");B=j}else B=new Uint8Array(q);return e.streamXOR(this._key,N,x,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),C,B.subarray(0,B.length-this.tagLength),A),i.wipe(N),B},b.prototype.open=function(S,x,A,j){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(x.length<this.tagLength)return null;var N=new Uint8Array(16);N.set(S,N.length-S.length);var C=new Uint8Array(32);e.stream(this._key,N,C,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,C,x.subarray(0,x.length-this.tagLength),A),!l.equal(q,x.subarray(x.length-this.tagLength,x.length)))return null;var B=x.length-this.tagLength,W;if(j){if(j.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");W=j}else W=new Uint8Array(B);return e.streamXOR(this._key,N,x.subarray(0,x.length-this.tagLength),W,4),i.wipe(N),W},b.prototype.clean=function(){return i.wipe(this._key),this},b.prototype._authenticate=function(S,x,A,j){var N=new t.Poly1305(x);j&&(N.update(j),j.length%16>0&&N.update(g.subarray(j.length%16))),N.update(A),A.length%16>0&&N.update(g.subarray(A.length%16));var C=new Uint8Array(8);j&&n.writeUint64LE(j.length,C),N.update(C),n.writeUint64LE(A.length,C),N.update(C);for(var q=N.digest(),B=0;B<q.length;B++)S[B]=q[B];N.clean(),i.wipe(q),i.wipe(C)},b}();r.ChaCha20Poly1305=p})(Ji);var qo={},Pr={},Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});function Kh(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}Xi.isSerializableHash=Kh;Object.defineProperty(Pr,"__esModule",{value:!0});var Dt=Xi,Vh=Bt,Gh=pt,zo=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Dt.isSerializableHash(this._inner)&&Dt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Gh.wipe(i)}return r.prototype.reset=function(){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Dt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Dt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Pr.HMAC=zo;function Wh(r,e,t){var i=new zo(r,e);i.update(t);var n=i.digest();return i.clean(),n}Pr.hmac=Wh;Pr.equal=Vh.equal;Object.defineProperty(qo,"__esModule",{value:!0});var ns=Pr,ss=pt,kh=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var l=ns.hmac(this._hash,i,t);this._hmac=new ns.HMAC(e,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),ss.wipe(this._buffer),ss.wipe(this._counter),this._bufpos=0},r}(),Yh=qo.HKDF=kh,ni={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ne,t=pt;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function p(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},p.prototype.update=function(b,S){if(S===void 0&&(S=b.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var x=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&S>0;)this._buffer[this._bufferLength++]=b[x++],S--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(x=l(this._temp,this._state,b,x,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=b[x++],S--;return this},p.prototype.finish=function(b){if(!this._finished){var S=this._bytesHashed,x=this._bufferLength,A=S/536870912|0,j=S<<3,N=S%64<56?64:128;this._buffer[x]=128;for(var C=x+1;C<N-8;C++)this._buffer[C]=0;e.writeUint32BE(A,this._buffer,N-8),e.writeUint32BE(j,this._buffer,N-4),l(this._temp,this._state,this._buffer,0,N),this._finished=!0}for(var C=0;C<this.digestLength/4;C++)e.writeUint32BE(this._state[C],b,C*4);return this},p.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(b){return this._state.set(b.state),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(b){t.wipe(b.state),b.buffer&&t.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},p}();r.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(p,b,S,x,A){for(;A>=64;){for(var j=b[0],N=b[1],C=b[2],q=b[3],B=b[4],W=b[5],v=b[6],I=b[7],m=0;m<16;m++){var E=x+m*4;p[m]=e.readUint32BE(S,E)}for(var m=16;m<64;m++){var y=p[m-2],o=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=p[m-15];var d=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;p[m]=(o+p[m-7]|0)+(d+p[m-16]|0)}for(var m=0;m<64;m++){var o=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&W^~B&v)|0)+(I+(n[m]+p[m]|0)|0)|0,d=((j>>>2|j<<32-2)^(j>>>13|j<<32-13)^(j>>>22|j<<32-22))+(j&N^j&C^N&C)|0;I=v,v=W,W=B,B=q+o|0,q=C,C=N,N=j,j=o+d|0}b[0]+=j,b[1]+=N,b[2]+=C,b[3]+=q,b[4]+=B,b[5]+=W,b[6]+=v,b[7]+=I,x+=64,A-=64}return x}function g(p){var b=new i;b.update(p);var S=b.digest();return b.clean(),S}r.hash=g})(ni);var Zi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=sr,t=pt;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(m){const E=new Float64Array(16);if(m)for(let y=0;y<m.length;y++)E[y]=m[y];return E}const n=new Uint8Array(32);n[0]=9;const l=i([56129,1]);function g(m){let E=1;for(let y=0;y<16;y++){let o=m[y]+E+65535;E=Math.floor(o/65536),m[y]=o-E*65536}m[0]+=E-1+37*(E-1)}function p(m,E,y){const o=~(y-1);for(let d=0;d<16;d++){const H=o&(m[d]^E[d]);m[d]^=H,E[d]^=H}}function b(m,E){const y=i(),o=i();for(let d=0;d<16;d++)o[d]=E[d];g(o),g(o),g(o);for(let d=0;d<2;d++){y[0]=o[0]-65517;for(let s=1;s<15;s++)y[s]=o[s]-65535-(y[s-1]>>16&1),y[s-1]&=65535;y[15]=o[15]-32767-(y[14]>>16&1);const H=y[15]>>16&1;y[14]&=65535,p(o,y,1-H)}for(let d=0;d<16;d++)m[2*d]=o[d]&255,m[2*d+1]=o[d]>>8}function S(m,E){for(let y=0;y<16;y++)m[y]=E[2*y]+(E[2*y+1]<<8);m[15]&=32767}function x(m,E,y){for(let o=0;o<16;o++)m[o]=E[o]+y[o]}function A(m,E,y){for(let o=0;o<16;o++)m[o]=E[o]-y[o]}function j(m,E,y){let o,d,H=0,s=0,h=0,f=0,_=0,a=0,c=0,D=0,P=0,U=0,w=0,R=0,K=0,z=0,V=0,X=0,Y=0,ee=0,$=0,M=0,F=0,u=0,T=0,k=0,Z=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=y[0],pe=y[1],le=y[2],ue=y[3],ce=y[4],ae=y[5],oe=y[6],re=y[7],he=y[8],ge=y[9],ie=y[10],be=y[11],me=y[12],Ee=y[13],De=y[14],we=y[15];o=E[0],H+=o*ye,s+=o*pe,h+=o*le,f+=o*ue,_+=o*ce,a+=o*ae,c+=o*oe,D+=o*re,P+=o*he,U+=o*ge,w+=o*ie,R+=o*be,K+=o*me,z+=o*Ee,V+=o*De,X+=o*we,o=E[1],s+=o*ye,h+=o*pe,f+=o*le,_+=o*ue,a+=o*ce,c+=o*ae,D+=o*oe,P+=o*re,U+=o*he,w+=o*ge,R+=o*ie,K+=o*be,z+=o*me,V+=o*Ee,X+=o*De,Y+=o*we,o=E[2],h+=o*ye,f+=o*pe,_+=o*le,a+=o*ue,c+=o*ce,D+=o*ae,P+=o*oe,U+=o*re,w+=o*he,R+=o*ge,K+=o*ie,z+=o*be,V+=o*me,X+=o*Ee,Y+=o*De,ee+=o*we,o=E[3],f+=o*ye,_+=o*pe,a+=o*le,c+=o*ue,D+=o*ce,P+=o*ae,U+=o*oe,w+=o*re,R+=o*he,K+=o*ge,z+=o*ie,V+=o*be,X+=o*me,Y+=o*Ee,ee+=o*De,$+=o*we,o=E[4],_+=o*ye,a+=o*pe,c+=o*le,D+=o*ue,P+=o*ce,U+=o*ae,w+=o*oe,R+=o*re,K+=o*he,z+=o*ge,V+=o*ie,X+=o*be,Y+=o*me,ee+=o*Ee,$+=o*De,M+=o*we,o=E[5],a+=o*ye,c+=o*pe,D+=o*le,P+=o*ue,U+=o*ce,w+=o*ae,R+=o*oe,K+=o*re,z+=o*he,V+=o*ge,X+=o*ie,Y+=o*be,ee+=o*me,$+=o*Ee,M+=o*De,F+=o*we,o=E[6],c+=o*ye,D+=o*pe,P+=o*le,U+=o*ue,w+=o*ce,R+=o*ae,K+=o*oe,z+=o*re,V+=o*he,X+=o*ge,Y+=o*ie,ee+=o*be,$+=o*me,M+=o*Ee,F+=o*De,u+=o*we,o=E[7],D+=o*ye,P+=o*pe,U+=o*le,w+=o*ue,R+=o*ce,K+=o*ae,z+=o*oe,V+=o*re,X+=o*he,Y+=o*ge,ee+=o*ie,$+=o*be,M+=o*me,F+=o*Ee,u+=o*De,T+=o*we,o=E[8],P+=o*ye,U+=o*pe,w+=o*le,R+=o*ue,K+=o*ce,z+=o*ae,V+=o*oe,X+=o*re,Y+=o*he,ee+=o*ge,$+=o*ie,M+=o*be,F+=o*me,u+=o*Ee,T+=o*De,k+=o*we,o=E[9],U+=o*ye,w+=o*pe,R+=o*le,K+=o*ue,z+=o*ce,V+=o*ae,X+=o*oe,Y+=o*re,ee+=o*he,$+=o*ge,M+=o*ie,F+=o*be,u+=o*me,T+=o*Ee,k+=o*De,Z+=o*we,o=E[10],w+=o*ye,R+=o*pe,K+=o*le,z+=o*ue,V+=o*ce,X+=o*ae,Y+=o*oe,ee+=o*re,$+=o*he,M+=o*ge,F+=o*ie,u+=o*be,T+=o*me,k+=o*Ee,Z+=o*De,fe+=o*we,o=E[11],R+=o*ye,K+=o*pe,z+=o*le,V+=o*ue,X+=o*ce,Y+=o*ae,ee+=o*oe,$+=o*re,M+=o*he,F+=o*ge,u+=o*ie,T+=o*be,k+=o*me,Z+=o*Ee,fe+=o*De,_e+=o*we,o=E[12],K+=o*ye,z+=o*pe,V+=o*le,X+=o*ue,Y+=o*ce,ee+=o*ae,$+=o*oe,M+=o*re,F+=o*he,u+=o*ge,T+=o*ie,k+=o*be,Z+=o*me,fe+=o*Ee,_e+=o*De,de+=o*we,o=E[13],z+=o*ye,V+=o*pe,X+=o*le,Y+=o*ue,ee+=o*ce,$+=o*ae,M+=o*oe,F+=o*re,u+=o*he,T+=o*ge,k+=o*ie,Z+=o*be,fe+=o*me,_e+=o*Ee,de+=o*De,ve+=o*we,o=E[14],V+=o*ye,X+=o*pe,Y+=o*le,ee+=o*ue,$+=o*ce,M+=o*ae,F+=o*oe,u+=o*re,T+=o*he,k+=o*ge,Z+=o*ie,fe+=o*be,_e+=o*me,de+=o*Ee,ve+=o*De,Ue+=o*we,o=E[15],X+=o*ye,Y+=o*pe,ee+=o*le,$+=o*ue,M+=o*ce,F+=o*ae,u+=o*oe,T+=o*re,k+=o*he,Z+=o*ge,fe+=o*ie,_e+=o*be,de+=o*me,ve+=o*Ee,Ue+=o*De,Ce+=o*we,H+=38*Y,s+=38*ee,h+=38*$,f+=38*M,_+=38*F,a+=38*u,c+=38*T,D+=38*k,P+=38*Z,U+=38*fe,w+=38*_e,R+=38*de,K+=38*ve,z+=38*Ue,V+=38*Ce,d=1,o=H+d+65535,d=Math.floor(o/65536),H=o-d*65536,o=s+d+65535,d=Math.floor(o/65536),s=o-d*65536,o=h+d+65535,d=Math.floor(o/65536),h=o-d*65536,o=f+d+65535,d=Math.floor(o/65536),f=o-d*65536,o=_+d+65535,d=Math.floor(o/65536),_=o-d*65536,o=a+d+65535,d=Math.floor(o/65536),a=o-d*65536,o=c+d+65535,d=Math.floor(o/65536),c=o-d*65536,o=D+d+65535,d=Math.floor(o/65536),D=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=w+d+65535,d=Math.floor(o/65536),w=o-d*65536,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=V+d+65535,d=Math.floor(o/65536),V=o-d*65536,o=X+d+65535,d=Math.floor(o/65536),X=o-d*65536,H+=d-1+37*(d-1),d=1,o=H+d+65535,d=Math.floor(o/65536),H=o-d*65536,o=s+d+65535,d=Math.floor(o/65536),s=o-d*65536,o=h+d+65535,d=Math.floor(o/65536),h=o-d*65536,o=f+d+65535,d=Math.floor(o/65536),f=o-d*65536,o=_+d+65535,d=Math.floor(o/65536),_=o-d*65536,o=a+d+65535,d=Math.floor(o/65536),a=o-d*65536,o=c+d+65535,d=Math.floor(o/65536),c=o-d*65536,o=D+d+65535,d=Math.floor(o/65536),D=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=w+d+65535,d=Math.floor(o/65536),w=o-d*65536,o=R+d+65535,d=Math.floor(o/65536),R=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=z+d+65535,d=Math.floor(o/65536),z=o-d*65536,o=V+d+65535,d=Math.floor(o/65536),V=o-d*65536,o=X+d+65535,d=Math.floor(o/65536),X=o-d*65536,H+=d-1+37*(d-1),m[0]=H,m[1]=s,m[2]=h,m[3]=f,m[4]=_,m[5]=a,m[6]=c,m[7]=D,m[8]=P,m[9]=U,m[10]=w,m[11]=R,m[12]=K,m[13]=z,m[14]=V,m[15]=X}function N(m,E){j(m,E,E)}function C(m,E){const y=i();for(let o=0;o<16;o++)y[o]=E[o];for(let o=253;o>=0;o--)N(y,y),o!==2&&o!==4&&j(y,y,E);for(let o=0;o<16;o++)m[o]=y[o]}function q(m,E){const y=new Uint8Array(32),o=new Float64Array(80),d=i(),H=i(),s=i(),h=i(),f=i(),_=i();for(let P=0;P<31;P++)y[P]=m[P];y[31]=m[31]&127|64,y[0]&=248,S(o,E);for(let P=0;P<16;P++)H[P]=o[P];d[0]=h[0]=1;for(let P=254;P>=0;--P){const U=y[P>>>3]>>>(P&7)&1;p(d,H,U),p(s,h,U),x(f,d,s),A(d,d,s),x(s,H,h),A(H,H,h),N(h,f),N(_,d),j(d,s,d),j(s,H,f),x(f,d,s),A(d,d,s),N(H,d),A(s,h,_),j(d,s,l),x(d,d,h),j(s,s,d),j(d,h,_),j(h,H,o),N(H,f),p(d,H,U),p(s,h,U)}for(let P=0;P<16;P++)o[P+16]=d[P],o[P+32]=s[P],o[P+48]=H[P],o[P+64]=h[P];const a=o.subarray(32),c=o.subarray(16);C(a,a),j(c,c,a);const D=new Uint8Array(32);return b(D,c),D}r.scalarMult=q;function B(m){return q(m,n)}r.scalarMultBase=B;function W(m){if(m.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(m);return{publicKey:B(E),secretKey:E}}r.generateKeyPairFromSeed=W;function v(m){const E=(0,e.randomBytes)(32,m),y=W(E);return(0,t.wipe)(E),y}r.generateKeyPair=v;function I(m,E,y=!1){if(m.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=q(m,E);if(y){let d=0;for(let H=0;H<o.length;H++)d|=o[H];if(d===0)throw new Error("X25519: invalid shared key")}return o}r.sharedKey=I})(Zi);var os=globalThis&&globalThis.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,l;i<n;i++)(l||!(i in e))&&(l||(l=Array.prototype.slice.call(e,0,i)),l[i]=e[i]);return r.concat(l||Array.prototype.slice.call(e))},Jh=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),Xh=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),Zh=function(){function r(e,t,i,n){this.name=e,this.version=t,this.os=i,this.bot=n,this.type="bot-device"}return r}(),Qh=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),ef=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),tf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,rf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,as=3,nf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",tf]],cs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function sf(r){return r?us(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ef:typeof navigator<"u"?us(navigator.userAgent):cf()}function of(r){return r!==""&&nf.reduce(function(e,t){var i=t[0],n=t[1];if(e)return e;var l=n.exec(r);return!!l&&[i,l]},!1)}function us(r){var e=of(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new Qh;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<as&&(n=os(os([],n,!0),uf(as-n.length),!0)):n=[];var l=n.join("."),g=af(r),p=rf.exec(r);return p&&p[1]?new Zh(t,l,g,p[1]):new Jh(t,l,g)}function af(r){for(var e=0,t=cs.length;e<t;e++){var i=cs[e],n=i[0],l=i[1],g=l.exec(r);if(g)return n}return null}function cf(){var r=typeof process<"u"&&process.version;return r?new Xh(process.version.slice(1)):null}function uf(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Vo=Ie.getLocation=Ie.getLocationOrThrow=Qi=Ie.getNavigator=Ie.getNavigatorOrThrow=Ko=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Zt(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Ie.getFromWindow=Zt;function or(r){const e=Zt(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Ie.getFromWindowOrThrow=or;function hf(){return or("document")}Ie.getDocumentOrThrow=hf;function ff(){return Zt("document")}var Ko=Ie.getDocument=ff;function lf(){return or("navigator")}Ie.getNavigatorOrThrow=lf;function df(){return Zt("navigator")}var Qi=Ie.getNavigator=df;function pf(){return or("location")}Ie.getLocationOrThrow=pf;function gf(){return Zt("location")}var Vo=Ie.getLocation=gf;function yf(){return or("crypto")}Ie.getCryptoOrThrow=yf;function _f(){return Zt("crypto")}Ie.getCrypto=_f;function bf(){return or("localStorage")}Ie.getLocalStorageOrThrow=bf;function mf(){return Zt("localStorage")}Ie.getLocalStorage=mf;var en={};Object.defineProperty(en,"__esModule",{value:!0});var Go=en.getWindowMetadata=void 0;const hs=Ie;function vf(){let r,e;try{r=hs.getDocumentOrThrow(),e=hs.getLocationOrThrow()}catch{return null}function t(){const A=r.getElementsByTagName("link"),j=[];for(let N=0;N<A.length;N++){const C=A[N],q=C.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const B=C.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(B.indexOf("/")===0)W+=B;else{const v=e.pathname.split("/");v.pop(),W+=v.join("/")+"/"+B}j.push(W)}else if(B.indexOf("//")===0){const W=e.protocol+B;j.push(W)}else j.push(B)}}return j}function i(...A){const j=r.getElementsByTagName("meta");for(let N=0;N<j.length;N++){const C=j[N],q=["itemprop","property","name"].map(B=>C.getAttribute(B)).filter(B=>B?A.includes(B):!1);if(q.length&&q){const B=C.getAttribute("content");if(B)return B}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=r.title),A}function l(){return i("description","og:description","twitter:description","keywords")}const g=n(),p=l(),b=e.origin,S=t();return{description:p,url:b,icons:S,name:g}}Go=en.getWindowMetadata=vf;var Dr={},Wo=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ko="%[a-f0-9]{2}",fs=new RegExp("("+ko+")|([^%]+?)","gi"),ls=new RegExp("("+ko+")+","gi");function Ui(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var t=r.slice(0,e),i=r.slice(e);return Array.prototype.concat.call([],Ui(t),Ui(i))}function wf(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(fs)||[],t=1;t<e.length;t++)r=Ui(e,t).join(""),e=r.match(fs)||[];return r}}function Ef(r){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},t=ls.exec(r);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var i=wf(t[0]);i!==t[0]&&(e[t[0]]=i)}t=ls.exec(r)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),l=0;l<n.length;l++){var g=n[l];r=r.replace(new RegExp(g,"g"),e[g])}return r}var Yo=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return Ef(r)}},Jo=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const t=r.indexOf(e);return t===-1?[r]:[r.slice(0,t),r.slice(t+e.length)]},Xo=function(r,e){for(var t={},i=Object.keys(r),n=Array.isArray(e),l=0;l<i.length;l++){var g=i[l],p=r[g];(n?e.indexOf(g)!==-1:e(g,p,r))&&(t[g]=p)}return t};(function(r){const e=Wo,t=Yo,i=Jo,n=Xo,l=v=>v==null,g=Symbol("encodeFragmentIdentifier");function p(v){switch(v.arrayFormat){case"index":return I=>(m,E)=>{const y=m.length;return E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),"[",y,"]"].join("")]:[...m,[x(I,v),"[",x(y,v),"]=",x(E,v)].join("")]};case"bracket":return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),"[]"].join("")]:[...m,[x(I,v),"[]=",x(E,v)].join("")];case"colon-list-separator":return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),":list="].join("")]:[...m,[x(I,v),":list=",x(E,v)].join("")];case"comma":case"separator":case"bracket-separator":{const I=v.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(E,y)=>y===void 0||v.skipNull&&y===null||v.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[x(m,v),I,x(y,v)].join("")]:[[E,x(y,v)].join(v.arrayFormatSeparator)])}default:return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,x(I,v)]:[...m,[x(I,v),"=",x(E,v)].join("")]}}function b(v){let I;switch(v.arrayFormat){case"index":return(m,E,y)=>{if(I=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!I){y[m]=E;return}y[m]===void 0&&(y[m]={}),y[m][I[1]]=E};case"bracket":return(m,E,y)=>{if(I=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!I){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"colon-list-separator":return(m,E,y)=>{if(I=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!I){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"comma":case"separator":return(m,E,y)=>{const o=typeof E=="string"&&E.includes(v.arrayFormatSeparator),d=typeof E=="string"&&!o&&A(E,v).includes(v.arrayFormatSeparator);E=d?A(E,v):E;const H=o||d?E.split(v.arrayFormatSeparator).map(s=>A(s,v)):E===null?E:A(E,v);y[m]=H};case"bracket-separator":return(m,E,y)=>{const o=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!o){y[m]=E&&A(E,v);return}const d=E===null?[]:E.split(v.arrayFormatSeparator).map(H=>A(H,v));if(y[m]===void 0){y[m]=d;return}y[m]=[].concat(y[m],d)};default:return(m,E,y)=>{if(y[m]===void 0){y[m]=E;return}y[m]=[].concat(y[m],E)}}}function S(v){if(typeof v!="string"||v.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function x(v,I){return I.encode?I.strict?e(v):encodeURIComponent(v):v}function A(v,I){return I.decode?t(v):v}function j(v){return Array.isArray(v)?v.sort():typeof v=="object"?j(Object.keys(v)).sort((I,m)=>Number(I)-Number(m)).map(I=>v[I]):v}function N(v){const I=v.indexOf("#");return I!==-1&&(v=v.slice(0,I)),v}function C(v){let I="";const m=v.indexOf("#");return m!==-1&&(I=v.slice(m)),I}function q(v){v=N(v);const I=v.indexOf("?");return I===-1?"":v.slice(I+1)}function B(v,I){return I.parseNumbers&&!Number.isNaN(Number(v))&&typeof v=="string"&&v.trim()!==""?v=Number(v):I.parseBooleans&&v!==null&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")&&(v=v.toLowerCase()==="true"),v}function W(v,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),S(I.arrayFormatSeparator);const m=b(I),E=Object.create(null);if(typeof v!="string"||(v=v.trim().replace(/^[?#&]/,""),!v))return E;for(const y of v.split("&")){if(y==="")continue;let[o,d]=i(I.decode?y.replace(/\+/g," "):y,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?d:A(d,I),m(A(o,I),d,E)}for(const y of Object.keys(E)){const o=E[y];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=B(o[d],I);else E[y]=B(o,I)}return I.sort===!1?E:(I.sort===!0?Object.keys(E).sort():Object.keys(E).sort(I.sort)).reduce((y,o)=>{const d=E[o];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?y[o]=j(d):y[o]=d,y},Object.create(null))}r.extract=q,r.parse=W,r.stringify=(v,I)=>{if(!v)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),S(I.arrayFormatSeparator);const m=d=>I.skipNull&&l(v[d])||I.skipEmptyString&&v[d]==="",E=p(I),y={};for(const d of Object.keys(v))m(d)||(y[d]=v[d]);const o=Object.keys(y);return I.sort!==!1&&o.sort(I.sort),o.map(d=>{const H=v[d];return H===void 0?"":H===null?x(d,I):Array.isArray(H)?H.length===0&&I.arrayFormat==="bracket-separator"?x(d,I)+"[]":H.reduce(E(d),[]).join("&"):x(d,I)+"="+x(H,I)}).filter(d=>d.length>0).join("&")},r.parseUrl=(v,I)=>{I=Object.assign({decode:!0},I);const[m,E]=i(v,"#");return Object.assign({url:m.split("?")[0]||"",query:W(q(v),I)},I&&I.parseFragmentIdentifier&&E?{fragmentIdentifier:A(E,I)}:{})},r.stringifyUrl=(v,I)=>{I=Object.assign({encode:!0,strict:!0,[g]:!0},I);const m=N(v.url).split("?")[0]||"",E=r.extract(v.url),y=r.parse(E,{sort:!1}),o=Object.assign(y,v.query);let d=r.stringify(o,I);d&&(d=`?${d}`);let H=C(v.url);return v.fragmentIdentifier&&(H=`#${I[g]?x(v.fragmentIdentifier,I):v.fragmentIdentifier}`),`${m}${d}${H}`},r.pick=(v,I,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[g]:!1},m);const{url:E,query:y,fragmentIdentifier:o}=r.parseUrl(v,m);return r.stringifyUrl({url:E,query:n(y,I),fragmentIdentifier:o},m)},r.exclude=(v,I,m)=>{const E=Array.isArray(I)?y=>!I.includes(y):(y,o)=>!I(y,o);return r.pick(v,E,m)}})(Dr);const Df={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function tn(r,e){return r.includes(":")?[r]:e.chains||[]}const Zo="base10",ht="base16",ji="base64pad",rn="utf8",Qo=0,Qt=1,Sf=0,ds=1,Mi=12,nn=32;function Of(){const r=Zi.generateKeyPair();return{privateKey:ft(r.secretKey,ht),publicKey:ft(r.publicKey,ht)}}function $i(){const r=sr.randomBytes(nn);return ft(r,ht)}function If(r,e){const t=Zi.sharedKey(ut(r,ht),ut(e,ht)),i=new Yh(ni.SHA256,t).expand(nn);return ft(i,ht)}function xf(r){const e=ni.hash(ut(r,ht));return ft(e,ht)}function Jr(r){const e=ni.hash(ut(r,rn));return ft(e,ht)}function Pf(r){return ut(`${r}`,Zo)}function Tr(r){return Number(ft(r,Zo))}function Tf(r){const e=Pf(typeof r.type<"u"?r.type:Qo);if(Tr(e)===Qt&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,ht):void 0,i=typeof r.iv<"u"?ut(r.iv,ht):sr.randomBytes(Mi),n=new Ji.ChaCha20Poly1305(ut(r.symKey,ht)).seal(i,ut(r.message,rn));return Nf({type:e,sealed:n,iv:i,senderPublicKey:t})}function Af(r){const e=new Ji.ChaCha20Poly1305(ut(r.symKey,ht)),{sealed:t,iv:i}=sn(r.encoded),n=e.open(i,t);if(n===null)throw new Error("Failed to decrypt");return ft(n,rn)}function Nf(r){if(Tr(r.type)===Qt){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ft(Fi([r.type,r.senderPublicKey,r.iv,r.sealed]),ji)}return ft(Fi([r.type,r.iv,r.sealed]),ji)}function sn(r){const e=ut(r,ji),t=e.slice(Sf,ds),i=ds;if(Tr(t)===Qt){const p=i+nn,b=p+Mi,S=e.slice(i,p),x=e.slice(p,b),A=e.slice(b);return{type:t,sealed:A,iv:x,senderPublicKey:S}}const n=i+Mi,l=e.slice(i,n),g=e.slice(n);return{type:t,sealed:g,iv:l}}function Cf(r,e){const t=sn(r);return ea({type:Tr(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ft(t.senderPublicKey,ht):void 0,receiverPublicKey:e?.receiverPublicKey})}function ea(r){const e=r?.type||Qo;if(e===Qt){if(typeof r?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof r?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r?.senderPublicKey,receiverPublicKey:r?.receiverPublicKey}}function ps(r){return r.type===Qt&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var Rf=Object.defineProperty,gs=Object.getOwnPropertySymbols,Ff=Object.prototype.hasOwnProperty,Lf=Object.prototype.propertyIsEnumerable,ys=(r,e,t)=>e in r?Rf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_s=(r,e)=>{for(var t in e||(e={}))Ff.call(e,t)&&ys(r,t,e[t]);if(gs)for(var t of gs(e))Lf.call(e,t)&&ys(r,t,e[t]);return r};const Uf="ReactNative",vr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},jf="js";function ta(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Mf(){return!Ko()&&!!Qi()&&navigator.product===Uf}function $f(){return!ta()&&!!Qi()}function Hf(){return Mf()?vr.reactNative:ta()?vr.node:$f()?vr.browser:vr.unknown}function Bf(r,e){let t=Dr.parse(r);return t=_s(_s({},t),e),r=Dr.stringify(t),r}function qf(){return Go()||{name:"",description:"",url:"",icons:[""]}}function zf(){const r=sf();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function Kf(){var r;const e=Hf();return e===vr.browser?[e,((r=Vo())==null?void 0:r.host)||"unknown"].join(":"):e}function Vf(r,e,t){const i=zf(),n=Kf();return[[r,e].join("-"),[jf,t].join("-"),i,n].join("/")}function Gf({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:n,projectId:l}){const g=t.split("?"),p=Vf(r,e,i),b={auth:n,ua:p,projectId:l},S=Bf(g[1]||"",b);return g[0]+"?"+S}function jt(r,e){return r.filter(t=>e.includes(t)).length===r.length}function ra(r){return Object.fromEntries(r.entries())}function ia(r){return new Map(Object.entries(r))}function Jt(r){const e=te.toMiliseconds(r||te.FIVE_MINUTES);let t,i,n;return{resolve:l=>{n&&t&&(clearTimeout(n),t(l))},reject:l=>{n&&i&&(clearTimeout(n),i(l))},done:()=>new Promise((l,g)=>{n=setTimeout(g,e),t=l,i=g})}}function na(r,e){return new Promise(async(t,i)=>{const n=setTimeout(()=>i(),e),l=await r;clearTimeout(n),t(l)})}function sa(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function Wf(r){return sa("topic",r)}function kf(r){return sa("id",r)}function oa(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function It(r,e){return te.fromMiliseconds((e||Date.now())+te.toMiliseconds(r))}function Ut(r){return Date.now()>=te.toMiliseconds(r)}function je(r,e){return`${r}${e?`:${e}`:""}`}const Yf="irn";function Hi(r){return r?.relay||{protocol:Yf}}function Bi(r){const e=Df[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var Jf=Object.defineProperty,bs=Object.getOwnPropertySymbols,Xf=Object.prototype.hasOwnProperty,Zf=Object.prototype.propertyIsEnumerable,ms=(r,e,t)=>e in r?Jf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qf=(r,e)=>{for(var t in e||(e={}))Xf.call(e,t)&&ms(r,t,e[t]);if(bs)for(var t of bs(e))Zf.call(e,t)&&ms(r,t,e[t]);return r};function el(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(n=>{if(n.startsWith(i)){const l=n.replace(i,""),g=r[n];t[l]=g}}),t}function tl(r){const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),n=r.substring(e+1,t).split("@"),l=typeof t<"u"?r.substring(t):"",g=Dr.parse(l);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:g.symKey,relay:el(g)}}function rl(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(n=>{const l=t+e+n;r[n]&&(i[l]=r[n])}),i}function il(r){return`${r.protocol}:${r.topic}@${r.version}?`+Dr.stringify(Qf({symKey:r.symKey},rl(r.relay)))}function Ar(r){const e=[];return r.forEach(t=>{const[i,n]=t.split(":");e.push(`${i}:${n}`)}),e}function nl(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Ar(t.accounts))}),e}function sl(r,e){const t=[];return Object.values(r).forEach(i=>{Ar(i.accounts).includes(e)&&t.push(...i.methods)}),t}function ol(r,e){const t=[];return Object.values(r).forEach(i=>{Ar(i.accounts).includes(e)&&t.push(...i.events)}),t}function al(r,e){const t=Gr(r,e);if(t)throw new Error(t.message);const i={};for(const[n,l]of Object.entries(r))i[n]={methods:l.methods,events:l.events,chains:l.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return i}const cl={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ul={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(r,e){const{message:t,code:i}=ul[r];return{message:e?`${t} ${e}`:t,code:i}}function Ze(r,e){const{message:t,code:i}=cl[r];return{message:e?`${t} ${e}`:t,code:i}}function si(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function wr(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function at(r){return typeof r>"u"}function Qe(r,e){return e&&at(r)?!0:typeof r=="string"&&Boolean(r.trim().length)}function on(r,e){return e&&at(r)?!0:typeof r=="number"&&!isNaN(r)}function hl(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),n=Object.keys(t);let l=!0;return jt(n,i)?(i.forEach(g=>{const{accounts:p,methods:b,events:S}=r.namespaces[g],x=Ar(p),A=t[g];(!jt(tn(g,A),x)||!jt(A.methods,b)||!jt(A.events,S))&&(l=!1)}),l):!1}function an(r){return Qe(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function fl(r){if(Qe(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&an(t)}}return!1}function ll(r){if(Qe(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function dl(r){var e;return(e=r?.proposer)==null?void 0:e.publicKey}function pl(r){return r?.topic}function gl(r,e){let t=null;return Qe(r?.publicKey,!1)||(t=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function vs(r){let e=!0;return si(r)?r.length&&(e=r.every(t=>Qe(t,!1))):e=!1,e}function yl(r,e,t){let i=null;return si(e)?e.forEach(n=>{i||(!an(n)||!n.includes(r))&&(i=Ze("UNSUPPORTED_CHAINS",`${t}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=Ze("UNSUPPORTED_CHAINS",`${t}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function _l(r,e){let t=null;return Object.entries(r).forEach(([i,n])=>{if(t)return;const l=yl(i,tn(i,n),`${e} requiredNamespace`);l&&(t=l)}),t}function bl(r,e){let t=null;return si(r)?r.forEach(i=>{t||fl(i)||(t=Ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=Ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function ml(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=bl(i?.accounts,`${e} namespace`);n&&(t=n)}),t}function vl(r,e){let t=null;return vs(r?.methods)?vs(r?.events)||(t=Ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function aa(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const n=vl(i,`${e}, namespace`);n&&(t=n)}),t}function wl(r,e,t){let i=null;if(r&&wr(r)){const n=aa(r,e);n&&(i=n);const l=_l(r,e);l&&(i=l)}else i=J("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function Gr(r,e){let t=null;if(r&&wr(r)){const i=aa(r,e);i&&(t=i);const n=ml(r,e);n&&(t=n)}else t=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function ca(r){return Qe(r.protocol,!0)}function El(r,e){let t=!1;return e&&!r?t=!0:r&&si(r)&&r.length&&r.forEach(i=>{t=ca(i)}),t}function Dl(r){return typeof r=="number"}function ct(r){return typeof r<"u"&&typeof r!==null}function Sl(r){return!(!r||typeof r!="object"||!r.code||!on(r.code,!1)||!r.message||!Qe(r.message,!1))}function Ol(r){return!(at(r)||!Qe(r.method,!1))}function Il(r){return!(at(r)||at(r.result)&&at(r.error)||!on(r.id,!1)||!Qe(r.jsonrpc,!1))}function xl(r){return!(at(r)||!Qe(r.name,!1))}function ws(r,e){return!(!an(e)||!nl(r).includes(e))}function Pl(r,e,t){return Qe(t,!1)?sl(r,e).includes(t):!1}function Tl(r,e,t){return Qe(t,!1)?ol(r,e).includes(t):!1}function Di(r,e,t,i){let n=null;const l=Object.keys(r),g=Object.keys(e);return jt(l,g)?l.forEach(p=>{if(n)return;const b=Ar(e[p].accounts);jt(tn(p,r[p]),b)?jt(r[p].methods,e[p].methods)?jt(r[p].events,e[p].events)||(n=J("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${p}`)):n=J("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${p}`):n=J("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace chains for ${p}`)}):n=J("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy ${i}`),n}function Al(r,e){return on(r,!1)&&r<=e.max&&r>=e.min}const Nl="PARSE_ERROR",Cl="INVALID_REQUEST",Rl="METHOD_NOT_FOUND",Fl="INVALID_PARAMS",ua="INTERNAL_ERROR",cn="SERVER_ERROR",Ll=[-32700,-32600,-32601,-32602,-32603],Er={[Nl]:{code:-32700,message:"Parse error"},[Cl]:{code:-32600,message:"Invalid Request"},[Rl]:{code:-32601,message:"Method not found"},[Fl]:{code:-32602,message:"Invalid params"},[ua]:{code:-32603,message:"Internal error"},[cn]:{code:-32e3,message:"Server error"}},ha=cn;function Ul(r){return Ll.includes(r)}function Es(r){return Object.keys(Er).includes(r)?Er[r]:Er[ha]}function jl(r){const e=Object.values(Er).find(t=>t.code===r);return e||Er[ha]}function fa(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var la={},da={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,n,l,g,p,b,S,x,A,j,N,C,q,B,W,v,I,m,E,y,o;(function(d){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(s(H,s(r.exports)));function s(h,f){return h!==H&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(_,a){return h[_]=f?f(_,a):a}}})(function(d){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,h){s.__proto__=h}||function(s,h){for(var f in h)h.hasOwnProperty(f)&&(s[f]=h[f])};e=function(s,h){H(s,h);function f(){this.constructor=s}s.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)},t=Object.assign||function(s){for(var h,f=1,_=arguments.length;f<_;f++){h=arguments[f];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(s[a]=h[a])}return s},i=function(s,h){var f={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&h.indexOf(_)<0&&(f[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,_=Object.getOwnPropertySymbols(s);a<_.length;a++)h.indexOf(_[a])<0&&Object.prototype.propertyIsEnumerable.call(s,_[a])&&(f[_[a]]=s[_[a]]);return f},n=function(s,h,f,_){var a=arguments.length,c=a<3?h:_===null?_=Object.getOwnPropertyDescriptor(h,f):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,h,f,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(c=(a<3?D(c):a>3?D(h,f,c):D(h,f))||c);return a>3&&c&&Object.defineProperty(h,f,c),c},l=function(s,h){return function(f,_){h(f,_,s)}},g=function(s,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,h)},p=function(s,h,f,_){function a(c){return c instanceof f?c:new f(function(D){D(c)})}return new(f||(f=Promise))(function(c,D){function P(R){try{w(_.next(R))}catch(K){D(K)}}function U(R){try{w(_.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(P,U)}w((_=_.apply(s,h||[])).next())})},b=function(s,h){var f={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,a,c,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(w){return function(R){return U([w,R])}}function U(w){if(_)throw new TypeError("Generator is already executing.");for(;f;)try{if(_=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,a=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(c=f.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){f.label=w[1];break}if(w[0]===6&&f.label<c[1]){f.label=c[1],c=w;break}if(c&&f.label<c[2]){f.label=c[2],f.ops.push(w);break}c[2]&&f.ops.pop(),f.trys.pop();continue}w=h.call(s,f)}catch(R){w=[6,R],a=0}finally{_=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},o=function(s,h,f,_){_===void 0&&(_=f),s[_]=h[f]},S=function(s,h){for(var f in s)f!=="default"&&!h.hasOwnProperty(f)&&(h[f]=s[f])},x=function(s){var h=typeof Symbol=="function"&&Symbol.iterator,f=h&&s[h],_=0;if(f)return f.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,h){var f=typeof Symbol=="function"&&s[Symbol.iterator];if(!f)return s;var _=f.call(s),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=_.next()).done;)c.push(a.value)}catch(P){D={error:P}}finally{try{a&&!a.done&&(f=_.return)&&f.call(_)}finally{if(D)throw D.error}}return c},j=function(){for(var s=[],h=0;h<arguments.length;h++)s=s.concat(A(arguments[h]));return s},N=function(){for(var s=0,h=0,f=arguments.length;h<f;h++)s+=arguments[h].length;for(var _=Array(s),a=0,h=0;h<f;h++)for(var c=arguments[h],D=0,P=c.length;D<P;D++,a++)_[a]=c[D];return _},C=function(s){return this instanceof C?(this.v=s,this):new C(s)},q=function(s,h,f){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=f.apply(s,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){_[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||P(z,V)})})}function P(z,V){try{U(_[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof C?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){P("next",z)}function R(z){P("throw",z)}function K(z,V){z(V),c.shift(),c.length&&P(c[0][0],c[0][1])}},B=function(s){var h,f;return h={},_("next"),_("throw",function(a){throw a}),_("return"),h[Symbol.iterator]=function(){return this},h;function _(a,c){h[a]=s[a]?function(D){return(f=!f)?{value:C(s[a](D)),done:a==="return"}:c?c(D):D}:c}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=s[Symbol.asyncIterator],f;return h?h.call(s):(s=typeof x=="function"?x(s):s[Symbol.iterator](),f={},_("next"),_("throw"),_("return"),f[Symbol.asyncIterator]=function(){return this},f);function _(c){f[c]=s[c]&&function(D){return new Promise(function(P,U){D=s[c](D),a(P,U,D.done,D.value)})}}function a(c,D,P,U){Promise.resolve(U).then(function(w){c({value:w,done:P})},D)}},v=function(s,h){return Object.defineProperty?Object.defineProperty(s,"raw",{value:h}):s.raw=h,s},I=function(s){if(s&&s.__esModule)return s;var h={};if(s!=null)for(var f in s)Object.hasOwnProperty.call(s,f)&&(h[f]=s[f]);return h.default=s,h},m=function(s){return s&&s.__esModule?s:{default:s}},E=function(s,h){if(!h.has(s))throw new TypeError("attempted to get private field on non-instance");return h.get(s)},y=function(s,h,f){if(!h.has(s))throw new TypeError("attempted to set private field on non-instance");return h.set(s,f),f},d("__extends",e),d("__assign",t),d("__rest",i),d("__decorate",n),d("__param",l),d("__metadata",g),d("__awaiter",p),d("__generator",b),d("__exportStar",S),d("__createBinding",o),d("__values",x),d("__read",A),d("__spread",j),d("__spreadArrays",N),d("__await",C),d("__asyncGenerator",q),d("__asyncDelegator",B),d("__asyncValues",W),d("__makeTemplateObject",v),d("__importStar",I),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(da);var Tt={},Ds;function Ml(){if(Ds)return Tt;Ds=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.isBrowserCryptoAvailable=Tt.getSubtleCrypto=Tt.getBrowerCrypto=void 0;function r(){return(Ae===null||Ae===void 0?void 0:Ae.crypto)||(Ae===null||Ae===void 0?void 0:Ae.msCrypto)||{}}Tt.getBrowerCrypto=r;function e(){const i=r();return i.subtle||i.webkitSubtle}Tt.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return Tt.isBrowserCryptoAvailable=t,Tt}var At={},Ss;function $l(){if(Ss)return At;Ss=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowser=At.isNode=At.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}At.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}At.isNode=e;function t(){return!r()&&!e()}return At.isBrowser=t,At}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=da.exports;e.__exportStar(Ml(),r),e.__exportStar($l(),r)})(la);function Hl(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function oi(r,e,t){return{id:t||Hl(),jsonrpc:"2.0",method:r,params:e}}function un(r,e){return{id:r,jsonrpc:"2.0",result:e}}function ai(r,e,t){return{id:r,jsonrpc:"2.0",error:Bl(e,t)}}function Bl(r,e){return typeof r>"u"?Es(ua):(typeof r=="string"&&(r=Object.assign(Object.assign({},Es(cn)),{message:r})),typeof e<"u"&&(r.data=e),Ul(r.code)&&(r=jl(r.code)),r)}class ql{}class zl extends ql{constructor(){super()}}class Kl extends zl{constructor(e){super()}}const Vl="^https?:",Gl="^wss?:";function Wl(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function pa(r,e){const t=Wl(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Os(r){return pa(r,Vl)}function Is(r){return pa(r,Gl)}function kl(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function ga(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function hn(r){return ga(r)&&"method"in r}function fn(r){return ga(r)&&(Nt(r)||wt(r))}function Nt(r){return"result"in r}function wt(r){return"error"in r}class Nr extends Kl{constructor(e){super(e),this.events=new st.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(oi(e.method,e.params||[]),t)}async requestStrict(e,t){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(l){n(l)}this.events.on(`${e.id}`,l=>{wt(l)?n(l.error):i(l.result)});try{await this.connection.send(e,t)}catch(l){n(l)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),fn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}function Yl(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function Jl(r){return typeof r=="string"?r:JSON.stringify(r)}const xs=10,Xl=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Zl=()=>typeof window<"u",Ql=Xl();class ed{constructor(e){if(this.url=e,this.events=new st.exports.EventEmitter,this.registering=!1,!Is(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Jl(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Is(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),n(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const n=la.isReactNative()?void 0:{rejectUnauthorized:!kl(e)},l=new Ql(e,[],n);Zl()?l.onerror=g=>{const p=g;i(this.emitError(p.error))}:l.on("error",g=>{i(this.emitError(g))}),l.onopen=()=>{this.onOpen(l),t(l)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Yl(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),l=ai(e,n);this.events.emit("payload",l)}parseError(e,t=this.url){return fa(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>xs&&this.events.setMaxListeners(xs)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}var qi={exports:{}};(function(r,e){var t=200,i="__lodash_hash_undefined__",n=1,l=2,g=9007199254740991,p="[object Arguments]",b="[object Array]",S="[object AsyncFunction]",x="[object Boolean]",A="[object Date]",j="[object Error]",N="[object Function]",C="[object GeneratorFunction]",q="[object Map]",B="[object Number]",W="[object Null]",v="[object Object]",I="[object Promise]",m="[object Proxy]",E="[object RegExp]",y="[object Set]",o="[object String]",d="[object Symbol]",H="[object Undefined]",s="[object WeakMap]",h="[object ArrayBuffer]",f="[object DataView]",_="[object Float32Array]",a="[object Float64Array]",c="[object Int8Array]",D="[object Int16Array]",P="[object Int32Array]",U="[object Uint8Array]",w="[object Uint8ClampedArray]",R="[object Uint16Array]",K="[object Uint32Array]",z=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,Y={};Y[_]=Y[a]=Y[c]=Y[D]=Y[P]=Y[U]=Y[w]=Y[R]=Y[K]=!0,Y[p]=Y[b]=Y[h]=Y[x]=Y[f]=Y[A]=Y[j]=Y[N]=Y[q]=Y[B]=Y[v]=Y[E]=Y[y]=Y[o]=Y[s]=!1;var ee=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,$=typeof self=="object"&&self&&self.Object===Object&&self,M=ee||$||Function("return this")(),F=e&&!e.nodeType&&e,u=F&&!0&&r&&!r.nodeType&&r,T=u&&u.exports===F,k=T&&ee.process,Z=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),fe=Z&&Z.isTypedArray;function _e(O,L){for(var G=-1,Q=O==null?0:O.length,Pe=0,se=[];++G<Q;){var Le=O[G];L(Le,G,O)&&(se[Pe++]=Le)}return se}function de(O,L){for(var G=-1,Q=L.length,Pe=O.length;++G<Q;)O[Pe+G]=L[G];return O}function ve(O,L){for(var G=-1,Q=O==null?0:O.length;++G<Q;)if(L(O[G],G,O))return!0;return!1}function Ue(O,L){for(var G=-1,Q=Array(O);++G<O;)Q[G]=L(G);return Q}function Ce(O){return function(L){return O(L)}}function ye(O,L){return O.has(L)}function pe(O,L){return O?.[L]}function le(O){var L=-1,G=Array(O.size);return O.forEach(function(Q,Pe){G[++L]=[Pe,Q]}),G}function ue(O,L){return function(G){return O(L(G))}}function ce(O){var L=-1,G=Array(O.size);return O.forEach(function(Q){G[++L]=Q}),G}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,he=M["__core-js_shared__"],ge=oe.toString,ie=re.hasOwnProperty,be=function(){var O=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),me=re.toString,Ee=RegExp("^"+ge.call(ie).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=T?M.Buffer:void 0,we=M.Symbol,mt=M.Uint8Array,Et=re.propertyIsEnumerable,Ct=ae.splice,lt=we?we.toStringTag:void 0,qt=Object.getOwnPropertySymbols,cr=De?De.isBuffer:void 0,Fr=ue(Object.keys,Object),Me=tr(M,"DataView"),Re=tr(M,"Map"),$e=tr(M,"Promise"),He=tr(M,"Set"),Be=tr(M,"WeakMap"),Fe=tr(Object,"create"),Ke=Kt(Me),Ve=Kt(Re),Ge=Kt($e),We=Kt(He),ke=Kt(Be),ze=we?we.prototype:void 0,qe=ze?ze.valueOf:void 0;function Te(O){var L=-1,G=O==null?0:O.length;for(this.clear();++L<G;){var Q=O[L];this.set(Q[0],Q[1])}}function Ye(){this.__data__=Fe?Fe(null):{},this.size=0}function Je(O){var L=this.has(O)&&delete this.__data__[O];return this.size-=L?1:0,L}function Ca(O){var L=this.__data__;if(Fe){var G=L[O];return G===i?void 0:G}return ie.call(L,O)?L[O]:void 0}function Ra(O){var L=this.__data__;return Fe?L[O]!==void 0:ie.call(L,O)}function Fa(O,L){var G=this.__data__;return this.size+=this.has(O)?0:1,G[O]=Fe&&L===void 0?i:L,this}Te.prototype.clear=Ye,Te.prototype.delete=Je,Te.prototype.get=Ca,Te.prototype.has=Ra,Te.prototype.set=Fa;function xt(O){var L=-1,G=O==null?0:O.length;for(this.clear();++L<G;){var Q=O[L];this.set(Q[0],Q[1])}}function La(){this.__data__=[],this.size=0}function Ua(O){var L=this.__data__,G=Ur(L,O);if(G<0)return!1;var Q=L.length-1;return G==Q?L.pop():Ct.call(L,G,1),--this.size,!0}function ja(O){var L=this.__data__,G=Ur(L,O);return G<0?void 0:L[G][1]}function Ma(O){return Ur(this.__data__,O)>-1}function $a(O,L){var G=this.__data__,Q=Ur(G,O);return Q<0?(++this.size,G.push([O,L])):G[Q][1]=L,this}xt.prototype.clear=La,xt.prototype.delete=Ua,xt.prototype.get=ja,xt.prototype.has=Ma,xt.prototype.set=$a;function zt(O){var L=-1,G=O==null?0:O.length;for(this.clear();++L<G;){var Q=O[L];this.set(Q[0],Q[1])}}function Ha(){this.size=0,this.__data__={hash:new Te,map:new(Re||xt),string:new Te}}function Ba(O){var L=jr(this,O).delete(O);return this.size-=L?1:0,L}function qa(O){return jr(this,O).get(O)}function za(O){return jr(this,O).has(O)}function Ka(O,L){var G=jr(this,O),Q=G.size;return G.set(O,L),this.size+=G.size==Q?0:1,this}zt.prototype.clear=Ha,zt.prototype.delete=Ba,zt.prototype.get=qa,zt.prototype.has=za,zt.prototype.set=Ka;function Lr(O){var L=-1,G=O==null?0:O.length;for(this.__data__=new zt;++L<G;)this.add(O[L])}function Va(O){return this.__data__.set(O,i),this}function Ga(O){return this.__data__.has(O)}Lr.prototype.add=Lr.prototype.push=Va,Lr.prototype.has=Ga;function Rt(O){var L=this.__data__=new xt(O);this.size=L.size}function Wa(){this.__data__=new xt,this.size=0}function ka(O){var L=this.__data__,G=L.delete(O);return this.size=L.size,G}function Ya(O){return this.__data__.get(O)}function Ja(O){return this.__data__.has(O)}function Xa(O,L){var G=this.__data__;if(G instanceof xt){var Q=G.__data__;if(!Re||Q.length<t-1)return Q.push([O,L]),this.size=++G.size,this;G=this.__data__=new zt(Q)}return G.set(O,L),this.size=G.size,this}Rt.prototype.clear=Wa,Rt.prototype.delete=ka,Rt.prototype.get=Ya,Rt.prototype.has=Ja,Rt.prototype.set=Xa;function Za(O,L){var G=Mr(O),Q=!G&&dc(O),Pe=!G&&!Q&&li(O),se=!G&&!Q&&!Pe&&In(O),Le=G||Q||Pe||se,Xe=Le?Ue(O.length,String):[],et=Xe.length;for(var Ne in O)(L||ie.call(O,Ne))&&!(Le&&(Ne=="length"||Pe&&(Ne=="offset"||Ne=="parent")||se&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||cc(Ne,et)))&&Xe.push(Ne);return Xe}function Ur(O,L){for(var G=O.length;G--;)if(En(O[G][0],L))return G;return-1}function Qa(O,L,G){var Q=L(O);return Mr(O)?Q:de(Q,G(O))}function ur(O){return O==null?O===void 0?H:W:lt&&lt in Object(O)?oc(O):lc(O)}function bn(O){return hr(O)&&ur(O)==p}function mn(O,L,G,Q,Pe){return O===L?!0:O==null||L==null||!hr(O)&&!hr(L)?O!==O&&L!==L:ec(O,L,G,Q,mn,Pe)}function ec(O,L,G,Q,Pe,se){var Le=Mr(O),Xe=Mr(L),et=Le?b:Ft(O),Ne=Xe?b:Ft(L);et=et==p?v:et,Ne=Ne==p?v:Ne;var dt=et==v,vt=Ne==v,it=et==Ne;if(it&&li(O)){if(!li(L))return!1;Le=!0,dt=!1}if(it&&!dt)return se||(se=new Rt),Le||In(O)?vn(O,L,G,Q,Pe,se):nc(O,L,et,G,Q,Pe,se);if(!(G&n)){var gt=dt&&ie.call(O,"__wrapped__"),yt=vt&&ie.call(L,"__wrapped__");if(gt||yt){var Lt=gt?O.value():O,Pt=yt?L.value():L;return se||(se=new Rt),Pe(Lt,Pt,G,Q,se)}}return it?(se||(se=new Rt),sc(O,L,G,Q,Pe,se)):!1}function tc(O){if(!On(O)||hc(O))return!1;var L=Dn(O)?Ee:V;return L.test(Kt(O))}function rc(O){return hr(O)&&Sn(O.length)&&!!Y[ur(O)]}function ic(O){if(!fc(O))return Fr(O);var L=[];for(var G in Object(O))ie.call(O,G)&&G!="constructor"&&L.push(G);return L}function vn(O,L,G,Q,Pe,se){var Le=G&n,Xe=O.length,et=L.length;if(Xe!=et&&!(Le&&et>Xe))return!1;var Ne=se.get(O);if(Ne&&se.get(L))return Ne==L;var dt=-1,vt=!0,it=G&l?new Lr:void 0;for(se.set(O,L),se.set(L,O);++dt<Xe;){var gt=O[dt],yt=L[dt];if(Q)var Lt=Le?Q(yt,gt,dt,L,O,se):Q(gt,yt,dt,O,L,se);if(Lt!==void 0){if(Lt)continue;vt=!1;break}if(it){if(!ve(L,function(Pt,Vt){if(!ye(it,Vt)&&(gt===Pt||Pe(gt,Pt,G,Q,se)))return it.push(Vt)})){vt=!1;break}}else if(!(gt===yt||Pe(gt,yt,G,Q,se))){vt=!1;break}}return se.delete(O),se.delete(L),vt}function nc(O,L,G,Q,Pe,se,Le){switch(G){case f:if(O.byteLength!=L.byteLength||O.byteOffset!=L.byteOffset)return!1;O=O.buffer,L=L.buffer;case h:return!(O.byteLength!=L.byteLength||!se(new mt(O),new mt(L)));case x:case A:case B:return En(+O,+L);case j:return O.name==L.name&&O.message==L.message;case E:case o:return O==L+"";case q:var Xe=le;case y:var et=Q&n;if(Xe||(Xe=ce),O.size!=L.size&&!et)return!1;var Ne=Le.get(O);if(Ne)return Ne==L;Q|=l,Le.set(O,L);var dt=vn(Xe(O),Xe(L),Q,Pe,se,Le);return Le.delete(O),dt;case d:if(qe)return qe.call(O)==qe.call(L)}return!1}function sc(O,L,G,Q,Pe,se){var Le=G&n,Xe=wn(O),et=Xe.length,Ne=wn(L),dt=Ne.length;if(et!=dt&&!Le)return!1;for(var vt=et;vt--;){var it=Xe[vt];if(!(Le?it in L:ie.call(L,it)))return!1}var gt=se.get(O);if(gt&&se.get(L))return gt==L;var yt=!0;se.set(O,L),se.set(L,O);for(var Lt=Le;++vt<et;){it=Xe[vt];var Pt=O[it],Vt=L[it];if(Q)var xn=Le?Q(Vt,Pt,it,L,O,se):Q(Pt,Vt,it,O,L,se);if(!(xn===void 0?Pt===Vt||Pe(Pt,Vt,G,Q,se):xn)){yt=!1;break}Lt||(Lt=it=="constructor")}if(yt&&!Lt){var $r=O.constructor,Hr=L.constructor;$r!=Hr&&"constructor"in O&&"constructor"in L&&!(typeof $r=="function"&&$r instanceof $r&&typeof Hr=="function"&&Hr instanceof Hr)&&(yt=!1)}return se.delete(O),se.delete(L),yt}function wn(O){return Qa(O,yc,ac)}function jr(O,L){var G=O.__data__;return uc(L)?G[typeof L=="string"?"string":"hash"]:G.map}function tr(O,L){var G=pe(O,L);return tc(G)?G:void 0}function oc(O){var L=ie.call(O,lt),G=O[lt];try{O[lt]=void 0;var Q=!0}catch{}var Pe=me.call(O);return Q&&(L?O[lt]=G:delete O[lt]),Pe}var ac=qt?function(O){return O==null?[]:(O=Object(O),_e(qt(O),function(L){return Et.call(O,L)}))}:_c,Ft=ur;(Me&&Ft(new Me(new ArrayBuffer(1)))!=f||Re&&Ft(new Re)!=q||$e&&Ft($e.resolve())!=I||He&&Ft(new He)!=y||Be&&Ft(new Be)!=s)&&(Ft=function(O){var L=ur(O),G=L==v?O.constructor:void 0,Q=G?Kt(G):"";if(Q)switch(Q){case Ke:return f;case Ve:return q;case Ge:return I;case We:return y;case ke:return s}return L});function cc(O,L){return L=L??g,!!L&&(typeof O=="number"||X.test(O))&&O>-1&&O%1==0&&O<L}function uc(O){var L=typeof O;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?O!=="__proto__":O===null}function hc(O){return!!be&&be in O}function fc(O){var L=O&&O.constructor,G=typeof L=="function"&&L.prototype||re;return O===G}function lc(O){return me.call(O)}function Kt(O){if(O!=null){try{return ge.call(O)}catch{}try{return O+""}catch{}}return""}function En(O,L){return O===L||O!==O&&L!==L}var dc=bn(function(){return arguments}())?bn:function(O){return hr(O)&&ie.call(O,"callee")&&!Et.call(O,"callee")},Mr=Array.isArray;function pc(O){return O!=null&&Sn(O.length)&&!Dn(O)}var li=cr||bc;function gc(O,L){return mn(O,L)}function Dn(O){if(!On(O))return!1;var L=ur(O);return L==N||L==C||L==S||L==m}function Sn(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=g}function On(O){var L=typeof O;return O!=null&&(L=="object"||L=="function")}function hr(O){return O!=null&&typeof O=="object"}var In=fe?Ce(fe):rc;function yc(O){return pc(O)?Za(O):ic(O)}function _c(){return[]}function bc(){return!1}r.exports=gc})(qi,qi.exports);const td=qi.exports;function rd(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var l=r.charAt(n),g=l.charCodeAt(0);if(t[g]!==255)throw new TypeError(l+" is ambiguous");t[g]=n}var p=r.length,b=r.charAt(0),S=Math.log(p)/Math.log(256),x=Math.log(256)/Math.log(p);function A(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var q=0,B=0,W=0,v=C.length;W!==v&&C[W]===0;)W++,q++;for(var I=(v-W)*x+1>>>0,m=new Uint8Array(I);W!==v;){for(var E=C[W],y=0,o=I-1;(E!==0||y<B)&&o!==-1;o--,y++)E+=256*m[o]>>>0,m[o]=E%p>>>0,E=E/p>>>0;if(E!==0)throw new Error("Non-zero carry");B=y,W++}for(var d=I-B;d!==I&&m[d]===0;)d++;for(var H=b.repeat(q);d<I;++d)H+=r.charAt(m[d]);return H}function j(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var q=0;if(C[q]!==" "){for(var B=0,W=0;C[q]===b;)B++,q++;for(var v=(C.length-q)*S+1>>>0,I=new Uint8Array(v);C[q];){var m=t[C.charCodeAt(q)];if(m===255)return;for(var E=0,y=v-1;(m!==0||E<W)&&y!==-1;y--,E++)m+=p*I[y]>>>0,I[y]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");W=E,q++}if(C[q]!==" "){for(var o=v-W;o!==v&&I[o]===0;)o++;for(var d=new Uint8Array(B+(v-o)),H=B;o!==v;)d[H++]=I[o++];return d}}}function N(C){var q=j(C);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:A,decodeUnsafe:j,decode:N}}var id=rd,nd=id;const ya=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},sd=r=>new TextEncoder().encode(r),od=r=>new TextDecoder().decode(r);class ad{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class cd{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _a(this,e)}}class ud{constructor(e){this.decoders=e}or(e){return _a(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _a=(r,e)=>new ud({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class hd{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new ad(e,t,i),this.decoder=new cd(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ci=({name:r,prefix:e,encode:t,decode:i})=>new hd(r,e,t,i),Cr=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:n}=nd(t,e);return ci({prefix:r,name:e,encode:i,decode:l=>ya(n(l))})},fd=(r,e,t,i)=>{const n={};for(let x=0;x<e.length;++x)n[e[x]]=x;let l=r.length;for(;r[l-1]==="=";)--l;const g=new Uint8Array(l*t/8|0);let p=0,b=0,S=0;for(let x=0;x<l;++x){const A=n[r[x]];if(A===void 0)throw new SyntaxError(`Non-${i} character`);b=b<<t|A,p+=t,p>=8&&(p-=8,g[S++]=255&b>>p)}if(p>=t||255&b<<8-p)throw new SyntaxError("Unexpected end of data");return g},ld=(r,e,t)=>{const i=e[e.length-1]==="=",n=(1<<t)-1;let l="",g=0,p=0;for(let b=0;b<r.length;++b)for(p=p<<8|r[b],g+=8;g>t;)g-=t,l+=e[n&p>>g];if(g&&(l+=e[n&p<<t-g]),i)for(;l.length*t&7;)l+="=";return l},rt=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>ci({prefix:e,name:r,encode(n){return ld(n,i,t)},decode(n){return fd(n,i,t,r)}}),dd=ci({prefix:"\0",name:"identity",encode:r=>od(r),decode:r=>sd(r)});var pd=Object.freeze({__proto__:null,identity:dd});const gd=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yd=Object.freeze({__proto__:null,base2:gd});const _d=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bd=Object.freeze({__proto__:null,base8:_d});const md=Cr({prefix:"9",name:"base10",alphabet:"0123456789"});var vd=Object.freeze({__proto__:null,base10:md});const wd=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ed=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Dd=Object.freeze({__proto__:null,base16:wd,base16upper:Ed});const Sd=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Od=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Id=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),xd=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pd=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Td=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ad=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nd=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cd=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Rd=Object.freeze({__proto__:null,base32:Sd,base32upper:Od,base32pad:Id,base32padupper:xd,base32hex:Pd,base32hexupper:Td,base32hexpad:Ad,base32hexpadupper:Nd,base32z:Cd});const Fd=Cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ld=Cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ud=Object.freeze({__proto__:null,base36:Fd,base36upper:Ld});const jd=Cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Md=Cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var $d=Object.freeze({__proto__:null,base58btc:jd,base58flickr:Md});const Hd=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bd=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qd=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zd=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Kd=Object.freeze({__proto__:null,base64:Hd,base64pad:Bd,base64url:qd,base64urlpad:zd});const ba=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Vd=ba.reduce((r,e,t)=>(r[t]=e,r),[]),Gd=ba.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Wd(r){return r.reduce((e,t)=>(e+=Vd[t],e),"")}function kd(r){const e=[];for(const t of r){const i=Gd[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const Yd=ci({prefix:"\u{1F680}",name:"base256emoji",encode:Wd,decode:kd});var Jd=Object.freeze({__proto__:null,base256emoji:Yd}),Xd=ma,Ps=128,Zd=127,Qd=~Zd,ep=Math.pow(2,31);function ma(r,e,t){e=e||[],t=t||0;for(var i=t;r>=ep;)e[t++]=r&255|Ps,r/=128;for(;r&Qd;)e[t++]=r&255|Ps,r>>>=7;return e[t]=r|0,ma.bytes=t-i+1,e}var tp=zi,rp=128,Ts=127;function zi(r,i){var t=0,i=i||0,n=0,l=i,g,p=r.length;do{if(l>=p)throw zi.bytes=0,new RangeError("Could not decode varint");g=r[l++],t+=n<28?(g&Ts)<<n:(g&Ts)*Math.pow(2,n),n+=7}while(g>=rp);return zi.bytes=l-i,t}var ip=Math.pow(2,7),np=Math.pow(2,14),sp=Math.pow(2,21),op=Math.pow(2,28),ap=Math.pow(2,35),cp=Math.pow(2,42),up=Math.pow(2,49),hp=Math.pow(2,56),fp=Math.pow(2,63),lp=function(r){return r<ip?1:r<np?2:r<sp?3:r<op?4:r<ap?5:r<cp?6:r<up?7:r<hp?8:r<fp?9:10},dp={encode:Xd,decode:tp,encodingLength:lp},va=dp;const As=(r,e,t=0)=>(va.encode(r,e,t),e),Ns=r=>va.encodingLength(r),Ki=(r,e)=>{const t=e.byteLength,i=Ns(r),n=i+Ns(t),l=new Uint8Array(n+t);return As(r,l,0),As(t,l,i),l.set(e,n),new pp(r,t,e,l)};class pp{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}const wa=({name:r,code:e,encode:t})=>new gp(r,e,t);class gp{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ki(this.code,t):t.then(i=>Ki(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ea=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),yp=wa({name:"sha2-256",code:18,encode:Ea("SHA-256")}),_p=wa({name:"sha2-512",code:19,encode:Ea("SHA-512")});var bp=Object.freeze({__proto__:null,sha256:yp,sha512:_p});const Da=0,mp="identity",Sa=ya,vp=r=>Ki(Da,Sa(r)),wp={code:Da,name:mp,encode:Sa,digest:vp};var Ep=Object.freeze({__proto__:null,identity:wp});new TextEncoder,new TextDecoder;const Cs={...pd,...yd,...bd,...vd,...Dd,...Rd,...Ud,...$d,...Kd,...Jd};({...bp,...Ep});function Dp(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Oa(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Rs=Oa("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Si=Oa("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Dp(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Sp={utf8:Rs,"utf-8":Rs,hex:Cs.base16,latin1:Si,ascii:Si,binary:Si,...Cs};function Op(r,e="utf8"){const t=Sp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const Ia="wc",Ip=2,ln="core",Mt=`${Ia}@${2}:${ln}:`,xp={name:ln,logger:"error"},Pp={database:":memory:"},Tp="crypto",Fs="client_ed25519_seed",Ap=te.ONE_DAY,Np="keychain",Cp="0.3",Rp="messages",Fp="0.3",Lp=te.SIX_HOURS,Up="publisher",xa="irn",jp="error",Pa="wss://relay.walletconnect.com",Mp="relayer",tt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},$p="_subscription",Br={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ls=te.ONE_SECOND,Hp="2.4.5",Bp="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},qp="subscription",zp="0.3",Kp=te.FIVE_SECONDS*1e3,Vp="pairing",Gp="0.3",br={wc_pairingDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:te.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:te.ONE_DAY,prompt:!1,tag:0},res:{ttl:te.ONE_DAY,prompt:!1,tag:0}}},St={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Wp="history",kp="0.3",Yp="expirer",bt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Jp="0.3";class Xp{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=Np,this.version=Cp,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:l}=J("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(l)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Zp{constructor(e,t,i){this.core=e,this.logger=t,this.name=Tp,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),l=is(n);return Mo(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Of();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const l=await this.getClientSeed(),g=is(l),p=$i();return await Uh(p,n,Ap,g)},this.generateSharedKey=(n,l,g)=>{this.isInitialized();const p=this.getPrivateKey(n),b=If(p,l);return this.setSymKey(b,g)},this.setSymKey=async(n,l)=>{this.isInitialized();const g=l||xf(n);return await this.keychain.set(g,n),g},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,l,g)=>{this.isInitialized();const p=ea(g),b=yu(l);if(ps(p)){const j=p.senderPublicKey,N=p.receiverPublicKey;n=await this.generateSharedKey(j,N)}const S=this.getSymKey(n),{type:x,senderPublicKey:A}=p;return Tf({type:x,symKey:S,message:b,senderPublicKey:A})},this.decode=async(n,l,g)=>{this.isInitialized();const p=Cf(l,g);if(ps(p)){const x=p.receiverPublicKey,A=p.senderPublicKey;n=await this.generateSharedKey(x,A)}const b=this.getSymKey(n),S=Af({symKey:b,encoded:l});return gu(S)},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.keychain=i||new Xp(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const t=sn(e);return Tr(t.type)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Fs)}catch{e=$i(),await this.keychain.set(Fs,e)}return Op(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Qp extends au{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Rp,this.version=Fp,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const l=Jr(n);let g=this.messages.get(i);return typeof g>"u"&&(g={}),typeof g[l]<"u"||(g[l]=n,this.messages.set(i,g),await this.persist()),l},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const l=this.get(i),g=Jr(n);return typeof l[g]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=t}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class eg extends cu{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new st.exports.EventEmitter,this.name=Up,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:l}});try{const g=l?.ttl||Lp,p=Hi(l),b=l?.prompt||!1,S=l?.tag||0,x={topic:i,message:n,opts:{ttl:g,relay:p,prompt:b,tag:S}},A=Jr(n);this.queue.set(A,x);try{await await na(this.rpcPublish(i,n,g,p,b,S),this.publishTimeout),this.relayer.events.emit(tt.publish,x)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(tt.connection_stalled);return}this.onPublish(A,x),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:l}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,t,i,n,l,g){var p,b,S,x;const A={method:Bi(n.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:l,tag:g}};return at((p=A.params)==null?void 0:p.prompt)&&((b=A.params)==null||delete b.prompt),at((S=A.params)==null?void 0:S.tag)&&((x=A.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.provider.request(A)}onPublish(e,t){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:n}=e;await this.publish(t,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class tg{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const n=i.filter(l=>l!==t);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var rg=Object.defineProperty,ig=Object.defineProperties,ng=Object.getOwnPropertyDescriptors,Us=Object.getOwnPropertySymbols,sg=Object.prototype.hasOwnProperty,og=Object.prototype.propertyIsEnumerable,js=(r,e,t)=>e in r?rg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qr=(r,e)=>{for(var t in e||(e={}))sg.call(e,t)&&js(r,t,e[t]);if(Us)for(var t of Us(e))og.call(e,t)&&js(r,t,e[t]);return r},Oi=(r,e)=>ig(r,ng(e));class ag extends fu{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new tg,this.events=new st.exports.EventEmitter,this.name=qp,this.version=zp,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const l=Hi(n),g={topic:i,relay:l};this.pending.set(i,g);const p=await this.rpcSubscribe(i,l);return this.onSubscribe(p,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),p}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,l)=>{const g=new te.Watch;g.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(p),g.stop(this.pendingSubscriptionWatchLabel),n(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=Kp&&(clearInterval(p),g.stop(this.pendingSubscriptionWatchLabel),l(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const n=Hi(i);await this.rpcUnsubscribe(e,t,n);const l=Ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,t){const i={method:Bi(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await na(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tt.connection_stalled)}return Jr(e+this.clientId)}rpcUnsubscribe(e,t,i){const n={method:Bi(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,t){this.setSubscription(e,Oi(qr({},t),{id:e})),this.pending.delete(t.topic)}onResubscribe(e,t){this.addSubscription(e,Oi(qr({},t),{id:e})),this.pending.delete(t.topic)}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,qr({},t)),this.topicMap.set(t.topic,e),this.events.emit(Ot.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,Oi(qr({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Ot.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:t,relay:i}=e,n={topic:t,relay:i};this.pending.set(n.topic,n);const l=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(l,n)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const t=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(t,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(tt.connect,async()=>{await this.onConnect()}),this.relayer.on(tt.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const t=Ot.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const t=Ot.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var cg=Object.defineProperty,Ms=Object.getOwnPropertySymbols,ug=Object.prototype.hasOwnProperty,hg=Object.prototype.propertyIsEnumerable,$s=(r,e,t)=>e in r?cg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fg=(r,e)=>{for(var t in e||(e={}))ug.call(e,t)&&$s(r,t,e[t]);if(Ms)for(var t of Ms(e))hg.call(e,t)&&$s(r,t,e[t]);return r};class lg extends uu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new st.exports.EventEmitter,this.name=Mp,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Xr(Se.getDefaultLoggerOptions({level:e.logger||jp})),this.messages=new Qp(this.logger,e.core),this.subscriber=new ag(this,this.logger),this.publisher=new eg(this,this.logger),this.relayUrl=e?.relayUrl||Pa,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t})}async subscribe(e,t){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Ot.created,l=>{l.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,t),n()})]),i}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(tt.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Ot.resubscribed,()=>{t()})}),await Promise.race([new Promise(async t=>{await this.provider.connect(),this.removeListener(tt.transport_closed,this.rejectTransportOpen),t()}),new Promise(t=>this.once(tt.transport_closed,this.rejectTransportOpen))])])}catch(t){const i=t;if(!/socket hang up/i.test(i.message))throw t;this.logger.error(t),this.events.emit(tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(t=>setTimeout(t,Ls)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Nr(new ed(Gf({sdkVersion:Hp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),hn(e)){if(!e.method.endsWith($p))return;const t=e.params,{topic:i,message:n}=t.data,l={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(fg({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=un(e.id,!0);await this.provider.connection.send(t)}registerEventListeners(){this.provider.on(Br.payload,e=>this.onProviderPayload(e)),this.provider.on(Br.connect,()=>{this.events.emit(tt.connect)}),this.provider.on(Br.disconnect,()=>{this.events.emit(tt.disconnect),this.attemptToReconnect()}),this.provider.on(Br.error,e=>this.events.emit(tt.error,e)),this.events.on(tt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},te.toMiliseconds(Ls))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var dg=Object.defineProperty,Hs=Object.getOwnPropertySymbols,pg=Object.prototype.hasOwnProperty,gg=Object.prototype.propertyIsEnumerable,Bs=(r,e,t)=>e in r?dg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qs=(r,e)=>{for(var t in e||(e={}))pg.call(e,t)&&Bs(r,t,e[t]);if(Hs)for(var t of Hs(e))gg.call(e,t)&&Bs(r,t,e[t]);return r};class ui extends hu{constructor(e,t,i,n=Mt,l=void 0){super(e,t,i,n),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=Bp,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{dl(g)?this.map.set(g.id,g):pl(g)?this.map.set(g.topic,g):this.getKey&&g!==null&&!at(g)&&this.map.set(this.getKey(g),g)}),this.cached=[],this.initialized=!0)},this.set=async(g,p)=>{this.isInitialized(),this.map.has(g)?await this.update(g,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:p}),this.map.set(g,p),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(p=>Object.keys(g).every(b=>td(p[b],g[b]))):this.values),this.update=async(g,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:p});const b=qs(qs({},this.getData(g)),p);this.map.set(g,b),await this.persist()},this.delete=async(g,p)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:p}),this.map.delete(g),await this.persist())},this.logger=Se.generateChildLogger(t,this.name),this.storagePrefix=n,this.getKey=l}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yg{constructor(e,t){this.core=e,this.logger=t,this.name=Vp,this.version=Gp,this.events=new st.exports,this.initialized=!1,this.storagePrefix=Mt,this.ignoredPayloadTypes=[Qt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=$i(),n=await this.core.crypto.setSymKey(i),l=It(te.FIVE_MINUTES),g={protocol:xa},p={topic:n,expiry:l,relay:g,active:!1},b=il({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:g});return await this.pairings.set(n,p),await this.core.relayer.subscribe(n),this.core.expirer.set(n,l),{topic:n,uri:b}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:l,relay:g}=tl(i.uri),p=It(te.FIVE_MINUTES),b={topic:n,relay:g,expiry:p,active:!1};return await this.pairings.set(n,b),await this.core.crypto.setSymKey(l,n),await this.core.relayer.subscribe(n,{relay:g}),this.core.expirer.set(n,p),i.activatePairing&&await this.activate({topic:n}),b},this.activate=async({topic:i})=>{this.isInitialized();const n=It(te.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const l=await this.sendRequest(n,"wc_pairingPing",{}),{done:g,resolve:p,reject:b}=Jt();this.events.once(je("pairing_ping",l),({error:S})=>{S?b(S):p()}),await g()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ze("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,l)=>{const g=oi(n,l),p=await this.core.crypto.encode(i,g),b=br[n].req;return this.core.history.set(i,g),await this.core.relayer.publish(i,p,b),g.id},this.sendResult=async(i,n,l)=>{const g=un(i,l),p=await this.core.crypto.encode(n,g),b=await this.core.history.get(n,i),S=br[b.request.method].res;await this.core.relayer.publish(n,p,S),await this.core.history.resolve(g)},this.sendError=async(i,n,l)=>{const g=ai(i,l),p=await this.core.crypto.encode(n,g),b=await this.core.history.get(n,i),S=br[b.request.method]?br[b.request.method].res:br.unregistered_method.res;await this.core.relayer.publish(n,p,S),await this.core.history.resolve(g)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Ut(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:l}=i,g=l.method;if(this.pairings.keys.includes(n))switch(g){case"wc_pairingPing":return this.onPairingPingRequest(n,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,l);default:return this.onUnknownRpcMethodRequest(n,l)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:l}=i,g=(await this.core.history.get(n,l.id)).request.method;if(this.pairings.keys.includes(n))switch(g){case"wc_pairingPing":return this.onPairingPingResponse(n,l);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(i,n)=>{const{id:l}=n;try{this.isValidPing({topic:i}),await this.sendResult(l,i,!0),this.events.emit("pairing_ping",{id:l,topic:i})}catch(g){await this.sendError(l,i,g),this.logger.error(g)}},this.onPairingPingResponse=(i,n)=>{const{id:l}=n;setTimeout(()=>{Nt(n)?this.events.emit(je("pairing_ping",l),{}):wt(n)&&this.events.emit(je("pairing_ping",l),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:l}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:l,topic:i})}catch(g){await this.sendError(l,i,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:l,method:g}=n;try{if(this.registeredMethods.includes(g))return;const p=Ze("WC_METHOD_UNSUPPORTED",g);await this.sendError(l,i,p),this.logger.error(p)}catch(p){await this.sendError(l,i,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ct(i)){const{message:n}=J("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!ll(i.uri)){const{message:n}=J("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ct(i)){const{message:l}=J("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(l)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ct(i)){const{message:l}=J("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(l)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Qe(i,!1)){const{message:n}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Ut(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=J("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.pairings=new ui(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(t,i);hn(n)?(this.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):fn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:t,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(bt.expired,async e=>{const{topic:t}=oa(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class _g extends ou{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new st.exports.EventEmitter,this.name=Wp,this.version=kp,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:l}),this.records.has(n.id))return;const g={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:l};this.records.set(g.id,g),this.events.emit(St.created,g)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=wt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(St.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(l=>{if(l.topic===i){if(typeof n<"u"&&l.id!==n)return;this.records.delete(l.id),this.events.emit(St.deleted,l)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:oi(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(St.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(St.created,e=>{const t=St.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(St.updated,e=>{const t=St.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(St.deleted,e=>{const t=St.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class bg extends lu{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new st.exports.EventEmitter,this.name=Yp,this.version=Jp,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const l=this.formatTarget(i),g={target:l,expiry:n};this.expirations.set(l,g),this.checkExpiry(l,g),this.events.emit(bt.created,{target:l,expiration:g})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),l=this.getExpiration(n);this.expirations.delete(n),this.events.emit(bt.deleted,{target:n,expiration:l})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Wf(e);if(typeof e=="number")return kf(e);const{message:t}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(bt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;te.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(bt.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(bt.created,e=>{const t=bt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(bt.expired,e=>{const t=bt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(bt.deleted,e=>{const t=bt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var mg=Object.defineProperty,zs=Object.getOwnPropertySymbols,vg=Object.prototype.hasOwnProperty,wg=Object.prototype.propertyIsEnumerable,Ks=(r,e,t)=>e in r?mg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vs=(r,e)=>{for(var t in e||(e={}))vg.call(e,t)&&Ks(r,t,e[t]);if(zs)for(var t of zs(e))wg.call(e,t)&&Ks(r,t,e[t]);return r};class dn extends su{constructor(e){super(e),this.protocol=Ia,this.version=Ip,this.name=ln,this.events=new st.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Pa;const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xr(Se.getDefaultLoggerOptions({level:e?.logger||xp.logger}));this.logger=Se.generateChildLogger(t,this.name),this.heartbeat=new Or.HeartBeat,this.crypto=new Zp(this,this.logger,e?.keychain),this.history=new _g(this,this.logger),this.expirer=new bg(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Kc(Vs(Vs({},Pp),e?.storageOptions)),this.relayer=new lg({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new yg(this,this.logger)}static async init(e){const t=new dn(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Eg=dn,Ta="wc",Aa=2,Na="client",pn=`${Ta}@${Aa}:${Na}:`,Ii={name:Na,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Dg="proposal",Sg="session",zr=te.SEVEN_DAYS,Og="engine",mr={wc_sessionPropose:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1104},res:{ttl:te.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1106},res:{ttl:te.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1112},res:{ttl:te.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1115}}},xi={min:te.FIVE_MINUTES,max:te.SEVEN_DAYS},Ig="request";var xg=Object.defineProperty,Pg=Object.defineProperties,Tg=Object.getOwnPropertyDescriptors,Gs=Object.getOwnPropertySymbols,Ag=Object.prototype.hasOwnProperty,Ng=Object.prototype.propertyIsEnumerable,Ws=(r,e,t)=>e in r?xg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_t=(r,e)=>{for(var t in e||(e={}))Ag.call(e,t)&&Ws(r,t,e[t]);if(Gs)for(var t of Gs(e))Ng.call(e,t)&&Ws(r,t,e[t]);return r},Pi=(r,e)=>Pg(r,Tg(e));class Cg extends pu{constructor(e){super(e),this.name=Og,this.events=new st.exports,this.initialized=!1,this.ignoredPayloadTypes=[Qt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(mr)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const i=Pi(_t({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:l,optionalNamespaces:g,sessionProperties:p,relays:b}=i;let S=n,x,A=!1;if(S&&(A=this.client.core.pairing.pairings.get(S).active),!S||!A){const{topic:I,uri:m}=await this.client.core.pairing.create();S=I,x=m}const j=await this.client.core.crypto.generateKeyPair(),N=_t({requiredNamespaces:l,optionalNamespaces:g,relays:b??[{protocol:xa}],proposer:{publicKey:j,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:C,resolve:q,done:B}=Jt();if(this.events.once(je("session_connect"),async({error:I,session:m})=>{if(I)C(I);else if(m){m.self.publicKey=j;const E=Pi(_t({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,E),await this.setExpiry(m.topic,m.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:m.peer.metadata}),q(E)}}),!S){const{message:I}=J("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(I)}const W=await this.sendRequest(S,"wc_sessionPropose",N),v=It(te.FIVE_MINUTES);return await this.setProposal(W,_t({id:W,expiry:v},N)),{uri:x,approval:B}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:i,relayProtocol:n,namespaces:l,sessionProperties:g}=t,p=this.client.proposal.get(i);let{pairingTopic:b,proposer:S,requiredNamespaces:x,optionalNamespaces:A}=p;wr(x)||(x=al(l,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),N=S.publicKey,C=await this.client.core.crypto.generateSharedKey(j,N);b&&i&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:S.metadata}),await this.sendResult(i,b,{relay:{protocol:n??"irn"},responderPublicKey:j}),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const q=_t({relay:{protocol:n??"irn"},namespaces:l,requiredNamespaces:x,optionalNamespaces:A,controller:{publicKey:j,metadata:this.client.metadata},expiry:It(zr)},g&&{sessionProperties:g});await this.client.core.relayer.subscribe(C);const B=await this.sendRequest(C,"wc_sessionSettle",q),{done:W,resolve:v,reject:I}=Jt();this.events.once(je("session_approve",B),({error:E})=>{E?I(E):v(this.client.session.get(C))});const m=Pi(_t({},q),{topic:C,acknowledged:!1,self:q.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:j});return await this.client.session.set(C,m),await this.setExpiry(C,It(zr)),{topic:C,acknowledged:W}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:i,reason:n}=t,{pairingTopic:l}=this.client.proposal.get(i);l&&(await this.sendError(i,l,n),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:i,namespaces:n}=t,l=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:g,resolve:p,reject:b}=Jt();return this.events.once(je("session_update",l),({error:S})=>{S?b(S):p()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:g}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:i}=t,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:l,resolve:g,reject:p}=Jt();return this.events.once(je("session_extend",n),({error:b})=>{b?p(b):g()}),await this.setExpiry(i,It(zr)),{acknowledged:l}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:i,request:n,topic:l,expiry:g}=t,p=await this.sendRequest(l,"wc_sessionRequest",{request:n,chainId:i},g),{done:b,resolve:S,reject:x}=Jt(g);return this.events.once(je("session_request",p),({error:A,result:j})=>{A?x(A):S(j)}),this.client.events.emit("session_request_sent",{topic:l,request:n,chainId:i}),await b()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:n}=t,{id:l}=n;Nt(n)?await this.sendResult(l,i,n.result):wt(n)&&await this.sendError(l,i,n.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:i}=t;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:l,resolve:g,reject:p}=Jt();this.events.once(je("session_ping",n),({error:b})=>{b?p(b):g()}),await l()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:i,event:n,chainId:l}=t;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:l})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:i}=t;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Ze("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>hl(i,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(t,i)=>{const{self:n}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,Ze("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(t),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,i)=>{await Promise.all([this.client.proposal.delete(t,Ze("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),n?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:i}),this.client.core.expirer.set(t,i)},this.setProposal=async(t,i)=>{await this.client.proposal.set(t,i),this.client.core.expirer.set(t,i.expiry)},this.setPendingSessionRequest=async t=>{const i=mr.wc_sessionRequest.req.ttl,{id:n,topic:l,params:g}=t;await this.client.pendingRequest.set(n,{id:n,topic:l,params:g}),i&&this.client.core.expirer.set(n,It(i))},this.sendRequest=async(t,i,n,l)=>{const g=oi(i,n),p=await this.client.core.crypto.encode(t,g),b=mr[i].req;return l&&(b.ttl=l),this.client.core.history.set(t,g),this.client.core.relayer.publish(t,p,b),g.id},this.sendResult=async(t,i,n)=>{const l=un(t,n),g=await this.client.core.crypto.encode(i,l),p=await this.client.core.history.get(i,t),b=mr[p.request.method].res;this.client.core.relayer.publish(i,g,b),await this.client.core.history.resolve(l)},this.sendError=async(t,i,n)=>{const l=ai(t,n),g=await this.client.core.crypto.encode(i,l),p=await this.client.core.history.get(i,t),b=mr[p.request.method].res;this.client.core.relayer.publish(i,g,b),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(n=>{Ut(n.expiry)&&t.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ut(n.expiry)&&i.push(n.id)}),await Promise.all([...t.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=t=>{const{topic:i,payload:n}=t,l=n.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:n}=t,l=(await this.client.core.history.get(i,n.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onSessionProposeRequest=async(t,i)=>{const{params:n,id:l}=i;try{this.isValidConnect(_t({},i.params));const g=It(te.FIVE_MINUTES),p=_t({id:l,pairingTopic:t,expiry:g},n);await this.setProposal(l,p),this.client.events.emit("session_proposal",{id:l,params:p})}catch(g){await this.sendError(l,t,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(t,i)=>{const{id:n}=i;if(Nt(i)){const{result:l}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const g=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const p=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const b=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const S=await this.client.core.crypto.generateSharedKey(p,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const x=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:t})}else wt(i)&&(await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")),this.events.emit(je("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(t,i)=>{const{id:n,params:l}=i;try{this.isValidSessionSettleRequest(l);const{relay:g,controller:p,expiry:b,namespaces:S,requiredNamespaces:x,optionalNamespaces:A,sessionProperties:j}=i.params,N=_t({topic:t,relay:g,expiry:b,namespaces:S,acknowledged:!0,requiredNamespaces:x,optionalNamespaces:A,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},j&&{sessionProperties:j});await this.sendResult(i.id,t,!0),this.events.emit(je("session_connect"),{session:N})}catch(g){await this.sendError(n,t,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(t,i)=>{const{id:n}=i;Nt(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(je("session_approve",n),{})):wt(i)&&(await this.client.session.delete(t,Ze("USER_DISCONNECTED")),this.events.emit(je("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:n,id:l}=i;try{this.isValidUpdate(_t({topic:t},n)),await this.client.session.update(t,{namespaces:n.namespaces}),await this.sendResult(l,t,!0),this.client.events.emit("session_update",{id:l,topic:t,params:n})}catch(g){await this.sendError(l,t,g),this.client.logger.error(g)}},this.onSessionUpdateResponse=(t,i)=>{const{id:n}=i;Nt(i)?this.events.emit(je("session_update",n),{}):wt(i)&&this.events.emit(je("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:n}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,It(zr)),await this.sendResult(n,t,!0),this.client.events.emit("session_extend",{id:n,topic:t})}catch(l){await this.sendError(n,t,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(t,i)=>{const{id:n}=i;Nt(i)?this.events.emit(je("session_extend",n),{}):wt(i)&&this.events.emit(je("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:n}=i;try{this.isValidPing({topic:t}),await this.sendResult(n,t,!0),this.client.events.emit("session_ping",{id:n,topic:t})}catch(l){await this.sendError(n,t,l),this.client.logger.error(l)}},this.onSessionPingResponse=(t,i)=>{const{id:n}=i;setTimeout(()=>{Nt(i)?this.events.emit(je("session_ping",n),{}):wt(i)&&this.events.emit(je("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),this.client.core.relayer.once(tt.publish,async()=>{await this.deleteSession(t)}),await this.sendResult(n,t,!0),this.client.events.emit("session_delete",{id:n,topic:t})}catch(l){await this.sendError(n,t,l),this.client.logger.error(l)}},this.onSessionRequest=async(t,i)=>{const{id:n,params:l}=i;try{this.isValidRequest(_t({topic:t},l)),await this.setPendingSessionRequest({id:n,topic:t,params:l}),this.client.events.emit("session_request",{id:n,topic:t,params:l})}catch(g){await this.sendError(n,t,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(t,i)=>{const{id:n}=i;Nt(i)?this.events.emit(je("session_request",n),{result:i.result}):wt(i)&&this.events.emit(je("session_request",n),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:n,params:l}=i;try{this.isValidEmit(_t({topic:t},l)),this.client.events.emit("session_event",{id:n,topic:t,params:l})}catch(g){await this.sendError(n,t,g),this.client.logger.error(g)}},this.isValidConnect=async t=>{if(!ct(t)){const{message:b}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(b)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:l,sessionProperties:g,relays:p}=t;if(at(i)||await this.isValidPairingTopic(i),!El(p,!0)){const{message:b}=J("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(b)}!at(n)&&wr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!at(l)&&wr(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),at(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(t,i)=>{const n=wl(t,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async t=>{if(!ct(t))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:n,relayProtocol:l,sessionProperties:g}=t;await this.isValidProposalId(i);const p=this.client.proposal.get(i),b=Gr(n,"approve()");if(b)throw new Error(b.message);const S=Di(p.requiredNamespaces,n,"approve()","requiredNamespaces");if(S)throw new Error(S.message);if(!Qe(l,!0)){const{message:x}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(x)}if(Object.keys(n).length>Object.keys(p.requiredNamespaces).length){const x=Object.keys(p.optionalNamespaces).filter(N=>n[N]),A={};for(const N in p.optionalNamespaces)x.includes(N)&&(A[N]=p.optionalNamespaces[N]);const j=Di(A,n,"approve()","optionalNamespaces");if(j)throw new Error(j.message)}at(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async t=>{if(!ct(t)){const{message:l}=J("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(l)}const{id:i,reason:n}=t;if(await this.isValidProposalId(i),!Sl(n)){const{message:l}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(l)}},this.isValidSessionSettleRequest=t=>{if(!ct(t)){const{message:S}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(S)}const{relay:i,controller:n,namespaces:l,expiry:g}=t;if(!ca(i)){const{message:S}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const p=gl(n,"onSessionSettleRequest()");if(p)throw new Error(p.message);const b=Gr(l,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Ut(g)){const{message:S}=J("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async t=>{if(!ct(t)){const{message:b}=J("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(b)}const{topic:i,namespaces:n}=t;await this.isValidSessionTopic(i);const l=this.client.session.get(i),g=Gr(n,"update()");if(g)throw new Error(g.message);const p=Di(l.requiredNamespaces,n,"update()","requiredNamespaces");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!ct(t)){const{message:n}=J("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!ct(t)){const{message:b}=J("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(b)}const{topic:i,request:n,chainId:l,expiry:g}=t;await this.isValidSessionTopic(i);const{namespaces:p}=this.client.session.get(i);if(!ws(p,l)){const{message:b}=J("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(b)}if(!Ol(n)){const{message:b}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(b)}if(!Pl(p,l,n.method)){const{message:b}=J("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(b)}if(g&&!Al(g,xi)){const{message:b}=J("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${xi.min} and ${xi.max}`);throw new Error(b)}},this.isValidRespond=async t=>{if(!ct(t)){const{message:l}=J("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(l)}const{topic:i,response:n}=t;if(await this.isValidSessionTopic(i),!Il(n)){const{message:l}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(l)}},this.isValidPing=async t=>{if(!ct(t)){const{message:n}=J("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!ct(t)){const{message:p}=J("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:i,event:n,chainId:l}=t;await this.isValidSessionTopic(i);const{namespaces:g}=this.client.session.get(i);if(!ws(g,l)){const{message:p}=J("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(p)}if(!xl(n)){const{message:p}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(p)}if(!Tl(g,l,n.name)){const{message:p}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!ct(t)){const{message:n}=J("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(n=>{if(!Qe(n,!1)){const{message:l}=J("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(tt.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(t,i);hn(n)?(this.client.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):fn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:t,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(bt.expired,async e=>{const{topic:t,id:i}=oa(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,J("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ut(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ut(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=J("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:t}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Dl(e)){const{message:t}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ut(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=J("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Rg extends ui{constructor(e,t){super(e,t,Dg,pn),this.core=e,this.logger=t}}class Fg extends ui{constructor(e,t){super(e,t,Sg,pn),this.core=e,this.logger=t}}class Lg extends ui{constructor(e,t){super(e,t,Ig,pn),this.core=e,this.logger=t}}class gn extends du{constructor(e){super(e),this.protocol=Ta,this.version=Aa,this.name=Ii.name,this.events=new st.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||Ii.name,this.metadata=e?.metadata||qf();const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xr(Se.getDefaultLoggerOptions({level:e?.logger||Ii.logger}));this.core=e?.core||new Eg(e),this.logger=Se.generateChildLogger(t,this.name),this.session=new Fg(this.core,this.logger),this.proposal=new Rg(this.core,this.logger),this.pendingRequest=new Lg(this.core,this.logger),this.engine=new Cg(this)}static async init(e){const t=new gn(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=xe.getLocation=xe.getLocationOrThrow=xe.getNavigator=xe.getNavigatorOrThrow=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function er(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}xe.getFromWindow=er;function ar(r){const e=er(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}xe.getFromWindowOrThrow=ar;function Ug(){return ar("document")}xe.getDocumentOrThrow=Ug;function jg(){return er("document")}xe.getDocument=jg;function Mg(){return ar("navigator")}xe.getNavigatorOrThrow=Mg;function $g(){return er("navigator")}xe.getNavigator=$g;function Hg(){return ar("location")}xe.getLocationOrThrow=Hg;function Bg(){return er("location")}xe.getLocation=Bg;function qg(){return ar("crypto")}xe.getCryptoOrThrow=qg;function zg(){return er("crypto")}xe.getCrypto=zg;function Kg(){return ar("localStorage")}xe.getLocalStorageOrThrow=Kg;function Vg(){return er("localStorage")}xe.getLocalStorage=Vg;var yn={};Object.defineProperty(yn,"__esModule",{value:!0});yn.getWindowMetadata=void 0;const ks=xe;function Gg(){let r,e;try{r=ks.getDocumentOrThrow(),e=ks.getLocationOrThrow()}catch{return null}function t(){const A=r.getElementsByTagName("link"),j=[];for(let N=0;N<A.length;N++){const C=A[N],q=C.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const B=C.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(B.indexOf("/")===0)W+=B;else{const v=e.pathname.split("/");v.pop(),W+=v.join("/")+"/"+B}j.push(W)}else if(B.indexOf("//")===0){const W=e.protocol+B;j.push(W)}else j.push(B)}}return j}function i(...A){const j=r.getElementsByTagName("meta");for(let N=0;N<j.length;N++){const C=j[N],q=["itemprop","property","name"].map(B=>C.getAttribute(B)).filter(B=>B?A.includes(B):!1);if(q.length&&q){const B=C.getAttribute("content");if(B)return B}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=r.title),A}function l(){return i("description","og:description","twitter:description","keywords")}const g=n(),p=l(),b=e.origin,S=t();return{description:p,url:b,icons:S,name:g}}yn.getWindowMetadata=Gg;var Wg={};(function(r){const e=Wo,t=Yo,i=Jo,n=Xo,l=v=>v==null,g=Symbol("encodeFragmentIdentifier");function p(v){switch(v.arrayFormat){case"index":return I=>(m,E)=>{const y=m.length;return E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),"[",y,"]"].join("")]:[...m,[x(I,v),"[",x(y,v),"]=",x(E,v)].join("")]};case"bracket":return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),"[]"].join("")]:[...m,[x(I,v),"[]=",x(E,v)].join("")];case"colon-list-separator":return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[x(I,v),":list="].join("")]:[...m,[x(I,v),":list=",x(E,v)].join("")];case"comma":case"separator":case"bracket-separator":{const I=v.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(E,y)=>y===void 0||v.skipNull&&y===null||v.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[x(m,v),I,x(y,v)].join("")]:[[E,x(y,v)].join(v.arrayFormatSeparator)])}default:return I=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,x(I,v)]:[...m,[x(I,v),"=",x(E,v)].join("")]}}function b(v){let I;switch(v.arrayFormat){case"index":return(m,E,y)=>{if(I=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!I){y[m]=E;return}y[m]===void 0&&(y[m]={}),y[m][I[1]]=E};case"bracket":return(m,E,y)=>{if(I=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!I){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"colon-list-separator":return(m,E,y)=>{if(I=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!I){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"comma":case"separator":return(m,E,y)=>{const o=typeof E=="string"&&E.includes(v.arrayFormatSeparator),d=typeof E=="string"&&!o&&A(E,v).includes(v.arrayFormatSeparator);E=d?A(E,v):E;const H=o||d?E.split(v.arrayFormatSeparator).map(s=>A(s,v)):E===null?E:A(E,v);y[m]=H};case"bracket-separator":return(m,E,y)=>{const o=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!o){y[m]=E&&A(E,v);return}const d=E===null?[]:E.split(v.arrayFormatSeparator).map(H=>A(H,v));if(y[m]===void 0){y[m]=d;return}y[m]=[].concat(y[m],d)};default:return(m,E,y)=>{if(y[m]===void 0){y[m]=E;return}y[m]=[].concat(y[m],E)}}}function S(v){if(typeof v!="string"||v.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function x(v,I){return I.encode?I.strict?e(v):encodeURIComponent(v):v}function A(v,I){return I.decode?t(v):v}function j(v){return Array.isArray(v)?v.sort():typeof v=="object"?j(Object.keys(v)).sort((I,m)=>Number(I)-Number(m)).map(I=>v[I]):v}function N(v){const I=v.indexOf("#");return I!==-1&&(v=v.slice(0,I)),v}function C(v){let I="";const m=v.indexOf("#");return m!==-1&&(I=v.slice(m)),I}function q(v){v=N(v);const I=v.indexOf("?");return I===-1?"":v.slice(I+1)}function B(v,I){return I.parseNumbers&&!Number.isNaN(Number(v))&&typeof v=="string"&&v.trim()!==""?v=Number(v):I.parseBooleans&&v!==null&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")&&(v=v.toLowerCase()==="true"),v}function W(v,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),S(I.arrayFormatSeparator);const m=b(I),E=Object.create(null);if(typeof v!="string"||(v=v.trim().replace(/^[?#&]/,""),!v))return E;for(const y of v.split("&")){if(y==="")continue;let[o,d]=i(I.decode?y.replace(/\+/g," "):y,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?d:A(d,I),m(A(o,I),d,E)}for(const y of Object.keys(E)){const o=E[y];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=B(o[d],I);else E[y]=B(o,I)}return I.sort===!1?E:(I.sort===!0?Object.keys(E).sort():Object.keys(E).sort(I.sort)).reduce((y,o)=>{const d=E[o];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?y[o]=j(d):y[o]=d,y},Object.create(null))}r.extract=q,r.parse=W,r.stringify=(v,I)=>{if(!v)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),S(I.arrayFormatSeparator);const m=d=>I.skipNull&&l(v[d])||I.skipEmptyString&&v[d]==="",E=p(I),y={};for(const d of Object.keys(v))m(d)||(y[d]=v[d]);const o=Object.keys(y);return I.sort!==!1&&o.sort(I.sort),o.map(d=>{const H=v[d];return H===void 0?"":H===null?x(d,I):Array.isArray(H)?H.length===0&&I.arrayFormat==="bracket-separator"?x(d,I)+"[]":H.reduce(E(d),[]).join("&"):x(d,I)+"="+x(H,I)}).filter(d=>d.length>0).join("&")},r.parseUrl=(v,I)=>{I=Object.assign({decode:!0},I);const[m,E]=i(v,"#");return Object.assign({url:m.split("?")[0]||"",query:W(q(v),I)},I&&I.parseFragmentIdentifier&&E?{fragmentIdentifier:A(E,I)}:{})},r.stringifyUrl=(v,I)=>{I=Object.assign({encode:!0,strict:!0,[g]:!0},I);const m=N(v.url).split("?")[0]||"",E=r.extract(v.url),y=r.parse(E,{sort:!1}),o=Object.assign(y,v.query);let d=r.stringify(o,I);d&&(d=`?${d}`);let H=C(v.url);return v.fragmentIdentifier&&(H=`#${I[g]?x(v.fragmentIdentifier,I):v.fragmentIdentifier}`),`${m}${d}${H}`},r.pick=(v,I,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[g]:!1},m);const{url:E,query:y,fragmentIdentifier:o}=r.parseUrl(v,m);return r.stringifyUrl({url:E,query:n(y,I),fragmentIdentifier:o},m)},r.exclude=(v,I,m)=>{const E=Array.isArray(I)?y=>!I.includes(y):(y,o)=>!I(y,o);return r.pick(v,E,m)}})(Wg);const kg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Ys(r,e){const{message:t,code:i}=kg[r];return{message:e?`${t} ${e}`:t,code:i}}function Yg(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}var Vi={exports:{}};(function(r,e){var t=typeof self<"u"?self:Ae,i=function(){function l(){this.fetch=!1,this.DOMException=t.DOMException}return l.prototype=t,new l}();(function(l){(function(g){var p={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function b(a){return a&&DataView.prototype.isPrototypeOf(a)}if(p.arrayBuffer)var S=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],x=ArrayBuffer.isView||function(a){return a&&S.indexOf(Object.prototype.toString.call(a))>-1};function A(a){if(typeof a!="string"&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function j(a){return typeof a!="string"&&(a=String(a)),a}function N(a){var c={next:function(){var D=a.shift();return{done:D===void 0,value:D}}};return p.iterable&&(c[Symbol.iterator]=function(){return c}),c}function C(a){this.map={},a instanceof C?a.forEach(function(c,D){this.append(D,c)},this):Array.isArray(a)?a.forEach(function(c){this.append(c[0],c[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(c){this.append(c,a[c])},this)}C.prototype.append=function(a,c){a=A(a),c=j(c);var D=this.map[a];this.map[a]=D?D+", "+c:c},C.prototype.delete=function(a){delete this.map[A(a)]},C.prototype.get=function(a){return a=A(a),this.has(a)?this.map[a]:null},C.prototype.has=function(a){return this.map.hasOwnProperty(A(a))},C.prototype.set=function(a,c){this.map[A(a)]=j(c)},C.prototype.forEach=function(a,c){for(var D in this.map)this.map.hasOwnProperty(D)&&a.call(c,this.map[D],D,this)},C.prototype.keys=function(){var a=[];return this.forEach(function(c,D){a.push(D)}),N(a)},C.prototype.values=function(){var a=[];return this.forEach(function(c){a.push(c)}),N(a)},C.prototype.entries=function(){var a=[];return this.forEach(function(c,D){a.push([D,c])}),N(a)},p.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function q(a){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}function B(a){return new Promise(function(c,D){a.onload=function(){c(a.result)},a.onerror=function(){D(a.error)}})}function W(a){var c=new FileReader,D=B(c);return c.readAsArrayBuffer(a),D}function v(a){var c=new FileReader,D=B(c);return c.readAsText(a),D}function I(a){for(var c=new Uint8Array(a),D=new Array(c.length),P=0;P<c.length;P++)D[P]=String.fromCharCode(c[P]);return D.join("")}function m(a){if(a.slice)return a.slice(0);var c=new Uint8Array(a.byteLength);return c.set(new Uint8Array(a)),c.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(a){this._bodyInit=a,a?typeof a=="string"?this._bodyText=a:p.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:p.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():p.arrayBuffer&&p.blob&&b(a)?(this._bodyArrayBuffer=m(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||x(a))?this._bodyArrayBuffer=m(a):this._bodyText=a=Object.prototype.toString.call(a):this._bodyText="",this.headers.get("content-type")||(typeof a=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var a=q(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(W)}),this.text=function(){var a=q(this);if(a)return a;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(I(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(H)}),this.json=function(){return this.text().then(JSON.parse)},this}var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function o(a){var c=a.toUpperCase();return y.indexOf(c)>-1?c:a}function d(a,c){c=c||{};var D=c.body;if(a instanceof d){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,c.headers||(this.headers=new C(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,!D&&a._bodyInit!=null&&(D=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=c.credentials||this.credentials||"same-origin",(c.headers||!this.headers)&&(this.headers=new C(c.headers)),this.method=o(c.method||this.method||"GET"),this.mode=c.mode||this.mode||null,this.signal=c.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}d.prototype.clone=function(){return new d(this,{body:this._bodyInit})};function H(a){var c=new FormData;return a.trim().split("&").forEach(function(D){if(D){var P=D.split("="),U=P.shift().replace(/\+/g," "),w=P.join("=").replace(/\+/g," ");c.append(decodeURIComponent(U),decodeURIComponent(w))}}),c}function s(a){var c=new C,D=a.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(P){var U=P.split(":"),w=U.shift().trim();if(w){var R=U.join(":").trim();c.append(w,R)}}),c}E.call(d.prototype);function h(a,c){c||(c={}),this.type="default",this.status=c.status===void 0?200:c.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in c?c.statusText:"OK",this.headers=new C(c.headers),this.url=c.url||"",this._initBody(a)}E.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},h.error=function(){var a=new h(null,{status:0,statusText:""});return a.type="error",a};var f=[301,302,303,307,308];h.redirect=function(a,c){if(f.indexOf(c)===-1)throw new RangeError("Invalid status code");return new h(null,{status:c,headers:{location:a}})},g.DOMException=l.DOMException;try{new g.DOMException}catch{g.DOMException=function(c,D){this.message=c,this.name=D;var P=Error(c);this.stack=P.stack},g.DOMException.prototype=Object.create(Error.prototype),g.DOMException.prototype.constructor=g.DOMException}function _(a,c){return new Promise(function(D,P){var U=new d(a,c);if(U.signal&&U.signal.aborted)return P(new g.DOMException("Aborted","AbortError"));var w=new XMLHttpRequest;function R(){w.abort()}w.onload=function(){var K={status:w.status,statusText:w.statusText,headers:s(w.getAllResponseHeaders()||"")};K.url="responseURL"in w?w.responseURL:K.headers.get("X-Request-URL");var z="response"in w?w.response:w.responseText;D(new h(z,K))},w.onerror=function(){P(new TypeError("Network request failed"))},w.ontimeout=function(){P(new TypeError("Network request failed"))},w.onabort=function(){P(new g.DOMException("Aborted","AbortError"))},w.open(U.method,U.url,!0),U.credentials==="include"?w.withCredentials=!0:U.credentials==="omit"&&(w.withCredentials=!1),"responseType"in w&&p.blob&&(w.responseType="blob"),U.headers.forEach(function(K,z){w.setRequestHeader(z,K)}),U.signal&&(U.signal.addEventListener("abort",R),w.onreadystatechange=function(){w.readyState===4&&U.signal.removeEventListener("abort",R)}),w.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return _.polyfill=!0,l.fetch||(l.fetch=_,l.Headers=C,l.Request=d,l.Response=h),g.Headers=C,g.Request=d,g.Response=h,g.fetch=_,Object.defineProperty(g,"__esModule",{value:!0}),g})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,r.exports=e})(Vi,Vi.exports);const Js=Pc(Vi.exports);function Jg(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function Xs(r){return typeof r=="string"?r:JSON.stringify(r)}const Xg={Accept:"application/json","Content-Type":"application/json"},Zg="POST",Zs={headers:Xg,method:Zg},Qs=10;class hi{constructor(e){if(this.url=e,this.events=new st.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Os(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const i=Xs(e),l=await(await Js(this.url,Object.assign(Object.assign({},Zs),{body:i}))).json();this.onPayload({data:l})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Os(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,n)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),n(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const t=Xs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Js(e,Object.assign(Object.assign({},Zs),{body:t})),this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Jg(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),n=i.message||i.toString(),l=ai(e,n);this.events.emit("payload",l)}parseError(e,t=this.url){return fa(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Qs&&this.events.setMaxListeners(Qs)}}const eo="error",Qg="wss://relay.walletconnect.com",ey="wc",ty="universal_provider",to=`${ey}@${2}:${ty}:`,ry="https://rpc.walletconnect.com/v1",Rr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function $t(r,e,t){let i;const n=Gi(r);return e.rpcMap&&(i=e.rpcMap[n]),i||(i=`${ry}?chainId=eip155:${n}&projectId=${t}`),i}function Gi(r){return r.includes("eip155")?Number(r.split(":")[1]):Number(r)}function iy(r,e){if(!e.includes(r))throw new Error(`Chain '${r}' not approved. Please use one of the following: ${e.toString()}`)}function ny(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}const fi=(r,e)=>{const t=i=>{i.request!==e.request||i.topic!==e.topic||(r.events.removeListener("session_request_sent",t),sy())};r.on("session_request_sent",t)};function sy(){if(typeof window<"u")try{const r=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(r){const e=JSON.parse(r);window.open(e.href,"_self","noreferrer noopener")}}catch(r){console.error(r)}}class oy{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var t;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(fi(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const i=Gi(e);if(!this.httpProviders[i]){const n=t||$t(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||$t(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Nr(new hi(i))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=Gi(t);e[i]=this.createHttpProvider(i)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){const t=parseInt(e,16),i=`${this.name}:${t}`;iy(i,this.namespace.chains),this.setDefaultChain(`${t}`)}}class ay{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(fi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||$t(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||$t(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Nr(new hi(i))}}class cy{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(fi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||$t(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||$t(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Nr(new hi(i))}}class uy{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(fi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||$t(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Rr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||$t(e,this.namespace);return typeof i>"u"?void 0:new Nr(new hi(i))}}var hy=Object.defineProperty,fy=Object.defineProperties,ly=Object.getOwnPropertyDescriptors,ro=Object.getOwnPropertySymbols,dy=Object.prototype.hasOwnProperty,py=Object.prototype.propertyIsEnumerable,io=(r,e,t)=>e in r?hy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kr=(r,e)=>{for(var t in e||(e={}))dy.call(e,t)&&io(r,t,e[t]);if(ro)for(var t of ro(e))py.call(e,t)&&io(r,t,e[t]);return r},Ti=(r,e)=>fy(r,ly(e));class _n{constructor(e){this.events=new st.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Xr(Se.getDefaultLoggerOptions({level:e?.logger||eo}))}static async init(e){const t=new _n(e);return await t.initialize(),t}async request(e,t){const[i,n]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Kr({},e),chainId:`${i}:${n}`,topic:this.session.topic})}sendAsync(e,t,i){this.request(e,i).then(n=>t(null,n)).catch(n=>t(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ys("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});return t&&(this.uri=t,this.events.emit("display_uri",t)),this.session=await i(),this.createProviders(),this.onConnect(),this.session}setDefaultChain(e,t){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Yg(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await gn.init({logger:this.providerOpts.logger||eo,relayUrl:this.providerOpts.relayUrl||Qg,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{var t,i,n;const l=((t=this.session)==null?void 0:t.namespaces[e].accounts)||[],g=ny(l),p=Ti(Kr({},Object.assign(this.namespaces[e],(n=(i=this.optionalNamespaces)==null?void 0:i[e])!=null?n:{})),{accounts:l,chains:g});switch(e){case"eip155":this.rpcProviders[e]=new oy({client:this.client,namespace:p,events:this.events});break;case"solana":this.rpcProviders[e]=new ay({client:this.client,namespace:p,events:this.events});break;case"cosmos":this.rpcProviders[e]=new cy({client:this.client,namespace:p,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new uy({client:this.client,namespace:p,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:n}=t,l=(i=this.client)==null?void 0:i.session.get(e);this.session=Ti(Kr({},l),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ti(Kr({},Ys("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Rr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:n}=e;if(!t||!Object.keys(t).length)throw new Error("Namespaces must be not empty");this.namespaces=t,this.optionalNamespaces=i,this.sessionProperties=n,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){const[t,i]=e?.split(":")||["",""];if(t&&!Object.keys(this.namespaces).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const n=Object.keys(this.namespaces)[0],l=this.rpcProviders[n].getDefaultChain();return[n,l]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){const[i,n]=this.validateChain(e);t||this.getProvider(i).setDefaultChain(n),this.namespaces[i].defaultChain=n,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${to}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${to}/${e}`)}}var gy=globalThis&&globalThis.__awaiter||function(r,e,t,i){function n(l){return l instanceof t?l:new t(function(g){g(l)})}return new(t||(t=Promise))(function(l,g){function p(x){try{S(i.next(x))}catch(A){g(A)}}function b(x){try{S(i.throw(x))}catch(A){g(A)}}function S(x){x.done?l(x.value):n(x.value).then(p,b)}S((i=i.apply(r,e||[])).next())})},yy=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,n,l,g;return g={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function p(S){return function(x){return b([S,x])}}function b(S){if(i)throw new TypeError("Generator is already executing.");for(;g&&(g=0,S[0]&&(t=0)),t;)try{if(i=1,n&&(l=S[0]&2?n.return:S[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,S[1])).done)return l;switch(n=0,l&&(S=[S[0]&2,l.value]),S[0]){case 0:case 1:l=S;break;case 4:return t.label++,{value:S[1],done:!1};case 5:t.label++,n=S[1],S=[0];continue;case 7:S=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(S[0]===6||S[0]===2)){t=0;continue}if(S[0]===3&&(!l||S[1]>l[0]&&S[1]<l[3])){t.label=S[1];break}if(S[0]===6&&t.label<l[1]){t.label=l[1],l=S;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(S);break}l[2]&&t.ops.pop(),t.trys.pop();continue}S=e.call(r,t)}catch(x){S=[6,x],n=0}finally{i=l=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},by=["eip155:1"],my=function(){return gy(void 0,void 0,void 0,function(){return yy(this,function(r){switch(r.label){case 0:return[4,_n.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,r.sent()]}})})};export{by as WC_V2_DEFAULT_CHAINS,my as getWalletConnectV2ProviderInstance};

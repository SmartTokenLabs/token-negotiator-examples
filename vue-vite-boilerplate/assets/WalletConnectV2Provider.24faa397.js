import{b as Ae,g as Ic,d as xc,r as Pc,f as ho,t as Tc,e as Ac,h as Bt,i as en,j as fo,k as Nc,l as Cc,m as Rc,n as Fc,p as Lc}from"./index.927b9e0c.js";function Uc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var jc=Mc;function Mc(t,e,r){var i=r&&r.stringify||Uc,n=1;if(typeof t=="object"&&t!==null){var h=e.length+n;if(h===1)return t;var g=new Array(h);g[0]=i(t);for(var d=1;d<h;d++)g[d]=i(e[d]);return g.join(" ")}if(typeof t!="string")return t;var y=e.length;if(y===0)return t;for(var E="",O=1-n,A=-1,$=t&&t.length||0,C=0;C<$;){if(t.charCodeAt(C)===37&&C+1<$){switch(A=A>-1?A:0,t.charCodeAt(C+1)){case 100:case 102:if(O>=y||e[O]==null)break;A<C&&(E+=t.slice(A,C)),E+=Number(e[O]),A=C+2,C++;break;case 105:if(O>=y||e[O]==null)break;A<C&&(E+=t.slice(A,C)),E+=Math.floor(Number(e[O])),A=C+2,C++;break;case 79:case 111:case 106:if(O>=y||e[O]===void 0)break;A<C&&(E+=t.slice(A,C));var N=typeof e[O];if(N==="string"){E+="'"+e[O]+"'",A=C+2,C++;break}if(N==="function"){E+=e[O].name||"<anonymous>",A=C+2,C++;break}E+=i(e[O]),A=C+2,C++;break;case 115:if(O>=y)break;A<C&&(E+=t.slice(A,C)),E+=String(e[O]),A=C+2,C++;break;case 37:A<C&&(E+=t.slice(A,C)),E+="%",A=C+2,C++,O--;break}++O}++C}return A===-1?t:(A<$&&(E+=t.slice(A)),E)}const Ln=jc;var Tr=xt;const Ir=kc().console||{},$c={mapHttpRequest:Wr,mapHttpResponse:Wr,wrapRequestSerializer:vi,wrapResponseSerializer:vi,wrapErrorSerializer:vi,req:Wr,res:Wr,err:Kc};function Hc(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function xt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Ir;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=Hc(t.browser.serialize,i);let h=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(h=!1);const g=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const d=t.level||"info",y=Object.create(r);y.log||(y.log=xr),Object.defineProperty(y,"levelVal",{get:O}),Object.defineProperty(y,"level",{get:A,set:$});const E={transmit:e,serialize:n,asObject:t.browser.asObject,levels:g,timestamp:Vc(t)};y.levels=xt.levels,y.level=d,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=xr,y.serializers=i,y._serialize=n,y._stdErrSerialize=h,y.child=C,e&&(y._logEvent=Ui());function O(){return this.level==="silent"?1/0:this.levels.values[this.level]}function A(){return this._level}function $(N){if(N!=="silent"&&!this.levels.values[N])throw Error("unknown level "+N);this._level=N,ir(E,y,"error","log"),ir(E,y,"fatal","error"),ir(E,y,"warn","error"),ir(E,y,"info","log"),ir(E,y,"debug","log"),ir(E,y,"trace","log")}function C(N,K){if(!N)throw new Error("missing bindings for child Pino");K=K||{},n&&N.serializers&&(K.serializers=N.serializers);const H=K.serializers;if(n&&H){var W=Object.assign({},i,H),m=t.browser.serialize===!0?Object.keys(W):n;delete N.serializers,ni([N],m,W,this._stdErrSerialize)}function x(b){this._childLevel=(b._childLevel|0)+1,this.error=nr(b,N,"error"),this.fatal=nr(b,N,"fatal"),this.warn=nr(b,N,"warn"),this.info=nr(b,N,"info"),this.debug=nr(b,N,"debug"),this.trace=nr(b,N,"trace"),W&&(this.serializers=W,this._serialize=m),e&&(this._logEvent=Ui([].concat(b._logEvent.bindings,N)))}return x.prototype=this,new x(this)}return y}xt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};xt.stdSerializers=$c;xt.stdTimeFunctions=Object.assign({},{nullTime:lo,epochTime:po,unixTime:Gc,isoTime:Wc});function ir(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?xr:n[r]?n[r]:Ir[r]||Ir[i]||xr,Bc(t,e,r)}function Bc(t,e,r){!t.transmit&&e[r]===xr||(e[r]=function(i){return function(){const h=t.timestamp(),g=new Array(arguments.length),d=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ir?Ir:this;for(var y=0;y<g.length;y++)g[y]=arguments[y];if(t.serialize&&!t.asObject&&ni(g,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(d,qc(this,r,g,h)):i.apply(d,g),t.transmit){const E=t.transmit.level||e.level,O=xt.levels.values[E],A=xt.levels.values[r];if(A<O)return;zc(this,{ts:h,methodLevel:r,methodValue:A,transmitLevel:E,transmitValue:xt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},g)}}}(e[r]))}function qc(t,e,r,i){t._serialize&&ni(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let h=n[0];const g={};i&&(g.time=i),g.level=xt.levels.values[e];let d=(t._childLevel|0)+1;if(d<1&&(d=1),h!==null&&typeof h=="object"){for(;d--&&typeof n[0]=="object";)Object.assign(g,n.shift());h=n.length?Ln(n.shift(),n):void 0}else typeof h=="string"&&(h=Ln(n.shift(),n));return h!==void 0&&(g.msg=h),g}function ni(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=xt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const h in t[n])e&&e.indexOf(h)>-1&&h in r&&(t[n][h]=r[h](t[n][h]))}function nr(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function zc(t,e,r){const i=e.send,n=e.ts,h=e.methodLevel,g=e.methodValue,d=e.val,y=t._logEvent.bindings;ni(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(E){return y.indexOf(E)===-1}),t._logEvent.level.label=h,t._logEvent.level.value=g,i(h,t._logEvent,d),t._logEvent=Ui(y)}function Ui(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Kc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Vc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?lo:po}function Wr(){return{}}function vi(t){return t}function xr(){}function lo(){return!1}function po(){return Date.now()}function Gc(){return Math.round(Date.now()/1e3)}function Wc(){return new Date(Date.now()).toISOString()}function kc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var st={exports:{}},ar=typeof Reflect=="object"?Reflect:null,Un=ar&&typeof ar.apply=="function"?ar.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Zr;ar&&typeof ar.ownKeys=="function"?Zr=ar.ownKeys:Object.getOwnPropertySymbols?Zr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Zr=function(e){return Object.getOwnPropertyNames(e)};function Yc(t){console&&console.warn&&console.warn(t)}var go=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}st.exports=Oe;st.exports.once=Qc;Oe.EventEmitter=Oe;Oe.prototype._events=void 0;Oe.prototype._eventsCount=0;Oe.prototype._maxListeners=void 0;var jn=10;function si(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return jn},set:function(t){if(typeof t!="number"||t<0||go(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");jn=t}});Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||go(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function yo(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return yo(this)};Oe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",h=this._events;if(h!==void 0)n=n&&h.error===void 0;else if(!n)return!1;if(n){var g;if(r.length>0&&(g=r[0]),g instanceof Error)throw g;var d=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw d.context=g,d}var y=h[e];if(y===void 0)return!1;if(typeof y=="function")Un(y,this,r);else for(var E=y.length,O=wo(y,E),i=0;i<E;++i)Un(O[i],this,r);return!0};function _o(t,e,r,i){var n,h,g;if(si(r),h=t._events,h===void 0?(h=t._events=Object.create(null),t._eventsCount=0):(h.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),h=t._events),g=h[e]),g===void 0)g=h[e]=r,++t._eventsCount;else if(typeof g=="function"?g=h[e]=i?[r,g]:[g,r]:i?g.unshift(r):g.push(r),n=yo(t),n>0&&g.length>n&&!g.warned){g.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=e,d.count=g.length,Yc(d)}return t}Oe.prototype.addListener=function(e,r){return _o(this,e,r,!1)};Oe.prototype.on=Oe.prototype.addListener;Oe.prototype.prependListener=function(e,r){return _o(this,e,r,!0)};function Jc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bo(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Jc.bind(i);return n.listener=r,i.wrapFn=n,n}Oe.prototype.once=function(e,r){return si(r),this.on(e,bo(this,e,r)),this};Oe.prototype.prependOnceListener=function(e,r){return si(r),this.prependListener(e,bo(this,e,r)),this};Oe.prototype.removeListener=function(e,r){var i,n,h,g,d;if(si(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(h=-1,g=i.length-1;g>=0;g--)if(i[g]===r||i[g].listener===r){d=i[g].listener,h=g;break}if(h<0)return this;h===0?i.shift():Xc(i,h),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,d||r)}return this};Oe.prototype.off=Oe.prototype.removeListener;Oe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var h=Object.keys(i),g;for(n=0;n<h.length;++n)g=h[n],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function mo(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Zc(n):wo(n,n.length)}Oe.prototype.listeners=function(e){return mo(this,e,!0)};Oe.prototype.rawListeners=function(e){return mo(this,e,!1)};Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):vo.call(t,e)};Oe.prototype.listenerCount=vo;function vo(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Zr(this._events):[]};function wo(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Xc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Zc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Qc(t,e){return new Promise(function(r,i){function n(g){t.removeListener(e,h),i(g)}function h(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Eo(t,e,h,{once:!0}),e!=="error"&&eu(t,n,{once:!0})})}function eu(t,e,r){typeof t.on=="function"&&Eo(t,"error",e,r)}function Eo(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(h){i.once&&t.removeEventListener(e,n),r(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var oi={},tn={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,i,n,h,g,d,y,E,O,A,$,C,N,K,H,W,m,x,b,w,S,o;(function(p){var B=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(s(B,s(t.exports)));function s(f,l){return f!==B&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,f){s.__proto__=f}||function(s,f){for(var l in f)f.hasOwnProperty(l)&&(s[l]=f[l])};e=function(s,f){B(s,f);function l(){this.constructor=s}s.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(s){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(s[c]=f[c])}return s},i=function(s,f){var l={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&f.indexOf(_)<0&&(l[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(s);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(s,_[c])&&(l[_[c]]=s[_[c]]);return l},n=function(s,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,f,l,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(a=(c<3?D(a):c>3?D(f,l,a):D(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},h=function(s,f){return function(l,_){f(l,_,s)}},g=function(s,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,f)},d=function(s,f,l,_){function c(a){return a instanceof l?a:new l(function(D){D(a)})}return new(l||(l=Promise))(function(a,D){function P(U){try{v(_.next(U))}catch(z){D(z)}}function L(U){try{v(_.throw(U))}catch(z){D(z)}}function v(U){U.done?a(U.value):c(U.value).then(P,L)}v((_=_.apply(s,f||[])).next())})},y=function(s,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(s,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},o=function(s,f,l,_){_===void 0&&(_=l),s[_]=f[l]},E=function(s,f){for(var l in s)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=s[l])},O=function(s){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&s[f],_=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,f){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var _=l.call(s),c,a=[],D;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(P){D={error:P}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(D)throw D.error}}return a},$=function(){for(var s=[],f=0;f<arguments.length;f++)s=s.concat(A(arguments[f]));return s},C=function(){for(var s=0,f=0,l=arguments.length;f<l;f++)s+=arguments[f].length;for(var _=Array(s),c=0,f=0;f<l;f++)for(var a=arguments[f],D=0,P=a.length;D<P;D++,c++)_[c]=a[D];return _},N=function(s){return this instanceof N?(this.v=s,this):new N(s)},K=function(s,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(s,f||[]),c,a=[];return c={},D("next"),D("throw"),D("return"),c[Symbol.asyncIterator]=function(){return this},c;function D(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||P(q,V)})})}function P(q,V){try{L(_[q](V))}catch(Q){z(a[0][3],Q)}}function L(q){q.value instanceof N?Promise.resolve(q.value.v).then(v,U):z(a[0][2],q)}function v(q){P("next",q)}function U(q){P("throw",q)}function z(q,V){q(V),a.shift(),a.length&&P(a[0][0],a[0][1])}},H=function(s){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=s[c]?function(D){return(l=!l)?{value:N(s[c](D)),done:c==="return"}:a?a(D):D}:a}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=s[Symbol.asyncIterator],l;return f?f.call(s):(s=typeof O=="function"?O(s):s[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=s[a]&&function(D){return new Promise(function(P,L){D=s[a](D),c(P,L,D.done,D.value)})}}function c(a,D,P,L){Promise.resolve(L).then(function(v){a({value:v,done:P})},D)}},m=function(s,f){return Object.defineProperty?Object.defineProperty(s,"raw",{value:f}):s.raw=f,s},x=function(s){if(s&&s.__esModule)return s;var f={};if(s!=null)for(var l in s)Object.hasOwnProperty.call(s,l)&&(f[l]=s[l]);return f.default=s,f},b=function(s){return s&&s.__esModule?s:{default:s}},w=function(s,f){if(!f.has(s))throw new TypeError("attempted to get private field on non-instance");return f.get(s)},S=function(s,f,l){if(!f.has(s))throw new TypeError("attempted to set private field on non-instance");return f.set(s,l),l},p("__extends",e),p("__assign",r),p("__rest",i),p("__decorate",n),p("__param",h),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",o),p("__values",O),p("__read",A),p("__spread",$),p("__spreadArrays",C),p("__await",N),p("__asyncGenerator",K),p("__asyncDelegator",H),p("__asyncValues",W),p("__makeTemplateObject",m),p("__importStar",x),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",S)})})(tn);var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function tu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Ar.safeJsonParse=tu;function ru(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Ar.safeJsonStringify=ru;var pr={exports:{}},Mn;function iu(){return Mn||(Mn=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ae<"u"&&Ae.localStorage?pr.exports=Ae.localStorage:typeof window<"u"&&window.localStorage?pr.exports=window.localStorage:pr.exports=new e}()),pr.exports}var wi={},gr={},$n;function nu(){if($n)return gr;$n=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.IKeyValueStorage=void 0;class t{}return gr.IKeyValueStorage=t,gr}var yr={},Hn;function su(){if(Hn)return yr;Hn=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.parseEntry=void 0;const t=Ar;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return yr.parseEntry=e,yr}var Bn;function ou(){return Bn||(Bn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=tn.exports;e.__exportStar(nu(),t),e.__exportStar(su(),t)}(wi)),wi}Object.defineProperty(oi,"__esModule",{value:!0});oi.KeyValueStorage=void 0;const or=tn.exports,qn=Ar,au=or.__importDefault(iu()),cu=ou();class Do{constructor(){this.localStorage=au.default}getKeys(){return or.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return or.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(cu.parseEntry)})}getItem(e){return or.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return qn.safeJsonParse(r)})}setItem(e,r){return or.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,qn.safeJsonStringify(r))})}removeItem(e){return or.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}oi.KeyValueStorage=Do;var uu=oi.default=Do,Nr={},Cr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,i,n,h,g,d,y,E,O,A,$,C,N,K,H,W,m,x,b,w,S,o;(function(p){var B=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(s(B,s(t.exports)));function s(f,l){return f!==B&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,f){s.__proto__=f}||function(s,f){for(var l in f)f.hasOwnProperty(l)&&(s[l]=f[l])};e=function(s,f){B(s,f);function l(){this.constructor=s}s.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(s){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(s[c]=f[c])}return s},i=function(s,f){var l={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&f.indexOf(_)<0&&(l[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(s);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(s,_[c])&&(l[_[c]]=s[_[c]]);return l},n=function(s,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,f,l,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(a=(c<3?D(a):c>3?D(f,l,a):D(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},h=function(s,f){return function(l,_){f(l,_,s)}},g=function(s,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,f)},d=function(s,f,l,_){function c(a){return a instanceof l?a:new l(function(D){D(a)})}return new(l||(l=Promise))(function(a,D){function P(U){try{v(_.next(U))}catch(z){D(z)}}function L(U){try{v(_.throw(U))}catch(z){D(z)}}function v(U){U.done?a(U.value):c(U.value).then(P,L)}v((_=_.apply(s,f||[])).next())})},y=function(s,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(s,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},o=function(s,f,l,_){_===void 0&&(_=l),s[_]=f[l]},E=function(s,f){for(var l in s)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=s[l])},O=function(s){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&s[f],_=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,f){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var _=l.call(s),c,a=[],D;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(P){D={error:P}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(D)throw D.error}}return a},$=function(){for(var s=[],f=0;f<arguments.length;f++)s=s.concat(A(arguments[f]));return s},C=function(){for(var s=0,f=0,l=arguments.length;f<l;f++)s+=arguments[f].length;for(var _=Array(s),c=0,f=0;f<l;f++)for(var a=arguments[f],D=0,P=a.length;D<P;D++,c++)_[c]=a[D];return _},N=function(s){return this instanceof N?(this.v=s,this):new N(s)},K=function(s,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(s,f||[]),c,a=[];return c={},D("next"),D("throw"),D("return"),c[Symbol.asyncIterator]=function(){return this},c;function D(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||P(q,V)})})}function P(q,V){try{L(_[q](V))}catch(Q){z(a[0][3],Q)}}function L(q){q.value instanceof N?Promise.resolve(q.value.v).then(v,U):z(a[0][2],q)}function v(q){P("next",q)}function U(q){P("throw",q)}function z(q,V){q(V),a.shift(),a.length&&P(a[0][0],a[0][1])}},H=function(s){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=s[c]?function(D){return(l=!l)?{value:N(s[c](D)),done:c==="return"}:a?a(D):D}:a}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=s[Symbol.asyncIterator],l;return f?f.call(s):(s=typeof O=="function"?O(s):s[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=s[a]&&function(D){return new Promise(function(P,L){D=s[a](D),c(P,L,D.done,D.value)})}}function c(a,D,P,L){Promise.resolve(L).then(function(v){a({value:v,done:P})},D)}},m=function(s,f){return Object.defineProperty?Object.defineProperty(s,"raw",{value:f}):s.raw=f,s},x=function(s){if(s&&s.__esModule)return s;var f={};if(s!=null)for(var l in s)Object.hasOwnProperty.call(s,l)&&(f[l]=s[l]);return f.default=s,f},b=function(s){return s&&s.__esModule?s:{default:s}},w=function(s,f){if(!f.has(s))throw new TypeError("attempted to get private field on non-instance");return f.get(s)},S=function(s,f,l){if(!f.has(s))throw new TypeError("attempted to set private field on non-instance");return f.set(s,l),l},p("__extends",e),p("__assign",r),p("__rest",i),p("__decorate",n),p("__param",h),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",o),p("__values",O),p("__read",A),p("__spread",$),p("__spreadArrays",C),p("__await",N),p("__asyncGenerator",K),p("__asyncDelegator",H),p("__asyncValues",W),p("__makeTemplateObject",m),p("__importStar",x),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",S)})})(Cr);var _r={},ee={},Rr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,i,n,h,g,d,y,E,O,A,$,C,N,K,H,W,m,x,b,w,S,o;(function(p){var B=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(s(B,s(t.exports)));function s(f,l){return f!==B&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,f){s.__proto__=f}||function(s,f){for(var l in f)f.hasOwnProperty(l)&&(s[l]=f[l])};e=function(s,f){B(s,f);function l(){this.constructor=s}s.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(s){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(s[c]=f[c])}return s},i=function(s,f){var l={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&f.indexOf(_)<0&&(l[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(s);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(s,_[c])&&(l[_[c]]=s[_[c]]);return l},n=function(s,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,f,l,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(a=(c<3?D(a):c>3?D(f,l,a):D(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},h=function(s,f){return function(l,_){f(l,_,s)}},g=function(s,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,f)},d=function(s,f,l,_){function c(a){return a instanceof l?a:new l(function(D){D(a)})}return new(l||(l=Promise))(function(a,D){function P(U){try{v(_.next(U))}catch(z){D(z)}}function L(U){try{v(_.throw(U))}catch(z){D(z)}}function v(U){U.done?a(U.value):c(U.value).then(P,L)}v((_=_.apply(s,f||[])).next())})},y=function(s,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(s,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},o=function(s,f,l,_){_===void 0&&(_=l),s[_]=f[l]},E=function(s,f){for(var l in s)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=s[l])},O=function(s){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&s[f],_=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,f){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var _=l.call(s),c,a=[],D;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(P){D={error:P}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(D)throw D.error}}return a},$=function(){for(var s=[],f=0;f<arguments.length;f++)s=s.concat(A(arguments[f]));return s},C=function(){for(var s=0,f=0,l=arguments.length;f<l;f++)s+=arguments[f].length;for(var _=Array(s),c=0,f=0;f<l;f++)for(var a=arguments[f],D=0,P=a.length;D<P;D++,c++)_[c]=a[D];return _},N=function(s){return this instanceof N?(this.v=s,this):new N(s)},K=function(s,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(s,f||[]),c,a=[];return c={},D("next"),D("throw"),D("return"),c[Symbol.asyncIterator]=function(){return this},c;function D(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||P(q,V)})})}function P(q,V){try{L(_[q](V))}catch(Q){z(a[0][3],Q)}}function L(q){q.value instanceof N?Promise.resolve(q.value.v).then(v,U):z(a[0][2],q)}function v(q){P("next",q)}function U(q){P("throw",q)}function z(q,V){q(V),a.shift(),a.length&&P(a[0][0],a[0][1])}},H=function(s){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=s[c]?function(D){return(l=!l)?{value:N(s[c](D)),done:c==="return"}:a?a(D):D}:a}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=s[Symbol.asyncIterator],l;return f?f.call(s):(s=typeof O=="function"?O(s):s[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=s[a]&&function(D){return new Promise(function(P,L){D=s[a](D),c(P,L,D.done,D.value)})}}function c(a,D,P,L){Promise.resolve(L).then(function(v){a({value:v,done:P})},D)}},m=function(s,f){return Object.defineProperty?Object.defineProperty(s,"raw",{value:f}):s.raw=f,s},x=function(s){if(s&&s.__esModule)return s;var f={};if(s!=null)for(var l in s)Object.hasOwnProperty.call(s,l)&&(f[l]=s[l]);return f.default=s,f},b=function(s){return s&&s.__esModule?s:{default:s}},w=function(s,f){if(!f.has(s))throw new TypeError("attempted to get private field on non-instance");return f.get(s)},S=function(s,f,l){if(!f.has(s))throw new TypeError("attempted to set private field on non-instance");return f.set(s,l),l},p("__extends",e),p("__assign",r),p("__rest",i),p("__decorate",n),p("__param",h),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",o),p("__values",O),p("__read",A),p("__spread",$),p("__spreadArrays",C),p("__await",N),p("__asyncGenerator",K),p("__asyncDelegator",H),p("__asyncValues",W),p("__makeTemplateObject",m),p("__importStar",x),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",S)})})(Rr);var Ei={},br={},zn;function hu(){if(zn)return br;zn=1,Object.defineProperty(br,"__esModule",{value:!0}),br.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return br.delay=t,br}var Wt={},Di={},kt={},Kn;function fu(){return Kn||(Kn=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.ONE_THOUSAND=kt.ONE_HUNDRED=void 0,kt.ONE_HUNDRED=100,kt.ONE_THOUSAND=1e3),kt}var Si={},Vn;function lu(){return Vn||(Vn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Si)),Si}var Gn;function So(){return Gn||(Gn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(fu(),t),e.__exportStar(lu(),t)}(Di)),Di}var Wn;function du(){if(Wn)return Wt;Wn=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.fromMiliseconds=Wt.toMiliseconds=void 0;const t=So();function e(i){return i*t.ONE_THOUSAND}Wt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Wt.fromMiliseconds=r,Wt}var kn;function pu(){return kn||(kn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(hu(),t),e.__exportStar(du(),t)}(Ei)),Ei}var sr={},Yn;function gu(){if(Yn)return sr;Yn=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return sr.Watch=t,sr.default=t,sr}var Oi={},mr={},Jn;function yu(){if(Jn)return mr;Jn=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IWatch=void 0;class t{}return mr.IWatch=t,mr}var Xn;function _u(){return Xn||(Xn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Rr.exports.__exportStar(yu(),t)}(Oi)),Oi}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(pu(),t),e.__exportStar(gu(),t),e.__exportStar(_u(),t),e.__exportStar(So(),t)})(ee);var Ii={},vr={};class Zt{}const bu=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zt},Symbol.toStringTag,{value:"Module"})),mu=Ic(bu);var Zn;function vu(){if(Zn)return vr;Zn=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IHeartBeat=void 0;const t=mu;class e extends t.IEvents{constructor(i){super()}}return vr.IHeartBeat=e,vr}var Qn;function Oo(){return Qn||(Qn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.exports.__exportStar(vu(),t)}(Ii)),Ii}var xi={},Yt={},es;function wu(){if(es)return Yt;es=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.HEARTBEAT_EVENTS=Yt.HEARTBEAT_INTERVAL=void 0;const t=ee;return Yt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Yt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yt}var ts;function Io(){return ts||(ts=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.exports.__exportStar(wu(),t)}(xi)),xi}var rs;function Eu(){if(rs)return _r;rs=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.HeartBeat=void 0;const t=Cr.exports,e=st.exports,r=ee,i=Oo(),n=Io();class h extends i.IHeartBeat{constructor(d){super(d),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=d?.interval||n.HEARTBEAT_INTERVAL}static init(d){return t.__awaiter(this,void 0,void 0,function*(){const y=new h(d);return yield y.init(),y})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,y){this.events.on(d,y)}once(d,y){this.events.once(d,y)}off(d,y){this.events.off(d,y)}removeListener(d,y){this.events.removeListener(d,y)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return _r.HeartBeat=h,_r}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr.exports;e.__exportStar(Eu(),t),e.__exportStar(Oo(),t),e.__exportStar(Io(),t)})(Nr);var Se={},xo={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,i,n,h,g,d,y,E,O,A,$,C,N,K,H,W,m,x,b,w,S,o;(function(p){var B=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(s(B,s(t.exports)));function s(f,l){return f!==B&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,f){s.__proto__=f}||function(s,f){for(var l in f)f.hasOwnProperty(l)&&(s[l]=f[l])};e=function(s,f){B(s,f);function l(){this.constructor=s}s.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(s){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(s[c]=f[c])}return s},i=function(s,f){var l={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&f.indexOf(_)<0&&(l[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(s);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(s,_[c])&&(l[_[c]]=s[_[c]]);return l},n=function(s,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,f,l,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(a=(c<3?D(a):c>3?D(f,l,a):D(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},h=function(s,f){return function(l,_){f(l,_,s)}},g=function(s,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,f)},d=function(s,f,l,_){function c(a){return a instanceof l?a:new l(function(D){D(a)})}return new(l||(l=Promise))(function(a,D){function P(U){try{v(_.next(U))}catch(z){D(z)}}function L(U){try{v(_.throw(U))}catch(z){D(z)}}function v(U){U.done?a(U.value):c(U.value).then(P,L)}v((_=_.apply(s,f||[])).next())})},y=function(s,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(s,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},o=function(s,f,l,_){_===void 0&&(_=l),s[_]=f[l]},E=function(s,f){for(var l in s)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=s[l])},O=function(s){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&s[f],_=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,f){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var _=l.call(s),c,a=[],D;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(P){D={error:P}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(D)throw D.error}}return a},$=function(){for(var s=[],f=0;f<arguments.length;f++)s=s.concat(A(arguments[f]));return s},C=function(){for(var s=0,f=0,l=arguments.length;f<l;f++)s+=arguments[f].length;for(var _=Array(s),c=0,f=0;f<l;f++)for(var a=arguments[f],D=0,P=a.length;D<P;D++,c++)_[c]=a[D];return _},N=function(s){return this instanceof N?(this.v=s,this):new N(s)},K=function(s,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(s,f||[]),c,a=[];return c={},D("next"),D("throw"),D("return"),c[Symbol.asyncIterator]=function(){return this},c;function D(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||P(q,V)})})}function P(q,V){try{L(_[q](V))}catch(Q){z(a[0][3],Q)}}function L(q){q.value instanceof N?Promise.resolve(q.value.v).then(v,U):z(a[0][2],q)}function v(q){P("next",q)}function U(q){P("throw",q)}function z(q,V){q(V),a.shift(),a.length&&P(a[0][0],a[0][1])}},H=function(s){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=s[c]?function(D){return(l=!l)?{value:N(s[c](D)),done:c==="return"}:a?a(D):D}:a}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=s[Symbol.asyncIterator],l;return f?f.call(s):(s=typeof O=="function"?O(s):s[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=s[a]&&function(D){return new Promise(function(P,L){D=s[a](D),c(P,L,D.done,D.value)})}}function c(a,D,P,L){Promise.resolve(L).then(function(v){a({value:v,done:P})},D)}},m=function(s,f){return Object.defineProperty?Object.defineProperty(s,"raw",{value:f}):s.raw=f,s},x=function(s){if(s&&s.__esModule)return s;var f={};if(s!=null)for(var l in s)Object.hasOwnProperty.call(s,l)&&(f[l]=s[l]);return f.default=s,f},b=function(s){return s&&s.__esModule?s:{default:s}},w=function(s,f){if(!f.has(s))throw new TypeError("attempted to get private field on non-instance");return f.get(s)},S=function(s,f,l){if(!f.has(s))throw new TypeError("attempted to set private field on non-instance");return f.set(s,l),l},p("__extends",e),p("__assign",r),p("__rest",i),p("__decorate",n),p("__param",h),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",o),p("__values",O),p("__read",A),p("__spread",$),p("__spreadArrays",C),p("__await",N),p("__asyncGenerator",K),p("__asyncDelegator",H),p("__asyncValues",W),p("__makeTemplateObject",m),p("__importStar",x),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",S)})})(xo);var Jt={},is;function Po(){return is||(is=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.PINO_CUSTOM_CONTEXT_KEY=Jt.PINO_LOGGER_DEFAULTS=void 0,Jt.PINO_LOGGER_DEFAULTS={level:"info"},Jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Jt}var ot={},ns;function Du(){if(ns)return ot;ns=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Po();function e(d){return Object.assign(Object.assign({},d),{level:d?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(d,y=t.PINO_CUSTOM_CONTEXT_KEY){return d[y]||""}ot.getBrowserLoggerContext=r;function i(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){return d[E]=y,d}ot.setBrowserLoggerContext=i;function n(d,y=t.PINO_CUSTOM_CONTEXT_KEY){let E="";return typeof d.bindings>"u"?E=r(d,y):E=d.bindings().context||"",E}ot.getLoggerContext=n;function h(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){const O=n(d,E);return O.trim()?`${O}/${y}`:y}ot.formatChildLoggerContext=h;function g(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){const O=h(d,y,E),A=d.child({context:O});return i(A,O,E)}return ot.generateChildLogger=g,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=xo.exports,r=e.__importDefault(Tr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Po(),t),e.__exportStar(Du(),t)})(Se);class Su extends Zt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Ou extends Zt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Iu{constructor(e,r){this.logger=e,this.core=r}}class xu extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Pu extends Zt{constructor(e){super()}}class Tu{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Au extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Nu extends Zt{constructor(e,r){super(),this.core=e,this.logger=r}}class Cu{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Ru{constructor(e){this.client=e}}function Fu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Lu(t){return typeof t=="string"?t:JSON.stringify(t)}var rn={},cr={},ai={},ci={};Object.defineProperty(ci,"__esModule",{value:!0});ci.BrowserRandomSource=void 0;const ss=65536;class Uu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=ss)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,ss)));return r}}ci.BrowserRandomSource=Uu;var ui={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function ju(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=ju;Object.defineProperty(ui,"__esModule",{value:!0});ui.NodeRandomSource=void 0;const Mu=pt;class $u{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof xc<"u"){const e=Pc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Mu.wipe)(r),i}}ui.NodeRandomSource=$u;Object.defineProperty(ai,"__esModule",{value:!0});ai.SystemRandomSource=void 0;const Hu=ci,Bu=ui;class qu{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Hu.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Bu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ai.SystemRandomSource=qu;var ie={},To={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(d,y){var E=d>>>16&65535,O=d&65535,A=y>>>16&65535,$=y&65535;return O*$+(E*$+O*A<<16>>>0)|0}t.mul=Math.imul||e;function r(d,y){return d+y|0}t.add=r;function i(d,y){return d-y|0}t.sub=i;function n(d,y){return d<<y|d>>>32-y}t.rotl=n;function h(d,y){return d<<32-y|d>>>y}t.rotr=h;function g(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}t.isInteger=Number.isInteger||g,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(d){return t.isInteger(d)&&d>=-t.MAX_SAFE_INTEGER&&d<=t.MAX_SAFE_INTEGER}})(To);Object.defineProperty(ie,"__esModule",{value:!0});var Ao=To;function zu(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ie.readInt16BE=zu;function Ku(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ie.readUint16BE=Ku;function Vu(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ie.readInt16LE=Vu;function Gu(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ie.readUint16LE=Gu;function No(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ie.writeUint16BE=No;ie.writeInt16BE=No;function Co(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ie.writeUint16LE=Co;ie.writeInt16LE=Co;function ji(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ie.readInt32BE=ji;function Mi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ie.readUint32BE=Mi;function $i(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ie.readInt32LE=$i;function Hi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ie.readUint32LE=Hi;function ei(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ie.writeUint32BE=ei;ie.writeInt32BE=ei;function ti(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ie.writeUint32LE=ti;ie.writeInt32LE=ti;function Wu(t,e){e===void 0&&(e=0);var r=ji(t,e),i=ji(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=Wu;function ku(t,e){e===void 0&&(e=0);var r=Mi(t,e),i=Mi(t,e+4);return r*4294967296+i}ie.readUint64BE=ku;function Yu(t,e){e===void 0&&(e=0);var r=$i(t,e),i=$i(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ie.readInt64LE=Yu;function Ju(t,e){e===void 0&&(e=0);var r=Hi(t,e),i=Hi(t,e+4);return i*4294967296+r}ie.readUint64LE=Ju;function Ro(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ei(t/4294967296>>>0,e,r),ei(t>>>0,e,r+4),e}ie.writeUint64BE=Ro;ie.writeInt64BE=Ro;function Fo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ti(t>>>0,e,r),ti(t/4294967296>>>0,e,r+4),e}ie.writeUint64LE=Fo;ie.writeInt64LE=Fo;function Xu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,h=t/8+r-1;h>=r;h--)i+=e[h]*n,n*=256;return i}ie.readUintBE=Xu;function Zu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,h=r;h<r+t/8;h++)i+=e[h]*n,n*=256;return i}ie.readUintLE=Zu;function Qu(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ao.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,h=t/8+i-1;h>=i;h--)r[h]=e/n&255,n*=256;return r}ie.writeUintBE=Qu;function eh(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ao.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,h=i;h<i+t/8;h++)r[h]=e/n&255,n*=256;return r}ie.writeUintLE=eh;function th(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ie.readFloat32BE=th;function rh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ie.readFloat32LE=rh;function ih(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ie.readFloat64BE=ih;function nh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ie.readFloat64LE=nh;function sh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ie.writeFloat32BE=sh;function oh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ie.writeFloat32LE=oh;function ah(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ie.writeFloat64BE=ah;function ch(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ie.writeFloat64LE=ch;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ai,r=ie,i=pt;t.defaultRandomSource=new e.SystemRandomSource;function n(E,O=t.defaultRandomSource){return O.randomBytes(E)}t.randomBytes=n;function h(E=t.defaultRandomSource){const O=n(4,E),A=(0,r.readUint32LE)(O);return(0,i.wipe)(O),A}t.randomUint32=h;const g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(E,O=g,A=t.defaultRandomSource){if(O.length<2)throw new Error("randomString charset is too short");if(O.length>256)throw new Error("randomString charset is too long");let $="";const C=O.length,N=256-256%C;for(;E>0;){const K=n(Math.ceil(E*256/N),A);for(let H=0;H<K.length&&E>0;H++){const W=K[H];W<N&&($+=O.charAt(W%C),E--)}(0,i.wipe)(K)}return $}t.randomString=d;function y(E,O=g,A=t.defaultRandomSource){const $=Math.ceil(E/(Math.log(O.length)/Math.LN2));return d($,O,A)}t.randomStringForEntropy=y})(cr);var Lo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function d(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(y,E){if(E===void 0&&(E=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var O=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&E>0;)this._buffer[this._bufferLength++]=y[O++],E--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(O=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,O,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=y[O++],E--;return this},d.prototype.finish=function(y){if(!this._finished){var E=this._bytesHashed,O=this._bufferLength,A=E/536870912|0,$=E<<3,C=E%128<112?128:256;this._buffer[O]=128;for(var N=O+1;N<C-8;N++)this._buffer[N]=0;e.writeUint32BE(A,this._buffer,C-8),e.writeUint32BE($,this._buffer,C-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,C),this._finished=!0}for(var N=0;N<this.digestLength/8;N++)e.writeUint32BE(this._stateHi[N],y,N*8),e.writeUint32BE(this._stateLo[N],y,N*8+4);return this},d.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(y){r.wipe(y.stateHi),r.wipe(y.stateLo),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},d}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(d,y,E,O,A,$,C){for(var N=E[0],K=E[1],H=E[2],W=E[3],m=E[4],x=E[5],b=E[6],w=E[7],S=O[0],o=O[1],p=O[2],B=O[3],s=O[4],f=O[5],l=O[6],_=O[7],c,a,D,P,L,v,U,z;C>=128;){for(var q=0;q<16;q++){var V=8*q+$;d[q]=e.readUint32BE(A,V),y[q]=e.readUint32BE(A,V+4)}for(var q=0;q<80;q++){var Q=N,Y=K,ae=H,M=W,j=m,R=x,u=b,T=w,k=S,X=o,fe=p,_e=B,de=s,ve=f,Ue=l,Ce=_;if(c=w,a=_,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=(m>>>14|s<<32-14)^(m>>>18|s<<32-18)^(s>>>41-32|m<<32-(41-32)),a=(s>>>14|m<<32-14)^(s>>>18|m<<32-18)^(m>>>41-32|s<<32-(41-32)),L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,c=m&x^~m&b,a=s&f^~s&l,L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,c=n[q*2],a=n[q*2+1],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,c=d[q%16],a=y[q%16],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,D=U&65535|z<<16,P=L&65535|v<<16,c=D,a=P,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=(N>>>28|S<<32-28)^(S>>>34-32|N<<32-(34-32))^(S>>>39-32|N<<32-(39-32)),a=(S>>>28|N<<32-28)^(N>>>34-32|S<<32-(34-32))^(N>>>39-32|S<<32-(39-32)),L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,c=N&K^N&H^K&H,a=S&o^S&p^o&p,L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,T=U&65535|z<<16,Ce=L&65535|v<<16,c=M,a=_e,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=D,a=P,L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,M=U&65535|z<<16,_e=L&65535|v<<16,K=Q,H=Y,W=ae,m=M,x=j,b=R,w=u,N=T,o=k,p=X,B=fe,s=_e,f=de,l=ve,_=Ue,S=Ce,q%16===15)for(var V=0;V<16;V++)c=d[V],a=y[V],L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=d[(V+9)%16],a=y[(V+9)%16],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,D=d[(V+1)%16],P=y[(V+1)%16],c=(D>>>1|P<<32-1)^(D>>>8|P<<32-8)^D>>>7,a=(P>>>1|D<<32-1)^(P>>>8|D<<32-8)^(P>>>7|D<<32-7),L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,D=d[(V+14)%16],P=y[(V+14)%16],c=(D>>>19|P<<32-19)^(P>>>61-32|D<<32-(61-32))^D>>>6,a=(P>>>19|D<<32-19)^(D>>>61-32|P<<32-(61-32))^(P>>>6|D<<32-6),L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,d[V]=U&65535|z<<16,y[V]=L&65535|v<<16}c=N,a=S,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[0],a=O[0],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[0]=N=U&65535|z<<16,O[0]=S=L&65535|v<<16,c=K,a=o,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[1],a=O[1],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[1]=K=U&65535|z<<16,O[1]=o=L&65535|v<<16,c=H,a=p,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[2],a=O[2],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[2]=H=U&65535|z<<16,O[2]=p=L&65535|v<<16,c=W,a=B,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[3],a=O[3],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[3]=W=U&65535|z<<16,O[3]=B=L&65535|v<<16,c=m,a=s,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[4],a=O[4],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[4]=m=U&65535|z<<16,O[4]=s=L&65535|v<<16,c=x,a=f,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[5],a=O[5],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[5]=x=U&65535|z<<16,O[5]=f=L&65535|v<<16,c=b,a=l,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[6],a=O[6],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[6]=b=U&65535|z<<16,O[6]=l=L&65535|v<<16,c=w,a=_,L=a&65535,v=a>>>16,U=c&65535,z=c>>>16,c=E[7],a=O[7],L+=a&65535,v+=a>>>16,U+=c&65535,z+=c>>>16,v+=L>>>16,U+=v>>>16,z+=U>>>16,E[7]=w=U&65535|z<<16,O[7]=_=L&65535|v<<16,$+=128,C-=128}return $}function g(d){var y=new i;y.update(d);var E=y.digest();return y.clean(),E}t.hash=g})(Lo);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=cr,r=Lo,i=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(M){const j=new Float64Array(16);if(M)for(let R=0;R<M.length;R++)j[R]=M[R];return j}const h=new Uint8Array(32);h[0]=9;const g=n(),d=n([1]),y=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),O=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function C(M,j){for(let R=0;R<16;R++)M[R]=j[R]|0}function N(M){let j=1;for(let R=0;R<16;R++){let u=M[R]+j+65535;j=Math.floor(u/65536),M[R]=u-j*65536}M[0]+=j-1+37*(j-1)}function K(M,j,R){const u=~(R-1);for(let T=0;T<16;T++){const k=u&(M[T]^j[T]);M[T]^=k,j[T]^=k}}function H(M,j){const R=n(),u=n();for(let T=0;T<16;T++)u[T]=j[T];N(u),N(u),N(u);for(let T=0;T<2;T++){R[0]=u[0]-65517;for(let X=1;X<15;X++)R[X]=u[X]-65535-(R[X-1]>>16&1),R[X-1]&=65535;R[15]=u[15]-32767-(R[14]>>16&1);const k=R[15]>>16&1;R[14]&=65535,K(u,R,1-k)}for(let T=0;T<16;T++)M[2*T]=u[T]&255,M[2*T+1]=u[T]>>8}function W(M,j){let R=0;for(let u=0;u<32;u++)R|=M[u]^j[u];return(1&R-1>>>8)-1}function m(M,j){const R=new Uint8Array(32),u=new Uint8Array(32);return H(R,M),H(u,j),W(R,u)}function x(M){const j=new Uint8Array(32);return H(j,M),j[0]&1}function b(M,j){for(let R=0;R<16;R++)M[R]=j[2*R]+(j[2*R+1]<<8);M[15]&=32767}function w(M,j,R){for(let u=0;u<16;u++)M[u]=j[u]+R[u]}function S(M,j,R){for(let u=0;u<16;u++)M[u]=j[u]-R[u]}function o(M,j,R){let u,T,k=0,X=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,te=0,he=0,ge=0,re=0,be=0,me=0,Ee=0,De=0,we=0,mt=0,Et=0,Rt=0,lt=0,zt=0,fr=0,Hr=0,Me=R[0],Re=R[1],$e=R[2],He=R[3],Be=R[4],Fe=R[5],Ke=R[6],Ve=R[7],Ge=R[8],We=R[9],ke=R[10],ze=R[11],qe=R[12],Te=R[13],Ye=R[14],Je=R[15];u=j[0],k+=u*Me,X+=u*Re,fe+=u*$e,_e+=u*He,de+=u*Be,ve+=u*Fe,Ue+=u*Ke,Ce+=u*Ve,ye+=u*Ge,pe+=u*We,le+=u*ke,ue+=u*ze,ce+=u*qe,oe+=u*Te,se+=u*Ye,te+=u*Je,u=j[1],X+=u*Me,fe+=u*Re,_e+=u*$e,de+=u*He,ve+=u*Be,Ue+=u*Fe,Ce+=u*Ke,ye+=u*Ve,pe+=u*Ge,le+=u*We,ue+=u*ke,ce+=u*ze,oe+=u*qe,se+=u*Te,te+=u*Ye,he+=u*Je,u=j[2],fe+=u*Me,_e+=u*Re,de+=u*$e,ve+=u*He,Ue+=u*Be,Ce+=u*Fe,ye+=u*Ke,pe+=u*Ve,le+=u*Ge,ue+=u*We,ce+=u*ke,oe+=u*ze,se+=u*qe,te+=u*Te,he+=u*Ye,ge+=u*Je,u=j[3],_e+=u*Me,de+=u*Re,ve+=u*$e,Ue+=u*He,Ce+=u*Be,ye+=u*Fe,pe+=u*Ke,le+=u*Ve,ue+=u*Ge,ce+=u*We,oe+=u*ke,se+=u*ze,te+=u*qe,he+=u*Te,ge+=u*Ye,re+=u*Je,u=j[4],de+=u*Me,ve+=u*Re,Ue+=u*$e,Ce+=u*He,ye+=u*Be,pe+=u*Fe,le+=u*Ke,ue+=u*Ve,ce+=u*Ge,oe+=u*We,se+=u*ke,te+=u*ze,he+=u*qe,ge+=u*Te,re+=u*Ye,be+=u*Je,u=j[5],ve+=u*Me,Ue+=u*Re,Ce+=u*$e,ye+=u*He,pe+=u*Be,le+=u*Fe,ue+=u*Ke,ce+=u*Ve,oe+=u*Ge,se+=u*We,te+=u*ke,he+=u*ze,ge+=u*qe,re+=u*Te,be+=u*Ye,me+=u*Je,u=j[6],Ue+=u*Me,Ce+=u*Re,ye+=u*$e,pe+=u*He,le+=u*Be,ue+=u*Fe,ce+=u*Ke,oe+=u*Ve,se+=u*Ge,te+=u*We,he+=u*ke,ge+=u*ze,re+=u*qe,be+=u*Te,me+=u*Ye,Ee+=u*Je,u=j[7],Ce+=u*Me,ye+=u*Re,pe+=u*$e,le+=u*He,ue+=u*Be,ce+=u*Fe,oe+=u*Ke,se+=u*Ve,te+=u*Ge,he+=u*We,ge+=u*ke,re+=u*ze,be+=u*qe,me+=u*Te,Ee+=u*Ye,De+=u*Je,u=j[8],ye+=u*Me,pe+=u*Re,le+=u*$e,ue+=u*He,ce+=u*Be,oe+=u*Fe,se+=u*Ke,te+=u*Ve,he+=u*Ge,ge+=u*We,re+=u*ke,be+=u*ze,me+=u*qe,Ee+=u*Te,De+=u*Ye,we+=u*Je,u=j[9],pe+=u*Me,le+=u*Re,ue+=u*$e,ce+=u*He,oe+=u*Be,se+=u*Fe,te+=u*Ke,he+=u*Ve,ge+=u*Ge,re+=u*We,be+=u*ke,me+=u*ze,Ee+=u*qe,De+=u*Te,we+=u*Ye,mt+=u*Je,u=j[10],le+=u*Me,ue+=u*Re,ce+=u*$e,oe+=u*He,se+=u*Be,te+=u*Fe,he+=u*Ke,ge+=u*Ve,re+=u*Ge,be+=u*We,me+=u*ke,Ee+=u*ze,De+=u*qe,we+=u*Te,mt+=u*Ye,Et+=u*Je,u=j[11],ue+=u*Me,ce+=u*Re,oe+=u*$e,se+=u*He,te+=u*Be,he+=u*Fe,ge+=u*Ke,re+=u*Ve,be+=u*Ge,me+=u*We,Ee+=u*ke,De+=u*ze,we+=u*qe,mt+=u*Te,Et+=u*Ye,Rt+=u*Je,u=j[12],ce+=u*Me,oe+=u*Re,se+=u*$e,te+=u*He,he+=u*Be,ge+=u*Fe,re+=u*Ke,be+=u*Ve,me+=u*Ge,Ee+=u*We,De+=u*ke,we+=u*ze,mt+=u*qe,Et+=u*Te,Rt+=u*Ye,lt+=u*Je,u=j[13],oe+=u*Me,se+=u*Re,te+=u*$e,he+=u*He,ge+=u*Be,re+=u*Fe,be+=u*Ke,me+=u*Ve,Ee+=u*Ge,De+=u*We,we+=u*ke,mt+=u*ze,Et+=u*qe,Rt+=u*Te,lt+=u*Ye,zt+=u*Je,u=j[14],se+=u*Me,te+=u*Re,he+=u*$e,ge+=u*He,re+=u*Be,be+=u*Fe,me+=u*Ke,Ee+=u*Ve,De+=u*Ge,we+=u*We,mt+=u*ke,Et+=u*ze,Rt+=u*qe,lt+=u*Te,zt+=u*Ye,fr+=u*Je,u=j[15],te+=u*Me,he+=u*Re,ge+=u*$e,re+=u*He,be+=u*Be,me+=u*Fe,Ee+=u*Ke,De+=u*Ve,we+=u*Ge,mt+=u*We,Et+=u*ke,Rt+=u*ze,lt+=u*qe,zt+=u*Te,fr+=u*Ye,Hr+=u*Je,k+=38*he,X+=38*ge,fe+=38*re,_e+=38*be,de+=38*me,ve+=38*Ee,Ue+=38*De,Ce+=38*we,ye+=38*mt,pe+=38*Et,le+=38*Rt,ue+=38*lt,ce+=38*zt,oe+=38*fr,se+=38*Hr,T=1,u=k+T+65535,T=Math.floor(u/65536),k=u-T*65536,u=X+T+65535,T=Math.floor(u/65536),X=u-T*65536,u=fe+T+65535,T=Math.floor(u/65536),fe=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=de+T+65535,T=Math.floor(u/65536),de=u-T*65536,u=ve+T+65535,T=Math.floor(u/65536),ve=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=pe+T+65535,T=Math.floor(u/65536),pe=u-T*65536,u=le+T+65535,T=Math.floor(u/65536),le=u-T*65536,u=ue+T+65535,T=Math.floor(u/65536),ue=u-T*65536,u=ce+T+65535,T=Math.floor(u/65536),ce=u-T*65536,u=oe+T+65535,T=Math.floor(u/65536),oe=u-T*65536,u=se+T+65535,T=Math.floor(u/65536),se=u-T*65536,u=te+T+65535,T=Math.floor(u/65536),te=u-T*65536,k+=T-1+37*(T-1),T=1,u=k+T+65535,T=Math.floor(u/65536),k=u-T*65536,u=X+T+65535,T=Math.floor(u/65536),X=u-T*65536,u=fe+T+65535,T=Math.floor(u/65536),fe=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=de+T+65535,T=Math.floor(u/65536),de=u-T*65536,u=ve+T+65535,T=Math.floor(u/65536),ve=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=pe+T+65535,T=Math.floor(u/65536),pe=u-T*65536,u=le+T+65535,T=Math.floor(u/65536),le=u-T*65536,u=ue+T+65535,T=Math.floor(u/65536),ue=u-T*65536,u=ce+T+65535,T=Math.floor(u/65536),ce=u-T*65536,u=oe+T+65535,T=Math.floor(u/65536),oe=u-T*65536,u=se+T+65535,T=Math.floor(u/65536),se=u-T*65536,u=te+T+65535,T=Math.floor(u/65536),te=u-T*65536,k+=T-1+37*(T-1),M[0]=k,M[1]=X,M[2]=fe,M[3]=_e,M[4]=de,M[5]=ve,M[6]=Ue,M[7]=Ce,M[8]=ye,M[9]=pe,M[10]=le,M[11]=ue,M[12]=ce,M[13]=oe,M[14]=se,M[15]=te}function p(M,j){o(M,j,j)}function B(M,j){const R=n();let u;for(u=0;u<16;u++)R[u]=j[u];for(u=253;u>=0;u--)p(R,R),u!==2&&u!==4&&o(R,R,j);for(u=0;u<16;u++)M[u]=R[u]}function s(M,j){const R=n();let u;for(u=0;u<16;u++)R[u]=j[u];for(u=250;u>=0;u--)p(R,R),u!==1&&o(R,R,j);for(u=0;u<16;u++)M[u]=R[u]}function f(M,j){const R=n(),u=n(),T=n(),k=n(),X=n(),fe=n(),_e=n(),de=n(),ve=n();S(R,M[1],M[0]),S(ve,j[1],j[0]),o(R,R,ve),w(u,M[0],M[1]),w(ve,j[0],j[1]),o(u,u,ve),o(T,M[3],j[3]),o(T,T,E),o(k,M[2],j[2]),w(k,k,k),S(X,u,R),S(fe,k,T),w(_e,k,T),w(de,u,R),o(M[0],X,fe),o(M[1],de,_e),o(M[2],_e,fe),o(M[3],X,de)}function l(M,j,R){for(let u=0;u<4;u++)K(M[u],j[u],R)}function _(M,j){const R=n(),u=n(),T=n();B(T,j[2]),o(R,j[0],T),o(u,j[1],T),H(M,u),M[31]^=x(R)<<7}function c(M,j,R){C(M[0],g),C(M[1],d),C(M[2],d),C(M[3],g);for(let u=255;u>=0;--u){const T=R[u/8|0]>>(u&7)&1;l(M,j,T),f(j,M),f(M,M),l(M,j,T)}}function a(M,j){const R=[n(),n(),n(),n()];C(R[0],O),C(R[1],A),C(R[2],d),o(R[3],O,A),c(M,R,j)}function D(M){if(M.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const j=(0,r.hash)(M);j[0]&=248,j[31]&=127,j[31]|=64;const R=new Uint8Array(32),u=[n(),n(),n(),n()];a(u,j),_(R,u);const T=new Uint8Array(64);return T.set(M),T.set(R,32),{publicKey:R,secretKey:T}}t.generateKeyPairFromSeed=D;function P(M){const j=(0,e.randomBytes)(32,M),R=D(j);return(0,i.wipe)(j),R}t.generateKeyPair=P;function L(M){if(M.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(M.subarray(32))}t.extractPublicKeyFromSecretKey=L;const v=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function U(M,j){let R,u,T,k;for(u=63;u>=32;--u){for(R=0,T=u-32,k=u-12;T<k;++T)j[T]+=R-16*j[u]*v[T-(u-32)],R=Math.floor((j[T]+128)/256),j[T]-=R*256;j[T]+=R,j[u]=0}for(R=0,T=0;T<32;T++)j[T]+=R-(j[31]>>4)*v[T],R=j[T]>>8,j[T]&=255;for(T=0;T<32;T++)j[T]-=R*v[T];for(u=0;u<32;u++)j[u+1]+=j[u]>>8,M[u]=j[u]&255}function z(M){const j=new Float64Array(64);for(let R=0;R<64;R++)j[R]=M[R];for(let R=0;R<64;R++)M[R]=0;U(M,j)}function q(M,j){const R=new Float64Array(64),u=[n(),n(),n(),n()],T=(0,r.hash)(M.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const k=new Uint8Array(64);k.set(T.subarray(32),32);const X=new r.SHA512;X.update(k.subarray(32)),X.update(j);const fe=X.digest();X.clean(),z(fe),a(u,fe),_(k,u),X.reset(),X.update(k.subarray(0,32)),X.update(M.subarray(32)),X.update(j);const _e=X.digest();z(_e);for(let de=0;de<32;de++)R[de]=fe[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)R[de+ve]+=_e[de]*T[ve];return U(k.subarray(32),R),k}t.sign=q;function V(M,j){const R=n(),u=n(),T=n(),k=n(),X=n(),fe=n(),_e=n();return C(M[2],d),b(M[1],j),p(T,M[1]),o(k,T,y),S(T,T,M[2]),w(k,M[2],k),p(X,k),p(fe,X),o(_e,fe,X),o(R,_e,T),o(R,R,k),s(R,R),o(R,R,T),o(R,R,k),o(R,R,k),o(M[0],R,k),p(u,M[0]),o(u,u,k),m(u,T)&&o(M[0],M[0],$),p(u,M[0]),o(u,u,k),m(u,T)?-1:(x(M[0])===j[31]>>7&&S(M[0],g,M[0]),o(M[3],M[0],M[1]),0)}function Q(M,j,R){const u=new Uint8Array(32),T=[n(),n(),n(),n()],k=[n(),n(),n(),n()];if(R.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(V(k,M))return!1;const X=new r.SHA512;X.update(R.subarray(0,32)),X.update(M),X.update(j);const fe=X.digest();return z(fe),c(T,k,fe),a(k,R.subarray(32)),f(T,k),_(u,T),!W(R,u)}t.verify=Q;function Y(M){let j=[n(),n(),n(),n()];if(V(j,M))throw new Error("Ed25519: invalid public key");let R=n(),u=n(),T=j[1];w(R,d,T),S(u,d,T),B(u,u),o(R,R,u);let k=new Uint8Array(32);return H(k,R),k}t.convertPublicKeyToX25519=Y;function ae(M){const j=(0,r.hash)(M.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const R=new Uint8Array(j.subarray(0,32));return(0,i.wipe)(j),R}t.convertSecretKeyToX25519=ae})(rn);const uh="EdDSA",hh="JWT",Uo=".",jo="base64url",fh="utf8",lh="utf8",dh=":",ph="did",gh="key",os="base58btc",yh="z",_h="K36",bh=32;function Mo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Bi(t,e){e||(e=t.reduce((n,h)=>n+h.length,0));const r=Mo(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}const mh=ho({prefix:"\0",name:"identity",encode:t=>Tc(t),decode:t=>Ac(t)}),vh=Object.freeze(Object.defineProperty({__proto__:null,identity:mh},Symbol.toStringTag,{value:"Module"})),wh=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Eh=Object.freeze(Object.defineProperty({__proto__:null,base2:wh},Symbol.toStringTag,{value:"Module"})),Dh=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Sh=Object.freeze(Object.defineProperty({__proto__:null,base8:Dh},Symbol.toStringTag,{value:"Module"})),Oh=en({prefix:"9",name:"base10",alphabet:"0123456789"}),Ih=Object.freeze(Object.defineProperty({__proto__:null,base10:Oh},Symbol.toStringTag,{value:"Module"})),xh=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ph=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Th=Object.freeze(Object.defineProperty({__proto__:null,base16:xh,base16upper:Ph},Symbol.toStringTag,{value:"Module"})),Ah=en({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Nh=en({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ch=Object.freeze(Object.defineProperty({__proto__:null,base36:Ah,base36upper:Nh},Symbol.toStringTag,{value:"Module"})),Rh=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fh=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lh=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Uh=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),jh=Object.freeze(Object.defineProperty({__proto__:null,base64:Rh,base64pad:Fh,base64url:Lh,base64urlpad:Uh},Symbol.toStringTag,{value:"Module"})),$o=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Mh=$o.reduce((t,e,r)=>(t[r]=e,t),[]),$h=$o.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Hh(t){return t.reduce((e,r)=>(e+=Mh[r],e),"")}function Bh(t){const e=[];for(const r of t){const i=$h[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const qh=ho({prefix:"\u{1F680}",name:"base256emoji",encode:Hh,decode:Bh}),zh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:qh},Symbol.toStringTag,{value:"Module"})),Ho=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Kh=fo({name:"sha2-256",code:18,encode:Ho("SHA-256")}),Vh=fo({name:"sha2-512",code:19,encode:Ho("SHA-512")}),Gh=Object.freeze(Object.defineProperty({__proto__:null,sha256:Kh,sha512:Vh},Symbol.toStringTag,{value:"Module"})),Bo=0,Wh="identity",qo=Nc,kh=t=>Cc(Bo,qo(t)),Yh={code:Bo,name:Wh,encode:qo,digest:kh},Jh=Object.freeze(Object.defineProperty({__proto__:null,identity:Yh},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const as={...vh,...Eh,...Sh,...Ih,...Th,...Rc,...Ch,...Fc,...jh,...zh};({...Gh,...Jh});function zo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const cs=zo("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Pi=zo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Mo(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ko={utf8:cs,"utf-8":cs,hex:as.base16,latin1:Pi,ascii:Pi,binary:Pi,...as};function ft(t,e="utf8"){const r=Ko[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ut(t,e="utf8"){const r=Ko[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Xh(t){return typeof t=="string"?t:JSON.stringify(t)}function ri(t){return ft(ut(Xh(t),fh),jo)}function Vo(t){const e=ut(_h,os),r=yh+ft(Bi([e,t]),os);return[ph,gh,r].join(dh)}function Zh(t){return ft(t,jo)}function Qh(t){return ut([ri(t.header),ri(t.payload)].join(Uo),lh)}function ef(t){return[ri(t.header),ri(t.payload),Zh(t.signature)].join(Uo)}function us(t=cr.randomBytes(bh)){return rn.generateKeyPairFromSeed(t)}async function tf(t,e,r,i,n=ee.fromMiliseconds(Date.now())){const h={alg:uh,typ:hh},g=Vo(i.publicKey),d=n+r,y={iss:g,sub:t,aud:e,iat:n,exp:d},E=Qh({header:h,payload:y}),O=rn.sign(i.secretKey,E);return ef({header:h,payload:y,signature:O})}var nn={},hi={};Object.defineProperty(hi,"__esModule",{value:!0});var nt=ie,qi=pt,rf=20;function nf(t,e,r){for(var i=1634760805,n=857760878,h=2036477234,g=1797285236,d=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],E=r[11]<<24|r[10]<<16|r[9]<<8|r[8],O=r[15]<<24|r[14]<<16|r[13]<<8|r[12],A=r[19]<<24|r[18]<<16|r[17]<<8|r[16],$=r[23]<<24|r[22]<<16|r[21]<<8|r[20],C=r[27]<<24|r[26]<<16|r[25]<<8|r[24],N=r[31]<<24|r[30]<<16|r[29]<<8|r[28],K=e[3]<<24|e[2]<<16|e[1]<<8|e[0],H=e[7]<<24|e[6]<<16|e[5]<<8|e[4],W=e[11]<<24|e[10]<<16|e[9]<<8|e[8],m=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=i,b=n,w=h,S=g,o=d,p=y,B=E,s=O,f=A,l=$,_=C,c=N,a=K,D=H,P=W,L=m,v=0;v<rf;v+=2)x=x+o|0,a^=x,a=a>>>32-16|a<<16,f=f+a|0,o^=f,o=o>>>32-12|o<<12,b=b+p|0,D^=b,D=D>>>32-16|D<<16,l=l+D|0,p^=l,p=p>>>32-12|p<<12,w=w+B|0,P^=w,P=P>>>32-16|P<<16,_=_+P|0,B^=_,B=B>>>32-12|B<<12,S=S+s|0,L^=S,L=L>>>32-16|L<<16,c=c+L|0,s^=c,s=s>>>32-12|s<<12,w=w+B|0,P^=w,P=P>>>32-8|P<<8,_=_+P|0,B^=_,B=B>>>32-7|B<<7,S=S+s|0,L^=S,L=L>>>32-8|L<<8,c=c+L|0,s^=c,s=s>>>32-7|s<<7,b=b+p|0,D^=b,D=D>>>32-8|D<<8,l=l+D|0,p^=l,p=p>>>32-7|p<<7,x=x+o|0,a^=x,a=a>>>32-8|a<<8,f=f+a|0,o^=f,o=o>>>32-7|o<<7,x=x+p|0,L^=x,L=L>>>32-16|L<<16,_=_+L|0,p^=_,p=p>>>32-12|p<<12,b=b+B|0,a^=b,a=a>>>32-16|a<<16,c=c+a|0,B^=c,B=B>>>32-12|B<<12,w=w+s|0,D^=w,D=D>>>32-16|D<<16,f=f+D|0,s^=f,s=s>>>32-12|s<<12,S=S+o|0,P^=S,P=P>>>32-16|P<<16,l=l+P|0,o^=l,o=o>>>32-12|o<<12,w=w+s|0,D^=w,D=D>>>32-8|D<<8,f=f+D|0,s^=f,s=s>>>32-7|s<<7,S=S+o|0,P^=S,P=P>>>32-8|P<<8,l=l+P|0,o^=l,o=o>>>32-7|o<<7,b=b+B|0,a^=b,a=a>>>32-8|a<<8,c=c+a|0,B^=c,B=B>>>32-7|B<<7,x=x+p|0,L^=x,L=L>>>32-8|L<<8,_=_+L|0,p^=_,p=p>>>32-7|p<<7;nt.writeUint32LE(x+i|0,t,0),nt.writeUint32LE(b+n|0,t,4),nt.writeUint32LE(w+h|0,t,8),nt.writeUint32LE(S+g|0,t,12),nt.writeUint32LE(o+d|0,t,16),nt.writeUint32LE(p+y|0,t,20),nt.writeUint32LE(B+E|0,t,24),nt.writeUint32LE(s+O|0,t,28),nt.writeUint32LE(f+A|0,t,32),nt.writeUint32LE(l+$|0,t,36),nt.writeUint32LE(_+C|0,t,40),nt.writeUint32LE(c+N|0,t,44),nt.writeUint32LE(a+K|0,t,48),nt.writeUint32LE(D+H|0,t,52),nt.writeUint32LE(P+W|0,t,56),nt.writeUint32LE(L+m|0,t,60)}function Go(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var h,g;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");h=new Uint8Array(16),g=h.length-e.length,h.set(e,g)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");h=e,g=n}for(var d=new Uint8Array(64),y=0;y<r.length;y+=64){nf(d,h,t);for(var E=y;E<y+64&&E<r.length;E++)i[E]=r[E]^d[E-y];of(h,0,g)}return qi.wipe(d),n===0&&qi.wipe(h),i}hi.streamXOR=Go;function sf(t,e,r,i){return i===void 0&&(i=0),qi.wipe(r),Go(t,e,r,r,i)}hi.stream=sf;function of(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Wo={},qt={};Object.defineProperty(qt,"__esModule",{value:!0});function af(t,e,r){return~(t-1)&e|t-1&r}qt.select=af;function cf(t,e){return(t|0)-(e|0)-1>>>31&1}qt.lessOrEqual=cf;function ko(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}qt.compare=ko;function uf(t,e){return t.length===0||e.length===0?!1:ko(t,e)!==0}qt.equal=uf;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=qt,r=pt;t.DIGEST_LENGTH=16;var i=function(){function g(d){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=d[0]|d[1]<<8;this._r[0]=y&8191;var E=d[2]|d[3]<<8;this._r[1]=(y>>>13|E<<3)&8191;var O=d[4]|d[5]<<8;this._r[2]=(E>>>10|O<<6)&7939;var A=d[6]|d[7]<<8;this._r[3]=(O>>>7|A<<9)&8191;var $=d[8]|d[9]<<8;this._r[4]=(A>>>4|$<<12)&255,this._r[5]=$>>>1&8190;var C=d[10]|d[11]<<8;this._r[6]=($>>>14|C<<2)&8191;var N=d[12]|d[13]<<8;this._r[7]=(C>>>11|N<<5)&8065;var K=d[14]|d[15]<<8;this._r[8]=(N>>>8|K<<8)&8191,this._r[9]=K>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return g.prototype._blocks=function(d,y,E){for(var O=this._fin?0:2048,A=this._h[0],$=this._h[1],C=this._h[2],N=this._h[3],K=this._h[4],H=this._h[5],W=this._h[6],m=this._h[7],x=this._h[8],b=this._h[9],w=this._r[0],S=this._r[1],o=this._r[2],p=this._r[3],B=this._r[4],s=this._r[5],f=this._r[6],l=this._r[7],_=this._r[8],c=this._r[9];E>=16;){var a=d[y+0]|d[y+1]<<8;A+=a&8191;var D=d[y+2]|d[y+3]<<8;$+=(a>>>13|D<<3)&8191;var P=d[y+4]|d[y+5]<<8;C+=(D>>>10|P<<6)&8191;var L=d[y+6]|d[y+7]<<8;N+=(P>>>7|L<<9)&8191;var v=d[y+8]|d[y+9]<<8;K+=(L>>>4|v<<12)&8191,H+=v>>>1&8191;var U=d[y+10]|d[y+11]<<8;W+=(v>>>14|U<<2)&8191;var z=d[y+12]|d[y+13]<<8;m+=(U>>>11|z<<5)&8191;var q=d[y+14]|d[y+15]<<8;x+=(z>>>8|q<<8)&8191,b+=q>>>5|O;var V=0,Q=V;Q+=A*w,Q+=$*(5*c),Q+=C*(5*_),Q+=N*(5*l),Q+=K*(5*f),V=Q>>>13,Q&=8191,Q+=H*(5*s),Q+=W*(5*B),Q+=m*(5*p),Q+=x*(5*o),Q+=b*(5*S),V+=Q>>>13,Q&=8191;var Y=V;Y+=A*S,Y+=$*w,Y+=C*(5*c),Y+=N*(5*_),Y+=K*(5*l),V=Y>>>13,Y&=8191,Y+=H*(5*f),Y+=W*(5*s),Y+=m*(5*B),Y+=x*(5*p),Y+=b*(5*o),V+=Y>>>13,Y&=8191;var ae=V;ae+=A*o,ae+=$*S,ae+=C*w,ae+=N*(5*c),ae+=K*(5*_),V=ae>>>13,ae&=8191,ae+=H*(5*l),ae+=W*(5*f),ae+=m*(5*s),ae+=x*(5*B),ae+=b*(5*p),V+=ae>>>13,ae&=8191;var M=V;M+=A*p,M+=$*o,M+=C*S,M+=N*w,M+=K*(5*c),V=M>>>13,M&=8191,M+=H*(5*_),M+=W*(5*l),M+=m*(5*f),M+=x*(5*s),M+=b*(5*B),V+=M>>>13,M&=8191;var j=V;j+=A*B,j+=$*p,j+=C*o,j+=N*S,j+=K*w,V=j>>>13,j&=8191,j+=H*(5*c),j+=W*(5*_),j+=m*(5*l),j+=x*(5*f),j+=b*(5*s),V+=j>>>13,j&=8191;var R=V;R+=A*s,R+=$*B,R+=C*p,R+=N*o,R+=K*S,V=R>>>13,R&=8191,R+=H*w,R+=W*(5*c),R+=m*(5*_),R+=x*(5*l),R+=b*(5*f),V+=R>>>13,R&=8191;var u=V;u+=A*f,u+=$*s,u+=C*B,u+=N*p,u+=K*o,V=u>>>13,u&=8191,u+=H*S,u+=W*w,u+=m*(5*c),u+=x*(5*_),u+=b*(5*l),V+=u>>>13,u&=8191;var T=V;T+=A*l,T+=$*f,T+=C*s,T+=N*B,T+=K*p,V=T>>>13,T&=8191,T+=H*o,T+=W*S,T+=m*w,T+=x*(5*c),T+=b*(5*_),V+=T>>>13,T&=8191;var k=V;k+=A*_,k+=$*l,k+=C*f,k+=N*s,k+=K*B,V=k>>>13,k&=8191,k+=H*p,k+=W*o,k+=m*S,k+=x*w,k+=b*(5*c),V+=k>>>13,k&=8191;var X=V;X+=A*c,X+=$*_,X+=C*l,X+=N*f,X+=K*s,V=X>>>13,X&=8191,X+=H*B,X+=W*p,X+=m*o,X+=x*S,X+=b*w,V+=X>>>13,X&=8191,V=(V<<2)+V|0,V=V+Q|0,Q=V&8191,V=V>>>13,Y+=V,A=Q,$=Y,C=ae,N=M,K=j,H=R,W=u,m=T,x=k,b=X,y+=16,E-=16}this._h[0]=A,this._h[1]=$,this._h[2]=C,this._h[3]=N,this._h[4]=K,this._h[5]=H,this._h[6]=W,this._h[7]=m,this._h[8]=x,this._h[9]=b},g.prototype.finish=function(d,y){y===void 0&&(y=0);var E=new Uint16Array(10),O,A,$,C;if(this._leftover){for(C=this._leftover,this._buffer[C++]=1;C<16;C++)this._buffer[C]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(O=this._h[1]>>>13,this._h[1]&=8191,C=2;C<10;C++)this._h[C]+=O,O=this._h[C]>>>13,this._h[C]&=8191;for(this._h[0]+=O*5,O=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=O,O=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=O,E[0]=this._h[0]+5,O=E[0]>>>13,E[0]&=8191,C=1;C<10;C++)E[C]=this._h[C]+O,O=E[C]>>>13,E[C]&=8191;for(E[9]-=1<<13,A=(O^1)-1,C=0;C<10;C++)E[C]&=A;for(A=~A,C=0;C<10;C++)this._h[C]=this._h[C]&A|E[C];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,$=this._h[0]+this._pad[0],this._h[0]=$&65535,C=1;C<8;C++)$=(this._h[C]+this._pad[C]|0)+($>>>16)|0,this._h[C]=$&65535;return d[y+0]=this._h[0]>>>0,d[y+1]=this._h[0]>>>8,d[y+2]=this._h[1]>>>0,d[y+3]=this._h[1]>>>8,d[y+4]=this._h[2]>>>0,d[y+5]=this._h[2]>>>8,d[y+6]=this._h[3]>>>0,d[y+7]=this._h[3]>>>8,d[y+8]=this._h[4]>>>0,d[y+9]=this._h[4]>>>8,d[y+10]=this._h[5]>>>0,d[y+11]=this._h[5]>>>8,d[y+12]=this._h[6]>>>0,d[y+13]=this._h[6]>>>8,d[y+14]=this._h[7]>>>0,d[y+15]=this._h[7]>>>8,this._finished=!0,this},g.prototype.update=function(d){var y=0,E=d.length,O;if(this._leftover){O=16-this._leftover,O>E&&(O=E);for(var A=0;A<O;A++)this._buffer[this._leftover+A]=d[y+A];if(E-=O,y+=O,this._leftover+=O,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(E>=16&&(O=E-E%16,this._blocks(d,y,O),y+=O,E-=O),E){for(var A=0;A<E;A++)this._buffer[this._leftover+A]=d[y+A];this._leftover+=E}return this},g.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},g.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},g}();t.Poly1305=i;function n(g,d){var y=new i(g);y.update(d);var E=y.digest();return y.clean(),E}t.oneTimeAuth=n;function h(g,d){return g.length!==t.DIGEST_LENGTH||d.length!==t.DIGEST_LENGTH?!1:e.equal(g,d)}t.equal=h})(Wo);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=hi,r=Wo,i=pt,n=ie,h=qt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var g=new Uint8Array(16),d=function(){function y(E){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,E.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(E)}return y.prototype.seal=function(E,O,A,$){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var C=new Uint8Array(16);C.set(E,C.length-E.length);var N=new Uint8Array(32);e.stream(this._key,C,N,4);var K=O.length+this.tagLength,H;if($){if($.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");H=$}else H=new Uint8Array(K);return e.streamXOR(this._key,C,O,H,4),this._authenticate(H.subarray(H.length-this.tagLength,H.length),N,H.subarray(0,H.length-this.tagLength),A),i.wipe(C),H},y.prototype.open=function(E,O,A,$){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(O.length<this.tagLength)return null;var C=new Uint8Array(16);C.set(E,C.length-E.length);var N=new Uint8Array(32);e.stream(this._key,C,N,4);var K=new Uint8Array(this.tagLength);if(this._authenticate(K,N,O.subarray(0,O.length-this.tagLength),A),!h.equal(K,O.subarray(O.length-this.tagLength,O.length)))return null;var H=O.length-this.tagLength,W;if($){if($.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");W=$}else W=new Uint8Array(H);return e.streamXOR(this._key,C,O.subarray(0,O.length-this.tagLength),W,4),i.wipe(C),W},y.prototype.clean=function(){return i.wipe(this._key),this},y.prototype._authenticate=function(E,O,A,$){var C=new r.Poly1305(O);$&&(C.update($),$.length%16>0&&C.update(g.subarray($.length%16))),C.update(A),A.length%16>0&&C.update(g.subarray(A.length%16));var N=new Uint8Array(8);$&&n.writeUint64LE($.length,N),C.update(N),n.writeUint64LE(A.length,N),C.update(N);for(var K=C.digest(),H=0;H<K.length;H++)E[H]=K[H];C.clean(),i.wipe(K),i.wipe(N)},y}();t.ChaCha20Poly1305=d})(nn);var Yo={},Fr={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});function hf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}sn.isSerializableHash=hf;Object.defineProperty(Fr,"__esModule",{value:!0});var Dt=sn,ff=qt,lf=pt,Jo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Dt.isSerializableHash(this._inner)&&Dt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),lf.wipe(i)}return t.prototype.reset=function(){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Dt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Dt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Fr.HMAC=Jo;function df(t,e,r){var i=new Jo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Fr.hmac=df;Fr.equal=ff.equal;Object.defineProperty(Yo,"__esModule",{value:!0});var hs=Fr,fs=pt,pf=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var h=hs.hmac(this._hash,i,r);this._hmac=new hs.HMAC(e,h),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),fs.wipe(this._buffer),fs.wipe(this._counter),this._bufpos=0},t}(),gf=Yo.HKDF=pf,fi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function d(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},d.prototype.update=function(y,E){if(E===void 0&&(E=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var O=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&E>0;)this._buffer[this._bufferLength++]=y[O++],E--;this._bufferLength===this.blockSize&&(h(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(O=h(this._temp,this._state,y,O,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=y[O++],E--;return this},d.prototype.finish=function(y){if(!this._finished){var E=this._bytesHashed,O=this._bufferLength,A=E/536870912|0,$=E<<3,C=E%64<56?64:128;this._buffer[O]=128;for(var N=O+1;N<C-8;N++)this._buffer[N]=0;e.writeUint32BE(A,this._buffer,C-8),e.writeUint32BE($,this._buffer,C-4),h(this._temp,this._state,this._buffer,0,C),this._finished=!0}for(var N=0;N<this.digestLength/4;N++)e.writeUint32BE(this._state[N],y,N*4);return this},d.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(y){r.wipe(y.state),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},d}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function h(d,y,E,O,A){for(;A>=64;){for(var $=y[0],C=y[1],N=y[2],K=y[3],H=y[4],W=y[5],m=y[6],x=y[7],b=0;b<16;b++){var w=O+b*4;d[b]=e.readUint32BE(E,w)}for(var b=16;b<64;b++){var S=d[b-2],o=(S>>>17|S<<32-17)^(S>>>19|S<<32-19)^S>>>10;S=d[b-15];var p=(S>>>7|S<<32-7)^(S>>>18|S<<32-18)^S>>>3;d[b]=(o+d[b-7]|0)+(p+d[b-16]|0)}for(var b=0;b<64;b++){var o=(((H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7))+(H&W^~H&m)|0)+(x+(n[b]+d[b]|0)|0)|0,p=(($>>>2|$<<32-2)^($>>>13|$<<32-13)^($>>>22|$<<32-22))+($&C^$&N^C&N)|0;x=m,m=W,W=H,H=K+o|0,K=N,N=C,C=$,$=o+p|0}y[0]+=$,y[1]+=C,y[2]+=N,y[3]+=K,y[4]+=H,y[5]+=W,y[6]+=m,y[7]+=x,O+=64,A-=64}return O}function g(d){var y=new i;y.update(d);var E=y.digest();return y.clean(),E}t.hash=g})(fi);var on={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=cr,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(b){const w=new Float64Array(16);if(b)for(let S=0;S<b.length;S++)w[S]=b[S];return w}const n=new Uint8Array(32);n[0]=9;const h=i([56129,1]);function g(b){let w=1;for(let S=0;S<16;S++){let o=b[S]+w+65535;w=Math.floor(o/65536),b[S]=o-w*65536}b[0]+=w-1+37*(w-1)}function d(b,w,S){const o=~(S-1);for(let p=0;p<16;p++){const B=o&(b[p]^w[p]);b[p]^=B,w[p]^=B}}function y(b,w){const S=i(),o=i();for(let p=0;p<16;p++)o[p]=w[p];g(o),g(o),g(o);for(let p=0;p<2;p++){S[0]=o[0]-65517;for(let s=1;s<15;s++)S[s]=o[s]-65535-(S[s-1]>>16&1),S[s-1]&=65535;S[15]=o[15]-32767-(S[14]>>16&1);const B=S[15]>>16&1;S[14]&=65535,d(o,S,1-B)}for(let p=0;p<16;p++)b[2*p]=o[p]&255,b[2*p+1]=o[p]>>8}function E(b,w){for(let S=0;S<16;S++)b[S]=w[2*S]+(w[2*S+1]<<8);b[15]&=32767}function O(b,w,S){for(let o=0;o<16;o++)b[o]=w[o]+S[o]}function A(b,w,S){for(let o=0;o<16;o++)b[o]=w[o]-S[o]}function $(b,w,S){let o,p,B=0,s=0,f=0,l=0,_=0,c=0,a=0,D=0,P=0,L=0,v=0,U=0,z=0,q=0,V=0,Q=0,Y=0,ae=0,M=0,j=0,R=0,u=0,T=0,k=0,X=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=S[0],pe=S[1],le=S[2],ue=S[3],ce=S[4],oe=S[5],se=S[6],te=S[7],he=S[8],ge=S[9],re=S[10],be=S[11],me=S[12],Ee=S[13],De=S[14],we=S[15];o=w[0],B+=o*ye,s+=o*pe,f+=o*le,l+=o*ue,_+=o*ce,c+=o*oe,a+=o*se,D+=o*te,P+=o*he,L+=o*ge,v+=o*re,U+=o*be,z+=o*me,q+=o*Ee,V+=o*De,Q+=o*we,o=w[1],s+=o*ye,f+=o*pe,l+=o*le,_+=o*ue,c+=o*ce,a+=o*oe,D+=o*se,P+=o*te,L+=o*he,v+=o*ge,U+=o*re,z+=o*be,q+=o*me,V+=o*Ee,Q+=o*De,Y+=o*we,o=w[2],f+=o*ye,l+=o*pe,_+=o*le,c+=o*ue,a+=o*ce,D+=o*oe,P+=o*se,L+=o*te,v+=o*he,U+=o*ge,z+=o*re,q+=o*be,V+=o*me,Q+=o*Ee,Y+=o*De,ae+=o*we,o=w[3],l+=o*ye,_+=o*pe,c+=o*le,a+=o*ue,D+=o*ce,P+=o*oe,L+=o*se,v+=o*te,U+=o*he,z+=o*ge,q+=o*re,V+=o*be,Q+=o*me,Y+=o*Ee,ae+=o*De,M+=o*we,o=w[4],_+=o*ye,c+=o*pe,a+=o*le,D+=o*ue,P+=o*ce,L+=o*oe,v+=o*se,U+=o*te,z+=o*he,q+=o*ge,V+=o*re,Q+=o*be,Y+=o*me,ae+=o*Ee,M+=o*De,j+=o*we,o=w[5],c+=o*ye,a+=o*pe,D+=o*le,P+=o*ue,L+=o*ce,v+=o*oe,U+=o*se,z+=o*te,q+=o*he,V+=o*ge,Q+=o*re,Y+=o*be,ae+=o*me,M+=o*Ee,j+=o*De,R+=o*we,o=w[6],a+=o*ye,D+=o*pe,P+=o*le,L+=o*ue,v+=o*ce,U+=o*oe,z+=o*se,q+=o*te,V+=o*he,Q+=o*ge,Y+=o*re,ae+=o*be,M+=o*me,j+=o*Ee,R+=o*De,u+=o*we,o=w[7],D+=o*ye,P+=o*pe,L+=o*le,v+=o*ue,U+=o*ce,z+=o*oe,q+=o*se,V+=o*te,Q+=o*he,Y+=o*ge,ae+=o*re,M+=o*be,j+=o*me,R+=o*Ee,u+=o*De,T+=o*we,o=w[8],P+=o*ye,L+=o*pe,v+=o*le,U+=o*ue,z+=o*ce,q+=o*oe,V+=o*se,Q+=o*te,Y+=o*he,ae+=o*ge,M+=o*re,j+=o*be,R+=o*me,u+=o*Ee,T+=o*De,k+=o*we,o=w[9],L+=o*ye,v+=o*pe,U+=o*le,z+=o*ue,q+=o*ce,V+=o*oe,Q+=o*se,Y+=o*te,ae+=o*he,M+=o*ge,j+=o*re,R+=o*be,u+=o*me,T+=o*Ee,k+=o*De,X+=o*we,o=w[10],v+=o*ye,U+=o*pe,z+=o*le,q+=o*ue,V+=o*ce,Q+=o*oe,Y+=o*se,ae+=o*te,M+=o*he,j+=o*ge,R+=o*re,u+=o*be,T+=o*me,k+=o*Ee,X+=o*De,fe+=o*we,o=w[11],U+=o*ye,z+=o*pe,q+=o*le,V+=o*ue,Q+=o*ce,Y+=o*oe,ae+=o*se,M+=o*te,j+=o*he,R+=o*ge,u+=o*re,T+=o*be,k+=o*me,X+=o*Ee,fe+=o*De,_e+=o*we,o=w[12],z+=o*ye,q+=o*pe,V+=o*le,Q+=o*ue,Y+=o*ce,ae+=o*oe,M+=o*se,j+=o*te,R+=o*he,u+=o*ge,T+=o*re,k+=o*be,X+=o*me,fe+=o*Ee,_e+=o*De,de+=o*we,o=w[13],q+=o*ye,V+=o*pe,Q+=o*le,Y+=o*ue,ae+=o*ce,M+=o*oe,j+=o*se,R+=o*te,u+=o*he,T+=o*ge,k+=o*re,X+=o*be,fe+=o*me,_e+=o*Ee,de+=o*De,ve+=o*we,o=w[14],V+=o*ye,Q+=o*pe,Y+=o*le,ae+=o*ue,M+=o*ce,j+=o*oe,R+=o*se,u+=o*te,T+=o*he,k+=o*ge,X+=o*re,fe+=o*be,_e+=o*me,de+=o*Ee,ve+=o*De,Ue+=o*we,o=w[15],Q+=o*ye,Y+=o*pe,ae+=o*le,M+=o*ue,j+=o*ce,R+=o*oe,u+=o*se,T+=o*te,k+=o*he,X+=o*ge,fe+=o*re,_e+=o*be,de+=o*me,ve+=o*Ee,Ue+=o*De,Ce+=o*we,B+=38*Y,s+=38*ae,f+=38*M,l+=38*j,_+=38*R,c+=38*u,a+=38*T,D+=38*k,P+=38*X,L+=38*fe,v+=38*_e,U+=38*de,z+=38*ve,q+=38*Ue,V+=38*Ce,p=1,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=s+p+65535,p=Math.floor(o/65536),s=o-p*65536,o=f+p+65535,p=Math.floor(o/65536),f=o-p*65536,o=l+p+65535,p=Math.floor(o/65536),l=o-p*65536,o=_+p+65535,p=Math.floor(o/65536),_=o-p*65536,o=c+p+65535,p=Math.floor(o/65536),c=o-p*65536,o=a+p+65535,p=Math.floor(o/65536),a=o-p*65536,o=D+p+65535,p=Math.floor(o/65536),D=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=v+p+65535,p=Math.floor(o/65536),v=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=V+p+65535,p=Math.floor(o/65536),V=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,B+=p-1+37*(p-1),p=1,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=s+p+65535,p=Math.floor(o/65536),s=o-p*65536,o=f+p+65535,p=Math.floor(o/65536),f=o-p*65536,o=l+p+65535,p=Math.floor(o/65536),l=o-p*65536,o=_+p+65535,p=Math.floor(o/65536),_=o-p*65536,o=c+p+65535,p=Math.floor(o/65536),c=o-p*65536,o=a+p+65535,p=Math.floor(o/65536),a=o-p*65536,o=D+p+65535,p=Math.floor(o/65536),D=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=v+p+65535,p=Math.floor(o/65536),v=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=V+p+65535,p=Math.floor(o/65536),V=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,B+=p-1+37*(p-1),b[0]=B,b[1]=s,b[2]=f,b[3]=l,b[4]=_,b[5]=c,b[6]=a,b[7]=D,b[8]=P,b[9]=L,b[10]=v,b[11]=U,b[12]=z,b[13]=q,b[14]=V,b[15]=Q}function C(b,w){$(b,w,w)}function N(b,w){const S=i();for(let o=0;o<16;o++)S[o]=w[o];for(let o=253;o>=0;o--)C(S,S),o!==2&&o!==4&&$(S,S,w);for(let o=0;o<16;o++)b[o]=S[o]}function K(b,w){const S=new Uint8Array(32),o=new Float64Array(80),p=i(),B=i(),s=i(),f=i(),l=i(),_=i();for(let P=0;P<31;P++)S[P]=b[P];S[31]=b[31]&127|64,S[0]&=248,E(o,w);for(let P=0;P<16;P++)B[P]=o[P];p[0]=f[0]=1;for(let P=254;P>=0;--P){const L=S[P>>>3]>>>(P&7)&1;d(p,B,L),d(s,f,L),O(l,p,s),A(p,p,s),O(s,B,f),A(B,B,f),C(f,l),C(_,p),$(p,s,p),$(s,B,l),O(l,p,s),A(p,p,s),C(B,p),A(s,f,_),$(p,s,h),O(p,p,f),$(s,s,p),$(p,f,_),$(f,B,o),C(B,l),d(p,B,L),d(s,f,L)}for(let P=0;P<16;P++)o[P+16]=p[P],o[P+32]=s[P],o[P+48]=B[P],o[P+64]=f[P];const c=o.subarray(32),a=o.subarray(16);N(c,c),$(a,a,c);const D=new Uint8Array(32);return y(D,a),D}t.scalarMult=K;function H(b){return K(b,n)}t.scalarMultBase=H;function W(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(b);return{publicKey:H(w),secretKey:w}}t.generateKeyPairFromSeed=W;function m(b){const w=(0,e.randomBytes)(32,b),S=W(w);return(0,r.wipe)(w),S}t.generateKeyPair=m;function x(b,w,S=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=K(b,w);if(S){let p=0;for(let B=0;B<o.length;B++)p|=o[B];if(p===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=x})(on);var ls=globalThis&&globalThis.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,h;i<n;i++)(h||!(i in e))&&(h||(h=Array.prototype.slice.call(e,0,i)),h[i]=e[i]);return t.concat(h||Array.prototype.slice.call(e))},yf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),_f=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),bf=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),mf=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),vf=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),wf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ef=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ds=3,Df=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",wf]],ps=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Sf(t){return t?gs(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new vf:typeof navigator<"u"?gs(navigator.userAgent):xf()}function Of(t){return t!==""&&Df.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var h=n.exec(t);return!!h&&[i,h]},!1)}function gs(t){var e=Of(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new mf;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<ds&&(n=ls(ls([],n,!0),Pf(ds-n.length),!0)):n=[];var h=n.join("."),g=If(t),d=Ef.exec(t);return d&&d[1]?new bf(r,h,g,d[1]):new yf(r,h,g)}function If(t){for(var e=0,r=ps.length;e<r;e++){var i=ps[e],n=i[0],h=i[1],g=h.exec(t);if(g)return n}return null}function xf(){var t=typeof process<"u"&&process.version;return t?new _f(process.version.slice(1)):null}function Pf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Zo=Ie.getLocation=Ie.getLocationOrThrow=an=Ie.getNavigator=Ie.getNavigatorOrThrow=Xo=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Qt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=Qt;function ur(t){const e=Qt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=ur;function Tf(){return ur("document")}Ie.getDocumentOrThrow=Tf;function Af(){return Qt("document")}var Xo=Ie.getDocument=Af;function Nf(){return ur("navigator")}Ie.getNavigatorOrThrow=Nf;function Cf(){return Qt("navigator")}var an=Ie.getNavigator=Cf;function Rf(){return ur("location")}Ie.getLocationOrThrow=Rf;function Ff(){return Qt("location")}var Zo=Ie.getLocation=Ff;function Lf(){return ur("crypto")}Ie.getCryptoOrThrow=Lf;function Uf(){return Qt("crypto")}Ie.getCrypto=Uf;function jf(){return ur("localStorage")}Ie.getLocalStorageOrThrow=jf;function Mf(){return Qt("localStorage")}Ie.getLocalStorage=Mf;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});var Qo=cn.getWindowMetadata=void 0;const ys=Ie;function $f(){let t,e;try{t=ys.getDocumentOrThrow(),e=ys.getLocationOrThrow()}catch{return null}function r(){const A=t.getElementsByTagName("link"),$=[];for(let C=0;C<A.length;C++){const N=A[C],K=N.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const H=N.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(H.indexOf("/")===0)W+=H;else{const m=e.pathname.split("/");m.pop(),W+=m.join("/")+"/"+H}$.push(W)}else if(H.indexOf("//")===0){const W=e.protocol+H;$.push(W)}else $.push(H)}}return $}function i(...A){const $=t.getElementsByTagName("meta");for(let C=0;C<$.length;C++){const N=$[C],K=["itemprop","property","name"].map(H=>N.getAttribute(H)).filter(H=>H?A.includes(H):!1);if(K.length&&K){const H=N.getAttribute("content");if(H)return H}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=t.title),A}function h(){return i("description","og:description","twitter:description","keywords")}const g=n(),d=h(),y=e.origin,E=r();return{description:d,url:y,icons:E,name:g}}Qo=cn.getWindowMetadata=$f;var Pr={},ea=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ta="%[a-f0-9]{2}",_s=new RegExp("("+ta+")|([^%]+?)","gi"),bs=new RegExp("("+ta+")+","gi");function zi(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],zi(r),zi(i))}function Hf(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(_s)||[],r=1;r<e.length;r++)t=zi(e,r).join(""),e=t.match(_s)||[];return t}}function Bf(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=bs.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Hf(r[0]);i!==r[0]&&(e[r[0]]=i)}r=bs.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),h=0;h<n.length;h++){var g=n[h];t=t.replace(new RegExp(g,"g"),e[g])}return t}var ra=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Bf(t)}},ia=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},na=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),h=0;h<i.length;h++){var g=i[h],d=t[g];(n?e.indexOf(g)!==-1:e(g,d,t))&&(r[g]=d)}return r};(function(t){const e=ea,r=ra,i=ia,n=na,h=m=>m==null,g=Symbol("encodeFragmentIdentifier");function d(m){switch(m.arrayFormat){case"index":return x=>(b,w)=>{const S=b.length;return w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),"[",S,"]"].join("")]:[...b,[O(x,m),"[",O(S,m),"]=",O(w,m)].join("")]};case"bracket":return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),"[]"].join("")]:[...b,[O(x,m),"[]=",O(w,m)].join("")];case"colon-list-separator":return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),":list="].join("")]:[...b,[O(x,m),":list=",O(w,m)].join("")];case"comma":case"separator":case"bracket-separator":{const x=m.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,S)=>S===void 0||m.skipNull&&S===null||m.skipEmptyString&&S===""?w:(S=S===null?"":S,w.length===0?[[O(b,m),x,O(S,m)].join("")]:[[w,O(S,m)].join(m.arrayFormatSeparator)])}default:return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,O(x,m)]:[...b,[O(x,m),"=",O(w,m)].join("")]}}function y(m){let x;switch(m.arrayFormat){case"index":return(b,w,S)=>{if(x=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!x){S[b]=w;return}S[b]===void 0&&(S[b]={}),S[b][x[1]]=w};case"bracket":return(b,w,S)=>{if(x=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!x){S[b]=w;return}if(S[b]===void 0){S[b]=[w];return}S[b]=[].concat(S[b],w)};case"colon-list-separator":return(b,w,S)=>{if(x=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!x){S[b]=w;return}if(S[b]===void 0){S[b]=[w];return}S[b]=[].concat(S[b],w)};case"comma":case"separator":return(b,w,S)=>{const o=typeof w=="string"&&w.includes(m.arrayFormatSeparator),p=typeof w=="string"&&!o&&A(w,m).includes(m.arrayFormatSeparator);w=p?A(w,m):w;const B=o||p?w.split(m.arrayFormatSeparator).map(s=>A(s,m)):w===null?w:A(w,m);S[b]=B};case"bracket-separator":return(b,w,S)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){S[b]=w&&A(w,m);return}const p=w===null?[]:w.split(m.arrayFormatSeparator).map(B=>A(B,m));if(S[b]===void 0){S[b]=p;return}S[b]=[].concat(S[b],p)};default:return(b,w,S)=>{if(S[b]===void 0){S[b]=w;return}S[b]=[].concat(S[b],w)}}}function E(m){if(typeof m!="string"||m.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function O(m,x){return x.encode?x.strict?e(m):encodeURIComponent(m):m}function A(m,x){return x.decode?r(m):m}function $(m){return Array.isArray(m)?m.sort():typeof m=="object"?$(Object.keys(m)).sort((x,b)=>Number(x)-Number(b)).map(x=>m[x]):m}function C(m){const x=m.indexOf("#");return x!==-1&&(m=m.slice(0,x)),m}function N(m){let x="";const b=m.indexOf("#");return b!==-1&&(x=m.slice(b)),x}function K(m){m=C(m);const x=m.indexOf("?");return x===-1?"":m.slice(x+1)}function H(m,x){return x.parseNumbers&&!Number.isNaN(Number(m))&&typeof m=="string"&&m.trim()!==""?m=Number(m):x.parseBooleans&&m!==null&&(m.toLowerCase()==="true"||m.toLowerCase()==="false")&&(m=m.toLowerCase()==="true"),m}function W(m,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),E(x.arrayFormatSeparator);const b=y(x),w=Object.create(null);if(typeof m!="string"||(m=m.trim().replace(/^[?#&]/,""),!m))return w;for(const S of m.split("&")){if(S==="")continue;let[o,p]=i(x.decode?S.replace(/\+/g," "):S,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?p:A(p,x),b(A(o,x),p,w)}for(const S of Object.keys(w)){const o=w[S];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=H(o[p],x);else w[S]=H(o,x)}return x.sort===!1?w:(x.sort===!0?Object.keys(w).sort():Object.keys(w).sort(x.sort)).reduce((S,o)=>{const p=w[o];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?S[o]=$(p):S[o]=p,S},Object.create(null))}t.extract=K,t.parse=W,t.stringify=(m,x)=>{if(!m)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),E(x.arrayFormatSeparator);const b=p=>x.skipNull&&h(m[p])||x.skipEmptyString&&m[p]==="",w=d(x),S={};for(const p of Object.keys(m))b(p)||(S[p]=m[p]);const o=Object.keys(S);return x.sort!==!1&&o.sort(x.sort),o.map(p=>{const B=m[p];return B===void 0?"":B===null?O(p,x):Array.isArray(B)?B.length===0&&x.arrayFormat==="bracket-separator"?O(p,x)+"[]":B.reduce(w(p),[]).join("&"):O(p,x)+"="+O(B,x)}).filter(p=>p.length>0).join("&")},t.parseUrl=(m,x)=>{x=Object.assign({decode:!0},x);const[b,w]=i(m,"#");return Object.assign({url:b.split("?")[0]||"",query:W(K(m),x)},x&&x.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,x)}:{})},t.stringifyUrl=(m,x)=>{x=Object.assign({encode:!0,strict:!0,[g]:!0},x);const b=C(m.url).split("?")[0]||"",w=t.extract(m.url),S=t.parse(w,{sort:!1}),o=Object.assign(S,m.query);let p=t.stringify(o,x);p&&(p=`?${p}`);let B=N(m.url);return m.fragmentIdentifier&&(B=`#${x[g]?O(m.fragmentIdentifier,x):m.fragmentIdentifier}`),`${b}${p}${B}`},t.pick=(m,x,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[g]:!1},b);const{url:w,query:S,fragmentIdentifier:o}=t.parseUrl(m,b);return t.stringifyUrl({url:w,query:n(S,x),fragmentIdentifier:o},b)},t.exclude=(m,x,b)=>{const w=Array.isArray(x)?S=>!x.includes(S):(S,o)=>!x(S,o);return t.pick(m,w,b)}})(Pr);const qf={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function un(t,e){return t.includes(":")?[t]:e.chains||[]}const sa="base10",ht="base16",Ki="base64pad",hn="utf8",oa=0,er=1,zf=0,ms=1,Vi=12,fn=32;function Kf(){const t=on.generateKeyPair();return{privateKey:ft(t.secretKey,ht),publicKey:ft(t.publicKey,ht)}}function Gi(){const t=cr.randomBytes(fn);return ft(t,ht)}function Vf(t,e){const r=on.sharedKey(ut(t,ht),ut(e,ht)),i=new gf(fi.SHA256,r).expand(fn);return ft(i,ht)}function Gf(t){const e=fi.hash(ut(t,ht));return ft(e,ht)}function ii(t){const e=fi.hash(ut(t,hn));return ft(e,ht)}function Wf(t){return ut(`${t}`,sa)}function Lr(t){return Number(ft(t,sa))}function kf(t){const e=Wf(typeof t.type<"u"?t.type:oa);if(Lr(e)===er&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ut(t.senderPublicKey,ht):void 0,i=typeof t.iv<"u"?ut(t.iv,ht):cr.randomBytes(Vi),n=new nn.ChaCha20Poly1305(ut(t.symKey,ht)).seal(i,ut(t.message,hn));return Jf({type:e,sealed:n,iv:i,senderPublicKey:r})}function Yf(t){const e=new nn.ChaCha20Poly1305(ut(t.symKey,ht)),{sealed:r,iv:i}=ln(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return ft(n,hn)}function Jf(t){if(Lr(t.type)===er){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ft(Bi([t.type,t.senderPublicKey,t.iv,t.sealed]),Ki)}return ft(Bi([t.type,t.iv,t.sealed]),Ki)}function ln(t){const e=ut(t,Ki),r=e.slice(zf,ms),i=ms;if(Lr(r)===er){const d=i+fn,y=d+Vi,E=e.slice(i,d),O=e.slice(d,y),A=e.slice(y);return{type:r,sealed:A,iv:O,senderPublicKey:E}}const n=i+Vi,h=e.slice(i,n),g=e.slice(n);return{type:r,sealed:g,iv:h}}function Xf(t,e){const r=ln(t);return aa({type:Lr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ft(r.senderPublicKey,ht):void 0,receiverPublicKey:e?.receiverPublicKey})}function aa(t){const e=t?.type||oa;if(e===er){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function vs(t){return t.type===er&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Zf=Object.defineProperty,ws=Object.getOwnPropertySymbols,Qf=Object.prototype.hasOwnProperty,el=Object.prototype.propertyIsEnumerable,Es=(t,e,r)=>e in t?Zf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ds=(t,e)=>{for(var r in e||(e={}))Qf.call(e,r)&&Es(t,r,e[r]);if(ws)for(var r of ws(e))el.call(e,r)&&Es(t,r,e[r]);return t};const tl="ReactNative",Dr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},rl="js";function ca(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function il(){return!Xo()&&!!an()&&navigator.product===tl}function nl(){return!ca()&&!!an()}function sl(){return il()?Dr.reactNative:ca()?Dr.node:nl()?Dr.browser:Dr.unknown}function ol(t,e){let r=Pr.parse(t);return r=Ds(Ds({},r),e),t=Pr.stringify(r),t}function al(){return Qo()||{name:"",description:"",url:"",icons:[""]}}function cl(){const t=Sf();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function ul(){var t;const e=sl();return e===Dr.browser?[e,((t=Zo())==null?void 0:t.host)||"unknown"].join(":"):e}function hl(t,e,r){const i=cl(),n=ul();return[[t,e].join("-"),[rl,r].join("-"),i,n].join("/")}function fl({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:h}){const g=r.split("?"),d=hl(t,e,i),y={auth:n,ua:d,projectId:h},E=ol(g[1]||"",y);return g[0]+"?"+E}function Mt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ua(t){return Object.fromEntries(t.entries())}function ha(t){return new Map(Object.entries(t))}function Xt(t){const e=ee.toMiliseconds(t||ee.FIVE_MINUTES);let r,i,n;return{resolve:h=>{n&&r&&(clearTimeout(n),r(h))},reject:h=>{n&&i&&(clearTimeout(n),i(h))},done:()=>new Promise((h,g)=>{n=setTimeout(g,e),r=h,i=g})}}function fa(t,e){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(),e),h=await t;clearTimeout(n),r(h)})}function la(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function ll(t){return la("topic",t)}function dl(t){return la("id",t)}function da(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function It(t,e){return ee.fromMiliseconds((e||Date.now())+ee.toMiliseconds(t))}function jt(t){return Date.now()>=ee.toMiliseconds(t)}function je(t,e){return`${t}${e?`:${e}`:""}`}const pl="irn";function Wi(t){return t?.relay||{protocol:pl}}function ki(t){const e=qf[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var gl=Object.defineProperty,Ss=Object.getOwnPropertySymbols,yl=Object.prototype.hasOwnProperty,_l=Object.prototype.propertyIsEnumerable,Os=(t,e,r)=>e in t?gl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bl=(t,e)=>{for(var r in e||(e={}))yl.call(e,r)&&Os(t,r,e[r]);if(Ss)for(var r of Ss(e))_l.call(e,r)&&Os(t,r,e[r]);return t};function ml(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const h=n.replace(i,""),g=t[n];r[h]=g}}),r}function vl(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),h=typeof r<"u"?t.substring(r):"",g=Pr.parse(h);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:g.symKey,relay:ml(g)}}function wl(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const h=r+e+n;t[n]&&(i[h]=t[n])}),i}function El(t){return`${t.protocol}:${t.topic}@${t.version}?`+Pr.stringify(bl({symKey:t.symKey},wl(t.relay)))}function Ur(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Dl(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Ur(r.accounts))}),e}function Sl(t,e){const r=[];return Object.values(t).forEach(i=>{Ur(i.accounts).includes(e)&&r.push(...i.methods)}),r}function Ol(t,e){const r=[];return Object.values(t).forEach(i=>{Ur(i.accounts).includes(e)&&r.push(...i.events)}),r}function Il(t,e){const r=Qr(t,e);if(r)throw new Error(r.message);const i={};for(const[n,h]of Object.entries(t))i[n]={methods:h.methods,events:h.events,chains:h.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return i}const xl={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Pl={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(t,e){const{message:r,code:i}=Pl[t];return{message:e?`${r} ${e}`:r,code:i}}function Ze(t,e){const{message:r,code:i}=xl[t];return{message:e?`${r} ${e}`:r,code:i}}function li(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Sr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function at(t){return typeof t>"u"}function Qe(t,e){return e&&at(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function dn(t,e){return e&&at(t)?!0:typeof t=="number"&&!isNaN(t)}function Tl(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let h=!0;return Mt(n,i)?(i.forEach(g=>{const{accounts:d,methods:y,events:E}=t.namespaces[g],O=Ur(d),A=r[g];(!Mt(un(g,A),O)||!Mt(A.methods,y)||!Mt(A.events,E))&&(h=!1)}),h):!1}function pn(t){return Qe(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Al(t){if(Qe(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&pn(r)}}return!1}function Nl(t){if(Qe(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Cl(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Rl(t){return t?.topic}function Fl(t,e){let r=null;return Qe(t?.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Is(t){let e=!0;return li(t)?t.length&&(e=t.every(r=>Qe(r,!1))):e=!1,e}function Ll(t,e,r){let i=null;return li(e)?e.forEach(n=>{i||(!pn(n)||!n.includes(t))&&(i=Ze("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=Ze("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Ul(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const h=Ll(i,un(i,n),`${e} requiredNamespace`);h&&(r=h)}),r}function jl(t,e){let r=null;return li(t)?t.forEach(i=>{r||Al(i)||(r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Ml(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=jl(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function $l(t,e){let r=null;return Is(t?.methods)?Is(t?.events)||(r=Ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function pa(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=$l(i,`${e}, namespace`);n&&(r=n)}),r}function Hl(t,e,r){let i=null;if(t&&Sr(t)){const n=pa(t,e);n&&(i=n);const h=Ul(t,e);h&&(i=h)}else i=J("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Qr(t,e){let r=null;if(t&&Sr(t)){const i=pa(t,e);i&&(r=i);const n=Ml(t,e);n&&(r=n)}else r=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function ga(t){return Qe(t.protocol,!0)}function Bl(t,e){let r=!1;return e&&!t?r=!0:t&&li(t)&&t.length&&t.forEach(i=>{r=ga(i)}),r}function ql(t){return typeof t=="number"}function ct(t){return typeof t<"u"&&typeof t!==null}function zl(t){return!(!t||typeof t!="object"||!t.code||!dn(t.code,!1)||!t.message||!Qe(t.message,!1))}function Kl(t){return!(at(t)||!Qe(t.method,!1))}function Vl(t){return!(at(t)||at(t.result)&&at(t.error)||!dn(t.id,!1)||!Qe(t.jsonrpc,!1))}function Gl(t){return!(at(t)||!Qe(t.name,!1))}function xs(t,e){return!(!pn(e)||!Dl(t).includes(e))}function Wl(t,e,r){return Qe(r,!1)?Sl(t,e).includes(r):!1}function kl(t,e,r){return Qe(r,!1)?Ol(t,e).includes(r):!1}function Ti(t,e,r,i){let n=null;const h=Object.keys(t),g=Object.keys(e);return Mt(h,g)?h.forEach(d=>{if(n)return;const y=Ur(e[d].accounts);Mt(un(d,t[d]),y)?Mt(t[d].methods,e[d].methods)?Mt(t[d].events,e[d].events)||(n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`):n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace chains for ${d}`)}):n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy ${i}`),n}function Yl(t,e){return dn(t,!1)&&t<=e.max&&t>=e.min}const Jl="PARSE_ERROR",Xl="INVALID_REQUEST",Zl="METHOD_NOT_FOUND",Ql="INVALID_PARAMS",ya="INTERNAL_ERROR",gn="SERVER_ERROR",ed=[-32700,-32600,-32601,-32602,-32603],Or={[Jl]:{code:-32700,message:"Parse error"},[Xl]:{code:-32600,message:"Invalid Request"},[Zl]:{code:-32601,message:"Method not found"},[Ql]:{code:-32602,message:"Invalid params"},[ya]:{code:-32603,message:"Internal error"},[gn]:{code:-32e3,message:"Server error"}},_a=gn;function td(t){return ed.includes(t)}function Ps(t){return Object.keys(Or).includes(t)?Or[t]:Or[_a]}function rd(t){const e=Object.values(Or).find(r=>r.code===t);return e||Or[_a]}function ba(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var ma={},va={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,i,n,h,g,d,y,E,O,A,$,C,N,K,H,W,m,x,b,w,S,o;(function(p){var B=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(s(B,s(t.exports)));function s(f,l){return f!==B&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,f){s.__proto__=f}||function(s,f){for(var l in f)f.hasOwnProperty(l)&&(s[l]=f[l])};e=function(s,f){B(s,f);function l(){this.constructor=s}s.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(s){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(s[c]=f[c])}return s},i=function(s,f){var l={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&f.indexOf(_)<0&&(l[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(s);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(s,_[c])&&(l[_[c]]=s[_[c]]);return l},n=function(s,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,f,l,_);else for(var P=s.length-1;P>=0;P--)(D=s[P])&&(a=(c<3?D(a):c>3?D(f,l,a):D(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},h=function(s,f){return function(l,_){f(l,_,s)}},g=function(s,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,f)},d=function(s,f,l,_){function c(a){return a instanceof l?a:new l(function(D){D(a)})}return new(l||(l=Promise))(function(a,D){function P(U){try{v(_.next(U))}catch(z){D(z)}}function L(U){try{v(_.throw(U))}catch(z){D(z)}}function v(U){U.done?a(U.value):c(U.value).then(P,L)}v((_=_.apply(s,f||[])).next())})},y=function(s,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,D;return D={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function P(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(s,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},o=function(s,f,l,_){_===void 0&&(_=l),s[_]=f[l]},E=function(s,f){for(var l in s)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=s[l])},O=function(s){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&s[f],_=0;if(l)return l.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&_>=s.length&&(s=void 0),{value:s&&s[_++],done:!s}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},A=function(s,f){var l=typeof Symbol=="function"&&s[Symbol.iterator];if(!l)return s;var _=l.call(s),c,a=[],D;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(P){D={error:P}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(D)throw D.error}}return a},$=function(){for(var s=[],f=0;f<arguments.length;f++)s=s.concat(A(arguments[f]));return s},C=function(){for(var s=0,f=0,l=arguments.length;f<l;f++)s+=arguments[f].length;for(var _=Array(s),c=0,f=0;f<l;f++)for(var a=arguments[f],D=0,P=a.length;D<P;D++,c++)_[c]=a[D];return _},N=function(s){return this instanceof N?(this.v=s,this):new N(s)},K=function(s,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(s,f||[]),c,a=[];return c={},D("next"),D("throw"),D("return"),c[Symbol.asyncIterator]=function(){return this},c;function D(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||P(q,V)})})}function P(q,V){try{L(_[q](V))}catch(Q){z(a[0][3],Q)}}function L(q){q.value instanceof N?Promise.resolve(q.value.v).then(v,U):z(a[0][2],q)}function v(q){P("next",q)}function U(q){P("throw",q)}function z(q,V){q(V),a.shift(),a.length&&P(a[0][0],a[0][1])}},H=function(s){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=s[c]?function(D){return(l=!l)?{value:N(s[c](D)),done:c==="return"}:a?a(D):D}:a}},W=function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=s[Symbol.asyncIterator],l;return f?f.call(s):(s=typeof O=="function"?O(s):s[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=s[a]&&function(D){return new Promise(function(P,L){D=s[a](D),c(P,L,D.done,D.value)})}}function c(a,D,P,L){Promise.resolve(L).then(function(v){a({value:v,done:P})},D)}},m=function(s,f){return Object.defineProperty?Object.defineProperty(s,"raw",{value:f}):s.raw=f,s},x=function(s){if(s&&s.__esModule)return s;var f={};if(s!=null)for(var l in s)Object.hasOwnProperty.call(s,l)&&(f[l]=s[l]);return f.default=s,f},b=function(s){return s&&s.__esModule?s:{default:s}},w=function(s,f){if(!f.has(s))throw new TypeError("attempted to get private field on non-instance");return f.get(s)},S=function(s,f,l){if(!f.has(s))throw new TypeError("attempted to set private field on non-instance");return f.set(s,l),l},p("__extends",e),p("__assign",r),p("__rest",i),p("__decorate",n),p("__param",h),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",o),p("__values",O),p("__read",A),p("__spread",$),p("__spreadArrays",C),p("__await",N),p("__asyncGenerator",K),p("__asyncDelegator",H),p("__asyncValues",W),p("__makeTemplateObject",m),p("__importStar",x),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",S)})})(va);var At={},Ts;function id(){if(Ts)return At;Ts=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function t(){return(Ae===null||Ae===void 0?void 0:Ae.crypto)||(Ae===null||Ae===void 0?void 0:Ae.msCrypto)||{}}At.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}At.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return At.isBrowserCryptoAvailable=r,At}var Nt={},As;function nd(){if(As)return Nt;As=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowser=Nt.isNode=Nt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Nt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Nt.isNode=e;function r(){return!t()&&!e()}return Nt.isBrowser=r,Nt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=va.exports;e.__exportStar(id(),t),e.__exportStar(nd(),t)})(ma);function sd(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function di(t,e,r){return{id:r||sd(),jsonrpc:"2.0",method:t,params:e}}function yn(t,e){return{id:t,jsonrpc:"2.0",result:e}}function pi(t,e,r){return{id:t,jsonrpc:"2.0",error:od(e,r)}}function od(t,e){return typeof t>"u"?Ps(ya):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ps(gn)),{message:t})),typeof e<"u"&&(t.data=e),td(t.code)&&(t=rd(t.code)),t)}class ad{}class cd extends ad{constructor(){super()}}class ud extends cd{constructor(e){super()}}const hd="^https?:",fd="^wss?:";function ld(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function wa(t,e){const r=ld(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Ns(t){return wa(t,hd)}function Cs(t){return wa(t,fd)}function dd(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Ea(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function _n(t){return Ea(t)&&"method"in t}function bn(t){return Ea(t)&&(Ct(t)||wt(t))}function Ct(t){return"result"in t}function wt(t){return"error"in t}class jr extends ud{constructor(e){super(e),this.events=new st.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(di(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(h){n(h)}this.events.on(`${e.id}`,h=>{wt(h)?n(h.error):i(h.result)});try{await this.connection.send(e,r)}catch(h){n(h)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),bn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}function pd(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function gd(t){return typeof t=="string"?t:JSON.stringify(t)}const Rs=10,yd=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),_d=()=>typeof window<"u",bd=yd();class md{constructor(e){if(this.url=e,this.events=new st.exports.EventEmitter,this.registering=!1,!Cs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(gd(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Cs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),n(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=ma.isReactNative()?void 0:{rejectUnauthorized:!dd(e)},h=new bd(e,[],n);_d()?h.onerror=g=>{const d=g;i(this.emitError(d.error))}:h.on("error",g=>{i(this.emitError(g))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?pd(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),h=pi(e,n);this.events.emit("payload",h)}parseError(e,r=this.url){return ba(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Rs&&this.events.setMaxListeners(Rs)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Yi={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,h=2,g=9007199254740991,d="[object Arguments]",y="[object Array]",E="[object AsyncFunction]",O="[object Boolean]",A="[object Date]",$="[object Error]",C="[object Function]",N="[object GeneratorFunction]",K="[object Map]",H="[object Number]",W="[object Null]",m="[object Object]",x="[object Promise]",b="[object Proxy]",w="[object RegExp]",S="[object Set]",o="[object String]",p="[object Symbol]",B="[object Undefined]",s="[object WeakMap]",f="[object ArrayBuffer]",l="[object DataView]",_="[object Float32Array]",c="[object Float64Array]",a="[object Int8Array]",D="[object Int16Array]",P="[object Int32Array]",L="[object Uint8Array]",v="[object Uint8ClampedArray]",U="[object Uint16Array]",z="[object Uint32Array]",q=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[_]=Y[c]=Y[a]=Y[D]=Y[P]=Y[L]=Y[v]=Y[U]=Y[z]=!0,Y[d]=Y[y]=Y[f]=Y[O]=Y[l]=Y[A]=Y[$]=Y[C]=Y[K]=Y[H]=Y[m]=Y[w]=Y[S]=Y[o]=Y[s]=!1;var ae=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,M=typeof self=="object"&&self&&self.Object===Object&&self,j=ae||M||Function("return this")(),R=e&&!e.nodeType&&e,u=R&&!0&&t&&!t.nodeType&&t,T=u&&u.exports===R,k=T&&ae.process,X=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),fe=X&&X.isTypedArray;function _e(I,F){for(var G=-1,Z=I==null?0:I.length,Pe=0,ne=[];++G<Z;){var Le=I[G];F(Le,G,I)&&(ne[Pe++]=Le)}return ne}function de(I,F){for(var G=-1,Z=F.length,Pe=I.length;++G<Z;)I[Pe+G]=F[G];return I}function ve(I,F){for(var G=-1,Z=I==null?0:I.length;++G<Z;)if(F(I[G],G,I))return!0;return!1}function Ue(I,F){for(var G=-1,Z=Array(I);++G<I;)Z[G]=F(G);return Z}function Ce(I){return function(F){return I(F)}}function ye(I,F){return I.has(F)}function pe(I,F){return I?.[F]}function le(I){var F=-1,G=Array(I.size);return I.forEach(function(Z,Pe){G[++F]=[Pe,Z]}),G}function ue(I,F){return function(G){return I(F(G))}}function ce(I){var F=-1,G=Array(I.size);return I.forEach(function(Z){G[++F]=Z}),G}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,he=j["__core-js_shared__"],ge=se.toString,re=te.hasOwnProperty,be=function(){var I=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),me=te.toString,Ee=RegExp("^"+ge.call(re).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=T?j.Buffer:void 0,we=j.Symbol,mt=j.Uint8Array,Et=te.propertyIsEnumerable,Rt=oe.splice,lt=we?we.toStringTag:void 0,zt=Object.getOwnPropertySymbols,fr=De?De.isBuffer:void 0,Hr=ue(Object.keys,Object),Me=rr(j,"DataView"),Re=rr(j,"Map"),$e=rr(j,"Promise"),He=rr(j,"Set"),Be=rr(j,"WeakMap"),Fe=rr(Object,"create"),Ke=Vt(Me),Ve=Vt(Re),Ge=Vt($e),We=Vt(He),ke=Vt(Be),ze=we?we.prototype:void 0,qe=ze?ze.valueOf:void 0;function Te(I){var F=-1,G=I==null?0:I.length;for(this.clear();++F<G;){var Z=I[F];this.set(Z[0],Z[1])}}function Ye(){this.__data__=Fe?Fe(null):{},this.size=0}function Je(I){var F=this.has(I)&&delete this.__data__[I];return this.size-=F?1:0,F}function $a(I){var F=this.__data__;if(Fe){var G=F[I];return G===i?void 0:G}return re.call(F,I)?F[I]:void 0}function Ha(I){var F=this.__data__;return Fe?F[I]!==void 0:re.call(F,I)}function Ba(I,F){var G=this.__data__;return this.size+=this.has(I)?0:1,G[I]=Fe&&F===void 0?i:F,this}Te.prototype.clear=Ye,Te.prototype.delete=Je,Te.prototype.get=$a,Te.prototype.has=Ha,Te.prototype.set=Ba;function Pt(I){var F=-1,G=I==null?0:I.length;for(this.clear();++F<G;){var Z=I[F];this.set(Z[0],Z[1])}}function qa(){this.__data__=[],this.size=0}function za(I){var F=this.__data__,G=qr(F,I);if(G<0)return!1;var Z=F.length-1;return G==Z?F.pop():Rt.call(F,G,1),--this.size,!0}function Ka(I){var F=this.__data__,G=qr(F,I);return G<0?void 0:F[G][1]}function Va(I){return qr(this.__data__,I)>-1}function Ga(I,F){var G=this.__data__,Z=qr(G,I);return Z<0?(++this.size,G.push([I,F])):G[Z][1]=F,this}Pt.prototype.clear=qa,Pt.prototype.delete=za,Pt.prototype.get=Ka,Pt.prototype.has=Va,Pt.prototype.set=Ga;function Kt(I){var F=-1,G=I==null?0:I.length;for(this.clear();++F<G;){var Z=I[F];this.set(Z[0],Z[1])}}function Wa(){this.size=0,this.__data__={hash:new Te,map:new(Re||Pt),string:new Te}}function ka(I){var F=zr(this,I).delete(I);return this.size-=F?1:0,F}function Ya(I){return zr(this,I).get(I)}function Ja(I){return zr(this,I).has(I)}function Xa(I,F){var G=zr(this,I),Z=G.size;return G.set(I,F),this.size+=G.size==Z?0:1,this}Kt.prototype.clear=Wa,Kt.prototype.delete=ka,Kt.prototype.get=Ya,Kt.prototype.has=Ja,Kt.prototype.set=Xa;function Br(I){var F=-1,G=I==null?0:I.length;for(this.__data__=new Kt;++F<G;)this.add(I[F])}function Za(I){return this.__data__.set(I,i),this}function Qa(I){return this.__data__.has(I)}Br.prototype.add=Br.prototype.push=Za,Br.prototype.has=Qa;function Ft(I){var F=this.__data__=new Pt(I);this.size=F.size}function ec(){this.__data__=new Pt,this.size=0}function tc(I){var F=this.__data__,G=F.delete(I);return this.size=F.size,G}function rc(I){return this.__data__.get(I)}function ic(I){return this.__data__.has(I)}function nc(I,F){var G=this.__data__;if(G instanceof Pt){var Z=G.__data__;if(!Re||Z.length<r-1)return Z.push([I,F]),this.size=++G.size,this;G=this.__data__=new Kt(Z)}return G.set(I,F),this.size=G.size,this}Ft.prototype.clear=ec,Ft.prototype.delete=tc,Ft.prototype.get=rc,Ft.prototype.has=ic,Ft.prototype.set=nc;function sc(I,F){var G=Kr(I),Z=!G&&vc(I),Pe=!G&&!Z&&mi(I),ne=!G&&!Z&&!Pe&&Rn(I),Le=G||Z||Pe||ne,Xe=Le?Ue(I.length,String):[],et=Xe.length;for(var Ne in I)(F||re.call(I,Ne))&&!(Le&&(Ne=="length"||Pe&&(Ne=="offset"||Ne=="parent")||ne&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||gc(Ne,et)))&&Xe.push(Ne);return Xe}function qr(I,F){for(var G=I.length;G--;)if(Tn(I[G][0],F))return G;return-1}function oc(I,F,G){var Z=F(I);return Kr(I)?Z:de(Z,G(I))}function lr(I){return I==null?I===void 0?B:W:lt&&lt in Object(I)?dc(I):mc(I)}function On(I){return dr(I)&&lr(I)==d}function In(I,F,G,Z,Pe){return I===F?!0:I==null||F==null||!dr(I)&&!dr(F)?I!==I&&F!==F:ac(I,F,G,Z,In,Pe)}function ac(I,F,G,Z,Pe,ne){var Le=Kr(I),Xe=Kr(F),et=Le?y:Lt(I),Ne=Xe?y:Lt(F);et=et==d?m:et,Ne=Ne==d?m:Ne;var dt=et==m,vt=Ne==m,it=et==Ne;if(it&&mi(I)){if(!mi(F))return!1;Le=!0,dt=!1}if(it&&!dt)return ne||(ne=new Ft),Le||Rn(I)?xn(I,F,G,Z,Pe,ne):fc(I,F,et,G,Z,Pe,ne);if(!(G&n)){var gt=dt&&re.call(I,"__wrapped__"),yt=vt&&re.call(F,"__wrapped__");if(gt||yt){var Ut=gt?I.value():I,Tt=yt?F.value():F;return ne||(ne=new Ft),Pe(Ut,Tt,G,Z,ne)}}return it?(ne||(ne=new Ft),lc(I,F,G,Z,Pe,ne)):!1}function cc(I){if(!Cn(I)||_c(I))return!1;var F=An(I)?Ee:V;return F.test(Vt(I))}function uc(I){return dr(I)&&Nn(I.length)&&!!Y[lr(I)]}function hc(I){if(!bc(I))return Hr(I);var F=[];for(var G in Object(I))re.call(I,G)&&G!="constructor"&&F.push(G);return F}function xn(I,F,G,Z,Pe,ne){var Le=G&n,Xe=I.length,et=F.length;if(Xe!=et&&!(Le&&et>Xe))return!1;var Ne=ne.get(I);if(Ne&&ne.get(F))return Ne==F;var dt=-1,vt=!0,it=G&h?new Br:void 0;for(ne.set(I,F),ne.set(F,I);++dt<Xe;){var gt=I[dt],yt=F[dt];if(Z)var Ut=Le?Z(yt,gt,dt,F,I,ne):Z(gt,yt,dt,I,F,ne);if(Ut!==void 0){if(Ut)continue;vt=!1;break}if(it){if(!ve(F,function(Tt,Gt){if(!ye(it,Gt)&&(gt===Tt||Pe(gt,Tt,G,Z,ne)))return it.push(Gt)})){vt=!1;break}}else if(!(gt===yt||Pe(gt,yt,G,Z,ne))){vt=!1;break}}return ne.delete(I),ne.delete(F),vt}function fc(I,F,G,Z,Pe,ne,Le){switch(G){case l:if(I.byteLength!=F.byteLength||I.byteOffset!=F.byteOffset)return!1;I=I.buffer,F=F.buffer;case f:return!(I.byteLength!=F.byteLength||!ne(new mt(I),new mt(F)));case O:case A:case H:return Tn(+I,+F);case $:return I.name==F.name&&I.message==F.message;case w:case o:return I==F+"";case K:var Xe=le;case S:var et=Z&n;if(Xe||(Xe=ce),I.size!=F.size&&!et)return!1;var Ne=Le.get(I);if(Ne)return Ne==F;Z|=h,Le.set(I,F);var dt=xn(Xe(I),Xe(F),Z,Pe,ne,Le);return Le.delete(I),dt;case p:if(qe)return qe.call(I)==qe.call(F)}return!1}function lc(I,F,G,Z,Pe,ne){var Le=G&n,Xe=Pn(I),et=Xe.length,Ne=Pn(F),dt=Ne.length;if(et!=dt&&!Le)return!1;for(var vt=et;vt--;){var it=Xe[vt];if(!(Le?it in F:re.call(F,it)))return!1}var gt=ne.get(I);if(gt&&ne.get(F))return gt==F;var yt=!0;ne.set(I,F),ne.set(F,I);for(var Ut=Le;++vt<et;){it=Xe[vt];var Tt=I[it],Gt=F[it];if(Z)var Fn=Le?Z(Gt,Tt,it,F,I,ne):Z(Tt,Gt,it,I,F,ne);if(!(Fn===void 0?Tt===Gt||Pe(Tt,Gt,G,Z,ne):Fn)){yt=!1;break}Ut||(Ut=it=="constructor")}if(yt&&!Ut){var Vr=I.constructor,Gr=F.constructor;Vr!=Gr&&"constructor"in I&&"constructor"in F&&!(typeof Vr=="function"&&Vr instanceof Vr&&typeof Gr=="function"&&Gr instanceof Gr)&&(yt=!1)}return ne.delete(I),ne.delete(F),yt}function Pn(I){return oc(I,Dc,pc)}function zr(I,F){var G=I.__data__;return yc(F)?G[typeof F=="string"?"string":"hash"]:G.map}function rr(I,F){var G=pe(I,F);return cc(G)?G:void 0}function dc(I){var F=re.call(I,lt),G=I[lt];try{I[lt]=void 0;var Z=!0}catch{}var Pe=me.call(I);return Z&&(F?I[lt]=G:delete I[lt]),Pe}var pc=zt?function(I){return I==null?[]:(I=Object(I),_e(zt(I),function(F){return Et.call(I,F)}))}:Sc,Lt=lr;(Me&&Lt(new Me(new ArrayBuffer(1)))!=l||Re&&Lt(new Re)!=K||$e&&Lt($e.resolve())!=x||He&&Lt(new He)!=S||Be&&Lt(new Be)!=s)&&(Lt=function(I){var F=lr(I),G=F==m?I.constructor:void 0,Z=G?Vt(G):"";if(Z)switch(Z){case Ke:return l;case Ve:return K;case Ge:return x;case We:return S;case ke:return s}return F});function gc(I,F){return F=F??g,!!F&&(typeof I=="number"||Q.test(I))&&I>-1&&I%1==0&&I<F}function yc(I){var F=typeof I;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?I!=="__proto__":I===null}function _c(I){return!!be&&be in I}function bc(I){var F=I&&I.constructor,G=typeof F=="function"&&F.prototype||te;return I===G}function mc(I){return me.call(I)}function Vt(I){if(I!=null){try{return ge.call(I)}catch{}try{return I+""}catch{}}return""}function Tn(I,F){return I===F||I!==I&&F!==F}var vc=On(function(){return arguments}())?On:function(I){return dr(I)&&re.call(I,"callee")&&!Et.call(I,"callee")},Kr=Array.isArray;function wc(I){return I!=null&&Nn(I.length)&&!An(I)}var mi=fr||Oc;function Ec(I,F){return In(I,F)}function An(I){if(!Cn(I))return!1;var F=lr(I);return F==C||F==N||F==E||F==b}function Nn(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=g}function Cn(I){var F=typeof I;return I!=null&&(F=="object"||F=="function")}function dr(I){return I!=null&&typeof I=="object"}var Rn=fe?Ce(fe):uc;function Dc(I){return wc(I)?sc(I):hc(I)}function Sc(){return[]}function Oc(){return!1}t.exports=Ec})(Yi,Yi.exports);const vd=Yi.exports;function wd(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var h=t.charAt(n),g=h.charCodeAt(0);if(r[g]!==255)throw new TypeError(h+" is ambiguous");r[g]=n}var d=t.length,y=t.charAt(0),E=Math.log(d)/Math.log(256),O=Math.log(256)/Math.log(d);function A(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var K=0,H=0,W=0,m=N.length;W!==m&&N[W]===0;)W++,K++;for(var x=(m-W)*O+1>>>0,b=new Uint8Array(x);W!==m;){for(var w=N[W],S=0,o=x-1;(w!==0||S<H)&&o!==-1;o--,S++)w+=256*b[o]>>>0,b[o]=w%d>>>0,w=w/d>>>0;if(w!==0)throw new Error("Non-zero carry");H=S,W++}for(var p=x-H;p!==x&&b[p]===0;)p++;for(var B=y.repeat(K);p<x;++p)B+=t.charAt(b[p]);return B}function $(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var K=0;if(N[K]!==" "){for(var H=0,W=0;N[K]===y;)H++,K++;for(var m=(N.length-K)*E+1>>>0,x=new Uint8Array(m);N[K];){var b=r[N.charCodeAt(K)];if(b===255)return;for(var w=0,S=m-1;(b!==0||w<W)&&S!==-1;S--,w++)b+=d*x[S]>>>0,x[S]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");W=w,K++}if(N[K]!==" "){for(var o=m-W;o!==m&&x[o]===0;)o++;for(var p=new Uint8Array(H+(m-o)),B=H;o!==m;)p[B++]=x[o++];return p}}}function C(N){var K=$(N);if(K)return K;throw new Error(`Non-${e} character`)}return{encode:A,decodeUnsafe:$,decode:C}}var Ed=wd,Dd=Ed;const Da=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Sd=t=>new TextEncoder().encode(t),Od=t=>new TextDecoder().decode(t);class Id{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class xd{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Sa(this,e)}}class Pd{constructor(e){this.decoders=e}or(e){return Sa(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Sa=(t,e)=>new Pd({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Td{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Id(e,r,i),this.decoder=new xd(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gi=({name:t,prefix:e,encode:r,decode:i})=>new Td(t,e,r,i),Mr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Dd(r,e);return gi({prefix:t,name:e,encode:i,decode:h=>Da(n(h))})},Ad=(t,e,r,i)=>{const n={};for(let O=0;O<e.length;++O)n[e[O]]=O;let h=t.length;for(;t[h-1]==="=";)--h;const g=new Uint8Array(h*r/8|0);let d=0,y=0,E=0;for(let O=0;O<h;++O){const A=n[t[O]];if(A===void 0)throw new SyntaxError(`Non-${i} character`);y=y<<r|A,d+=r,d>=8&&(d-=8,g[E++]=255&y>>d)}if(d>=r||255&y<<8-d)throw new SyntaxError("Unexpected end of data");return g},Nd=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let h="",g=0,d=0;for(let y=0;y<t.length;++y)for(d=d<<8|t[y],g+=8;g>r;)g-=r,h+=e[n&d>>g];if(g&&(h+=e[n&d<<r-g]),i)for(;h.length*r&7;)h+="=";return h},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>gi({prefix:e,name:t,encode(n){return Nd(n,i,r)},decode(n){return Ad(n,i,r,t)}}),Cd=gi({prefix:"\0",name:"identity",encode:t=>Od(t),decode:t=>Sd(t)});var Rd=Object.freeze({__proto__:null,identity:Cd});const Fd=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ld=Object.freeze({__proto__:null,base2:Fd});const Ud=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var jd=Object.freeze({__proto__:null,base8:Ud});const Md=Mr({prefix:"9",name:"base10",alphabet:"0123456789"});var $d=Object.freeze({__proto__:null,base10:Md});const Hd=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Bd=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var qd=Object.freeze({__proto__:null,base16:Hd,base16upper:Bd});const zd=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Kd=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vd=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gd=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Wd=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kd=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Yd=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Jd=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Xd=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zd=Object.freeze({__proto__:null,base32:zd,base32upper:Kd,base32pad:Vd,base32padupper:Gd,base32hex:Wd,base32hexupper:kd,base32hexpad:Yd,base32hexpadupper:Jd,base32z:Xd});const Qd=Mr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ep=Mr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var tp=Object.freeze({__proto__:null,base36:Qd,base36upper:ep});const rp=Mr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ip=Mr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var np=Object.freeze({__proto__:null,base58btc:rp,base58flickr:ip});const sp=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),op=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ap=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),cp=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var up=Object.freeze({__proto__:null,base64:sp,base64pad:op,base64url:ap,base64urlpad:cp});const Oa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),hp=Oa.reduce((t,e,r)=>(t[r]=e,t),[]),fp=Oa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function lp(t){return t.reduce((e,r)=>(e+=hp[r],e),"")}function dp(t){const e=[];for(const r of t){const i=fp[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const pp=gi({prefix:"\u{1F680}",name:"base256emoji",encode:lp,decode:dp});var gp=Object.freeze({__proto__:null,base256emoji:pp}),yp=Ia,Fs=128,_p=127,bp=~_p,mp=Math.pow(2,31);function Ia(t,e,r){e=e||[],r=r||0;for(var i=r;t>=mp;)e[r++]=t&255|Fs,t/=128;for(;t&bp;)e[r++]=t&255|Fs,t>>>=7;return e[r]=t|0,Ia.bytes=r-i+1,e}var vp=Ji,wp=128,Ls=127;function Ji(t,i){var r=0,i=i||0,n=0,h=i,g,d=t.length;do{if(h>=d)throw Ji.bytes=0,new RangeError("Could not decode varint");g=t[h++],r+=n<28?(g&Ls)<<n:(g&Ls)*Math.pow(2,n),n+=7}while(g>=wp);return Ji.bytes=h-i,r}var Ep=Math.pow(2,7),Dp=Math.pow(2,14),Sp=Math.pow(2,21),Op=Math.pow(2,28),Ip=Math.pow(2,35),xp=Math.pow(2,42),Pp=Math.pow(2,49),Tp=Math.pow(2,56),Ap=Math.pow(2,63),Np=function(t){return t<Ep?1:t<Dp?2:t<Sp?3:t<Op?4:t<Ip?5:t<xp?6:t<Pp?7:t<Tp?8:t<Ap?9:10},Cp={encode:yp,decode:vp,encodingLength:Np},xa=Cp;const Us=(t,e,r=0)=>(xa.encode(t,e,r),e),js=t=>xa.encodingLength(t),Xi=(t,e)=>{const r=e.byteLength,i=js(t),n=i+js(r),h=new Uint8Array(n+r);return Us(t,h,0),Us(r,h,i),h.set(e,n),new Rp(t,r,e,h)};class Rp{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Pa=({name:t,code:e,encode:r})=>new Fp(t,e,r);class Fp{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Xi(this.code,r):r.then(i=>Xi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ta=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Lp=Pa({name:"sha2-256",code:18,encode:Ta("SHA-256")}),Up=Pa({name:"sha2-512",code:19,encode:Ta("SHA-512")});var jp=Object.freeze({__proto__:null,sha256:Lp,sha512:Up});const Aa=0,Mp="identity",Na=Da,$p=t=>Xi(Aa,Na(t)),Hp={code:Aa,name:Mp,encode:Na,digest:$p};var Bp=Object.freeze({__proto__:null,identity:Hp});new TextEncoder,new TextDecoder;const Ms={...Rd,...Ld,...jd,...$d,...qd,...Zd,...tp,...np,...up,...gp};({...jp,...Bp});function qp(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ca(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const $s=Ca("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ai=Ca("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=qp(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),zp={utf8:$s,"utf-8":$s,hex:Ms.base16,latin1:Ai,ascii:Ai,binary:Ai,...Ms};function Kp(t,e="utf8"){const r=zp[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Ra="wc",Vp=2,mn="core",$t=`${Ra}@${2}:${mn}:`,Gp={name:mn,logger:"error"},Wp={database:":memory:"},kp="crypto",Hs="client_ed25519_seed",Yp=ee.ONE_DAY,Jp="keychain",Xp="0.3",Zp="messages",Qp="0.3",eg=ee.SIX_HOURS,tg="publisher",Fa="irn",rg="error",La="wss://relay.walletconnect.com",ig="relayer",tt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ng="_subscription",kr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Bs=ee.ONE_SECOND,sg="2.4.5",og="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ag="subscription",cg="0.3",ug=ee.FIVE_SECONDS*1e3,hg="pairing",fg="0.3",wr={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},St={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},lg="history",dg="0.3",pg="expirer",bt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},gg="0.3";class yg{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Jp,this.version=Xp,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:h}=J("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(h)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ua(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ha(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class _g{constructor(e,r,i){this.core=e,this.logger=r,this.name=kp,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),h=us(n);return Vo(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Kf();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const h=await this.getClientSeed(),g=us(h),d=Gi();return await tf(d,n,Yp,g)},this.generateSharedKey=(n,h,g)=>{this.isInitialized();const d=this.getPrivateKey(n),y=Vf(d,h);return this.setSymKey(y,g)},this.setSymKey=async(n,h)=>{this.isInitialized();const g=h||Gf(n);return await this.keychain.set(g,n),g},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,h,g)=>{this.isInitialized();const d=aa(g),y=Lu(h);if(vs(d)){const $=d.senderPublicKey,C=d.receiverPublicKey;n=await this.generateSharedKey($,C)}const E=this.getSymKey(n),{type:O,senderPublicKey:A}=d;return kf({type:O,symKey:E,message:y,senderPublicKey:A})},this.decode=async(n,h,g)=>{this.isInitialized();const d=Xf(h,g);if(vs(d)){const O=d.receiverPublicKey,A=d.senderPublicKey;n=await this.generateSharedKey(O,A)}const y=this.getSymKey(n),E=Yf({symKey:y,encoded:h});return Fu(E)},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=i||new yg(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const r=ln(e);return Lr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hs)}catch{e=Gi(),await this.keychain.set(Hs,e)}return Kp(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class bg extends Iu{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Zp,this.version=Qp,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const h=ii(n);let g=this.messages.get(i);return typeof g>"u"&&(g={}),typeof g[h]<"u"||(g[h]=n,this.messages.set(i,g),await this.persist()),h},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const h=this.get(i),g=ii(n);return typeof h[g]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ua(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ha(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class mg extends xu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new st.exports.EventEmitter,this.name=tg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,h)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:h}});try{const g=h?.ttl||eg,d=Wi(h),y=h?.prompt||!1,E=h?.tag||0,O={topic:i,message:n,opts:{ttl:g,relay:d,prompt:y,tag:E}},A=ii(n);this.queue.set(A,O);try{await await fa(this.rpcPublish(i,n,g,d,y,E),this.publishTimeout),this.relayer.events.emit(tt.publish,O)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(tt.connection_stalled);return}this.onPublish(A,O),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,h,g){var d,y,E,O;const A={method:ki(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:h,tag:g}};return at((d=A.params)==null?void 0:d.prompt)&&((y=A.params)==null||delete y.prompt),at((E=A.params)==null?void 0:E.tag)&&((O=A.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.provider.request(A)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class vg{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(h=>h!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var wg=Object.defineProperty,Eg=Object.defineProperties,Dg=Object.getOwnPropertyDescriptors,qs=Object.getOwnPropertySymbols,Sg=Object.prototype.hasOwnProperty,Og=Object.prototype.propertyIsEnumerable,zs=(t,e,r)=>e in t?wg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Yr=(t,e)=>{for(var r in e||(e={}))Sg.call(e,r)&&zs(t,r,e[r]);if(qs)for(var r of qs(e))Og.call(e,r)&&zs(t,r,e[r]);return t},Ni=(t,e)=>Eg(t,Dg(e));class Ig extends Au{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new vg,this.events=new st.exports.EventEmitter,this.name=ag,this.version=cg,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$t,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const h=Wi(n),g={topic:i,relay:h};this.pending.set(i,g);const d=await this.rpcSubscribe(i,h);return this.onSubscribe(d,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),d}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,h)=>{const g=new ee.Watch;g.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(d),g.stop(this.pendingSubscriptionWatchLabel),n(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=ug&&(clearInterval(d),g.stop(this.pendingSubscriptionWatchLabel),h(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Wi(i);await this.rpcUnsubscribe(e,r,n);const h=Ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:ki(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await fa(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tt.connection_stalled)}return ii(e+this.clientId)}rpcUnsubscribe(e,r,i){const n={method:ki(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,Ni(Yr({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Ni(Yr({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Yr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ot.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,Ni(Yr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Ot.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const h=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(h,n)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(tt.connect,async()=>{await this.onConnect()}),this.relayer.on(tt.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var xg=Object.defineProperty,Ks=Object.getOwnPropertySymbols,Pg=Object.prototype.hasOwnProperty,Tg=Object.prototype.propertyIsEnumerable,Vs=(t,e,r)=>e in t?xg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ag=(t,e)=>{for(var r in e||(e={}))Pg.call(e,r)&&Vs(t,r,e[r]);if(Ks)for(var r of Ks(e))Tg.call(e,r)&&Vs(t,r,e[r]);return t};class Ng extends Pu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new st.exports.EventEmitter,this.name=ig,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Tr(Se.getDefaultLoggerOptions({level:e.logger||rg})),this.messages=new bg(this.logger,e.core),this.subscriber=new Ig(this,this.logger),this.publisher=new mg(this,this.logger),this.relayUrl=e?.relayUrl||La,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Ot.created,h=>{h.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(tt.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Ot.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(tt.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(tt.transport_closed,this.rejectTransportOpen))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw r;this.logger.error(r),this.events.emit(tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,Bs)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new jr(new md(fl({sdkVersion:sg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),_n(e)){if(!e.method.endsWith(ng))return;const r=e.params,{topic:i,message:n}=r.data,h={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ag({type:"event",event:r.id},h)),this.events.emit(r.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=yn(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(kr.payload,e=>this.onProviderPayload(e)),this.provider.on(kr.connect,()=>{this.events.emit(tt.connect)}),this.provider.on(kr.disconnect,()=>{this.events.emit(tt.disconnect),this.attemptToReconnect()}),this.provider.on(kr.error,e=>this.events.emit(tt.error,e)),this.events.on(tt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},ee.toMiliseconds(Bs))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Cg=Object.defineProperty,Gs=Object.getOwnPropertySymbols,Rg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,Ws=(t,e,r)=>e in t?Cg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ks=(t,e)=>{for(var r in e||(e={}))Rg.call(e,r)&&Ws(t,r,e[r]);if(Gs)for(var r of Gs(e))Fg.call(e,r)&&Ws(t,r,e[r]);return t};class yi extends Tu{constructor(e,r,i,n=$t,h=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=og,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{Cl(g)?this.map.set(g.id,g):Rl(g)?this.map.set(g.topic,g):this.getKey&&g!==null&&!at(g)&&this.map.set(this.getKey(g),g)}),this.cached=[],this.initialized=!0)},this.set=async(g,d)=>{this.isInitialized(),this.map.has(g)?await this.update(g,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:d}),this.map.set(g,d),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(d=>Object.keys(g).every(y=>vd(d[y],g[y]))):this.values),this.update=async(g,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:d});const y=ks(ks({},this.getData(g)),d);this.map.set(g,y),await this.persist()},this.delete=async(g,d)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:d}),this.map.delete(g),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=h}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Lg{constructor(e,r){this.core=e,this.logger=r,this.name=hg,this.version=fg,this.events=new st.exports,this.initialized=!1,this.storagePrefix=$t,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Gi(),n=await this.core.crypto.setSymKey(i),h=It(ee.FIVE_MINUTES),g={protocol:Fa},d={topic:n,expiry:h,relay:g,active:!1},y=El({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:g});return await this.pairings.set(n,d),await this.core.relayer.subscribe(n),this.core.expirer.set(n,h),{topic:n,uri:y}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:h,relay:g}=vl(i.uri),d=It(ee.FIVE_MINUTES),y={topic:n,relay:g,expiry:d,active:!1};return await this.pairings.set(n,y),await this.core.crypto.setSymKey(h,n),await this.core.relayer.subscribe(n,{relay:g}),this.core.expirer.set(n,d),i.activatePairing&&await this.activate({topic:n}),y},this.activate=async({topic:i})=>{this.isInitialized();const n=It(ee.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const h=await this.sendRequest(n,"wc_pairingPing",{}),{done:g,resolve:d,reject:y}=Xt();this.events.once(je("pairing_ping",h),({error:E})=>{E?y(E):d()}),await g()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ze("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,h)=>{const g=di(n,h),d=await this.core.crypto.encode(i,g),y=wr[n].req;return this.core.history.set(i,g),await this.core.relayer.publish(i,d,y),g.id},this.sendResult=async(i,n,h)=>{const g=yn(i,h),d=await this.core.crypto.encode(n,g),y=await this.core.history.get(n,i),E=wr[y.request.method].res;await this.core.relayer.publish(n,d,E),await this.core.history.resolve(g)},this.sendError=async(i,n,h)=>{const g=pi(i,h),d=await this.core.crypto.encode(n,g),y=await this.core.history.get(n,i),E=wr[y.request.method]?wr[y.request.method].res:wr.unregistered_method.res;await this.core.relayer.publish(n,d,E),await this.core.history.resolve(g)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>jt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:h}=i,g=h.method;if(this.pairings.keys.includes(n))switch(g){case"wc_pairingPing":return this.onPairingPingRequest(n,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,h);default:return this.onUnknownRpcMethodRequest(n,h)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:h}=i,g=(await this.core.history.get(n,h.id)).request.method;if(this.pairings.keys.includes(n))switch(g){case"wc_pairingPing":return this.onPairingPingResponse(n,h);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(i,n)=>{const{id:h}=n;try{this.isValidPing({topic:i}),await this.sendResult(h,i,!0),this.events.emit("pairing_ping",{id:h,topic:i})}catch(g){await this.sendError(h,i,g),this.logger.error(g)}},this.onPairingPingResponse=(i,n)=>{const{id:h}=n;setTimeout(()=>{Ct(n)?this.events.emit(je("pairing_ping",h),{}):wt(n)&&this.events.emit(je("pairing_ping",h),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:h}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:h,topic:i})}catch(g){await this.sendError(h,i,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:h,method:g}=n;try{if(this.registeredMethods.includes(g))return;const d=Ze("WC_METHOD_UNSUPPORTED",g);await this.sendError(h,i,d),this.logger.error(d)}catch(d){await this.sendError(h,i,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ct(i)){const{message:n}=J("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Nl(i.uri)){const{message:n}=J("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ct(i)){const{message:h}=J("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(h)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ct(i)){const{message:h}=J("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(h)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Qe(i,!1)){const{message:n}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(jt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=J("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new yi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);_n(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):bn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(bt.expired,async e=>{const{topic:r}=da(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Ug extends Ou{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new st.exports.EventEmitter,this.name=lg,this.version=dg,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:h}),this.records.has(n.id))return;const g={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:h};this.records.set(g.id,g),this.events.emit(St.created,g)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=wt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(St.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(h=>{if(h.topic===i){if(typeof n<"u"&&h.id!==n)return;this.records.delete(h.id),this.events.emit(St.deleted,h)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:di(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(St.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(St.created,e=>{const r=St.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(St.updated,e=>{const r=St.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(St.deleted,e=>{const r=St.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class jg extends Nu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new st.exports.EventEmitter,this.name=pg,this.version=gg,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const h=this.formatTarget(i),g={target:h,expiry:n};this.expirations.set(h,g),this.checkExpiry(h,g),this.events.emit(bt.created,{target:h,expiration:g})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),h=this.getExpiration(n);this.expirations.delete(n),this.events.emit(bt.deleted,{target:n,expiration:h})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return ll(e);if(typeof e=="number")return dl(e);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(bt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;ee.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(bt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(bt.created,e=>{const r=bt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(bt.expired,e=>{const r=bt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(bt.deleted,e=>{const r=bt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Mg=Object.defineProperty,Ys=Object.getOwnPropertySymbols,$g=Object.prototype.hasOwnProperty,Hg=Object.prototype.propertyIsEnumerable,Js=(t,e,r)=>e in t?Mg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xs=(t,e)=>{for(var r in e||(e={}))$g.call(e,r)&&Js(t,r,e[r]);if(Ys)for(var r of Ys(e))Hg.call(e,r)&&Js(t,r,e[r]);return t};class vn extends Su{constructor(e){super(e),this.protocol=Ra,this.version=Vp,this.name=mn,this.events=new st.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||La;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||Gp.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Nr.HeartBeat,this.crypto=new _g(this,this.logger,e?.keychain),this.history=new Ug(this,this.logger),this.expirer=new jg(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new uu(Xs(Xs({},Wp),e?.storageOptions)),this.relayer=new Ng({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Lg(this,this.logger)}static async init(e){const r=new vn(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Bg=vn,Ua="wc",ja=2,Ma="client",wn=`${Ua}@${ja}:${Ma}:`,Ci={name:Ma,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},qg="proposal",zg="session",Jr=ee.SEVEN_DAYS,Kg="engine",Er={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ri={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},Vg="request";var Gg=Object.defineProperty,Wg=Object.defineProperties,kg=Object.getOwnPropertyDescriptors,Zs=Object.getOwnPropertySymbols,Yg=Object.prototype.hasOwnProperty,Jg=Object.prototype.propertyIsEnumerable,Qs=(t,e,r)=>e in t?Gg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_t=(t,e)=>{for(var r in e||(e={}))Yg.call(e,r)&&Qs(t,r,e[r]);if(Zs)for(var r of Zs(e))Jg.call(e,r)&&Qs(t,r,e[r]);return t},Fi=(t,e)=>Wg(t,kg(e));class Xg extends Ru{constructor(e){super(e),this.name=Kg,this.events=new st.exports,this.initialized=!1,this.ignoredPayloadTypes=[er],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Er)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=Fi(_t({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:h,optionalNamespaces:g,sessionProperties:d,relays:y}=i;let E=n,O,A=!1;if(E&&(A=this.client.core.pairing.pairings.get(E).active),!E||!A){const{topic:x,uri:b}=await this.client.core.pairing.create();E=x,O=b}const $=await this.client.core.crypto.generateKeyPair(),C=_t({requiredNamespaces:h,optionalNamespaces:g,relays:y??[{protocol:Fa}],proposer:{publicKey:$,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:N,resolve:K,done:H}=Xt();if(this.events.once(je("session_connect"),async({error:x,session:b})=>{if(x)N(x);else if(b){b.self.publicKey=$;const w=Fi(_t({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces});await this.client.session.set(b.topic,w),await this.setExpiry(b.topic,b.expiry),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:b.peer.metadata}),K(w)}}),!E){const{message:x}=J("NO_MATCHING_KEY",`connect() pairing topic: ${E}`);throw new Error(x)}const W=await this.sendRequest(E,"wc_sessionPropose",C),m=It(ee.FIVE_MINUTES);return await this.setProposal(W,_t({id:W,expiry:m},C)),{uri:O,approval:H}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:h,sessionProperties:g}=r,d=this.client.proposal.get(i);let{pairingTopic:y,proposer:E,requiredNamespaces:O,optionalNamespaces:A}=d;Sr(O)||(O=Il(h,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),C=E.publicKey,N=await this.client.core.crypto.generateSharedKey($,C);y&&i&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:E.metadata}),await this.sendResult(i,y,{relay:{protocol:n??"irn"},responderPublicKey:$}),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const K=_t({relay:{protocol:n??"irn"},namespaces:h,requiredNamespaces:O,optionalNamespaces:A,controller:{publicKey:$,metadata:this.client.metadata},expiry:It(Jr)},g&&{sessionProperties:g});await this.client.core.relayer.subscribe(N);const H=await this.sendRequest(N,"wc_sessionSettle",K),{done:W,resolve:m,reject:x}=Xt();this.events.once(je("session_approve",H),({error:w})=>{w?x(w):m(this.client.session.get(N))});const b=Fi(_t({},K),{topic:N,acknowledged:!1,self:K.controller,peer:{publicKey:E.publicKey,metadata:E.metadata},controller:$});return await this.client.session.set(N,b),await this.setExpiry(N,It(Jr)),{topic:N,acknowledged:W}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:h}=this.client.proposal.get(i);h&&(await this.sendError(i,h,n),await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,h=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:g,resolve:d,reject:y}=Xt();return this.events.once(je("session_update",h),({error:E})=>{E?y(E):d()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:g}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:h,resolve:g,reject:d}=Xt();return this.events.once(je("session_extend",n),({error:y})=>{y?d(y):g()}),await this.setExpiry(i,It(Jr)),{acknowledged:h}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:h,expiry:g}=r,d=await this.sendRequest(h,"wc_sessionRequest",{request:n,chainId:i},g),{done:y,resolve:E,reject:O}=Xt(g);return this.events.once(je("session_request",d),({error:A,result:$})=>{A?O(A):E($)}),this.client.events.emit("session_request_sent",{topic:h,request:n,chainId:i}),await y()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:h}=n;Ct(n)?await this.sendResult(h,i,n.result):wt(n)&&await this.sendError(h,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:h,resolve:g,reject:d}=Xt();this.events.once(je("session_ping",n),({error:y})=>{y?d(y):g()}),await h()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:h}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:h})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Ze("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Tl(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Ze("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Er.wc_sessionRequest.req.ttl,{id:n,topic:h,params:g}=r;await this.client.pendingRequest.set(n,{id:n,topic:h,params:g}),i&&this.client.core.expirer.set(n,It(i))},this.sendRequest=async(r,i,n,h)=>{const g=di(i,n),d=await this.client.core.crypto.encode(r,g),y=Er[i].req;return h&&(y.ttl=h),this.client.core.history.set(r,g),this.client.core.relayer.publish(r,d,y),g.id},this.sendResult=async(r,i,n)=>{const h=yn(r,n),g=await this.client.core.crypto.encode(i,h),d=await this.client.core.history.get(i,r),y=Er[d.request.method].res;this.client.core.relayer.publish(i,g,y),await this.client.core.history.resolve(h)},this.sendError=async(r,i,n)=>{const h=pi(r,n),g=await this.client.core.crypto.encode(i,h),d=await this.client.core.history.get(i,r),y=Er[d.request.method].res;this.client.core.relayer.publish(i,g,y),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{jt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{jt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,h=n.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,h=(await this.client.core.history.get(i,n.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:h}=i;try{this.isValidConnect(_t({},i.params));const g=It(ee.FIVE_MINUTES),d=_t({id:h,pairingTopic:r,expiry:g},n);await this.setProposal(h,d),this.client.events.emit("session_proposal",{id:h,params:d})}catch(g){await this.sendError(h,r,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ct(i)){const{result:h}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const g=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const d=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const y=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const E=await this.client.core.crypto.generateSharedKey(d,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:E});const O=await this.client.core.relayer.subscribe(E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:O}),await this.client.core.pairing.activate({topic:r})}else wt(i)&&(await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")),this.events.emit(je("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:h}=i;try{this.isValidSessionSettleRequest(h);const{relay:g,controller:d,expiry:y,namespaces:E,requiredNamespaces:O,optionalNamespaces:A,sessionProperties:$}=i.params,C=_t({topic:r,relay:g,expiry:y,namespaces:E,acknowledged:!0,requiredNamespaces:O,optionalNamespaces:A,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},$&&{sessionProperties:$});await this.sendResult(i.id,r,!0),this.events.emit(je("session_connect"),{session:C})}catch(g){await this.sendError(n,r,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ct(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(je("session_approve",n),{})):wt(i)&&(await this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.events.emit(je("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:h}=i;try{this.isValidUpdate(_t({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(h,r,!0),this.client.events.emit("session_update",{id:h,topic:r,params:n})}catch(g){await this.sendError(h,r,g),this.client.logger.error(g)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_update",n),{}):wt(i)&&this.events.emit(je("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,It(Jr)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(h){await this.sendError(n,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_extend",n),{}):wt(i)&&this.events.emit(je("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(h){await this.sendError(n,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ct(i)?this.events.emit(je("session_ping",n),{}):wt(i)&&this.events.emit(je("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),this.client.core.relayer.once(tt.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(n,r,!0),this.client.events.emit("session_delete",{id:n,topic:r})}catch(h){await this.sendError(n,r,h),this.client.logger.error(h)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:h}=i;try{this.isValidRequest(_t({topic:r},h)),await this.setPendingSessionRequest({id:n,topic:r,params:h}),this.client.events.emit("session_request",{id:n,topic:r,params:h})}catch(g){await this.sendError(n,r,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_request",n),{result:i.result}):wt(i)&&this.events.emit(je("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:h}=i;try{this.isValidEmit(_t({topic:r},h)),this.client.events.emit("session_event",{id:n,topic:r,params:h})}catch(g){await this.sendError(n,r,g),this.client.logger.error(g)}},this.isValidConnect=async r=>{if(!ct(r)){const{message:y}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(y)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:h,sessionProperties:g,relays:d}=r;if(at(i)||await this.isValidPairingTopic(i),!Bl(d,!0)){const{message:y}=J("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(y)}!at(n)&&Sr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!at(h)&&Sr(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),at(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=Hl(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!ct(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:h,sessionProperties:g}=r;await this.isValidProposalId(i);const d=this.client.proposal.get(i),y=Qr(n,"approve()");if(y)throw new Error(y.message);const E=Ti(d.requiredNamespaces,n,"approve()","requiredNamespaces");if(E)throw new Error(E.message);if(!Qe(h,!0)){const{message:O}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(O)}if(Object.keys(n).length>Object.keys(d.requiredNamespaces).length){const O=Object.keys(d.optionalNamespaces).filter(C=>n[C]),A={};for(const C in d.optionalNamespaces)O.includes(C)&&(A[C]=d.optionalNamespaces[C]);const $=Ti(A,n,"approve()","optionalNamespaces");if($)throw new Error($.message)}at(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async r=>{if(!ct(r)){const{message:h}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!zl(n)){const{message:h}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!ct(r)){const{message:E}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(E)}const{relay:i,controller:n,namespaces:h,expiry:g}=r;if(!ga(i)){const{message:E}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(E)}const d=Fl(n,"onSessionSettleRequest()");if(d)throw new Error(d.message);const y=Qr(h,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(jt(g)){const{message:E}=J("EXPIRED","onSessionSettleRequest()");throw new Error(E)}},this.isValidUpdate=async r=>{if(!ct(r)){const{message:y}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(y)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const h=this.client.session.get(i),g=Qr(n,"update()");if(g)throw new Error(g.message);const d=Ti(h.requiredNamespaces,n,"update()","requiredNamespaces");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!ct(r)){const{message:n}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!ct(r)){const{message:y}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(y)}const{topic:i,request:n,chainId:h,expiry:g}=r;await this.isValidSessionTopic(i);const{namespaces:d}=this.client.session.get(i);if(!xs(d,h)){const{message:y}=J("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(y)}if(!Kl(n)){const{message:y}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(y)}if(!Wl(d,h,n.method)){const{message:y}=J("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(y)}if(g&&!Yl(g,Ri)){const{message:y}=J("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${Ri.min} and ${Ri.max}`);throw new Error(y)}},this.isValidRespond=async r=>{if(!ct(r)){const{message:h}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Vl(n)){const{message:h}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!ct(r)){const{message:n}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!ct(r)){const{message:d}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:i,event:n,chainId:h}=r;await this.isValidSessionTopic(i);const{namespaces:g}=this.client.session.get(i);if(!xs(g,h)){const{message:d}=J("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(d)}if(!Gl(n)){const{message:d}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(d)}if(!kl(g,h,n.name)){const{message:d}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!ct(r)){const{message:n}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Qe(n,!1)){const{message:h}=J("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(h)}})}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(tt.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);_n(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):bn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(bt.expired,async e=>{const{topic:r,id:i}=da(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=J("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!ql(e)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=J("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Zg extends yi{constructor(e,r){super(e,r,qg,wn),this.core=e,this.logger=r}}class Qg extends yi{constructor(e,r){super(e,r,zg,wn),this.core=e,this.logger=r}}class ey extends yi{constructor(e,r){super(e,r,Vg,wn),this.core=e,this.logger=r}}class En extends Cu{constructor(e){super(e),this.protocol=Ua,this.version=ja,this.name=Ci.name,this.events=new st.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||Ci.name,this.metadata=e?.metadata||al();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||Ci.logger}));this.core=e?.core||new Bg(e),this.logger=Se.generateChildLogger(r,this.name),this.session=new Qg(this.core,this.logger),this.proposal=new Zg(this.core,this.logger),this.pendingRequest=new ey(this.core,this.logger),this.engine=new Xg(this)}static async init(e){const r=new En(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=xe.getLocation=xe.getLocationOrThrow=xe.getNavigator=xe.getNavigatorOrThrow=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function tr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=tr;function hr(t){const e=tr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=hr;function ty(){return hr("document")}xe.getDocumentOrThrow=ty;function ry(){return tr("document")}xe.getDocument=ry;function iy(){return hr("navigator")}xe.getNavigatorOrThrow=iy;function ny(){return tr("navigator")}xe.getNavigator=ny;function sy(){return hr("location")}xe.getLocationOrThrow=sy;function oy(){return tr("location")}xe.getLocation=oy;function ay(){return hr("crypto")}xe.getCryptoOrThrow=ay;function cy(){return tr("crypto")}xe.getCrypto=cy;function uy(){return hr("localStorage")}xe.getLocalStorageOrThrow=uy;function hy(){return tr("localStorage")}xe.getLocalStorage=hy;var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.getWindowMetadata=void 0;const eo=xe;function fy(){let t,e;try{t=eo.getDocumentOrThrow(),e=eo.getLocationOrThrow()}catch{return null}function r(){const A=t.getElementsByTagName("link"),$=[];for(let C=0;C<A.length;C++){const N=A[C],K=N.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const H=N.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(H.indexOf("/")===0)W+=H;else{const m=e.pathname.split("/");m.pop(),W+=m.join("/")+"/"+H}$.push(W)}else if(H.indexOf("//")===0){const W=e.protocol+H;$.push(W)}else $.push(H)}}return $}function i(...A){const $=t.getElementsByTagName("meta");for(let C=0;C<$.length;C++){const N=$[C],K=["itemprop","property","name"].map(H=>N.getAttribute(H)).filter(H=>H?A.includes(H):!1);if(K.length&&K){const H=N.getAttribute("content");if(H)return H}}return""}function n(){let A=i("name","og:site_name","og:title","twitter:title");return A||(A=t.title),A}function h(){return i("description","og:description","twitter:description","keywords")}const g=n(),d=h(),y=e.origin,E=r();return{description:d,url:y,icons:E,name:g}}Dn.getWindowMetadata=fy;var ly={};(function(t){const e=ea,r=ra,i=ia,n=na,h=m=>m==null,g=Symbol("encodeFragmentIdentifier");function d(m){switch(m.arrayFormat){case"index":return x=>(b,w)=>{const S=b.length;return w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),"[",S,"]"].join("")]:[...b,[O(x,m),"[",O(S,m),"]=",O(w,m)].join("")]};case"bracket":return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),"[]"].join("")]:[...b,[O(x,m),"[]=",O(w,m)].join("")];case"colon-list-separator":return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[O(x,m),":list="].join("")]:[...b,[O(x,m),":list=",O(w,m)].join("")];case"comma":case"separator":case"bracket-separator":{const x=m.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,S)=>S===void 0||m.skipNull&&S===null||m.skipEmptyString&&S===""?w:(S=S===null?"":S,w.length===0?[[O(b,m),x,O(S,m)].join("")]:[[w,O(S,m)].join(m.arrayFormatSeparator)])}default:return x=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,O(x,m)]:[...b,[O(x,m),"=",O(w,m)].join("")]}}function y(m){let x;switch(m.arrayFormat){case"index":return(b,w,S)=>{if(x=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!x){S[b]=w;return}S[b]===void 0&&(S[b]={}),S[b][x[1]]=w};case"bracket":return(b,w,S)=>{if(x=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!x){S[b]=w;return}if(S[b]===void 0){S[b]=[w];return}S[b]=[].concat(S[b],w)};case"colon-list-separator":return(b,w,S)=>{if(x=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!x){S[b]=w;return}if(S[b]===void 0){S[b]=[w];return}S[b]=[].concat(S[b],w)};case"comma":case"separator":return(b,w,S)=>{const o=typeof w=="string"&&w.includes(m.arrayFormatSeparator),p=typeof w=="string"&&!o&&A(w,m).includes(m.arrayFormatSeparator);w=p?A(w,m):w;const B=o||p?w.split(m.arrayFormatSeparator).map(s=>A(s,m)):w===null?w:A(w,m);S[b]=B};case"bracket-separator":return(b,w,S)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){S[b]=w&&A(w,m);return}const p=w===null?[]:w.split(m.arrayFormatSeparator).map(B=>A(B,m));if(S[b]===void 0){S[b]=p;return}S[b]=[].concat(S[b],p)};default:return(b,w,S)=>{if(S[b]===void 0){S[b]=w;return}S[b]=[].concat(S[b],w)}}}function E(m){if(typeof m!="string"||m.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function O(m,x){return x.encode?x.strict?e(m):encodeURIComponent(m):m}function A(m,x){return x.decode?r(m):m}function $(m){return Array.isArray(m)?m.sort():typeof m=="object"?$(Object.keys(m)).sort((x,b)=>Number(x)-Number(b)).map(x=>m[x]):m}function C(m){const x=m.indexOf("#");return x!==-1&&(m=m.slice(0,x)),m}function N(m){let x="";const b=m.indexOf("#");return b!==-1&&(x=m.slice(b)),x}function K(m){m=C(m);const x=m.indexOf("?");return x===-1?"":m.slice(x+1)}function H(m,x){return x.parseNumbers&&!Number.isNaN(Number(m))&&typeof m=="string"&&m.trim()!==""?m=Number(m):x.parseBooleans&&m!==null&&(m.toLowerCase()==="true"||m.toLowerCase()==="false")&&(m=m.toLowerCase()==="true"),m}function W(m,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),E(x.arrayFormatSeparator);const b=y(x),w=Object.create(null);if(typeof m!="string"||(m=m.trim().replace(/^[?#&]/,""),!m))return w;for(const S of m.split("&")){if(S==="")continue;let[o,p]=i(x.decode?S.replace(/\+/g," "):S,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?p:A(p,x),b(A(o,x),p,w)}for(const S of Object.keys(w)){const o=w[S];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=H(o[p],x);else w[S]=H(o,x)}return x.sort===!1?w:(x.sort===!0?Object.keys(w).sort():Object.keys(w).sort(x.sort)).reduce((S,o)=>{const p=w[o];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?S[o]=$(p):S[o]=p,S},Object.create(null))}t.extract=K,t.parse=W,t.stringify=(m,x)=>{if(!m)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),E(x.arrayFormatSeparator);const b=p=>x.skipNull&&h(m[p])||x.skipEmptyString&&m[p]==="",w=d(x),S={};for(const p of Object.keys(m))b(p)||(S[p]=m[p]);const o=Object.keys(S);return x.sort!==!1&&o.sort(x.sort),o.map(p=>{const B=m[p];return B===void 0?"":B===null?O(p,x):Array.isArray(B)?B.length===0&&x.arrayFormat==="bracket-separator"?O(p,x)+"[]":B.reduce(w(p),[]).join("&"):O(p,x)+"="+O(B,x)}).filter(p=>p.length>0).join("&")},t.parseUrl=(m,x)=>{x=Object.assign({decode:!0},x);const[b,w]=i(m,"#");return Object.assign({url:b.split("?")[0]||"",query:W(K(m),x)},x&&x.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,x)}:{})},t.stringifyUrl=(m,x)=>{x=Object.assign({encode:!0,strict:!0,[g]:!0},x);const b=C(m.url).split("?")[0]||"",w=t.extract(m.url),S=t.parse(w,{sort:!1}),o=Object.assign(S,m.query);let p=t.stringify(o,x);p&&(p=`?${p}`);let B=N(m.url);return m.fragmentIdentifier&&(B=`#${x[g]?O(m.fragmentIdentifier,x):m.fragmentIdentifier}`),`${b}${p}${B}`},t.pick=(m,x,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[g]:!1},b);const{url:w,query:S,fragmentIdentifier:o}=t.parseUrl(m,b);return t.stringifyUrl({url:w,query:n(S,x),fragmentIdentifier:o},b)},t.exclude=(m,x,b)=>{const w=Array.isArray(x)?S=>!x.includes(S):(S,o)=>!x(S,o);return t.pick(m,w,b)}})(ly);const dy={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function to(t,e){const{message:r,code:i}=dy[t];return{message:e?`${r} ${e}`:r,code:i}}function py(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}var Zi={exports:{}};(function(t,e){var r=typeof self<"u"?self:Ae,i=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(g){var d={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function y(c){return c&&DataView.prototype.isPrototypeOf(c)}if(d.arrayBuffer)var E=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],O=ArrayBuffer.isView||function(c){return c&&E.indexOf(Object.prototype.toString.call(c))>-1};function A(c){if(typeof c!="string"&&(c=String(c)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(c))throw new TypeError("Invalid character in header field name");return c.toLowerCase()}function $(c){return typeof c!="string"&&(c=String(c)),c}function C(c){var a={next:function(){var D=c.shift();return{done:D===void 0,value:D}}};return d.iterable&&(a[Symbol.iterator]=function(){return a}),a}function N(c){this.map={},c instanceof N?c.forEach(function(a,D){this.append(D,a)},this):Array.isArray(c)?c.forEach(function(a){this.append(a[0],a[1])},this):c&&Object.getOwnPropertyNames(c).forEach(function(a){this.append(a,c[a])},this)}N.prototype.append=function(c,a){c=A(c),a=$(a);var D=this.map[c];this.map[c]=D?D+", "+a:a},N.prototype.delete=function(c){delete this.map[A(c)]},N.prototype.get=function(c){return c=A(c),this.has(c)?this.map[c]:null},N.prototype.has=function(c){return this.map.hasOwnProperty(A(c))},N.prototype.set=function(c,a){this.map[A(c)]=$(a)},N.prototype.forEach=function(c,a){for(var D in this.map)this.map.hasOwnProperty(D)&&c.call(a,this.map[D],D,this)},N.prototype.keys=function(){var c=[];return this.forEach(function(a,D){c.push(D)}),C(c)},N.prototype.values=function(){var c=[];return this.forEach(function(a){c.push(a)}),C(c)},N.prototype.entries=function(){var c=[];return this.forEach(function(a,D){c.push([D,a])}),C(c)},d.iterable&&(N.prototype[Symbol.iterator]=N.prototype.entries);function K(c){if(c.bodyUsed)return Promise.reject(new TypeError("Already read"));c.bodyUsed=!0}function H(c){return new Promise(function(a,D){c.onload=function(){a(c.result)},c.onerror=function(){D(c.error)}})}function W(c){var a=new FileReader,D=H(a);return a.readAsArrayBuffer(c),D}function m(c){var a=new FileReader,D=H(a);return a.readAsText(c),D}function x(c){for(var a=new Uint8Array(c),D=new Array(a.length),P=0;P<a.length;P++)D[P]=String.fromCharCode(a[P]);return D.join("")}function b(c){if(c.slice)return c.slice(0);var a=new Uint8Array(c.byteLength);return a.set(new Uint8Array(c)),a.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(c){this._bodyInit=c,c?typeof c=="string"?this._bodyText=c:d.blob&&Blob.prototype.isPrototypeOf(c)?this._bodyBlob=c:d.formData&&FormData.prototype.isPrototypeOf(c)?this._bodyFormData=c:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)?this._bodyText=c.toString():d.arrayBuffer&&d.blob&&y(c)?(this._bodyArrayBuffer=b(c.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(c)||O(c))?this._bodyArrayBuffer=b(c):this._bodyText=c=Object.prototype.toString.call(c):this._bodyText="",this.headers.get("content-type")||(typeof c=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var c=K(this);if(c)return c;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(W)}),this.text=function(){var c=K(this);if(c)return c;if(this._bodyBlob)return m(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(x(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function o(c){var a=c.toUpperCase();return S.indexOf(a)>-1?a:c}function p(c,a){a=a||{};var D=a.body;if(c instanceof p){if(c.bodyUsed)throw new TypeError("Already read");this.url=c.url,this.credentials=c.credentials,a.headers||(this.headers=new N(c.headers)),this.method=c.method,this.mode=c.mode,this.signal=c.signal,!D&&c._bodyInit!=null&&(D=c._bodyInit,c.bodyUsed=!0)}else this.url=String(c);if(this.credentials=a.credentials||this.credentials||"same-origin",(a.headers||!this.headers)&&(this.headers=new N(a.headers)),this.method=o(a.method||this.method||"GET"),this.mode=a.mode||this.mode||null,this.signal=a.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}p.prototype.clone=function(){return new p(this,{body:this._bodyInit})};function B(c){var a=new FormData;return c.trim().split("&").forEach(function(D){if(D){var P=D.split("="),L=P.shift().replace(/\+/g," "),v=P.join("=").replace(/\+/g," ");a.append(decodeURIComponent(L),decodeURIComponent(v))}}),a}function s(c){var a=new N,D=c.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(P){var L=P.split(":"),v=L.shift().trim();if(v){var U=L.join(":").trim();a.append(v,U)}}),a}w.call(p.prototype);function f(c,a){a||(a={}),this.type="default",this.status=a.status===void 0?200:a.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in a?a.statusText:"OK",this.headers=new N(a.headers),this.url=a.url||"",this._initBody(c)}w.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new N(this.headers),url:this.url})},f.error=function(){var c=new f(null,{status:0,statusText:""});return c.type="error",c};var l=[301,302,303,307,308];f.redirect=function(c,a){if(l.indexOf(a)===-1)throw new RangeError("Invalid status code");return new f(null,{status:a,headers:{location:c}})},g.DOMException=h.DOMException;try{new g.DOMException}catch{g.DOMException=function(a,D){this.message=a,this.name=D;var P=Error(a);this.stack=P.stack},g.DOMException.prototype=Object.create(Error.prototype),g.DOMException.prototype.constructor=g.DOMException}function _(c,a){return new Promise(function(D,P){var L=new p(c,a);if(L.signal&&L.signal.aborted)return P(new g.DOMException("Aborted","AbortError"));var v=new XMLHttpRequest;function U(){v.abort()}v.onload=function(){var z={status:v.status,statusText:v.statusText,headers:s(v.getAllResponseHeaders()||"")};z.url="responseURL"in v?v.responseURL:z.headers.get("X-Request-URL");var q="response"in v?v.response:v.responseText;D(new f(q,z))},v.onerror=function(){P(new TypeError("Network request failed"))},v.ontimeout=function(){P(new TypeError("Network request failed"))},v.onabort=function(){P(new g.DOMException("Aborted","AbortError"))},v.open(L.method,L.url,!0),L.credentials==="include"?v.withCredentials=!0:L.credentials==="omit"&&(v.withCredentials=!1),"responseType"in v&&d.blob&&(v.responseType="blob"),L.headers.forEach(function(z,q){v.setRequestHeader(q,z)}),L.signal&&(L.signal.addEventListener("abort",U),v.onreadystatechange=function(){v.readyState===4&&L.signal.removeEventListener("abort",U)}),v.send(typeof L._bodyInit>"u"?null:L._bodyInit)})}return _.polyfill=!0,h.fetch||(h.fetch=_,h.Headers=N,h.Request=p,h.Response=f),g.Headers=N,g.Request=p,g.Response=f,g.fetch=_,Object.defineProperty(g,"__esModule",{value:!0}),g})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(Zi,Zi.exports);const ro=Lc(Zi.exports);function gy(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function io(t){return typeof t=="string"?t:JSON.stringify(t)}const yy={Accept:"application/json","Content-Type":"application/json"},_y="POST",no={headers:yy,method:_y},so=10;class _i{constructor(e){if(this.url=e,this.events=new st.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ns(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=io(e),h=await(await ro(this.url,Object.assign(Object.assign({},no),{body:i}))).json();this.onPayload({data:h})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Ns(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),n(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=io({id:1,jsonrpc:"2.0",method:"test",params:[]});await ro(e,Object.assign(Object.assign({},no),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?gy(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),h=pi(e,n);this.events.emit("payload",h)}parseError(e,r=this.url){return ba(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>so&&this.events.setMaxListeners(so)}}const oo="error",by="wss://relay.walletconnect.com",my="wc",vy="universal_provider",ao=`${my}@${2}:${vy}:`,wy="https://rpc.walletconnect.com/v1",$r={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Ht(t,e,r){let i;const n=Qi(t);return e.rpcMap&&(i=e.rpcMap[n]),i||(i=`${wy}?chainId=eip155:${n}&projectId=${r}`),i}function Qi(t){return t.includes("eip155")?Number(t.split(":")[1]):Number(t)}function Ey(t,e){if(!e.includes(t))throw new Error(`Chain '${t}' not approved. Please use one of the following: ${e.toString()}`)}function Dy(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}const bi=(t,e)=>{const r=i=>{i.request!==e.request||i.topic!==e.topic||(t.events.removeListener("session_request_sent",r),Sy())};t.on("session_request_sent",r)};function Sy(){if(typeof window<"u")try{const t=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(t){const e=JSON.parse(t);window.open(e.href,"_self","noreferrer noopener")}}catch(t){console.error(t)}}class Oy{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(bi(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const i=Qi(e);if(!this.httpProviders[i]){const n=r||Ht(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit($r.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new jr(new _i(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=Qi(r);e[i]=this.createHttpProvider(i)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}handleSwitchChain(e){const r=parseInt(e,16),i=`${this.name}:${r}`;Ey(i,this.namespace.chains),this.setDefaultChain(`${r}`)}}class Iy{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(bi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit($r.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Ht(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new jr(new _i(i))}}class xy{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(bi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit($r.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Ht(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new jr(new _i(i))}}class Py{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(bi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit($r.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Ht(e,this.namespace);return typeof i>"u"?void 0:new jr(new _i(i))}}var Ty=Object.defineProperty,Ay=Object.defineProperties,Ny=Object.getOwnPropertyDescriptors,co=Object.getOwnPropertySymbols,Cy=Object.prototype.hasOwnProperty,Ry=Object.prototype.propertyIsEnumerable,uo=(t,e,r)=>e in t?Ty(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xr=(t,e)=>{for(var r in e||(e={}))Cy.call(e,r)&&uo(t,r,e[r]);if(co)for(var r of co(e))Ry.call(e,r)&&uo(t,r,e[r]);return t},Li=(t,e)=>Ay(t,Ny(e));class Sn{constructor(e){this.events=new st.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||oo}))}static async init(e){const r=new Sn(e);return await r.initialize(),r}async request(e,r){const[i,n]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Xr({},e),chainId:`${i}:${n}`,topic:this.session.topic})}sendAsync(e,r,i){this.request(e,i).then(n=>r(null,n)).catch(n=>r(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:to("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await i(),this.createProviders(),this.onConnect(),this.session}setDefaultChain(e,r){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(py(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await En.init({logger:this.providerOpts.logger||oo,relayUrl:this.providerOpts.relayUrl||by,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{var r,i,n;const h=((r=this.session)==null?void 0:r.namespaces[e].accounts)||[],g=Dy(h),d=Li(Xr({},Object.assign(this.namespaces[e],(n=(i=this.optionalNamespaces)==null?void 0:i[e])!=null?n:{})),{accounts:h,chains:g});switch(e){case"eip155":this.rpcProviders[e]=new Oy({client:this.client,namespace:d,events:this.events});break;case"solana":this.rpcProviders[e]=new Iy({client:this.client,namespace:d,events:this.events});break;case"cosmos":this.rpcProviders[e]=new xy({client:this.client,namespace:d,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new Py({client:this.client,namespace:d,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,h=(i=this.client)==null?void 0:i.session.get(e);this.session=Li(Xr({},h),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Li(Xr({},to("USER_DISCONNECTED")),{data:e.topic}))}),this.on($r.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:i,sessionProperties:n}=e;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=i,this.sessionProperties=n,this.persist("namespaces",r),this.persist("optionalNamespaces",i)}validateChain(e){const[r,i]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Object.keys(this.namespaces)[0],h=this.rpcProviders[n].getDefaultChain();return[n,h]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){const[i,n]=this.validateChain(e);r||this.getProvider(i).setDefaultChain(n),this.namespaces[i].defaultChain=n,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${ao}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${ao}/${e}`)}}var Fy=globalThis&&globalThis.__awaiter||function(t,e,r,i){function n(h){return h instanceof r?h:new r(function(g){g(h)})}return new(r||(r=Promise))(function(h,g){function d(O){try{E(i.next(O))}catch(A){g(A)}}function y(O){try{E(i.throw(O))}catch(A){g(A)}}function E(O){O.done?h(O.value):n(O.value).then(d,y)}E((i=i.apply(t,e||[])).next())})},Ly=globalThis&&globalThis.__generator||function(t,e){var r={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},i,n,h,g;return g={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function d(E){return function(O){return y([E,O])}}function y(E){if(i)throw new TypeError("Generator is already executing.");for(;g&&(g=0,E[0]&&(r=0)),r;)try{if(i=1,n&&(h=E[0]&2?n.return:E[0]?n.throw||((h=n.return)&&h.call(n),0):n.next)&&!(h=h.call(n,E[1])).done)return h;switch(n=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return r.label++,{value:E[1],done:!1};case 5:r.label++,n=E[1],E=[0];continue;case 7:E=r.ops.pop(),r.trys.pop();continue;default:if(h=r.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){r=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){r.label=E[1];break}if(E[0]===6&&r.label<h[1]){r.label=h[1],h=E;break}if(h&&r.label<h[2]){r.label=h[2],r.ops.push(E);break}h[2]&&r.ops.pop(),r.trys.pop();continue}E=e.call(t,r)}catch(O){E=[6,O],n=0}finally{i=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},jy=["eip155:1"],My=function(){return Fy(void 0,void 0,void 0,function(){return Ly(this,function(t){switch(t.label){case 0:return[4,Sn.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,t.sent()]}})})};export{jy as WC_V2_DEFAULT_CHAINS,My as getWalletConnectV2ProviderInstance};

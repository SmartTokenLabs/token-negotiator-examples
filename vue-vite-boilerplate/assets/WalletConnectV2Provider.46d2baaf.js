import{b as Ae,d as Uc,e as jc,r as Mc,g as $c}from"./index.1a68ef75.js";function Bc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Hc=zc;function zc(t,e,r){var n=r&&r.stringify||Bc,i=1;if(typeof t=="object"&&t!==null){var u=e.length+i;if(u===1)return t;var g=new Array(u);g[0]=n(t);for(var d=1;d<u;d++)g[d]=n(e[d]);return g.join(" ")}if(typeof t!="string")return t;var y=e.length;if(y===0)return t;for(var E="",S=1-i,T=-1,$=t&&t.length||0,C=0;C<$;){if(t.charCodeAt(C)===37&&C+1<$){switch(T=T>-1?T:0,t.charCodeAt(C+1)){case 100:case 102:if(S>=y||e[S]==null)break;T<C&&(E+=t.slice(T,C)),E+=Number(e[S]),T=C+2,C++;break;case 105:if(S>=y||e[S]==null)break;T<C&&(E+=t.slice(T,C)),E+=Math.floor(Number(e[S])),T=C+2,C++;break;case 79:case 111:case 106:if(S>=y||e[S]===void 0)break;T<C&&(E+=t.slice(T,C));var P=typeof e[S];if(P==="string"){E+="'"+e[S]+"'",T=C+2,C++;break}if(P==="function"){E+=e[S].name||"<anonymous>",T=C+2,C++;break}E+=n(e[S]),T=C+2,C++;break;case 115:if(S>=y)break;T<C&&(E+=t.slice(T,C)),E+=String(e[S]),T=C+2,C++;break;case 37:T<C&&(E+=t.slice(T,C)),E+="%",T=C+2,C++,S--;break}++S}++C}return T===-1?t:(T<$&&(E+=t.slice(T)),E)}const Mi=Hc;var Tr=Pt;const Ir=Zc().console||{},qc={mapHttpRequest:kr,mapHttpResponse:kr,wrapRequestSerializer:Dn,wrapResponseSerializer:Dn,wrapErrorSerializer:Dn,req:kr,res:kr,err:kc};function Kc(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Pt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Ir;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=Kc(t.browser.serialize,n);let u=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(u=!1);const g=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const d=t.level||"info",y=Object.create(r);y.log||(y.log=xr),Object.defineProperty(y,"levelVal",{get:S}),Object.defineProperty(y,"level",{get:T,set:$});const E={transmit:e,serialize:i,asObject:t.browser.asObject,levels:g,timestamp:Yc(t)};y.levels=Pt.levels,y.level=d,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=xr,y.serializers=n,y._serialize=i,y._stdErrSerialize=u,y.child=C,e&&(y._logEvent=$n());function S(){return this.level==="silent"?1/0:this.levels.values[this.level]}function T(){return this._level}function $(P){if(P!=="silent"&&!this.levels.values[P])throw Error("unknown level "+P);this._level=P,nr(E,y,"error","log"),nr(E,y,"fatal","error"),nr(E,y,"warn","error"),nr(E,y,"info","log"),nr(E,y,"debug","log"),nr(E,y,"trace","log")}function C(P,z){if(!P)throw new Error("missing bindings for child Pino");z=z||{},i&&P.serializers&&(z.serializers=P.serializers);const B=z.serializers;if(i&&B){var G=Object.assign({},n,B),m=t.browser.serialize===!0?Object.keys(G):i;delete P.serializers,on([P],m,G,this._stdErrSerialize)}function I(b){this._childLevel=(b._childLevel|0)+1,this.error=ir(b,P,"error"),this.fatal=ir(b,P,"fatal"),this.warn=ir(b,P,"warn"),this.info=ir(b,P,"info"),this.debug=ir(b,P,"debug"),this.trace=ir(b,P,"trace"),G&&(this.serializers=G,this._serialize=m),e&&(this._logEvent=$n([].concat(b._logEvent.bindings,P)))}return I.prototype=this,new I(this)}return y}Pt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Pt.stdSerializers=qc;Pt.stdTimeFunctions=Object.assign({},{nullTime:bo,epochTime:mo,unixTime:Jc,isoTime:Xc});function nr(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?xr:i[r]?i[r]:Ir[r]||Ir[n]||xr,Vc(t,e,r)}function Vc(t,e,r){!t.transmit&&e[r]===xr||(e[r]=function(n){return function(){const u=t.timestamp(),g=new Array(arguments.length),d=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ir?Ir:this;for(var y=0;y<g.length;y++)g[y]=arguments[y];if(t.serialize&&!t.asObject&&on(g,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(d,Gc(this,r,g,u)):n.apply(d,g),t.transmit){const E=t.transmit.level||e.level,S=Pt.levels.values[E],T=Pt.levels.values[r];if(T<S)return;Wc(this,{ts:u,methodLevel:r,methodValue:T,transmitLevel:E,transmitValue:Pt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},g)}}}(e[r]))}function Gc(t,e,r,n){t._serialize&&on(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let u=i[0];const g={};n&&(g.time=n),g.level=Pt.levels.values[e];let d=(t._childLevel|0)+1;if(d<1&&(d=1),u!==null&&typeof u=="object"){for(;d--&&typeof i[0]=="object";)Object.assign(g,i.shift());u=i.length?Mi(i.shift(),i):void 0}else typeof u=="string"&&(u=Mi(i.shift(),i));return u!==void 0&&(g.msg=u),g}function on(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Pt.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const u in t[i])e&&e.indexOf(u)>-1&&u in r&&(t[i][u]=r[u](t[i][u]))}function ir(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function Wc(t,e,r){const n=e.send,i=e.ts,u=e.methodLevel,g=e.methodValue,d=e.val,y=t._logEvent.bindings;on(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(E){return y.indexOf(E)===-1}),t._logEvent.level.label=u,t._logEvent.level.value=g,n(u,t._logEvent,d),t._logEvent=$n(y)}function $n(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function kc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Yc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?bo:mo}function kr(){return{}}function Dn(t){return t}function xr(){}function bo(){return!1}function mo(){return Date.now()}function Jc(){return Math.round(Date.now()/1e3)}function Xc(){return new Date(Date.now()).toISOString()}function Zc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var ot={exports:{}},ar=typeof Reflect=="object"?Reflect:null,$i=ar&&typeof ar.apply=="function"?ar.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Qr;ar&&typeof ar.ownKeys=="function"?Qr=ar.ownKeys:Object.getOwnPropertySymbols?Qr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Qr=function(e){return Object.getOwnPropertyNames(e)};function Qc(t){console&&console.warn&&console.warn(t)}var vo=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ot.exports=Oe;ot.exports.once=nu;Oe.EventEmitter=Oe;Oe.prototype._events=void 0;Oe.prototype._eventsCount=0;Oe.prototype._maxListeners=void 0;var Bi=10;function an(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return Bi},set:function(t){if(typeof t!="number"||t<0||vo(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Bi=t}});Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||vo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function wo(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return wo(this)};Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",u=this._events;if(u!==void 0)i=i&&u.error===void 0;else if(!i)return!1;if(i){var g;if(r.length>0&&(g=r[0]),g instanceof Error)throw g;var d=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw d.context=g,d}var y=u[e];if(y===void 0)return!1;if(typeof y=="function")$i(y,this,r);else for(var E=y.length,S=Io(y,E),n=0;n<E;++n)$i(S[n],this,r);return!0};function Eo(t,e,r,n){var i,u,g;if(an(r),u=t._events,u===void 0?(u=t._events=Object.create(null),t._eventsCount=0):(u.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),u=t._events),g=u[e]),g===void 0)g=u[e]=r,++t._eventsCount;else if(typeof g=="function"?g=u[e]=n?[r,g]:[g,r]:n?g.unshift(r):g.push(r),i=wo(t),i>0&&g.length>i&&!g.warned){g.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=e,d.count=g.length,Qc(d)}return t}Oe.prototype.addListener=function(e,r){return Eo(this,e,r,!1)};Oe.prototype.on=Oe.prototype.addListener;Oe.prototype.prependListener=function(e,r){return Eo(this,e,r,!0)};function eu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Do(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=eu.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return an(r),this.on(e,Do(this,e,r)),this};Oe.prototype.prependOnceListener=function(e,r){return an(r),this.prependListener(e,Do(this,e,r)),this};Oe.prototype.removeListener=function(e,r){var n,i,u,g,d;if(an(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(u=-1,g=n.length-1;g>=0;g--)if(n[g]===r||n[g].listener===r){d=n[g].listener,u=g;break}if(u<0)return this;u===0?n.shift():tu(n,u),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,d||r)}return this};Oe.prototype.off=Oe.prototype.removeListener;Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var u=Object.keys(n),g;for(i=0;i<u.length;++i)g=u[i],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function So(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?ru(i):Io(i,i.length)}Oe.prototype.listeners=function(e){return So(this,e,!0)};Oe.prototype.rawListeners=function(e){return So(this,e,!1)};Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Oo.call(t,e)};Oe.prototype.listenerCount=Oo;function Oo(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Qr(this._events):[]};function Io(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function tu(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function ru(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function nu(t,e){return new Promise(function(r,n){function i(g){t.removeListener(e,u),n(g)}function u(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}xo(t,e,u,{once:!0}),e!=="error"&&iu(t,i,{once:!0})})}function iu(t,e,r){typeof t.on=="function"&&xo(t,"error",e,r)}function xo(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(u){n.once&&t.removeEventListener(e,i),r(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var cn={},si={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,n,i,u,g,d,y,E,S,T,$,C,P,z,B,G,m,I,b,w,D,s;(function(p){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(o(H,o(t.exports)));function o(f,l){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var l in f)f.hasOwnProperty(l)&&(o[l]=f[l])};e=function(o,f){H(o,f);function l(){this.constructor=o}o.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(o){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(o[c]=f[c])}return o},n=function(o,f){var l={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&f.indexOf(_)<0&&(l[_]=o[_]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(o);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(o,_[c])&&(l[_[c]]=o[_[c]]);return l},i=function(o,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,f,l,_);else for(var A=o.length-1;A>=0;A--)(O=o[A])&&(a=(c<3?O(a):c>3?O(f,l,a):O(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},u=function(o,f){return function(l,_){f(l,_,o)}},g=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},d=function(o,f,l,_){function c(a){return a instanceof l?a:new l(function(O){O(a)})}return new(l||(l=Promise))(function(a,O){function A(U){try{v(_.next(U))}catch(K){O(K)}}function L(U){try{v(_.throw(U))}catch(K){O(K)}}function v(U){U.done?a(U.value):c(U.value).then(A,L)}v((_=_.apply(o,f||[])).next())})},y=function(o,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,O;return O={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function A(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(o,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},s=function(o,f,l,_){_===void 0&&(_=l),o[_]=f[l]},E=function(o,f){for(var l in o)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=o[l])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&o[f],_=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},T=function(o,f){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var _=l.call(o),c,a=[],O;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(A){O={error:A}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(O)throw O.error}}return a},$=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(T(arguments[f]));return o},C=function(){for(var o=0,f=0,l=arguments.length;f<l;f++)o+=arguments[f].length;for(var _=Array(o),c=0,f=0;f<l;f++)for(var a=arguments[f],O=0,A=a.length;O<A;O++,c++)_[c]=a[O];return _},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},z=function(o,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(o,f||[]),c,a=[];return c={},O("next"),O("throw"),O("return"),c[Symbol.asyncIterator]=function(){return this},c;function O(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||A(q,V)})})}function A(q,V){try{L(_[q](V))}catch(Q){K(a[0][3],Q)}}function L(q){q.value instanceof P?Promise.resolve(q.value.v).then(v,U):K(a[0][2],q)}function v(q){A("next",q)}function U(q){A("throw",q)}function K(q,V){q(V),a.shift(),a.length&&A(a[0][0],a[0][1])}},B=function(o){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=o[c]?function(O){return(l=!l)?{value:P(o[c](O)),done:c==="return"}:a?a(O):O}:a}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],l;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=o[a]&&function(O){return new Promise(function(A,L){O=o[a](O),c(A,L,O.done,O.value)})}}function c(a,O,A,L){Promise.resolve(L).then(function(v){a({value:v,done:A})},O)}},m=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},I=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(f[l]=o[l]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},D=function(o,f,l){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,l),l},p("__extends",e),p("__assign",r),p("__rest",n),p("__decorate",i),p("__param",u),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",s),p("__values",S),p("__read",T),p("__spread",$),p("__spreadArrays",C),p("__await",P),p("__asyncGenerator",z),p("__asyncDelegator",B),p("__asyncValues",G),p("__makeTemplateObject",m),p("__importStar",I),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",D)})})(si);var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function su(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Ar.safeJsonParse=su;function ou(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Ar.safeJsonStringify=ou;var pr={exports:{}},Hi;function au(){return Hi||(Hi=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ae<"u"&&Ae.localStorage?pr.exports=Ae.localStorage:typeof window<"u"&&window.localStorage?pr.exports=window.localStorage:pr.exports=new e}()),pr.exports}var Sn={},gr={},zi;function cu(){if(zi)return gr;zi=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.IKeyValueStorage=void 0;class t{}return gr.IKeyValueStorage=t,gr}var yr={},qi;function uu(){if(qi)return yr;qi=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.parseEntry=void 0;const t=Ar;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return yr.parseEntry=e,yr}var Ki;function hu(){return Ki||(Ki=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=si.exports;e.__exportStar(cu(),t),e.__exportStar(uu(),t)}(Sn)),Sn}Object.defineProperty(cn,"__esModule",{value:!0});cn.KeyValueStorage=void 0;const or=si.exports,Vi=Ar,fu=or.__importDefault(au()),lu=hu();class Po{constructor(){this.localStorage=fu.default}getKeys(){return or.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return or.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(lu.parseEntry)})}getItem(e){return or.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Vi.safeJsonParse(r)})}setItem(e,r){return or.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Vi.safeJsonStringify(r))})}removeItem(e){return or.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}cn.KeyValueStorage=Po;var du=cn.default=Po,Nr={},Cr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,n,i,u,g,d,y,E,S,T,$,C,P,z,B,G,m,I,b,w,D,s;(function(p){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(o(H,o(t.exports)));function o(f,l){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var l in f)f.hasOwnProperty(l)&&(o[l]=f[l])};e=function(o,f){H(o,f);function l(){this.constructor=o}o.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(o){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(o[c]=f[c])}return o},n=function(o,f){var l={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&f.indexOf(_)<0&&(l[_]=o[_]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(o);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(o,_[c])&&(l[_[c]]=o[_[c]]);return l},i=function(o,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,f,l,_);else for(var A=o.length-1;A>=0;A--)(O=o[A])&&(a=(c<3?O(a):c>3?O(f,l,a):O(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},u=function(o,f){return function(l,_){f(l,_,o)}},g=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},d=function(o,f,l,_){function c(a){return a instanceof l?a:new l(function(O){O(a)})}return new(l||(l=Promise))(function(a,O){function A(U){try{v(_.next(U))}catch(K){O(K)}}function L(U){try{v(_.throw(U))}catch(K){O(K)}}function v(U){U.done?a(U.value):c(U.value).then(A,L)}v((_=_.apply(o,f||[])).next())})},y=function(o,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,O;return O={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function A(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(o,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},s=function(o,f,l,_){_===void 0&&(_=l),o[_]=f[l]},E=function(o,f){for(var l in o)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=o[l])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&o[f],_=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},T=function(o,f){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var _=l.call(o),c,a=[],O;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(A){O={error:A}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(O)throw O.error}}return a},$=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(T(arguments[f]));return o},C=function(){for(var o=0,f=0,l=arguments.length;f<l;f++)o+=arguments[f].length;for(var _=Array(o),c=0,f=0;f<l;f++)for(var a=arguments[f],O=0,A=a.length;O<A;O++,c++)_[c]=a[O];return _},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},z=function(o,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(o,f||[]),c,a=[];return c={},O("next"),O("throw"),O("return"),c[Symbol.asyncIterator]=function(){return this},c;function O(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||A(q,V)})})}function A(q,V){try{L(_[q](V))}catch(Q){K(a[0][3],Q)}}function L(q){q.value instanceof P?Promise.resolve(q.value.v).then(v,U):K(a[0][2],q)}function v(q){A("next",q)}function U(q){A("throw",q)}function K(q,V){q(V),a.shift(),a.length&&A(a[0][0],a[0][1])}},B=function(o){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=o[c]?function(O){return(l=!l)?{value:P(o[c](O)),done:c==="return"}:a?a(O):O}:a}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],l;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=o[a]&&function(O){return new Promise(function(A,L){O=o[a](O),c(A,L,O.done,O.value)})}}function c(a,O,A,L){Promise.resolve(L).then(function(v){a({value:v,done:A})},O)}},m=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},I=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(f[l]=o[l]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},D=function(o,f,l){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,l),l},p("__extends",e),p("__assign",r),p("__rest",n),p("__decorate",i),p("__param",u),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",s),p("__values",S),p("__read",T),p("__spread",$),p("__spreadArrays",C),p("__await",P),p("__asyncGenerator",z),p("__asyncDelegator",B),p("__asyncValues",G),p("__makeTemplateObject",m),p("__importStar",I),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",D)})})(Cr);var _r={},ee={},Rr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,n,i,u,g,d,y,E,S,T,$,C,P,z,B,G,m,I,b,w,D,s;(function(p){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(o(H,o(t.exports)));function o(f,l){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var l in f)f.hasOwnProperty(l)&&(o[l]=f[l])};e=function(o,f){H(o,f);function l(){this.constructor=o}o.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(o){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(o[c]=f[c])}return o},n=function(o,f){var l={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&f.indexOf(_)<0&&(l[_]=o[_]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(o);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(o,_[c])&&(l[_[c]]=o[_[c]]);return l},i=function(o,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,f,l,_);else for(var A=o.length-1;A>=0;A--)(O=o[A])&&(a=(c<3?O(a):c>3?O(f,l,a):O(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},u=function(o,f){return function(l,_){f(l,_,o)}},g=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},d=function(o,f,l,_){function c(a){return a instanceof l?a:new l(function(O){O(a)})}return new(l||(l=Promise))(function(a,O){function A(U){try{v(_.next(U))}catch(K){O(K)}}function L(U){try{v(_.throw(U))}catch(K){O(K)}}function v(U){U.done?a(U.value):c(U.value).then(A,L)}v((_=_.apply(o,f||[])).next())})},y=function(o,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,O;return O={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function A(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(o,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},s=function(o,f,l,_){_===void 0&&(_=l),o[_]=f[l]},E=function(o,f){for(var l in o)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=o[l])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&o[f],_=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},T=function(o,f){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var _=l.call(o),c,a=[],O;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(A){O={error:A}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(O)throw O.error}}return a},$=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(T(arguments[f]));return o},C=function(){for(var o=0,f=0,l=arguments.length;f<l;f++)o+=arguments[f].length;for(var _=Array(o),c=0,f=0;f<l;f++)for(var a=arguments[f],O=0,A=a.length;O<A;O++,c++)_[c]=a[O];return _},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},z=function(o,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(o,f||[]),c,a=[];return c={},O("next"),O("throw"),O("return"),c[Symbol.asyncIterator]=function(){return this},c;function O(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||A(q,V)})})}function A(q,V){try{L(_[q](V))}catch(Q){K(a[0][3],Q)}}function L(q){q.value instanceof P?Promise.resolve(q.value.v).then(v,U):K(a[0][2],q)}function v(q){A("next",q)}function U(q){A("throw",q)}function K(q,V){q(V),a.shift(),a.length&&A(a[0][0],a[0][1])}},B=function(o){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=o[c]?function(O){return(l=!l)?{value:P(o[c](O)),done:c==="return"}:a?a(O):O}:a}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],l;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=o[a]&&function(O){return new Promise(function(A,L){O=o[a](O),c(A,L,O.done,O.value)})}}function c(a,O,A,L){Promise.resolve(L).then(function(v){a({value:v,done:A})},O)}},m=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},I=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(f[l]=o[l]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},D=function(o,f,l){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,l),l},p("__extends",e),p("__assign",r),p("__rest",n),p("__decorate",i),p("__param",u),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",s),p("__values",S),p("__read",T),p("__spread",$),p("__spreadArrays",C),p("__await",P),p("__asyncGenerator",z),p("__asyncDelegator",B),p("__asyncValues",G),p("__makeTemplateObject",m),p("__importStar",I),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",D)})})(Rr);var On={},br={},Gi;function pu(){if(Gi)return br;Gi=1,Object.defineProperty(br,"__esModule",{value:!0}),br.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return br.delay=t,br}var Wt={},In={},kt={},Wi;function gu(){return Wi||(Wi=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.ONE_THOUSAND=kt.ONE_HUNDRED=void 0,kt.ONE_HUNDRED=100,kt.ONE_THOUSAND=1e3),kt}var xn={},ki;function yu(){return ki||(ki=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(xn)),xn}var Yi;function To(){return Yi||(Yi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(gu(),t),e.__exportStar(yu(),t)}(In)),In}var Ji;function _u(){if(Ji)return Wt;Ji=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.fromMiliseconds=Wt.toMiliseconds=void 0;const t=To();function e(n){return n*t.ONE_THOUSAND}Wt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Wt.fromMiliseconds=r,Wt}var Xi;function bu(){return Xi||(Xi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(pu(),t),e.__exportStar(_u(),t)}(On)),On}var sr={},Zi;function mu(){if(Zi)return sr;Zi=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return sr.Watch=t,sr.default=t,sr}var Pn={},mr={},Qi;function vu(){if(Qi)return mr;Qi=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IWatch=void 0;class t{}return mr.IWatch=t,mr}var es;function wu(){return es||(es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Rr.exports.__exportStar(vu(),t)}(Pn)),Pn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Rr.exports;e.__exportStar(bu(),t),e.__exportStar(mu(),t),e.__exportStar(wu(),t),e.__exportStar(To(),t)})(ee);var Tn={},vr={};class Zt{}const Eu=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zt},Symbol.toStringTag,{value:"Module"})),Du=Uc(Eu);var ts;function Su(){if(ts)return vr;ts=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IHeartBeat=void 0;const t=Du;class e extends t.IEvents{constructor(n){super()}}return vr.IHeartBeat=e,vr}var rs;function Ao(){return rs||(rs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.exports.__exportStar(Su(),t)}(Tn)),Tn}var An={},Yt={},ns;function Ou(){if(ns)return Yt;ns=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.HEARTBEAT_EVENTS=Yt.HEARTBEAT_INTERVAL=void 0;const t=ee;return Yt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Yt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yt}var is;function No(){return is||(is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Cr.exports.__exportStar(Ou(),t)}(An)),An}var ss;function Iu(){if(ss)return _r;ss=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.HeartBeat=void 0;const t=Cr.exports,e=ot.exports,r=ee,n=Ao(),i=No();class u extends n.IHeartBeat{constructor(d){super(d),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=d?.interval||i.HEARTBEAT_INTERVAL}static init(d){return t.__awaiter(this,void 0,void 0,function*(){const y=new u(d);return yield y.init(),y})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,y){this.events.on(d,y)}once(d,y){this.events.once(d,y)}off(d,y){this.events.off(d,y)}removeListener(d,y){this.events.removeListener(d,y)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return _r.HeartBeat=u,_r}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Cr.exports;e.__exportStar(Iu(),t),e.__exportStar(Ao(),t),e.__exportStar(No(),t)})(Nr);var Se={},Co={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,n,i,u,g,d,y,E,S,T,$,C,P,z,B,G,m,I,b,w,D,s;(function(p){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(o(H,o(t.exports)));function o(f,l){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var l in f)f.hasOwnProperty(l)&&(o[l]=f[l])};e=function(o,f){H(o,f);function l(){this.constructor=o}o.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(o){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(o[c]=f[c])}return o},n=function(o,f){var l={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&f.indexOf(_)<0&&(l[_]=o[_]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(o);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(o,_[c])&&(l[_[c]]=o[_[c]]);return l},i=function(o,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,f,l,_);else for(var A=o.length-1;A>=0;A--)(O=o[A])&&(a=(c<3?O(a):c>3?O(f,l,a):O(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},u=function(o,f){return function(l,_){f(l,_,o)}},g=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},d=function(o,f,l,_){function c(a){return a instanceof l?a:new l(function(O){O(a)})}return new(l||(l=Promise))(function(a,O){function A(U){try{v(_.next(U))}catch(K){O(K)}}function L(U){try{v(_.throw(U))}catch(K){O(K)}}function v(U){U.done?a(U.value):c(U.value).then(A,L)}v((_=_.apply(o,f||[])).next())})},y=function(o,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,O;return O={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function A(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(o,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},s=function(o,f,l,_){_===void 0&&(_=l),o[_]=f[l]},E=function(o,f){for(var l in o)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=o[l])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&o[f],_=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},T=function(o,f){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var _=l.call(o),c,a=[],O;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(A){O={error:A}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(O)throw O.error}}return a},$=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(T(arguments[f]));return o},C=function(){for(var o=0,f=0,l=arguments.length;f<l;f++)o+=arguments[f].length;for(var _=Array(o),c=0,f=0;f<l;f++)for(var a=arguments[f],O=0,A=a.length;O<A;O++,c++)_[c]=a[O];return _},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},z=function(o,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(o,f||[]),c,a=[];return c={},O("next"),O("throw"),O("return"),c[Symbol.asyncIterator]=function(){return this},c;function O(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||A(q,V)})})}function A(q,V){try{L(_[q](V))}catch(Q){K(a[0][3],Q)}}function L(q){q.value instanceof P?Promise.resolve(q.value.v).then(v,U):K(a[0][2],q)}function v(q){A("next",q)}function U(q){A("throw",q)}function K(q,V){q(V),a.shift(),a.length&&A(a[0][0],a[0][1])}},B=function(o){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=o[c]?function(O){return(l=!l)?{value:P(o[c](O)),done:c==="return"}:a?a(O):O}:a}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],l;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=o[a]&&function(O){return new Promise(function(A,L){O=o[a](O),c(A,L,O.done,O.value)})}}function c(a,O,A,L){Promise.resolve(L).then(function(v){a({value:v,done:A})},O)}},m=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},I=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(f[l]=o[l]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},D=function(o,f,l){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,l),l},p("__extends",e),p("__assign",r),p("__rest",n),p("__decorate",i),p("__param",u),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",s),p("__values",S),p("__read",T),p("__spread",$),p("__spreadArrays",C),p("__await",P),p("__asyncGenerator",z),p("__asyncDelegator",B),p("__asyncValues",G),p("__makeTemplateObject",m),p("__importStar",I),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",D)})})(Co);var Jt={},os;function Ro(){return os||(os=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.PINO_CUSTOM_CONTEXT_KEY=Jt.PINO_LOGGER_DEFAULTS=void 0,Jt.PINO_LOGGER_DEFAULTS={level:"info"},Jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Jt}var at={},as;function xu(){if(as)return at;as=1,Object.defineProperty(at,"__esModule",{value:!0}),at.generateChildLogger=at.formatChildLoggerContext=at.getLoggerContext=at.setBrowserLoggerContext=at.getBrowserLoggerContext=at.getDefaultLoggerOptions=void 0;const t=Ro();function e(d){return Object.assign(Object.assign({},d),{level:d?.level||t.PINO_LOGGER_DEFAULTS.level})}at.getDefaultLoggerOptions=e;function r(d,y=t.PINO_CUSTOM_CONTEXT_KEY){return d[y]||""}at.getBrowserLoggerContext=r;function n(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){return d[E]=y,d}at.setBrowserLoggerContext=n;function i(d,y=t.PINO_CUSTOM_CONTEXT_KEY){let E="";return typeof d.bindings>"u"?E=r(d,y):E=d.bindings().context||"",E}at.getLoggerContext=i;function u(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){const S=i(d,E);return S.trim()?`${S}/${y}`:y}at.formatChildLoggerContext=u;function g(d,y,E=t.PINO_CUSTOM_CONTEXT_KEY){const S=u(d,y,E),T=d.child({context:S});return n(T,S,E)}return at.generateChildLogger=g,at}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Co.exports,r=e.__importDefault(Tr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Ro(),t),e.__exportStar(xu(),t)})(Se);class Pu extends Zt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Tu extends Zt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Au{constructor(e,r){this.logger=e,this.core=r}}class Nu extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Cu extends Zt{constructor(e){super()}}class Ru{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Fu extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Lu extends Zt{constructor(e,r){super(),this.core=e,this.logger=r}}class Uu{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class ju{constructor(e){this.client=e}}function Mu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function $u(t){return typeof t=="string"?t:JSON.stringify(t)}var oi={},cr={},un={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.BrowserRandomSource=void 0;const cs=65536;class Bu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=cs)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,cs)));return r}}hn.BrowserRandomSource=Bu;var fn={},gt={};Object.defineProperty(gt,"__esModule",{value:!0});function Hu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}gt.wipe=Hu;Object.defineProperty(fn,"__esModule",{value:!0});fn.NodeRandomSource=void 0;const zu=gt;class qu{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof jc<"u"){const e=Mc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,zu.wipe)(r),n}}fn.NodeRandomSource=qu;Object.defineProperty(un,"__esModule",{value:!0});un.SystemRandomSource=void 0;const Ku=hn,Vu=fn;class Gu{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ku.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Vu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}un.SystemRandomSource=Gu;var ne={},Fo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(d,y){var E=d>>>16&65535,S=d&65535,T=y>>>16&65535,$=y&65535;return S*$+(E*$+S*T<<16>>>0)|0}t.mul=Math.imul||e;function r(d,y){return d+y|0}t.add=r;function n(d,y){return d-y|0}t.sub=n;function i(d,y){return d<<y|d>>>32-y}t.rotl=i;function u(d,y){return d<<32-y|d>>>y}t.rotr=u;function g(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}t.isInteger=Number.isInteger||g,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(d){return t.isInteger(d)&&d>=-t.MAX_SAFE_INTEGER&&d<=t.MAX_SAFE_INTEGER}})(Fo);Object.defineProperty(ne,"__esModule",{value:!0});var Lo=Fo;function Wu(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ne.readInt16BE=Wu;function ku(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ne.readUint16BE=ku;function Yu(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ne.readInt16LE=Yu;function Ju(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ne.readUint16LE=Ju;function Uo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ne.writeUint16BE=Uo;ne.writeInt16BE=Uo;function jo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ne.writeUint16LE=jo;ne.writeInt16LE=jo;function Bn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ne.readInt32BE=Bn;function Hn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ne.readUint32BE=Hn;function zn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ne.readInt32LE=zn;function qn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ne.readUint32LE=qn;function tn(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ne.writeUint32BE=tn;ne.writeInt32BE=tn;function rn(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ne.writeUint32LE=rn;ne.writeInt32LE=rn;function Xu(t,e){e===void 0&&(e=0);var r=Bn(t,e),n=Bn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}ne.readInt64BE=Xu;function Zu(t,e){e===void 0&&(e=0);var r=Hn(t,e),n=Hn(t,e+4);return r*4294967296+n}ne.readUint64BE=Zu;function Qu(t,e){e===void 0&&(e=0);var r=zn(t,e),n=zn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}ne.readInt64LE=Qu;function eh(t,e){e===void 0&&(e=0);var r=qn(t,e),n=qn(t,e+4);return n*4294967296+r}ne.readUint64LE=eh;function Mo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),tn(t/4294967296>>>0,e,r),tn(t>>>0,e,r+4),e}ne.writeUint64BE=Mo;ne.writeInt64BE=Mo;function $o(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),rn(t>>>0,e,r),rn(t/4294967296>>>0,e,r+4),e}ne.writeUint64LE=$o;ne.writeInt64LE=$o;function th(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,u=t/8+r-1;u>=r;u--)n+=e[u]*i,i*=256;return n}ne.readUintBE=th;function rh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,u=r;u<r+t/8;u++)n+=e[u]*i,i*=256;return n}ne.readUintLE=rh;function nh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Lo.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,u=t/8+n-1;u>=n;u--)r[u]=e/i&255,i*=256;return r}ne.writeUintBE=nh;function ih(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Lo.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,u=n;u<n+t/8;u++)r[u]=e/i&255,i*=256;return r}ne.writeUintLE=ih;function sh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ne.readFloat32BE=sh;function oh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ne.readFloat32LE=oh;function ah(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ne.readFloat64BE=ah;function ch(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ne.readFloat64LE=ch;function uh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}ne.writeFloat32BE=uh;function hh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}ne.writeFloat32LE=hh;function fh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}ne.writeFloat64BE=fh;function lh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}ne.writeFloat64LE=lh;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=un,r=ne,n=gt;t.defaultRandomSource=new e.SystemRandomSource;function i(E,S=t.defaultRandomSource){return S.randomBytes(E)}t.randomBytes=i;function u(E=t.defaultRandomSource){const S=i(4,E),T=(0,r.readUint32LE)(S);return(0,n.wipe)(S),T}t.randomUint32=u;const g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(E,S=g,T=t.defaultRandomSource){if(S.length<2)throw new Error("randomString charset is too short");if(S.length>256)throw new Error("randomString charset is too long");let $="";const C=S.length,P=256-256%C;for(;E>0;){const z=i(Math.ceil(E*256/P),T);for(let B=0;B<z.length&&E>0;B++){const G=z[B];G<P&&($+=S.charAt(G%C),E--)}(0,n.wipe)(z)}return $}t.randomString=d;function y(E,S=g,T=t.defaultRandomSource){const $=Math.ceil(E/(Math.log(S.length)/Math.LN2));return d($,S,T)}t.randomStringForEntropy=y})(cr);var Bo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=gt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function d(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(y,E){if(E===void 0&&(E=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&E>0;)this._buffer[this._bufferLength++]=y[S++],E--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(S=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,S,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=y[S++],E--;return this},d.prototype.finish=function(y){if(!this._finished){var E=this._bytesHashed,S=this._bufferLength,T=E/536870912|0,$=E<<3,C=E%128<112?128:256;this._buffer[S]=128;for(var P=S+1;P<C-8;P++)this._buffer[P]=0;e.writeUint32BE(T,this._buffer,C-8),e.writeUint32BE($,this._buffer,C-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,C),this._finished=!0}for(var P=0;P<this.digestLength/8;P++)e.writeUint32BE(this._stateHi[P],y,P*8),e.writeUint32BE(this._stateLo[P],y,P*8+4);return this},d.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(y){r.wipe(y.stateHi),r.wipe(y.stateLo),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},d}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(d,y,E,S,T,$,C){for(var P=E[0],z=E[1],B=E[2],G=E[3],m=E[4],I=E[5],b=E[6],w=E[7],D=S[0],s=S[1],p=S[2],H=S[3],o=S[4],f=S[5],l=S[6],_=S[7],c,a,O,A,L,v,U,K;C>=128;){for(var q=0;q<16;q++){var V=8*q+$;d[q]=e.readUint32BE(T,V),y[q]=e.readUint32BE(T,V+4)}for(var q=0;q<80;q++){var Q=P,Y=z,ae=B,M=G,j=m,R=I,h=b,N=w,k=D,X=s,fe=p,_e=H,de=o,ve=f,Ue=l,Ce=_;if(c=w,a=_,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=(m>>>14|o<<32-14)^(m>>>18|o<<32-18)^(o>>>41-32|m<<32-(41-32)),a=(o>>>14|m<<32-14)^(o>>>18|m<<32-18)^(m>>>41-32|o<<32-(41-32)),L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,c=m&I^~m&b,a=o&f^~o&l,L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,c=i[q*2],a=i[q*2+1],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,c=d[q%16],a=y[q%16],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,O=U&65535|K<<16,A=L&65535|v<<16,c=O,a=A,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=(P>>>28|D<<32-28)^(D>>>34-32|P<<32-(34-32))^(D>>>39-32|P<<32-(39-32)),a=(D>>>28|P<<32-28)^(P>>>34-32|D<<32-(34-32))^(P>>>39-32|D<<32-(39-32)),L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,c=P&z^P&B^z&B,a=D&s^D&p^s&p,L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,N=U&65535|K<<16,Ce=L&65535|v<<16,c=M,a=_e,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=O,a=A,L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,M=U&65535|K<<16,_e=L&65535|v<<16,z=Q,B=Y,G=ae,m=M,I=j,b=R,w=h,P=N,s=k,p=X,H=fe,o=_e,f=de,l=ve,_=Ue,D=Ce,q%16===15)for(var V=0;V<16;V++)c=d[V],a=y[V],L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=d[(V+9)%16],a=y[(V+9)%16],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,O=d[(V+1)%16],A=y[(V+1)%16],c=(O>>>1|A<<32-1)^(O>>>8|A<<32-8)^O>>>7,a=(A>>>1|O<<32-1)^(A>>>8|O<<32-8)^(A>>>7|O<<32-7),L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,O=d[(V+14)%16],A=y[(V+14)%16],c=(O>>>19|A<<32-19)^(A>>>61-32|O<<32-(61-32))^O>>>6,a=(A>>>19|O<<32-19)^(O>>>61-32|A<<32-(61-32))^(A>>>6|O<<32-6),L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,d[V]=U&65535|K<<16,y[V]=L&65535|v<<16}c=P,a=D,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[0],a=S[0],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[0]=P=U&65535|K<<16,S[0]=D=L&65535|v<<16,c=z,a=s,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[1],a=S[1],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[1]=z=U&65535|K<<16,S[1]=s=L&65535|v<<16,c=B,a=p,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[2],a=S[2],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[2]=B=U&65535|K<<16,S[2]=p=L&65535|v<<16,c=G,a=H,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[3],a=S[3],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[3]=G=U&65535|K<<16,S[3]=H=L&65535|v<<16,c=m,a=o,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[4],a=S[4],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[4]=m=U&65535|K<<16,S[4]=o=L&65535|v<<16,c=I,a=f,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[5],a=S[5],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[5]=I=U&65535|K<<16,S[5]=f=L&65535|v<<16,c=b,a=l,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[6],a=S[6],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[6]=b=U&65535|K<<16,S[6]=l=L&65535|v<<16,c=w,a=_,L=a&65535,v=a>>>16,U=c&65535,K=c>>>16,c=E[7],a=S[7],L+=a&65535,v+=a>>>16,U+=c&65535,K+=c>>>16,v+=L>>>16,U+=v>>>16,K+=U>>>16,E[7]=w=U&65535|K<<16,S[7]=_=L&65535|v<<16,$+=128,C-=128}return $}function g(d){var y=new n;y.update(d);var E=y.digest();return y.clean(),E}t.hash=g})(Bo);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=cr,r=Bo,n=gt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(M){const j=new Float64Array(16);if(M)for(let R=0;R<M.length;R++)j[R]=M[R];return j}const u=new Uint8Array(32);u[0]=9;const g=i(),d=i([1]),y=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function C(M,j){for(let R=0;R<16;R++)M[R]=j[R]|0}function P(M){let j=1;for(let R=0;R<16;R++){let h=M[R]+j+65535;j=Math.floor(h/65536),M[R]=h-j*65536}M[0]+=j-1+37*(j-1)}function z(M,j,R){const h=~(R-1);for(let N=0;N<16;N++){const k=h&(M[N]^j[N]);M[N]^=k,j[N]^=k}}function B(M,j){const R=i(),h=i();for(let N=0;N<16;N++)h[N]=j[N];P(h),P(h),P(h);for(let N=0;N<2;N++){R[0]=h[0]-65517;for(let X=1;X<15;X++)R[X]=h[X]-65535-(R[X-1]>>16&1),R[X-1]&=65535;R[15]=h[15]-32767-(R[14]>>16&1);const k=R[15]>>16&1;R[14]&=65535,z(h,R,1-k)}for(let N=0;N<16;N++)M[2*N]=h[N]&255,M[2*N+1]=h[N]>>8}function G(M,j){let R=0;for(let h=0;h<32;h++)R|=M[h]^j[h];return(1&R-1>>>8)-1}function m(M,j){const R=new Uint8Array(32),h=new Uint8Array(32);return B(R,M),B(h,j),G(R,h)}function I(M){const j=new Uint8Array(32);return B(j,M),j[0]&1}function b(M,j){for(let R=0;R<16;R++)M[R]=j[2*R]+(j[2*R+1]<<8);M[15]&=32767}function w(M,j,R){for(let h=0;h<16;h++)M[h]=j[h]+R[h]}function D(M,j,R){for(let h=0;h<16;h++)M[h]=j[h]-R[h]}function s(M,j,R){let h,N,k=0,X=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,te=0,he=0,ge=0,re=0,be=0,me=0,Ee=0,De=0,we=0,vt=0,Dt=0,Ft=0,dt=0,qt=0,fr=0,Hr=0,Me=R[0],Re=R[1],$e=R[2],Be=R[3],He=R[4],Fe=R[5],Ke=R[6],Ve=R[7],Ge=R[8],We=R[9],ke=R[10],qe=R[11],ze=R[12],Te=R[13],Ye=R[14],Je=R[15];h=j[0],k+=h*Me,X+=h*Re,fe+=h*$e,_e+=h*Be,de+=h*He,ve+=h*Fe,Ue+=h*Ke,Ce+=h*Ve,ye+=h*Ge,pe+=h*We,le+=h*ke,ue+=h*qe,ce+=h*ze,oe+=h*Te,se+=h*Ye,te+=h*Je,h=j[1],X+=h*Me,fe+=h*Re,_e+=h*$e,de+=h*Be,ve+=h*He,Ue+=h*Fe,Ce+=h*Ke,ye+=h*Ve,pe+=h*Ge,le+=h*We,ue+=h*ke,ce+=h*qe,oe+=h*ze,se+=h*Te,te+=h*Ye,he+=h*Je,h=j[2],fe+=h*Me,_e+=h*Re,de+=h*$e,ve+=h*Be,Ue+=h*He,Ce+=h*Fe,ye+=h*Ke,pe+=h*Ve,le+=h*Ge,ue+=h*We,ce+=h*ke,oe+=h*qe,se+=h*ze,te+=h*Te,he+=h*Ye,ge+=h*Je,h=j[3],_e+=h*Me,de+=h*Re,ve+=h*$e,Ue+=h*Be,Ce+=h*He,ye+=h*Fe,pe+=h*Ke,le+=h*Ve,ue+=h*Ge,ce+=h*We,oe+=h*ke,se+=h*qe,te+=h*ze,he+=h*Te,ge+=h*Ye,re+=h*Je,h=j[4],de+=h*Me,ve+=h*Re,Ue+=h*$e,Ce+=h*Be,ye+=h*He,pe+=h*Fe,le+=h*Ke,ue+=h*Ve,ce+=h*Ge,oe+=h*We,se+=h*ke,te+=h*qe,he+=h*ze,ge+=h*Te,re+=h*Ye,be+=h*Je,h=j[5],ve+=h*Me,Ue+=h*Re,Ce+=h*$e,ye+=h*Be,pe+=h*He,le+=h*Fe,ue+=h*Ke,ce+=h*Ve,oe+=h*Ge,se+=h*We,te+=h*ke,he+=h*qe,ge+=h*ze,re+=h*Te,be+=h*Ye,me+=h*Je,h=j[6],Ue+=h*Me,Ce+=h*Re,ye+=h*$e,pe+=h*Be,le+=h*He,ue+=h*Fe,ce+=h*Ke,oe+=h*Ve,se+=h*Ge,te+=h*We,he+=h*ke,ge+=h*qe,re+=h*ze,be+=h*Te,me+=h*Ye,Ee+=h*Je,h=j[7],Ce+=h*Me,ye+=h*Re,pe+=h*$e,le+=h*Be,ue+=h*He,ce+=h*Fe,oe+=h*Ke,se+=h*Ve,te+=h*Ge,he+=h*We,ge+=h*ke,re+=h*qe,be+=h*ze,me+=h*Te,Ee+=h*Ye,De+=h*Je,h=j[8],ye+=h*Me,pe+=h*Re,le+=h*$e,ue+=h*Be,ce+=h*He,oe+=h*Fe,se+=h*Ke,te+=h*Ve,he+=h*Ge,ge+=h*We,re+=h*ke,be+=h*qe,me+=h*ze,Ee+=h*Te,De+=h*Ye,we+=h*Je,h=j[9],pe+=h*Me,le+=h*Re,ue+=h*$e,ce+=h*Be,oe+=h*He,se+=h*Fe,te+=h*Ke,he+=h*Ve,ge+=h*Ge,re+=h*We,be+=h*ke,me+=h*qe,Ee+=h*ze,De+=h*Te,we+=h*Ye,vt+=h*Je,h=j[10],le+=h*Me,ue+=h*Re,ce+=h*$e,oe+=h*Be,se+=h*He,te+=h*Fe,he+=h*Ke,ge+=h*Ve,re+=h*Ge,be+=h*We,me+=h*ke,Ee+=h*qe,De+=h*ze,we+=h*Te,vt+=h*Ye,Dt+=h*Je,h=j[11],ue+=h*Me,ce+=h*Re,oe+=h*$e,se+=h*Be,te+=h*He,he+=h*Fe,ge+=h*Ke,re+=h*Ve,be+=h*Ge,me+=h*We,Ee+=h*ke,De+=h*qe,we+=h*ze,vt+=h*Te,Dt+=h*Ye,Ft+=h*Je,h=j[12],ce+=h*Me,oe+=h*Re,se+=h*$e,te+=h*Be,he+=h*He,ge+=h*Fe,re+=h*Ke,be+=h*Ve,me+=h*Ge,Ee+=h*We,De+=h*ke,we+=h*qe,vt+=h*ze,Dt+=h*Te,Ft+=h*Ye,dt+=h*Je,h=j[13],oe+=h*Me,se+=h*Re,te+=h*$e,he+=h*Be,ge+=h*He,re+=h*Fe,be+=h*Ke,me+=h*Ve,Ee+=h*Ge,De+=h*We,we+=h*ke,vt+=h*qe,Dt+=h*ze,Ft+=h*Te,dt+=h*Ye,qt+=h*Je,h=j[14],se+=h*Me,te+=h*Re,he+=h*$e,ge+=h*Be,re+=h*He,be+=h*Fe,me+=h*Ke,Ee+=h*Ve,De+=h*Ge,we+=h*We,vt+=h*ke,Dt+=h*qe,Ft+=h*ze,dt+=h*Te,qt+=h*Ye,fr+=h*Je,h=j[15],te+=h*Me,he+=h*Re,ge+=h*$e,re+=h*Be,be+=h*He,me+=h*Fe,Ee+=h*Ke,De+=h*Ve,we+=h*Ge,vt+=h*We,Dt+=h*ke,Ft+=h*qe,dt+=h*ze,qt+=h*Te,fr+=h*Ye,Hr+=h*Je,k+=38*he,X+=38*ge,fe+=38*re,_e+=38*be,de+=38*me,ve+=38*Ee,Ue+=38*De,Ce+=38*we,ye+=38*vt,pe+=38*Dt,le+=38*Ft,ue+=38*dt,ce+=38*qt,oe+=38*fr,se+=38*Hr,N=1,h=k+N+65535,N=Math.floor(h/65536),k=h-N*65536,h=X+N+65535,N=Math.floor(h/65536),X=h-N*65536,h=fe+N+65535,N=Math.floor(h/65536),fe=h-N*65536,h=_e+N+65535,N=Math.floor(h/65536),_e=h-N*65536,h=de+N+65535,N=Math.floor(h/65536),de=h-N*65536,h=ve+N+65535,N=Math.floor(h/65536),ve=h-N*65536,h=Ue+N+65535,N=Math.floor(h/65536),Ue=h-N*65536,h=Ce+N+65535,N=Math.floor(h/65536),Ce=h-N*65536,h=ye+N+65535,N=Math.floor(h/65536),ye=h-N*65536,h=pe+N+65535,N=Math.floor(h/65536),pe=h-N*65536,h=le+N+65535,N=Math.floor(h/65536),le=h-N*65536,h=ue+N+65535,N=Math.floor(h/65536),ue=h-N*65536,h=ce+N+65535,N=Math.floor(h/65536),ce=h-N*65536,h=oe+N+65535,N=Math.floor(h/65536),oe=h-N*65536,h=se+N+65535,N=Math.floor(h/65536),se=h-N*65536,h=te+N+65535,N=Math.floor(h/65536),te=h-N*65536,k+=N-1+37*(N-1),N=1,h=k+N+65535,N=Math.floor(h/65536),k=h-N*65536,h=X+N+65535,N=Math.floor(h/65536),X=h-N*65536,h=fe+N+65535,N=Math.floor(h/65536),fe=h-N*65536,h=_e+N+65535,N=Math.floor(h/65536),_e=h-N*65536,h=de+N+65535,N=Math.floor(h/65536),de=h-N*65536,h=ve+N+65535,N=Math.floor(h/65536),ve=h-N*65536,h=Ue+N+65535,N=Math.floor(h/65536),Ue=h-N*65536,h=Ce+N+65535,N=Math.floor(h/65536),Ce=h-N*65536,h=ye+N+65535,N=Math.floor(h/65536),ye=h-N*65536,h=pe+N+65535,N=Math.floor(h/65536),pe=h-N*65536,h=le+N+65535,N=Math.floor(h/65536),le=h-N*65536,h=ue+N+65535,N=Math.floor(h/65536),ue=h-N*65536,h=ce+N+65535,N=Math.floor(h/65536),ce=h-N*65536,h=oe+N+65535,N=Math.floor(h/65536),oe=h-N*65536,h=se+N+65535,N=Math.floor(h/65536),se=h-N*65536,h=te+N+65535,N=Math.floor(h/65536),te=h-N*65536,k+=N-1+37*(N-1),M[0]=k,M[1]=X,M[2]=fe,M[3]=_e,M[4]=de,M[5]=ve,M[6]=Ue,M[7]=Ce,M[8]=ye,M[9]=pe,M[10]=le,M[11]=ue,M[12]=ce,M[13]=oe,M[14]=se,M[15]=te}function p(M,j){s(M,j,j)}function H(M,j){const R=i();let h;for(h=0;h<16;h++)R[h]=j[h];for(h=253;h>=0;h--)p(R,R),h!==2&&h!==4&&s(R,R,j);for(h=0;h<16;h++)M[h]=R[h]}function o(M,j){const R=i();let h;for(h=0;h<16;h++)R[h]=j[h];for(h=250;h>=0;h--)p(R,R),h!==1&&s(R,R,j);for(h=0;h<16;h++)M[h]=R[h]}function f(M,j){const R=i(),h=i(),N=i(),k=i(),X=i(),fe=i(),_e=i(),de=i(),ve=i();D(R,M[1],M[0]),D(ve,j[1],j[0]),s(R,R,ve),w(h,M[0],M[1]),w(ve,j[0],j[1]),s(h,h,ve),s(N,M[3],j[3]),s(N,N,E),s(k,M[2],j[2]),w(k,k,k),D(X,h,R),D(fe,k,N),w(_e,k,N),w(de,h,R),s(M[0],X,fe),s(M[1],de,_e),s(M[2],_e,fe),s(M[3],X,de)}function l(M,j,R){for(let h=0;h<4;h++)z(M[h],j[h],R)}function _(M,j){const R=i(),h=i(),N=i();H(N,j[2]),s(R,j[0],N),s(h,j[1],N),B(M,h),M[31]^=I(R)<<7}function c(M,j,R){C(M[0],g),C(M[1],d),C(M[2],d),C(M[3],g);for(let h=255;h>=0;--h){const N=R[h/8|0]>>(h&7)&1;l(M,j,N),f(j,M),f(M,M),l(M,j,N)}}function a(M,j){const R=[i(),i(),i(),i()];C(R[0],S),C(R[1],T),C(R[2],d),s(R[3],S,T),c(M,R,j)}function O(M){if(M.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const j=(0,r.hash)(M);j[0]&=248,j[31]&=127,j[31]|=64;const R=new Uint8Array(32),h=[i(),i(),i(),i()];a(h,j),_(R,h);const N=new Uint8Array(64);return N.set(M),N.set(R,32),{publicKey:R,secretKey:N}}t.generateKeyPairFromSeed=O;function A(M){const j=(0,e.randomBytes)(32,M),R=O(j);return(0,n.wipe)(j),R}t.generateKeyPair=A;function L(M){if(M.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(M.subarray(32))}t.extractPublicKeyFromSecretKey=L;const v=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function U(M,j){let R,h,N,k;for(h=63;h>=32;--h){for(R=0,N=h-32,k=h-12;N<k;++N)j[N]+=R-16*j[h]*v[N-(h-32)],R=Math.floor((j[N]+128)/256),j[N]-=R*256;j[N]+=R,j[h]=0}for(R=0,N=0;N<32;N++)j[N]+=R-(j[31]>>4)*v[N],R=j[N]>>8,j[N]&=255;for(N=0;N<32;N++)j[N]-=R*v[N];for(h=0;h<32;h++)j[h+1]+=j[h]>>8,M[h]=j[h]&255}function K(M){const j=new Float64Array(64);for(let R=0;R<64;R++)j[R]=M[R];for(let R=0;R<64;R++)M[R]=0;U(M,j)}function q(M,j){const R=new Float64Array(64),h=[i(),i(),i(),i()],N=(0,r.hash)(M.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const k=new Uint8Array(64);k.set(N.subarray(32),32);const X=new r.SHA512;X.update(k.subarray(32)),X.update(j);const fe=X.digest();X.clean(),K(fe),a(h,fe),_(k,h),X.reset(),X.update(k.subarray(0,32)),X.update(M.subarray(32)),X.update(j);const _e=X.digest();K(_e);for(let de=0;de<32;de++)R[de]=fe[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)R[de+ve]+=_e[de]*N[ve];return U(k.subarray(32),R),k}t.sign=q;function V(M,j){const R=i(),h=i(),N=i(),k=i(),X=i(),fe=i(),_e=i();return C(M[2],d),b(M[1],j),p(N,M[1]),s(k,N,y),D(N,N,M[2]),w(k,M[2],k),p(X,k),p(fe,X),s(_e,fe,X),s(R,_e,N),s(R,R,k),o(R,R),s(R,R,N),s(R,R,k),s(R,R,k),s(M[0],R,k),p(h,M[0]),s(h,h,k),m(h,N)&&s(M[0],M[0],$),p(h,M[0]),s(h,h,k),m(h,N)?-1:(I(M[0])===j[31]>>7&&D(M[0],g,M[0]),s(M[3],M[0],M[1]),0)}function Q(M,j,R){const h=new Uint8Array(32),N=[i(),i(),i(),i()],k=[i(),i(),i(),i()];if(R.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(V(k,M))return!1;const X=new r.SHA512;X.update(R.subarray(0,32)),X.update(M),X.update(j);const fe=X.digest();return K(fe),c(N,k,fe),a(k,R.subarray(32)),f(N,k),_(h,N),!G(R,h)}t.verify=Q;function Y(M){let j=[i(),i(),i(),i()];if(V(j,M))throw new Error("Ed25519: invalid public key");let R=i(),h=i(),N=j[1];w(R,d,N),D(h,d,N),H(h,h),s(R,R,h);let k=new Uint8Array(32);return B(k,R),k}t.convertPublicKeyToX25519=Y;function ae(M){const j=(0,r.hash)(M.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const R=new Uint8Array(j.subarray(0,32));return(0,n.wipe)(j),R}t.convertSecretKeyToX25519=ae})(oi);const dh="EdDSA",ph="JWT",Ho=".",zo="base64url",gh="utf8",yh="utf8",_h=":",bh="did",mh="key",us="base58btc",vh="z",wh="K36",Eh=32;function qo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Kn(t,e){e||(e=t.reduce((i,u)=>i+u.length,0));const r=qo(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function Dh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var u=t.charAt(i),g=u.charCodeAt(0);if(r[g]!==255)throw new TypeError(u+" is ambiguous");r[g]=i}var d=t.length,y=t.charAt(0),E=Math.log(d)/Math.log(256),S=Math.log(256)/Math.log(d);function T(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var z=0,B=0,G=0,m=P.length;G!==m&&P[G]===0;)G++,z++;for(var I=(m-G)*S+1>>>0,b=new Uint8Array(I);G!==m;){for(var w=P[G],D=0,s=I-1;(w!==0||D<B)&&s!==-1;s--,D++)w+=256*b[s]>>>0,b[s]=w%d>>>0,w=w/d>>>0;if(w!==0)throw new Error("Non-zero carry");B=D,G++}for(var p=I-B;p!==I&&b[p]===0;)p++;for(var H=y.repeat(z);p<I;++p)H+=t.charAt(b[p]);return H}function $(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var z=0;if(P[z]!==" "){for(var B=0,G=0;P[z]===y;)B++,z++;for(var m=(P.length-z)*E+1>>>0,I=new Uint8Array(m);P[z];){var b=r[P.charCodeAt(z)];if(b===255)return;for(var w=0,D=m-1;(b!==0||w<G)&&D!==-1;D--,w++)b+=d*I[D]>>>0,I[D]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");G=w,z++}if(P[z]!==" "){for(var s=m-G;s!==m&&I[s]===0;)s++;for(var p=new Uint8Array(B+(m-s)),H=B;s!==m;)p[H++]=I[s++];return p}}}function C(P){var z=$(P);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:$,decode:C}}var Sh=Dh,Oh=Sh;const Ko=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Ih=t=>new TextEncoder().encode(t),xh=t=>new TextDecoder().decode(t);class Ph{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Th{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Vo(this,e)}}class Ah{constructor(e){this.decoders=e}or(e){return Vo(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vo=(t,e)=>new Ah({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Nh{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ph(e,r,n),this.decoder=new Th(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ln=({name:t,prefix:e,encode:r,decode:n})=>new Nh(t,e,r,n),Fr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Oh(r,e);return ln({prefix:t,name:e,encode:n,decode:u=>Ko(i(u))})},Ch=(t,e,r,n)=>{const i={};for(let S=0;S<e.length;++S)i[e[S]]=S;let u=t.length;for(;t[u-1]==="=";)--u;const g=new Uint8Array(u*r/8|0);let d=0,y=0,E=0;for(let S=0;S<u;++S){const T=i[t[S]];if(T===void 0)throw new SyntaxError(`Non-${n} character`);y=y<<r|T,d+=r,d>=8&&(d-=8,g[E++]=255&y>>d)}if(d>=r||255&y<<8-d)throw new SyntaxError("Unexpected end of data");return g},Rh=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let u="",g=0,d=0;for(let y=0;y<t.length;++y)for(d=d<<8|t[y],g+=8;g>r;)g-=r,u+=e[i&d>>g];if(g&&(u+=e[i&d<<r-g]),n)for(;u.length*r&7;)u+="=";return u},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ln({prefix:e,name:t,encode(i){return Rh(i,n,r)},decode(i){return Ch(i,n,r,t)}}),Fh=ln({prefix:"\0",name:"identity",encode:t=>xh(t),decode:t=>Ih(t)}),Lh=Object.freeze(Object.defineProperty({__proto__:null,identity:Fh},Symbol.toStringTag,{value:"Module"})),Uh=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),jh=Object.freeze(Object.defineProperty({__proto__:null,base2:Uh},Symbol.toStringTag,{value:"Module"})),Mh=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$h=Object.freeze(Object.defineProperty({__proto__:null,base8:Mh},Symbol.toStringTag,{value:"Module"})),Bh=Fr({prefix:"9",name:"base10",alphabet:"0123456789"}),Hh=Object.freeze(Object.defineProperty({__proto__:null,base10:Bh},Symbol.toStringTag,{value:"Module"})),zh=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qh=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Kh=Object.freeze(Object.defineProperty({__proto__:null,base16:zh,base16upper:qh},Symbol.toStringTag,{value:"Module"})),Vh=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gh=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Wh=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kh=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yh=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jh=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xh=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zh=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qh=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ef=Object.freeze(Object.defineProperty({__proto__:null,base32:Vh,base32upper:Gh,base32pad:Wh,base32padupper:kh,base32hex:Yh,base32hexupper:Jh,base32hexpad:Xh,base32hexpadupper:Zh,base32z:Qh},Symbol.toStringTag,{value:"Module"})),tf=Fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rf=Fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nf=Object.freeze(Object.defineProperty({__proto__:null,base36:tf,base36upper:rf},Symbol.toStringTag,{value:"Module"})),sf=Fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),of=Fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),af=Object.freeze(Object.defineProperty({__proto__:null,base58btc:sf,base58flickr:of},Symbol.toStringTag,{value:"Module"})),cf=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uf=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hf=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ff=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),lf=Object.freeze(Object.defineProperty({__proto__:null,base64:cf,base64pad:uf,base64url:hf,base64urlpad:ff},Symbol.toStringTag,{value:"Module"})),Go=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),df=Go.reduce((t,e,r)=>(t[r]=e,t),[]),pf=Go.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function gf(t){return t.reduce((e,r)=>(e+=df[r],e),"")}function yf(t){const e=[];for(const r of t){const n=pf[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const _f=ln({prefix:"\u{1F680}",name:"base256emoji",encode:gf,decode:yf}),bf=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:_f},Symbol.toStringTag,{value:"Module"}));var mf=Wo,hs=128,vf=127,wf=~vf,Ef=Math.pow(2,31);function Wo(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Ef;)e[r++]=t&255|hs,t/=128;for(;t&wf;)e[r++]=t&255|hs,t>>>=7;return e[r]=t|0,Wo.bytes=r-n+1,e}var Df=Vn,Sf=128,fs=127;function Vn(t,n){var r=0,n=n||0,i=0,u=n,g,d=t.length;do{if(u>=d)throw Vn.bytes=0,new RangeError("Could not decode varint");g=t[u++],r+=i<28?(g&fs)<<i:(g&fs)*Math.pow(2,i),i+=7}while(g>=Sf);return Vn.bytes=u-n,r}var Of=Math.pow(2,7),If=Math.pow(2,14),xf=Math.pow(2,21),Pf=Math.pow(2,28),Tf=Math.pow(2,35),Af=Math.pow(2,42),Nf=Math.pow(2,49),Cf=Math.pow(2,56),Rf=Math.pow(2,63),Ff=function(t){return t<Of?1:t<If?2:t<xf?3:t<Pf?4:t<Tf?5:t<Af?6:t<Nf?7:t<Cf?8:t<Rf?9:10},Lf={encode:mf,decode:Df,encodingLength:Ff},ko=Lf;const ls=(t,e,r=0)=>(ko.encode(t,e,r),e),ds=t=>ko.encodingLength(t),Gn=(t,e)=>{const r=e.byteLength,n=ds(t),i=n+ds(r),u=new Uint8Array(i+r);return ls(t,u,0),ls(r,u,n),u.set(e,i),new Uf(t,r,e,u)};class Uf{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Yo=({name:t,code:e,encode:r})=>new jf(t,e,r);class jf{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Gn(this.code,r):r.then(n=>Gn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Jo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Mf=Yo({name:"sha2-256",code:18,encode:Jo("SHA-256")}),$f=Yo({name:"sha2-512",code:19,encode:Jo("SHA-512")}),Bf=Object.freeze(Object.defineProperty({__proto__:null,sha256:Mf,sha512:$f},Symbol.toStringTag,{value:"Module"})),Xo=0,Hf="identity",Zo=Ko,zf=t=>Gn(Xo,Zo(t)),qf={code:Xo,name:Hf,encode:Zo,digest:zf},Kf=Object.freeze(Object.defineProperty({__proto__:null,identity:qf},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ps={...Lh,...jh,...$h,...Hh,...Kh,...ef,...nf,...af,...lf,...bf};({...Bf,...Kf});function Qo(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const gs=Qo("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Nn=Qo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=qo(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),ea={utf8:gs,"utf-8":gs,hex:ps.base16,latin1:Nn,ascii:Nn,binary:Nn,...ps};function lt(t,e="utf8"){const r=ea[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ht(t,e="utf8"){const r=ea[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Vf(t){return typeof t=="string"?t:JSON.stringify(t)}function nn(t){return lt(ht(Vf(t),gh),zo)}function ta(t){const e=ht(wh,us),r=vh+lt(Kn([e,t]),us);return[bh,mh,r].join(_h)}function Gf(t){return lt(t,zo)}function Wf(t){return ht([nn(t.header),nn(t.payload)].join(Ho),yh)}function kf(t){return[nn(t.header),nn(t.payload),Gf(t.signature)].join(Ho)}function ys(t=cr.randomBytes(Eh)){return oi.generateKeyPairFromSeed(t)}async function Yf(t,e,r,n,i=ee.fromMiliseconds(Date.now())){const u={alg:dh,typ:ph},g=ta(n.publicKey),d=i+r,y={iss:g,sub:t,aud:e,iat:i,exp:d},E=Wf({header:u,payload:y}),S=oi.sign(n.secretKey,E);return kf({header:u,payload:y,signature:S})}var ai={},dn={};Object.defineProperty(dn,"__esModule",{value:!0});var st=ne,Wn=gt,Jf=20;function Xf(t,e,r){for(var n=1634760805,i=857760878,u=2036477234,g=1797285236,d=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],E=r[11]<<24|r[10]<<16|r[9]<<8|r[8],S=r[15]<<24|r[14]<<16|r[13]<<8|r[12],T=r[19]<<24|r[18]<<16|r[17]<<8|r[16],$=r[23]<<24|r[22]<<16|r[21]<<8|r[20],C=r[27]<<24|r[26]<<16|r[25]<<8|r[24],P=r[31]<<24|r[30]<<16|r[29]<<8|r[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],G=e[11]<<24|e[10]<<16|e[9]<<8|e[8],m=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=n,b=i,w=u,D=g,s=d,p=y,H=E,o=S,f=T,l=$,_=C,c=P,a=z,O=B,A=G,L=m,v=0;v<Jf;v+=2)I=I+s|0,a^=I,a=a>>>32-16|a<<16,f=f+a|0,s^=f,s=s>>>32-12|s<<12,b=b+p|0,O^=b,O=O>>>32-16|O<<16,l=l+O|0,p^=l,p=p>>>32-12|p<<12,w=w+H|0,A^=w,A=A>>>32-16|A<<16,_=_+A|0,H^=_,H=H>>>32-12|H<<12,D=D+o|0,L^=D,L=L>>>32-16|L<<16,c=c+L|0,o^=c,o=o>>>32-12|o<<12,w=w+H|0,A^=w,A=A>>>32-8|A<<8,_=_+A|0,H^=_,H=H>>>32-7|H<<7,D=D+o|0,L^=D,L=L>>>32-8|L<<8,c=c+L|0,o^=c,o=o>>>32-7|o<<7,b=b+p|0,O^=b,O=O>>>32-8|O<<8,l=l+O|0,p^=l,p=p>>>32-7|p<<7,I=I+s|0,a^=I,a=a>>>32-8|a<<8,f=f+a|0,s^=f,s=s>>>32-7|s<<7,I=I+p|0,L^=I,L=L>>>32-16|L<<16,_=_+L|0,p^=_,p=p>>>32-12|p<<12,b=b+H|0,a^=b,a=a>>>32-16|a<<16,c=c+a|0,H^=c,H=H>>>32-12|H<<12,w=w+o|0,O^=w,O=O>>>32-16|O<<16,f=f+O|0,o^=f,o=o>>>32-12|o<<12,D=D+s|0,A^=D,A=A>>>32-16|A<<16,l=l+A|0,s^=l,s=s>>>32-12|s<<12,w=w+o|0,O^=w,O=O>>>32-8|O<<8,f=f+O|0,o^=f,o=o>>>32-7|o<<7,D=D+s|0,A^=D,A=A>>>32-8|A<<8,l=l+A|0,s^=l,s=s>>>32-7|s<<7,b=b+H|0,a^=b,a=a>>>32-8|a<<8,c=c+a|0,H^=c,H=H>>>32-7|H<<7,I=I+p|0,L^=I,L=L>>>32-8|L<<8,_=_+L|0,p^=_,p=p>>>32-7|p<<7;st.writeUint32LE(I+n|0,t,0),st.writeUint32LE(b+i|0,t,4),st.writeUint32LE(w+u|0,t,8),st.writeUint32LE(D+g|0,t,12),st.writeUint32LE(s+d|0,t,16),st.writeUint32LE(p+y|0,t,20),st.writeUint32LE(H+E|0,t,24),st.writeUint32LE(o+S|0,t,28),st.writeUint32LE(f+T|0,t,32),st.writeUint32LE(l+$|0,t,36),st.writeUint32LE(_+C|0,t,40),st.writeUint32LE(c+P|0,t,44),st.writeUint32LE(a+z|0,t,48),st.writeUint32LE(O+B|0,t,52),st.writeUint32LE(A+G|0,t,56),st.writeUint32LE(L+m|0,t,60)}function ra(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var u,g;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=new Uint8Array(16),g=u.length-e.length,u.set(e,g)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");u=e,g=i}for(var d=new Uint8Array(64),y=0;y<r.length;y+=64){Xf(d,u,t);for(var E=y;E<y+64&&E<r.length;E++)n[E]=r[E]^d[E-y];Qf(u,0,g)}return Wn.wipe(d),i===0&&Wn.wipe(u),n}dn.streamXOR=ra;function Zf(t,e,r,n){return n===void 0&&(n=0),Wn.wipe(r),ra(t,e,r,r,n)}dn.stream=Zf;function Qf(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var na={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});function el(t,e,r){return~(t-1)&e|t-1&r}zt.select=el;function tl(t,e){return(t|0)-(e|0)-1>>>31&1}zt.lessOrEqual=tl;function ia(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}zt.compare=ia;function rl(t,e){return t.length===0||e.length===0?!1:ia(t,e)!==0}zt.equal=rl;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=zt,r=gt;t.DIGEST_LENGTH=16;var n=function(){function g(d){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=d[0]|d[1]<<8;this._r[0]=y&8191;var E=d[2]|d[3]<<8;this._r[1]=(y>>>13|E<<3)&8191;var S=d[4]|d[5]<<8;this._r[2]=(E>>>10|S<<6)&7939;var T=d[6]|d[7]<<8;this._r[3]=(S>>>7|T<<9)&8191;var $=d[8]|d[9]<<8;this._r[4]=(T>>>4|$<<12)&255,this._r[5]=$>>>1&8190;var C=d[10]|d[11]<<8;this._r[6]=($>>>14|C<<2)&8191;var P=d[12]|d[13]<<8;this._r[7]=(C>>>11|P<<5)&8065;var z=d[14]|d[15]<<8;this._r[8]=(P>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return g.prototype._blocks=function(d,y,E){for(var S=this._fin?0:2048,T=this._h[0],$=this._h[1],C=this._h[2],P=this._h[3],z=this._h[4],B=this._h[5],G=this._h[6],m=this._h[7],I=this._h[8],b=this._h[9],w=this._r[0],D=this._r[1],s=this._r[2],p=this._r[3],H=this._r[4],o=this._r[5],f=this._r[6],l=this._r[7],_=this._r[8],c=this._r[9];E>=16;){var a=d[y+0]|d[y+1]<<8;T+=a&8191;var O=d[y+2]|d[y+3]<<8;$+=(a>>>13|O<<3)&8191;var A=d[y+4]|d[y+5]<<8;C+=(O>>>10|A<<6)&8191;var L=d[y+6]|d[y+7]<<8;P+=(A>>>7|L<<9)&8191;var v=d[y+8]|d[y+9]<<8;z+=(L>>>4|v<<12)&8191,B+=v>>>1&8191;var U=d[y+10]|d[y+11]<<8;G+=(v>>>14|U<<2)&8191;var K=d[y+12]|d[y+13]<<8;m+=(U>>>11|K<<5)&8191;var q=d[y+14]|d[y+15]<<8;I+=(K>>>8|q<<8)&8191,b+=q>>>5|S;var V=0,Q=V;Q+=T*w,Q+=$*(5*c),Q+=C*(5*_),Q+=P*(5*l),Q+=z*(5*f),V=Q>>>13,Q&=8191,Q+=B*(5*o),Q+=G*(5*H),Q+=m*(5*p),Q+=I*(5*s),Q+=b*(5*D),V+=Q>>>13,Q&=8191;var Y=V;Y+=T*D,Y+=$*w,Y+=C*(5*c),Y+=P*(5*_),Y+=z*(5*l),V=Y>>>13,Y&=8191,Y+=B*(5*f),Y+=G*(5*o),Y+=m*(5*H),Y+=I*(5*p),Y+=b*(5*s),V+=Y>>>13,Y&=8191;var ae=V;ae+=T*s,ae+=$*D,ae+=C*w,ae+=P*(5*c),ae+=z*(5*_),V=ae>>>13,ae&=8191,ae+=B*(5*l),ae+=G*(5*f),ae+=m*(5*o),ae+=I*(5*H),ae+=b*(5*p),V+=ae>>>13,ae&=8191;var M=V;M+=T*p,M+=$*s,M+=C*D,M+=P*w,M+=z*(5*c),V=M>>>13,M&=8191,M+=B*(5*_),M+=G*(5*l),M+=m*(5*f),M+=I*(5*o),M+=b*(5*H),V+=M>>>13,M&=8191;var j=V;j+=T*H,j+=$*p,j+=C*s,j+=P*D,j+=z*w,V=j>>>13,j&=8191,j+=B*(5*c),j+=G*(5*_),j+=m*(5*l),j+=I*(5*f),j+=b*(5*o),V+=j>>>13,j&=8191;var R=V;R+=T*o,R+=$*H,R+=C*p,R+=P*s,R+=z*D,V=R>>>13,R&=8191,R+=B*w,R+=G*(5*c),R+=m*(5*_),R+=I*(5*l),R+=b*(5*f),V+=R>>>13,R&=8191;var h=V;h+=T*f,h+=$*o,h+=C*H,h+=P*p,h+=z*s,V=h>>>13,h&=8191,h+=B*D,h+=G*w,h+=m*(5*c),h+=I*(5*_),h+=b*(5*l),V+=h>>>13,h&=8191;var N=V;N+=T*l,N+=$*f,N+=C*o,N+=P*H,N+=z*p,V=N>>>13,N&=8191,N+=B*s,N+=G*D,N+=m*w,N+=I*(5*c),N+=b*(5*_),V+=N>>>13,N&=8191;var k=V;k+=T*_,k+=$*l,k+=C*f,k+=P*o,k+=z*H,V=k>>>13,k&=8191,k+=B*p,k+=G*s,k+=m*D,k+=I*w,k+=b*(5*c),V+=k>>>13,k&=8191;var X=V;X+=T*c,X+=$*_,X+=C*l,X+=P*f,X+=z*o,V=X>>>13,X&=8191,X+=B*H,X+=G*p,X+=m*s,X+=I*D,X+=b*w,V+=X>>>13,X&=8191,V=(V<<2)+V|0,V=V+Q|0,Q=V&8191,V=V>>>13,Y+=V,T=Q,$=Y,C=ae,P=M,z=j,B=R,G=h,m=N,I=k,b=X,y+=16,E-=16}this._h[0]=T,this._h[1]=$,this._h[2]=C,this._h[3]=P,this._h[4]=z,this._h[5]=B,this._h[6]=G,this._h[7]=m,this._h[8]=I,this._h[9]=b},g.prototype.finish=function(d,y){y===void 0&&(y=0);var E=new Uint16Array(10),S,T,$,C;if(this._leftover){for(C=this._leftover,this._buffer[C++]=1;C<16;C++)this._buffer[C]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(S=this._h[1]>>>13,this._h[1]&=8191,C=2;C<10;C++)this._h[C]+=S,S=this._h[C]>>>13,this._h[C]&=8191;for(this._h[0]+=S*5,S=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=S,S=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=S,E[0]=this._h[0]+5,S=E[0]>>>13,E[0]&=8191,C=1;C<10;C++)E[C]=this._h[C]+S,S=E[C]>>>13,E[C]&=8191;for(E[9]-=1<<13,T=(S^1)-1,C=0;C<10;C++)E[C]&=T;for(T=~T,C=0;C<10;C++)this._h[C]=this._h[C]&T|E[C];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,$=this._h[0]+this._pad[0],this._h[0]=$&65535,C=1;C<8;C++)$=(this._h[C]+this._pad[C]|0)+($>>>16)|0,this._h[C]=$&65535;return d[y+0]=this._h[0]>>>0,d[y+1]=this._h[0]>>>8,d[y+2]=this._h[1]>>>0,d[y+3]=this._h[1]>>>8,d[y+4]=this._h[2]>>>0,d[y+5]=this._h[2]>>>8,d[y+6]=this._h[3]>>>0,d[y+7]=this._h[3]>>>8,d[y+8]=this._h[4]>>>0,d[y+9]=this._h[4]>>>8,d[y+10]=this._h[5]>>>0,d[y+11]=this._h[5]>>>8,d[y+12]=this._h[6]>>>0,d[y+13]=this._h[6]>>>8,d[y+14]=this._h[7]>>>0,d[y+15]=this._h[7]>>>8,this._finished=!0,this},g.prototype.update=function(d){var y=0,E=d.length,S;if(this._leftover){S=16-this._leftover,S>E&&(S=E);for(var T=0;T<S;T++)this._buffer[this._leftover+T]=d[y+T];if(E-=S,y+=S,this._leftover+=S,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(E>=16&&(S=E-E%16,this._blocks(d,y,S),y+=S,E-=S),E){for(var T=0;T<E;T++)this._buffer[this._leftover+T]=d[y+T];this._leftover+=E}return this},g.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},g.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},g}();t.Poly1305=n;function i(g,d){var y=new n(g);y.update(d);var E=y.digest();return y.clean(),E}t.oneTimeAuth=i;function u(g,d){return g.length!==t.DIGEST_LENGTH||d.length!==t.DIGEST_LENGTH?!1:e.equal(g,d)}t.equal=u})(na);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=dn,r=na,n=gt,i=ne,u=zt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var g=new Uint8Array(16),d=function(){function y(E){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,E.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(E)}return y.prototype.seal=function(E,S,T,$){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var C=new Uint8Array(16);C.set(E,C.length-E.length);var P=new Uint8Array(32);e.stream(this._key,C,P,4);var z=S.length+this.tagLength,B;if($){if($.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");B=$}else B=new Uint8Array(z);return e.streamXOR(this._key,C,S,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),P,B.subarray(0,B.length-this.tagLength),T),n.wipe(C),B},y.prototype.open=function(E,S,T,$){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(S.length<this.tagLength)return null;var C=new Uint8Array(16);C.set(E,C.length-E.length);var P=new Uint8Array(32);e.stream(this._key,C,P,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,P,S.subarray(0,S.length-this.tagLength),T),!u.equal(z,S.subarray(S.length-this.tagLength,S.length)))return null;var B=S.length-this.tagLength,G;if($){if($.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");G=$}else G=new Uint8Array(B);return e.streamXOR(this._key,C,S.subarray(0,S.length-this.tagLength),G,4),n.wipe(C),G},y.prototype.clean=function(){return n.wipe(this._key),this},y.prototype._authenticate=function(E,S,T,$){var C=new r.Poly1305(S);$&&(C.update($),$.length%16>0&&C.update(g.subarray($.length%16))),C.update(T),T.length%16>0&&C.update(g.subarray(T.length%16));var P=new Uint8Array(8);$&&i.writeUint64LE($.length,P),C.update(P),i.writeUint64LE(T.length,P),C.update(P);for(var z=C.digest(),B=0;B<z.length;B++)E[B]=z[B];C.clean(),n.wipe(z),n.wipe(P)},y}();t.ChaCha20Poly1305=d})(ai);var sa={},Lr={},ci={};Object.defineProperty(ci,"__esModule",{value:!0});function nl(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ci.isSerializableHash=nl;Object.defineProperty(Lr,"__esModule",{value:!0});var St=ci,il=zt,sl=gt,oa=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),sl.wipe(n)}return t.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Lr.HMAC=oa;function ol(t,e,r){var n=new oa(t,e);n.update(r);var i=n.digest();return n.clean(),i}Lr.hmac=ol;Lr.equal=il.equal;Object.defineProperty(sa,"__esModule",{value:!0});var _s=Lr,bs=gt,al=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var u=_s.hmac(this._hash,n,r);this._hmac=new _s.HMAC(e,u),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),bs.wipe(this._buffer),bs.wipe(this._counter),this._bufpos=0},t}(),cl=sa.HKDF=al,pn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=gt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function d(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},d.prototype.update=function(y,E){if(E===void 0&&(E=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var S=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&E>0;)this._buffer[this._bufferLength++]=y[S++],E--;this._bufferLength===this.blockSize&&(u(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(S=u(this._temp,this._state,y,S,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=y[S++],E--;return this},d.prototype.finish=function(y){if(!this._finished){var E=this._bytesHashed,S=this._bufferLength,T=E/536870912|0,$=E<<3,C=E%64<56?64:128;this._buffer[S]=128;for(var P=S+1;P<C-8;P++)this._buffer[P]=0;e.writeUint32BE(T,this._buffer,C-8),e.writeUint32BE($,this._buffer,C-4),u(this._temp,this._state,this._buffer,0,C),this._finished=!0}for(var P=0;P<this.digestLength/4;P++)e.writeUint32BE(this._state[P],y,P*4);return this},d.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(y){r.wipe(y.state),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},d}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function u(d,y,E,S,T){for(;T>=64;){for(var $=y[0],C=y[1],P=y[2],z=y[3],B=y[4],G=y[5],m=y[6],I=y[7],b=0;b<16;b++){var w=S+b*4;d[b]=e.readUint32BE(E,w)}for(var b=16;b<64;b++){var D=d[b-2],s=(D>>>17|D<<32-17)^(D>>>19|D<<32-19)^D>>>10;D=d[b-15];var p=(D>>>7|D<<32-7)^(D>>>18|D<<32-18)^D>>>3;d[b]=(s+d[b-7]|0)+(p+d[b-16]|0)}for(var b=0;b<64;b++){var s=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&G^~B&m)|0)+(I+(i[b]+d[b]|0)|0)|0,p=(($>>>2|$<<32-2)^($>>>13|$<<32-13)^($>>>22|$<<32-22))+($&C^$&P^C&P)|0;I=m,m=G,G=B,B=z+s|0,z=P,P=C,C=$,$=s+p|0}y[0]+=$,y[1]+=C,y[2]+=P,y[3]+=z,y[4]+=B,y[5]+=G,y[6]+=m,y[7]+=I,S+=64,T-=64}return S}function g(d){var y=new n;y.update(d);var E=y.digest();return y.clean(),E}t.hash=g})(pn);var ui={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=cr,r=gt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(b){const w=new Float64Array(16);if(b)for(let D=0;D<b.length;D++)w[D]=b[D];return w}const i=new Uint8Array(32);i[0]=9;const u=n([56129,1]);function g(b){let w=1;for(let D=0;D<16;D++){let s=b[D]+w+65535;w=Math.floor(s/65536),b[D]=s-w*65536}b[0]+=w-1+37*(w-1)}function d(b,w,D){const s=~(D-1);for(let p=0;p<16;p++){const H=s&(b[p]^w[p]);b[p]^=H,w[p]^=H}}function y(b,w){const D=n(),s=n();for(let p=0;p<16;p++)s[p]=w[p];g(s),g(s),g(s);for(let p=0;p<2;p++){D[0]=s[0]-65517;for(let o=1;o<15;o++)D[o]=s[o]-65535-(D[o-1]>>16&1),D[o-1]&=65535;D[15]=s[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,d(s,D,1-H)}for(let p=0;p<16;p++)b[2*p]=s[p]&255,b[2*p+1]=s[p]>>8}function E(b,w){for(let D=0;D<16;D++)b[D]=w[2*D]+(w[2*D+1]<<8);b[15]&=32767}function S(b,w,D){for(let s=0;s<16;s++)b[s]=w[s]+D[s]}function T(b,w,D){for(let s=0;s<16;s++)b[s]=w[s]-D[s]}function $(b,w,D){let s,p,H=0,o=0,f=0,l=0,_=0,c=0,a=0,O=0,A=0,L=0,v=0,U=0,K=0,q=0,V=0,Q=0,Y=0,ae=0,M=0,j=0,R=0,h=0,N=0,k=0,X=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=D[0],pe=D[1],le=D[2],ue=D[3],ce=D[4],oe=D[5],se=D[6],te=D[7],he=D[8],ge=D[9],re=D[10],be=D[11],me=D[12],Ee=D[13],De=D[14],we=D[15];s=w[0],H+=s*ye,o+=s*pe,f+=s*le,l+=s*ue,_+=s*ce,c+=s*oe,a+=s*se,O+=s*te,A+=s*he,L+=s*ge,v+=s*re,U+=s*be,K+=s*me,q+=s*Ee,V+=s*De,Q+=s*we,s=w[1],o+=s*ye,f+=s*pe,l+=s*le,_+=s*ue,c+=s*ce,a+=s*oe,O+=s*se,A+=s*te,L+=s*he,v+=s*ge,U+=s*re,K+=s*be,q+=s*me,V+=s*Ee,Q+=s*De,Y+=s*we,s=w[2],f+=s*ye,l+=s*pe,_+=s*le,c+=s*ue,a+=s*ce,O+=s*oe,A+=s*se,L+=s*te,v+=s*he,U+=s*ge,K+=s*re,q+=s*be,V+=s*me,Q+=s*Ee,Y+=s*De,ae+=s*we,s=w[3],l+=s*ye,_+=s*pe,c+=s*le,a+=s*ue,O+=s*ce,A+=s*oe,L+=s*se,v+=s*te,U+=s*he,K+=s*ge,q+=s*re,V+=s*be,Q+=s*me,Y+=s*Ee,ae+=s*De,M+=s*we,s=w[4],_+=s*ye,c+=s*pe,a+=s*le,O+=s*ue,A+=s*ce,L+=s*oe,v+=s*se,U+=s*te,K+=s*he,q+=s*ge,V+=s*re,Q+=s*be,Y+=s*me,ae+=s*Ee,M+=s*De,j+=s*we,s=w[5],c+=s*ye,a+=s*pe,O+=s*le,A+=s*ue,L+=s*ce,v+=s*oe,U+=s*se,K+=s*te,q+=s*he,V+=s*ge,Q+=s*re,Y+=s*be,ae+=s*me,M+=s*Ee,j+=s*De,R+=s*we,s=w[6],a+=s*ye,O+=s*pe,A+=s*le,L+=s*ue,v+=s*ce,U+=s*oe,K+=s*se,q+=s*te,V+=s*he,Q+=s*ge,Y+=s*re,ae+=s*be,M+=s*me,j+=s*Ee,R+=s*De,h+=s*we,s=w[7],O+=s*ye,A+=s*pe,L+=s*le,v+=s*ue,U+=s*ce,K+=s*oe,q+=s*se,V+=s*te,Q+=s*he,Y+=s*ge,ae+=s*re,M+=s*be,j+=s*me,R+=s*Ee,h+=s*De,N+=s*we,s=w[8],A+=s*ye,L+=s*pe,v+=s*le,U+=s*ue,K+=s*ce,q+=s*oe,V+=s*se,Q+=s*te,Y+=s*he,ae+=s*ge,M+=s*re,j+=s*be,R+=s*me,h+=s*Ee,N+=s*De,k+=s*we,s=w[9],L+=s*ye,v+=s*pe,U+=s*le,K+=s*ue,q+=s*ce,V+=s*oe,Q+=s*se,Y+=s*te,ae+=s*he,M+=s*ge,j+=s*re,R+=s*be,h+=s*me,N+=s*Ee,k+=s*De,X+=s*we,s=w[10],v+=s*ye,U+=s*pe,K+=s*le,q+=s*ue,V+=s*ce,Q+=s*oe,Y+=s*se,ae+=s*te,M+=s*he,j+=s*ge,R+=s*re,h+=s*be,N+=s*me,k+=s*Ee,X+=s*De,fe+=s*we,s=w[11],U+=s*ye,K+=s*pe,q+=s*le,V+=s*ue,Q+=s*ce,Y+=s*oe,ae+=s*se,M+=s*te,j+=s*he,R+=s*ge,h+=s*re,N+=s*be,k+=s*me,X+=s*Ee,fe+=s*De,_e+=s*we,s=w[12],K+=s*ye,q+=s*pe,V+=s*le,Q+=s*ue,Y+=s*ce,ae+=s*oe,M+=s*se,j+=s*te,R+=s*he,h+=s*ge,N+=s*re,k+=s*be,X+=s*me,fe+=s*Ee,_e+=s*De,de+=s*we,s=w[13],q+=s*ye,V+=s*pe,Q+=s*le,Y+=s*ue,ae+=s*ce,M+=s*oe,j+=s*se,R+=s*te,h+=s*he,N+=s*ge,k+=s*re,X+=s*be,fe+=s*me,_e+=s*Ee,de+=s*De,ve+=s*we,s=w[14],V+=s*ye,Q+=s*pe,Y+=s*le,ae+=s*ue,M+=s*ce,j+=s*oe,R+=s*se,h+=s*te,N+=s*he,k+=s*ge,X+=s*re,fe+=s*be,_e+=s*me,de+=s*Ee,ve+=s*De,Ue+=s*we,s=w[15],Q+=s*ye,Y+=s*pe,ae+=s*le,M+=s*ue,j+=s*ce,R+=s*oe,h+=s*se,N+=s*te,k+=s*he,X+=s*ge,fe+=s*re,_e+=s*be,de+=s*me,ve+=s*Ee,Ue+=s*De,Ce+=s*we,H+=38*Y,o+=38*ae,f+=38*M,l+=38*j,_+=38*R,c+=38*h,a+=38*N,O+=38*k,A+=38*X,L+=38*fe,v+=38*_e,U+=38*de,K+=38*ve,q+=38*Ue,V+=38*Ce,p=1,s=H+p+65535,p=Math.floor(s/65536),H=s-p*65536,s=o+p+65535,p=Math.floor(s/65536),o=s-p*65536,s=f+p+65535,p=Math.floor(s/65536),f=s-p*65536,s=l+p+65535,p=Math.floor(s/65536),l=s-p*65536,s=_+p+65535,p=Math.floor(s/65536),_=s-p*65536,s=c+p+65535,p=Math.floor(s/65536),c=s-p*65536,s=a+p+65535,p=Math.floor(s/65536),a=s-p*65536,s=O+p+65535,p=Math.floor(s/65536),O=s-p*65536,s=A+p+65535,p=Math.floor(s/65536),A=s-p*65536,s=L+p+65535,p=Math.floor(s/65536),L=s-p*65536,s=v+p+65535,p=Math.floor(s/65536),v=s-p*65536,s=U+p+65535,p=Math.floor(s/65536),U=s-p*65536,s=K+p+65535,p=Math.floor(s/65536),K=s-p*65536,s=q+p+65535,p=Math.floor(s/65536),q=s-p*65536,s=V+p+65535,p=Math.floor(s/65536),V=s-p*65536,s=Q+p+65535,p=Math.floor(s/65536),Q=s-p*65536,H+=p-1+37*(p-1),p=1,s=H+p+65535,p=Math.floor(s/65536),H=s-p*65536,s=o+p+65535,p=Math.floor(s/65536),o=s-p*65536,s=f+p+65535,p=Math.floor(s/65536),f=s-p*65536,s=l+p+65535,p=Math.floor(s/65536),l=s-p*65536,s=_+p+65535,p=Math.floor(s/65536),_=s-p*65536,s=c+p+65535,p=Math.floor(s/65536),c=s-p*65536,s=a+p+65535,p=Math.floor(s/65536),a=s-p*65536,s=O+p+65535,p=Math.floor(s/65536),O=s-p*65536,s=A+p+65535,p=Math.floor(s/65536),A=s-p*65536,s=L+p+65535,p=Math.floor(s/65536),L=s-p*65536,s=v+p+65535,p=Math.floor(s/65536),v=s-p*65536,s=U+p+65535,p=Math.floor(s/65536),U=s-p*65536,s=K+p+65535,p=Math.floor(s/65536),K=s-p*65536,s=q+p+65535,p=Math.floor(s/65536),q=s-p*65536,s=V+p+65535,p=Math.floor(s/65536),V=s-p*65536,s=Q+p+65535,p=Math.floor(s/65536),Q=s-p*65536,H+=p-1+37*(p-1),b[0]=H,b[1]=o,b[2]=f,b[3]=l,b[4]=_,b[5]=c,b[6]=a,b[7]=O,b[8]=A,b[9]=L,b[10]=v,b[11]=U,b[12]=K,b[13]=q,b[14]=V,b[15]=Q}function C(b,w){$(b,w,w)}function P(b,w){const D=n();for(let s=0;s<16;s++)D[s]=w[s];for(let s=253;s>=0;s--)C(D,D),s!==2&&s!==4&&$(D,D,w);for(let s=0;s<16;s++)b[s]=D[s]}function z(b,w){const D=new Uint8Array(32),s=new Float64Array(80),p=n(),H=n(),o=n(),f=n(),l=n(),_=n();for(let A=0;A<31;A++)D[A]=b[A];D[31]=b[31]&127|64,D[0]&=248,E(s,w);for(let A=0;A<16;A++)H[A]=s[A];p[0]=f[0]=1;for(let A=254;A>=0;--A){const L=D[A>>>3]>>>(A&7)&1;d(p,H,L),d(o,f,L),S(l,p,o),T(p,p,o),S(o,H,f),T(H,H,f),C(f,l),C(_,p),$(p,o,p),$(o,H,l),S(l,p,o),T(p,p,o),C(H,p),T(o,f,_),$(p,o,u),S(p,p,f),$(o,o,p),$(p,f,_),$(f,H,s),C(H,l),d(p,H,L),d(o,f,L)}for(let A=0;A<16;A++)s[A+16]=p[A],s[A+32]=o[A],s[A+48]=H[A],s[A+64]=f[A];const c=s.subarray(32),a=s.subarray(16);P(c,c),$(a,a,c);const O=new Uint8Array(32);return y(O,a),O}t.scalarMult=z;function B(b){return z(b,i)}t.scalarMultBase=B;function G(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(b);return{publicKey:B(w),secretKey:w}}t.generateKeyPairFromSeed=G;function m(b){const w=(0,e.randomBytes)(32,b),D=G(w);return(0,r.wipe)(w),D}t.generateKeyPair=m;function I(b,w,D=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const s=z(b,w);if(D){let p=0;for(let H=0;H<s.length;H++)p|=s[H];if(p===0)throw new Error("X25519: invalid shared key")}return s}t.sharedKey=I})(ui);var ms=globalThis&&globalThis.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,u;n<i;n++)(u||!(n in e))&&(u||(u=Array.prototype.slice.call(e,0,n)),u[n]=e[n]);return t.concat(u||Array.prototype.slice.call(e))},ul=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),hl=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),fl=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),ll=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),dl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),pl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,gl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,vs=3,yl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",pl]],ws=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function _l(t){return t?Es(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new dl:typeof navigator<"u"?Es(navigator.userAgent):vl()}function bl(t){return t!==""&&yl.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var u=i.exec(t);return!!u&&[n,u]},!1)}function Es(t){var e=bl(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new ll;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<vs&&(i=ms(ms([],i,!0),wl(vs-i.length),!0)):i=[];var u=i.join("."),g=ml(t),d=gl.exec(t);return d&&d[1]?new fl(r,u,g,d[1]):new ul(r,u,g)}function ml(t){for(var e=0,r=ws.length;e<r;e++){var n=ws[e],i=n[0],u=n[1],g=u.exec(t);if(g)return i}return null}function vl(){var t=typeof process<"u"&&process.version;return t?new hl(process.version.slice(1)):null}function wl(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=ca=Ie.getLocation=Ie.getLocationOrThrow=hi=Ie.getNavigator=Ie.getNavigatorOrThrow=aa=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Qt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=Qt;function ur(t){const e=Qt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=ur;function El(){return ur("document")}Ie.getDocumentOrThrow=El;function Dl(){return Qt("document")}var aa=Ie.getDocument=Dl;function Sl(){return ur("navigator")}Ie.getNavigatorOrThrow=Sl;function Ol(){return Qt("navigator")}var hi=Ie.getNavigator=Ol;function Il(){return ur("location")}Ie.getLocationOrThrow=Il;function xl(){return Qt("location")}var ca=Ie.getLocation=xl;function Pl(){return ur("crypto")}Ie.getCryptoOrThrow=Pl;function Tl(){return Qt("crypto")}Ie.getCrypto=Tl;function Al(){return ur("localStorage")}Ie.getLocalStorageOrThrow=Al;function Nl(){return Qt("localStorage")}Ie.getLocalStorage=Nl;var fi={};Object.defineProperty(fi,"__esModule",{value:!0});var ua=fi.getWindowMetadata=void 0;const Ds=Ie;function Cl(){let t,e;try{t=Ds.getDocumentOrThrow(),e=Ds.getLocationOrThrow()}catch{return null}function r(){const T=t.getElementsByTagName("link"),$=[];for(let C=0;C<T.length;C++){const P=T[C],z=P.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const B=P.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let G=e.protocol+"//"+e.host;if(B.indexOf("/")===0)G+=B;else{const m=e.pathname.split("/");m.pop(),G+=m.join("/")+"/"+B}$.push(G)}else if(B.indexOf("//")===0){const G=e.protocol+B;$.push(G)}else $.push(B)}}return $}function n(...T){const $=t.getElementsByTagName("meta");for(let C=0;C<$.length;C++){const P=$[C],z=["itemprop","property","name"].map(B=>P.getAttribute(B)).filter(B=>B?T.includes(B):!1);if(z.length&&z){const B=P.getAttribute("content");if(B)return B}}return""}function i(){let T=n("name","og:site_name","og:title","twitter:title");return T||(T=t.title),T}function u(){return n("description","og:description","twitter:description","keywords")}const g=i(),d=u(),y=e.origin,E=r();return{description:d,url:y,icons:E,name:g}}ua=fi.getWindowMetadata=Cl;var Pr={},ha=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),fa="%[a-f0-9]{2}",Ss=new RegExp("("+fa+")|([^%]+?)","gi"),Os=new RegExp("("+fa+")+","gi");function kn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],kn(r),kn(n))}function Rl(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Ss)||[],r=1;r<e.length;r++)t=kn(e,r).join(""),e=t.match(Ss)||[];return t}}function Fl(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Os.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=Rl(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Os.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),u=0;u<i.length;u++){var g=i[u];t=t.replace(new RegExp(g,"g"),e[g])}return t}var la=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Fl(t)}},da=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},pa=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),u=0;u<n.length;u++){var g=n[u],d=t[g];(i?e.indexOf(g)!==-1:e(g,d,t))&&(r[g]=d)}return r};(function(t){const e=ha,r=la,n=da,i=pa,u=m=>m==null,g=Symbol("encodeFragmentIdentifier");function d(m){switch(m.arrayFormat){case"index":return I=>(b,w)=>{const D=b.length;return w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),"[",D,"]"].join("")]:[...b,[S(I,m),"[",S(D,m),"]=",S(w,m)].join("")]};case"bracket":return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),"[]"].join("")]:[...b,[S(I,m),"[]=",S(w,m)].join("")];case"colon-list-separator":return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),":list="].join("")]:[...b,[S(I,m),":list=",S(w,m)].join("")];case"comma":case"separator":case"bracket-separator":{const I=m.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,D)=>D===void 0||m.skipNull&&D===null||m.skipEmptyString&&D===""?w:(D=D===null?"":D,w.length===0?[[S(b,m),I,S(D,m)].join("")]:[[w,S(D,m)].join(m.arrayFormatSeparator)])}default:return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,S(I,m)]:[...b,[S(I,m),"=",S(w,m)].join("")]}}function y(m){let I;switch(m.arrayFormat){case"index":return(b,w,D)=>{if(I=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!I){D[b]=w;return}D[b]===void 0&&(D[b]={}),D[b][I[1]]=w};case"bracket":return(b,w,D)=>{if(I=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!I){D[b]=w;return}if(D[b]===void 0){D[b]=[w];return}D[b]=[].concat(D[b],w)};case"colon-list-separator":return(b,w,D)=>{if(I=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!I){D[b]=w;return}if(D[b]===void 0){D[b]=[w];return}D[b]=[].concat(D[b],w)};case"comma":case"separator":return(b,w,D)=>{const s=typeof w=="string"&&w.includes(m.arrayFormatSeparator),p=typeof w=="string"&&!s&&T(w,m).includes(m.arrayFormatSeparator);w=p?T(w,m):w;const H=s||p?w.split(m.arrayFormatSeparator).map(o=>T(o,m)):w===null?w:T(w,m);D[b]=H};case"bracket-separator":return(b,w,D)=>{const s=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!s){D[b]=w&&T(w,m);return}const p=w===null?[]:w.split(m.arrayFormatSeparator).map(H=>T(H,m));if(D[b]===void 0){D[b]=p;return}D[b]=[].concat(D[b],p)};default:return(b,w,D)=>{if(D[b]===void 0){D[b]=w;return}D[b]=[].concat(D[b],w)}}}function E(m){if(typeof m!="string"||m.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(m,I){return I.encode?I.strict?e(m):encodeURIComponent(m):m}function T(m,I){return I.decode?r(m):m}function $(m){return Array.isArray(m)?m.sort():typeof m=="object"?$(Object.keys(m)).sort((I,b)=>Number(I)-Number(b)).map(I=>m[I]):m}function C(m){const I=m.indexOf("#");return I!==-1&&(m=m.slice(0,I)),m}function P(m){let I="";const b=m.indexOf("#");return b!==-1&&(I=m.slice(b)),I}function z(m){m=C(m);const I=m.indexOf("?");return I===-1?"":m.slice(I+1)}function B(m,I){return I.parseNumbers&&!Number.isNaN(Number(m))&&typeof m=="string"&&m.trim()!==""?m=Number(m):I.parseBooleans&&m!==null&&(m.toLowerCase()==="true"||m.toLowerCase()==="false")&&(m=m.toLowerCase()==="true"),m}function G(m,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),E(I.arrayFormatSeparator);const b=y(I),w=Object.create(null);if(typeof m!="string"||(m=m.trim().replace(/^[?#&]/,""),!m))return w;for(const D of m.split("&")){if(D==="")continue;let[s,p]=n(I.decode?D.replace(/\+/g," "):D,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?p:T(p,I),b(T(s,I),p,w)}for(const D of Object.keys(w)){const s=w[D];if(typeof s=="object"&&s!==null)for(const p of Object.keys(s))s[p]=B(s[p],I);else w[D]=B(s,I)}return I.sort===!1?w:(I.sort===!0?Object.keys(w).sort():Object.keys(w).sort(I.sort)).reduce((D,s)=>{const p=w[s];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?D[s]=$(p):D[s]=p,D},Object.create(null))}t.extract=z,t.parse=G,t.stringify=(m,I)=>{if(!m)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),E(I.arrayFormatSeparator);const b=p=>I.skipNull&&u(m[p])||I.skipEmptyString&&m[p]==="",w=d(I),D={};for(const p of Object.keys(m))b(p)||(D[p]=m[p]);const s=Object.keys(D);return I.sort!==!1&&s.sort(I.sort),s.map(p=>{const H=m[p];return H===void 0?"":H===null?S(p,I):Array.isArray(H)?H.length===0&&I.arrayFormat==="bracket-separator"?S(p,I)+"[]":H.reduce(w(p),[]).join("&"):S(p,I)+"="+S(H,I)}).filter(p=>p.length>0).join("&")},t.parseUrl=(m,I)=>{I=Object.assign({decode:!0},I);const[b,w]=n(m,"#");return Object.assign({url:b.split("?")[0]||"",query:G(z(m),I)},I&&I.parseFragmentIdentifier&&w?{fragmentIdentifier:T(w,I)}:{})},t.stringifyUrl=(m,I)=>{I=Object.assign({encode:!0,strict:!0,[g]:!0},I);const b=C(m.url).split("?")[0]||"",w=t.extract(m.url),D=t.parse(w,{sort:!1}),s=Object.assign(D,m.query);let p=t.stringify(s,I);p&&(p=`?${p}`);let H=P(m.url);return m.fragmentIdentifier&&(H=`#${I[g]?S(m.fragmentIdentifier,I):m.fragmentIdentifier}`),`${b}${p}${H}`},t.pick=(m,I,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[g]:!1},b);const{url:w,query:D,fragmentIdentifier:s}=t.parseUrl(m,b);return t.stringifyUrl({url:w,query:i(D,I),fragmentIdentifier:s},b)},t.exclude=(m,I,b)=>{const w=Array.isArray(I)?D=>!I.includes(D):(D,s)=>!I(D,s);return t.pick(m,w,b)}})(Pr);const Ll={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function li(t,e){return t.includes(":")?[t]:e.chains||[]}const ga="base10",ft="base16",Yn="base64pad",di="utf8",ya=0,er=1,Ul=0,Is=1,Jn=12,pi=32;function jl(){const t=ui.generateKeyPair();return{privateKey:lt(t.secretKey,ft),publicKey:lt(t.publicKey,ft)}}function Xn(){const t=cr.randomBytes(pi);return lt(t,ft)}function Ml(t,e){const r=ui.sharedKey(ht(t,ft),ht(e,ft)),n=new cl(pn.SHA256,r).expand(pi);return lt(n,ft)}function $l(t){const e=pn.hash(ht(t,ft));return lt(e,ft)}function sn(t){const e=pn.hash(ht(t,di));return lt(e,ft)}function Bl(t){return ht(`${t}`,ga)}function Ur(t){return Number(lt(t,ga))}function Hl(t){const e=Bl(typeof t.type<"u"?t.type:ya);if(Ur(e)===er&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ht(t.senderPublicKey,ft):void 0,n=typeof t.iv<"u"?ht(t.iv,ft):cr.randomBytes(Jn),i=new ai.ChaCha20Poly1305(ht(t.symKey,ft)).seal(n,ht(t.message,di));return ql({type:e,sealed:i,iv:n,senderPublicKey:r})}function zl(t){const e=new ai.ChaCha20Poly1305(ht(t.symKey,ft)),{sealed:r,iv:n}=gi(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return lt(i,di)}function ql(t){if(Ur(t.type)===er){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lt(Kn([t.type,t.senderPublicKey,t.iv,t.sealed]),Yn)}return lt(Kn([t.type,t.iv,t.sealed]),Yn)}function gi(t){const e=ht(t,Yn),r=e.slice(Ul,Is),n=Is;if(Ur(r)===er){const d=n+pi,y=d+Jn,E=e.slice(n,d),S=e.slice(d,y),T=e.slice(y);return{type:r,sealed:T,iv:S,senderPublicKey:E}}const i=n+Jn,u=e.slice(n,i),g=e.slice(i);return{type:r,sealed:g,iv:u}}function Kl(t,e){const r=gi(t);return _a({type:Ur(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?lt(r.senderPublicKey,ft):void 0,receiverPublicKey:e?.receiverPublicKey})}function _a(t){const e=t?.type||ya;if(e===er){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function xs(t){return t.type===er&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Vl=Object.defineProperty,Ps=Object.getOwnPropertySymbols,Gl=Object.prototype.hasOwnProperty,Wl=Object.prototype.propertyIsEnumerable,Ts=(t,e,r)=>e in t?Vl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,As=(t,e)=>{for(var r in e||(e={}))Gl.call(e,r)&&Ts(t,r,e[r]);if(Ps)for(var r of Ps(e))Wl.call(e,r)&&Ts(t,r,e[r]);return t};const kl="ReactNative",Dr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Yl="js";function ba(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Jl(){return!aa()&&!!hi()&&navigator.product===kl}function Xl(){return!ba()&&!!hi()}function Zl(){return Jl()?Dr.reactNative:ba()?Dr.node:Xl()?Dr.browser:Dr.unknown}function Ql(t,e){let r=Pr.parse(t);return r=As(As({},r),e),t=Pr.stringify(r),t}function ed(){return ua()||{name:"",description:"",url:"",icons:[""]}}function td(){const t=_l();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function rd(){var t;const e=Zl();return e===Dr.browser?[e,((t=ca())==null?void 0:t.host)||"unknown"].join(":"):e}function nd(t,e,r){const n=td(),i=rd();return[[t,e].join("-"),[Yl,r].join("-"),n,i].join("/")}function id({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:u}){const g=r.split("?"),d=nd(t,e,n),y={auth:i,ua:d,projectId:u},E=Ql(g[1]||"",y);return g[0]+"?"+E}function $t(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ma(t){return Object.fromEntries(t.entries())}function va(t){return new Map(Object.entries(t))}function Xt(t){const e=ee.toMiliseconds(t||ee.FIVE_MINUTES);let r,n,i;return{resolve:u=>{i&&r&&(clearTimeout(i),r(u))},reject:u=>{i&&n&&(clearTimeout(i),n(u))},done:()=>new Promise((u,g)=>{i=setTimeout(g,e),r=u,n=g})}}function wa(t,e){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),e),u=await t;clearTimeout(i),r(u)})}function Ea(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function sd(t){return Ea("topic",t)}function od(t){return Ea("id",t)}function Da(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function xt(t,e){return ee.fromMiliseconds((e||Date.now())+ee.toMiliseconds(t))}function Mt(t){return Date.now()>=ee.toMiliseconds(t)}function je(t,e){return`${t}${e?`:${e}`:""}`}const ad="irn";function Zn(t){return t?.relay||{protocol:ad}}function Qn(t){const e=Ll[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var cd=Object.defineProperty,Ns=Object.getOwnPropertySymbols,ud=Object.prototype.hasOwnProperty,hd=Object.prototype.propertyIsEnumerable,Cs=(t,e,r)=>e in t?cd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fd=(t,e)=>{for(var r in e||(e={}))ud.call(e,r)&&Cs(t,r,e[r]);if(Ns)for(var r of Ns(e))hd.call(e,r)&&Cs(t,r,e[r]);return t};function ld(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const u=i.replace(n,""),g=t[i];r[u]=g}}),r}function dd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),u=typeof r<"u"?t.substring(r):"",g=Pr.parse(u);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:g.symKey,relay:ld(g)}}function pd(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const u=r+e+i;t[i]&&(n[u]=t[i])}),n}function gd(t){return`${t.protocol}:${t.topic}@${t.version}?`+Pr.stringify(fd({symKey:t.symKey},pd(t.relay)))}function jr(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function yd(t){const e=[];return Object.values(t).forEach(r=>{e.push(...jr(r.accounts))}),e}function _d(t,e){const r=[];return Object.values(t).forEach(n=>{jr(n.accounts).includes(e)&&r.push(...n.methods)}),r}function bd(t,e){const r=[];return Object.values(t).forEach(n=>{jr(n.accounts).includes(e)&&r.push(...n.events)}),r}function md(t,e){const r=en(t,e);if(r)throw new Error(r.message);const n={};for(const[i,u]of Object.entries(t))n[i]={methods:u.methods,events:u.events,chains:u.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return n}const vd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},wd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(t,e){const{message:r,code:n}=wd[t];return{message:e?`${r} ${e}`:r,code:n}}function Ze(t,e){const{message:r,code:n}=vd[t];return{message:e?`${r} ${e}`:r,code:n}}function gn(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Sr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ct(t){return typeof t>"u"}function Qe(t,e){return e&&ct(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function yi(t,e){return e&&ct(t)?!0:typeof t=="number"&&!isNaN(t)}function Ed(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let u=!0;return $t(i,n)?(n.forEach(g=>{const{accounts:d,methods:y,events:E}=t.namespaces[g],S=jr(d),T=r[g];(!$t(li(g,T),S)||!$t(T.methods,y)||!$t(T.events,E))&&(u=!1)}),u):!1}function _i(t){return Qe(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Dd(t){if(Qe(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&_i(r)}}return!1}function Sd(t){if(Qe(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Od(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Id(t){return t?.topic}function xd(t,e){let r=null;return Qe(t?.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Rs(t){let e=!0;return gn(t)?t.length&&(e=t.every(r=>Qe(r,!1))):e=!1,e}function Pd(t,e,r){let n=null;return gn(e)?e.forEach(i=>{n||(!_i(i)||!i.includes(t))&&(n=Ze("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ze("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function Td(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const u=Pd(n,li(n,i),`${e} requiredNamespace`);u&&(r=u)}),r}function Ad(t,e){let r=null;return gn(t)?t.forEach(n=>{r||Dd(n)||(r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Nd(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Ad(n?.accounts,`${e} namespace`);i&&(r=i)}),r}function Cd(t,e){let r=null;return Rs(t?.methods)?Rs(t?.events)||(r=Ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Sa(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Cd(n,`${e}, namespace`);i&&(r=i)}),r}function Rd(t,e,r){let n=null;if(t&&Sr(t)){const i=Sa(t,e);i&&(n=i);const u=Td(t,e);u&&(n=u)}else n=J("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function en(t,e){let r=null;if(t&&Sr(t)){const n=Sa(t,e);n&&(r=n);const i=Nd(t,e);i&&(r=i)}else r=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Oa(t){return Qe(t.protocol,!0)}function Fd(t,e){let r=!1;return e&&!t?r=!0:t&&gn(t)&&t.length&&t.forEach(n=>{r=Oa(n)}),r}function Ld(t){return typeof t=="number"}function ut(t){return typeof t<"u"&&typeof t!==null}function Ud(t){return!(!t||typeof t!="object"||!t.code||!yi(t.code,!1)||!t.message||!Qe(t.message,!1))}function jd(t){return!(ct(t)||!Qe(t.method,!1))}function Md(t){return!(ct(t)||ct(t.result)&&ct(t.error)||!yi(t.id,!1)||!Qe(t.jsonrpc,!1))}function $d(t){return!(ct(t)||!Qe(t.name,!1))}function Fs(t,e){return!(!_i(e)||!yd(t).includes(e))}function Bd(t,e,r){return Qe(r,!1)?_d(t,e).includes(r):!1}function Hd(t,e,r){return Qe(r,!1)?bd(t,e).includes(r):!1}function Cn(t,e,r,n){let i=null;const u=Object.keys(t),g=Object.keys(e);return $t(u,g)?u.forEach(d=>{if(i)return;const y=jr(e[d].accounts);$t(li(d,t[d]),y)?$t(t[d].methods,e[d].methods)?$t(t[d].events,e[d].events)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`):i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace chains for ${d}`)}):i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy ${n}`),i}function zd(t,e){return yi(t,!1)&&t<=e.max&&t>=e.min}const qd="PARSE_ERROR",Kd="INVALID_REQUEST",Vd="METHOD_NOT_FOUND",Gd="INVALID_PARAMS",Ia="INTERNAL_ERROR",bi="SERVER_ERROR",Wd=[-32700,-32600,-32601,-32602,-32603],Or={[qd]:{code:-32700,message:"Parse error"},[Kd]:{code:-32600,message:"Invalid Request"},[Vd]:{code:-32601,message:"Method not found"},[Gd]:{code:-32602,message:"Invalid params"},[Ia]:{code:-32603,message:"Internal error"},[bi]:{code:-32e3,message:"Server error"}},xa=bi;function kd(t){return Wd.includes(t)}function Ls(t){return Object.keys(Or).includes(t)?Or[t]:Or[xa]}function Yd(t){const e=Object.values(Or).find(r=>r.code===t);return e||Or[xa]}function Pa(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ta={},Aa={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(t){var e,r,n,i,u,g,d,y,E,S,T,$,C,P,z,B,G,m,I,b,w,D,s;(function(p){var H=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};p(o(H,o(t.exports)));function o(f,l){return f!==H&&(typeof Object.create=="function"?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0),function(_,c){return f[_]=l?l(_,c):c}}})(function(p){var H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var l in f)f.hasOwnProperty(l)&&(o[l]=f[l])};e=function(o,f){H(o,f);function l(){this.constructor=o}o.prototype=f===null?Object.create(f):(l.prototype=f.prototype,new l)},r=Object.assign||function(o){for(var f,l=1,_=arguments.length;l<_;l++){f=arguments[l];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(o[c]=f[c])}return o},n=function(o,f){var l={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&f.indexOf(_)<0&&(l[_]=o[_]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,_=Object.getOwnPropertySymbols(o);c<_.length;c++)f.indexOf(_[c])<0&&Object.prototype.propertyIsEnumerable.call(o,_[c])&&(l[_[c]]=o[_[c]]);return l},i=function(o,f,l,_){var c=arguments.length,a=c<3?f:_===null?_=Object.getOwnPropertyDescriptor(f,l):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,f,l,_);else for(var A=o.length-1;A>=0;A--)(O=o[A])&&(a=(c<3?O(a):c>3?O(f,l,a):O(f,l))||a);return c>3&&a&&Object.defineProperty(f,l,a),a},u=function(o,f){return function(l,_){f(l,_,o)}},g=function(o,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,f)},d=function(o,f,l,_){function c(a){return a instanceof l?a:new l(function(O){O(a)})}return new(l||(l=Promise))(function(a,O){function A(U){try{v(_.next(U))}catch(K){O(K)}}function L(U){try{v(_.throw(U))}catch(K){O(K)}}function v(U){U.done?a(U.value):c(U.value).then(A,L)}v((_=_.apply(o,f||[])).next())})},y=function(o,f){var l={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},_,c,a,O;return O={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function A(v){return function(U){return L([v,U])}}function L(v){if(_)throw new TypeError("Generator is already executing.");for(;l;)try{if(_=1,c&&(a=v[0]&2?c.return:v[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,v[1])).done)return a;switch(c=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,c=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){l=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){l.label=v[1];break}if(v[0]===6&&l.label<a[1]){l.label=a[1],a=v;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(v);break}a[2]&&l.ops.pop(),l.trys.pop();continue}v=f.call(o,l)}catch(U){v=[6,U],c=0}finally{_=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},s=function(o,f,l,_){_===void 0&&(_=l),o[_]=f[l]},E=function(o,f){for(var l in o)l!=="default"&&!f.hasOwnProperty(l)&&(f[l]=o[l])},S=function(o){var f=typeof Symbol=="function"&&Symbol.iterator,l=f&&o[f],_=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.")},T=function(o,f){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var _=l.call(o),c,a=[],O;try{for(;(f===void 0||f-- >0)&&!(c=_.next()).done;)a.push(c.value)}catch(A){O={error:A}}finally{try{c&&!c.done&&(l=_.return)&&l.call(_)}finally{if(O)throw O.error}}return a},$=function(){for(var o=[],f=0;f<arguments.length;f++)o=o.concat(T(arguments[f]));return o},C=function(){for(var o=0,f=0,l=arguments.length;f<l;f++)o+=arguments[f].length;for(var _=Array(o),c=0,f=0;f<l;f++)for(var a=arguments[f],O=0,A=a.length;O<A;O++,c++)_[c]=a[O];return _},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},z=function(o,f,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=l.apply(o,f||[]),c,a=[];return c={},O("next"),O("throw"),O("return"),c[Symbol.asyncIterator]=function(){return this},c;function O(q){_[q]&&(c[q]=function(V){return new Promise(function(Q,Y){a.push([q,V,Q,Y])>1||A(q,V)})})}function A(q,V){try{L(_[q](V))}catch(Q){K(a[0][3],Q)}}function L(q){q.value instanceof P?Promise.resolve(q.value.v).then(v,U):K(a[0][2],q)}function v(q){A("next",q)}function U(q){A("throw",q)}function K(q,V){q(V),a.shift(),a.length&&A(a[0][0],a[0][1])}},B=function(o){var f,l;return f={},_("next"),_("throw",function(c){throw c}),_("return"),f[Symbol.iterator]=function(){return this},f;function _(c,a){f[c]=o[c]?function(O){return(l=!l)?{value:P(o[c](O)),done:c==="return"}:a?a(O):O}:a}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=o[Symbol.asyncIterator],l;return f?f.call(o):(o=typeof S=="function"?S(o):o[Symbol.iterator](),l={},_("next"),_("throw"),_("return"),l[Symbol.asyncIterator]=function(){return this},l);function _(a){l[a]=o[a]&&function(O){return new Promise(function(A,L){O=o[a](O),c(A,L,O.done,O.value)})}}function c(a,O,A,L){Promise.resolve(L).then(function(v){a({value:v,done:A})},O)}},m=function(o,f){return Object.defineProperty?Object.defineProperty(o,"raw",{value:f}):o.raw=f,o},I=function(o){if(o&&o.__esModule)return o;var f={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(f[l]=o[l]);return f.default=o,f},b=function(o){return o&&o.__esModule?o:{default:o}},w=function(o,f){if(!f.has(o))throw new TypeError("attempted to get private field on non-instance");return f.get(o)},D=function(o,f,l){if(!f.has(o))throw new TypeError("attempted to set private field on non-instance");return f.set(o,l),l},p("__extends",e),p("__assign",r),p("__rest",n),p("__decorate",i),p("__param",u),p("__metadata",g),p("__awaiter",d),p("__generator",y),p("__exportStar",E),p("__createBinding",s),p("__values",S),p("__read",T),p("__spread",$),p("__spreadArrays",C),p("__await",P),p("__asyncGenerator",z),p("__asyncDelegator",B),p("__asyncValues",G),p("__makeTemplateObject",m),p("__importStar",I),p("__importDefault",b),p("__classPrivateFieldGet",w),p("__classPrivateFieldSet",D)})})(Aa);var Nt={},Us;function Jd(){if(Us)return Nt;Us=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowserCryptoAvailable=Nt.getSubtleCrypto=Nt.getBrowerCrypto=void 0;function t(){return(Ae===null||Ae===void 0?void 0:Ae.crypto)||(Ae===null||Ae===void 0?void 0:Ae.msCrypto)||{}}Nt.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Nt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Nt.isBrowserCryptoAvailable=r,Nt}var Ct={},js;function Xd(){if(js)return Ct;js=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.isBrowser=Ct.isNode=Ct.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ct.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ct.isNode=e;function r(){return!t()&&!e()}return Ct.isBrowser=r,Ct}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Aa.exports;e.__exportStar(Jd(),t),e.__exportStar(Xd(),t)})(Ta);function Zd(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function yn(t,e,r){return{id:r||Zd(),jsonrpc:"2.0",method:t,params:e}}function mi(t,e){return{id:t,jsonrpc:"2.0",result:e}}function _n(t,e,r){return{id:t,jsonrpc:"2.0",error:Qd(e,r)}}function Qd(t,e){return typeof t>"u"?Ls(Ia):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ls(bi)),{message:t})),typeof e<"u"&&(t.data=e),kd(t.code)&&(t=Yd(t.code)),t)}class ep{}class tp extends ep{constructor(){super()}}class rp extends tp{constructor(e){super()}}const np="^https?:",ip="^wss?:";function sp(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Na(t,e){const r=sp(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Ms(t){return Na(t,np)}function $s(t){return Na(t,ip)}function op(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Ca(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function vi(t){return Ca(t)&&"method"in t}function wi(t){return Ca(t)&&(Rt(t)||Et(t))}function Rt(t){return"result"in t}function Et(t){return"error"in t}class Mr extends rp{constructor(e){super(e),this.events=new ot.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(yn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(u){i(u)}this.events.on(`${e.id}`,u=>{Et(u)?i(u.error):n(u.result)});try{await this.connection.send(e,r)}catch(u){i(u)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),wi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}function ap(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function cp(t){return typeof t=="string"?t:JSON.stringify(t)}const Bs=10,up=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),hp=()=>typeof window<"u",fp=up();class lp{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.registering=!1,!$s(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(cp(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!$s(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),i(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Ta.isReactNative()?void 0:{rejectUnauthorized:!op(e)},u=new fp(e,[],i);hp()?u.onerror=g=>{const d=g;n(this.emitError(d.error))}:u.on("error",g=>{n(this.emitError(g))}),u.onopen=()=>{this.onOpen(u),r(u)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ap(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),u=_n(e,i);this.events.emit("payload",u)}parseError(e,r=this.url){return Pa(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Bs&&this.events.setMaxListeners(Bs)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var ei={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,u=2,g=9007199254740991,d="[object Arguments]",y="[object Array]",E="[object AsyncFunction]",S="[object Boolean]",T="[object Date]",$="[object Error]",C="[object Function]",P="[object GeneratorFunction]",z="[object Map]",B="[object Number]",G="[object Null]",m="[object Object]",I="[object Promise]",b="[object Proxy]",w="[object RegExp]",D="[object Set]",s="[object String]",p="[object Symbol]",H="[object Undefined]",o="[object WeakMap]",f="[object ArrayBuffer]",l="[object DataView]",_="[object Float32Array]",c="[object Float64Array]",a="[object Int8Array]",O="[object Int16Array]",A="[object Int32Array]",L="[object Uint8Array]",v="[object Uint8ClampedArray]",U="[object Uint16Array]",K="[object Uint32Array]",q=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[_]=Y[c]=Y[a]=Y[O]=Y[A]=Y[L]=Y[v]=Y[U]=Y[K]=!0,Y[d]=Y[y]=Y[f]=Y[S]=Y[l]=Y[T]=Y[$]=Y[C]=Y[z]=Y[B]=Y[m]=Y[w]=Y[D]=Y[s]=Y[o]=!1;var ae=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,M=typeof self=="object"&&self&&self.Object===Object&&self,j=ae||M||Function("return this")(),R=e&&!e.nodeType&&e,h=R&&!0&&t&&!t.nodeType&&t,N=h&&h.exports===R,k=N&&ae.process,X=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),fe=X&&X.isTypedArray;function _e(x,F){for(var W=-1,Z=x==null?0:x.length,Pe=0,ie=[];++W<Z;){var Le=x[W];F(Le,W,x)&&(ie[Pe++]=Le)}return ie}function de(x,F){for(var W=-1,Z=F.length,Pe=x.length;++W<Z;)x[Pe+W]=F[W];return x}function ve(x,F){for(var W=-1,Z=x==null?0:x.length;++W<Z;)if(F(x[W],W,x))return!0;return!1}function Ue(x,F){for(var W=-1,Z=Array(x);++W<x;)Z[W]=F(W);return Z}function Ce(x){return function(F){return x(F)}}function ye(x,F){return x.has(F)}function pe(x,F){return x?.[F]}function le(x){var F=-1,W=Array(x.size);return x.forEach(function(Z,Pe){W[++F]=[Pe,Z]}),W}function ue(x,F){return function(W){return x(F(W))}}function ce(x){var F=-1,W=Array(x.size);return x.forEach(function(Z){W[++F]=Z}),W}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,he=j["__core-js_shared__"],ge=se.toString,re=te.hasOwnProperty,be=function(){var x=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),me=te.toString,Ee=RegExp("^"+ge.call(re).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=N?j.Buffer:void 0,we=j.Symbol,vt=j.Uint8Array,Dt=te.propertyIsEnumerable,Ft=oe.splice,dt=we?we.toStringTag:void 0,qt=Object.getOwnPropertySymbols,fr=De?De.isBuffer:void 0,Hr=ue(Object.keys,Object),Me=rr(j,"DataView"),Re=rr(j,"Map"),$e=rr(j,"Promise"),Be=rr(j,"Set"),He=rr(j,"WeakMap"),Fe=rr(Object,"create"),Ke=Vt(Me),Ve=Vt(Re),Ge=Vt($e),We=Vt(Be),ke=Vt(He),qe=we?we.prototype:void 0,ze=qe?qe.valueOf:void 0;function Te(x){var F=-1,W=x==null?0:x.length;for(this.clear();++F<W;){var Z=x[F];this.set(Z[0],Z[1])}}function Ye(){this.__data__=Fe?Fe(null):{},this.size=0}function Je(x){var F=this.has(x)&&delete this.__data__[x];return this.size-=F?1:0,F}function Ya(x){var F=this.__data__;if(Fe){var W=F[x];return W===n?void 0:W}return re.call(F,x)?F[x]:void 0}function Ja(x){var F=this.__data__;return Fe?F[x]!==void 0:re.call(F,x)}function Xa(x,F){var W=this.__data__;return this.size+=this.has(x)?0:1,W[x]=Fe&&F===void 0?n:F,this}Te.prototype.clear=Ye,Te.prototype.delete=Je,Te.prototype.get=Ya,Te.prototype.has=Ja,Te.prototype.set=Xa;function Tt(x){var F=-1,W=x==null?0:x.length;for(this.clear();++F<W;){var Z=x[F];this.set(Z[0],Z[1])}}function Za(){this.__data__=[],this.size=0}function Qa(x){var F=this.__data__,W=qr(F,x);if(W<0)return!1;var Z=F.length-1;return W==Z?F.pop():Ft.call(F,W,1),--this.size,!0}function ec(x){var F=this.__data__,W=qr(F,x);return W<0?void 0:F[W][1]}function tc(x){return qr(this.__data__,x)>-1}function rc(x,F){var W=this.__data__,Z=qr(W,x);return Z<0?(++this.size,W.push([x,F])):W[Z][1]=F,this}Tt.prototype.clear=Za,Tt.prototype.delete=Qa,Tt.prototype.get=ec,Tt.prototype.has=tc,Tt.prototype.set=rc;function Kt(x){var F=-1,W=x==null?0:x.length;for(this.clear();++F<W;){var Z=x[F];this.set(Z[0],Z[1])}}function nc(){this.size=0,this.__data__={hash:new Te,map:new(Re||Tt),string:new Te}}function ic(x){var F=Kr(this,x).delete(x);return this.size-=F?1:0,F}function sc(x){return Kr(this,x).get(x)}function oc(x){return Kr(this,x).has(x)}function ac(x,F){var W=Kr(this,x),Z=W.size;return W.set(x,F),this.size+=W.size==Z?0:1,this}Kt.prototype.clear=nc,Kt.prototype.delete=ic,Kt.prototype.get=sc,Kt.prototype.has=oc,Kt.prototype.set=ac;function zr(x){var F=-1,W=x==null?0:x.length;for(this.__data__=new Kt;++F<W;)this.add(x[F])}function cc(x){return this.__data__.set(x,n),this}function uc(x){return this.__data__.has(x)}zr.prototype.add=zr.prototype.push=cc,zr.prototype.has=uc;function Lt(x){var F=this.__data__=new Tt(x);this.size=F.size}function hc(){this.__data__=new Tt,this.size=0}function fc(x){var F=this.__data__,W=F.delete(x);return this.size=F.size,W}function lc(x){return this.__data__.get(x)}function dc(x){return this.__data__.has(x)}function pc(x,F){var W=this.__data__;if(W instanceof Tt){var Z=W.__data__;if(!Re||Z.length<r-1)return Z.push([x,F]),this.size=++W.size,this;W=this.__data__=new Kt(Z)}return W.set(x,F),this.size=W.size,this}Lt.prototype.clear=hc,Lt.prototype.delete=fc,Lt.prototype.get=lc,Lt.prototype.has=dc,Lt.prototype.set=pc;function gc(x,F){var W=Vr(x),Z=!W&&Ac(x),Pe=!W&&!Z&&En(x),ie=!W&&!Z&&!Pe&&Ui(x),Le=W||Z||Pe||ie,Xe=Le?Ue(x.length,String):[],et=Xe.length;for(var Ne in x)(F||re.call(x,Ne))&&!(Le&&(Ne=="length"||Pe&&(Ne=="offset"||Ne=="parent")||ie&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||Oc(Ne,et)))&&Xe.push(Ne);return Xe}function qr(x,F){for(var W=x.length;W--;)if(Ci(x[W][0],F))return W;return-1}function yc(x,F,W){var Z=F(x);return Vr(x)?Z:de(Z,W(x))}function lr(x){return x==null?x===void 0?H:G:dt&&dt in Object(x)?Dc(x):Tc(x)}function Pi(x){return dr(x)&&lr(x)==d}function Ti(x,F,W,Z,Pe){return x===F?!0:x==null||F==null||!dr(x)&&!dr(F)?x!==x&&F!==F:_c(x,F,W,Z,Ti,Pe)}function _c(x,F,W,Z,Pe,ie){var Le=Vr(x),Xe=Vr(F),et=Le?y:Ut(x),Ne=Xe?y:Ut(F);et=et==d?m:et,Ne=Ne==d?m:Ne;var pt=et==m,wt=Ne==m,it=et==Ne;if(it&&En(x)){if(!En(F))return!1;Le=!0,pt=!1}if(it&&!pt)return ie||(ie=new Lt),Le||Ui(x)?Ai(x,F,W,Z,Pe,ie):wc(x,F,et,W,Z,Pe,ie);if(!(W&i)){var yt=pt&&re.call(x,"__wrapped__"),_t=wt&&re.call(F,"__wrapped__");if(yt||_t){var jt=yt?x.value():x,At=_t?F.value():F;return ie||(ie=new Lt),Pe(jt,At,W,Z,ie)}}return it?(ie||(ie=new Lt),Ec(x,F,W,Z,Pe,ie)):!1}function bc(x){if(!Li(x)||xc(x))return!1;var F=Ri(x)?Ee:V;return F.test(Vt(x))}function mc(x){return dr(x)&&Fi(x.length)&&!!Y[lr(x)]}function vc(x){if(!Pc(x))return Hr(x);var F=[];for(var W in Object(x))re.call(x,W)&&W!="constructor"&&F.push(W);return F}function Ai(x,F,W,Z,Pe,ie){var Le=W&i,Xe=x.length,et=F.length;if(Xe!=et&&!(Le&&et>Xe))return!1;var Ne=ie.get(x);if(Ne&&ie.get(F))return Ne==F;var pt=-1,wt=!0,it=W&u?new zr:void 0;for(ie.set(x,F),ie.set(F,x);++pt<Xe;){var yt=x[pt],_t=F[pt];if(Z)var jt=Le?Z(_t,yt,pt,F,x,ie):Z(yt,_t,pt,x,F,ie);if(jt!==void 0){if(jt)continue;wt=!1;break}if(it){if(!ve(F,function(At,Gt){if(!ye(it,Gt)&&(yt===At||Pe(yt,At,W,Z,ie)))return it.push(Gt)})){wt=!1;break}}else if(!(yt===_t||Pe(yt,_t,W,Z,ie))){wt=!1;break}}return ie.delete(x),ie.delete(F),wt}function wc(x,F,W,Z,Pe,ie,Le){switch(W){case l:if(x.byteLength!=F.byteLength||x.byteOffset!=F.byteOffset)return!1;x=x.buffer,F=F.buffer;case f:return!(x.byteLength!=F.byteLength||!ie(new vt(x),new vt(F)));case S:case T:case B:return Ci(+x,+F);case $:return x.name==F.name&&x.message==F.message;case w:case s:return x==F+"";case z:var Xe=le;case D:var et=Z&i;if(Xe||(Xe=ce),x.size!=F.size&&!et)return!1;var Ne=Le.get(x);if(Ne)return Ne==F;Z|=u,Le.set(x,F);var pt=Ai(Xe(x),Xe(F),Z,Pe,ie,Le);return Le.delete(x),pt;case p:if(ze)return ze.call(x)==ze.call(F)}return!1}function Ec(x,F,W,Z,Pe,ie){var Le=W&i,Xe=Ni(x),et=Xe.length,Ne=Ni(F),pt=Ne.length;if(et!=pt&&!Le)return!1;for(var wt=et;wt--;){var it=Xe[wt];if(!(Le?it in F:re.call(F,it)))return!1}var yt=ie.get(x);if(yt&&ie.get(F))return yt==F;var _t=!0;ie.set(x,F),ie.set(F,x);for(var jt=Le;++wt<et;){it=Xe[wt];var At=x[it],Gt=F[it];if(Z)var ji=Le?Z(Gt,At,it,F,x,ie):Z(At,Gt,it,x,F,ie);if(!(ji===void 0?At===Gt||Pe(At,Gt,W,Z,ie):ji)){_t=!1;break}jt||(jt=it=="constructor")}if(_t&&!jt){var Gr=x.constructor,Wr=F.constructor;Gr!=Wr&&"constructor"in x&&"constructor"in F&&!(typeof Gr=="function"&&Gr instanceof Gr&&typeof Wr=="function"&&Wr instanceof Wr)&&(_t=!1)}return ie.delete(x),ie.delete(F),_t}function Ni(x){return yc(x,Rc,Sc)}function Kr(x,F){var W=x.__data__;return Ic(F)?W[typeof F=="string"?"string":"hash"]:W.map}function rr(x,F){var W=pe(x,F);return bc(W)?W:void 0}function Dc(x){var F=re.call(x,dt),W=x[dt];try{x[dt]=void 0;var Z=!0}catch{}var Pe=me.call(x);return Z&&(F?x[dt]=W:delete x[dt]),Pe}var Sc=qt?function(x){return x==null?[]:(x=Object(x),_e(qt(x),function(F){return Dt.call(x,F)}))}:Fc,Ut=lr;(Me&&Ut(new Me(new ArrayBuffer(1)))!=l||Re&&Ut(new Re)!=z||$e&&Ut($e.resolve())!=I||Be&&Ut(new Be)!=D||He&&Ut(new He)!=o)&&(Ut=function(x){var F=lr(x),W=F==m?x.constructor:void 0,Z=W?Vt(W):"";if(Z)switch(Z){case Ke:return l;case Ve:return z;case Ge:return I;case We:return D;case ke:return o}return F});function Oc(x,F){return F=F??g,!!F&&(typeof x=="number"||Q.test(x))&&x>-1&&x%1==0&&x<F}function Ic(x){var F=typeof x;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?x!=="__proto__":x===null}function xc(x){return!!be&&be in x}function Pc(x){var F=x&&x.constructor,W=typeof F=="function"&&F.prototype||te;return x===W}function Tc(x){return me.call(x)}function Vt(x){if(x!=null){try{return ge.call(x)}catch{}try{return x+""}catch{}}return""}function Ci(x,F){return x===F||x!==x&&F!==F}var Ac=Pi(function(){return arguments}())?Pi:function(x){return dr(x)&&re.call(x,"callee")&&!Dt.call(x,"callee")},Vr=Array.isArray;function Nc(x){return x!=null&&Fi(x.length)&&!Ri(x)}var En=fr||Lc;function Cc(x,F){return Ti(x,F)}function Ri(x){if(!Li(x))return!1;var F=lr(x);return F==C||F==P||F==E||F==b}function Fi(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=g}function Li(x){var F=typeof x;return x!=null&&(F=="object"||F=="function")}function dr(x){return x!=null&&typeof x=="object"}var Ui=fe?Ce(fe):mc;function Rc(x){return Nc(x)?gc(x):vc(x)}function Fc(){return[]}function Lc(){return!1}t.exports=Cc})(ei,ei.exports);const dp=ei.exports;function pp(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var u=t.charAt(i),g=u.charCodeAt(0);if(r[g]!==255)throw new TypeError(u+" is ambiguous");r[g]=i}var d=t.length,y=t.charAt(0),E=Math.log(d)/Math.log(256),S=Math.log(256)/Math.log(d);function T(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var z=0,B=0,G=0,m=P.length;G!==m&&P[G]===0;)G++,z++;for(var I=(m-G)*S+1>>>0,b=new Uint8Array(I);G!==m;){for(var w=P[G],D=0,s=I-1;(w!==0||D<B)&&s!==-1;s--,D++)w+=256*b[s]>>>0,b[s]=w%d>>>0,w=w/d>>>0;if(w!==0)throw new Error("Non-zero carry");B=D,G++}for(var p=I-B;p!==I&&b[p]===0;)p++;for(var H=y.repeat(z);p<I;++p)H+=t.charAt(b[p]);return H}function $(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var z=0;if(P[z]!==" "){for(var B=0,G=0;P[z]===y;)B++,z++;for(var m=(P.length-z)*E+1>>>0,I=new Uint8Array(m);P[z];){var b=r[P.charCodeAt(z)];if(b===255)return;for(var w=0,D=m-1;(b!==0||w<G)&&D!==-1;D--,w++)b+=d*I[D]>>>0,I[D]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");G=w,z++}if(P[z]!==" "){for(var s=m-G;s!==m&&I[s]===0;)s++;for(var p=new Uint8Array(B+(m-s)),H=B;s!==m;)p[H++]=I[s++];return p}}}function C(P){var z=$(P);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:$,decode:C}}var gp=pp,yp=gp;const Ra=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_p=t=>new TextEncoder().encode(t),bp=t=>new TextDecoder().decode(t);class mp{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vp{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Fa(this,e)}}class wp{constructor(e){this.decoders=e}or(e){return Fa(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Fa=(t,e)=>new wp({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Ep{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new mp(e,r,n),this.decoder=new vp(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bn=({name:t,prefix:e,encode:r,decode:n})=>new Ep(t,e,r,n),$r=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=yp(r,e);return bn({prefix:t,name:e,encode:n,decode:u=>Ra(i(u))})},Dp=(t,e,r,n)=>{const i={};for(let S=0;S<e.length;++S)i[e[S]]=S;let u=t.length;for(;t[u-1]==="=";)--u;const g=new Uint8Array(u*r/8|0);let d=0,y=0,E=0;for(let S=0;S<u;++S){const T=i[t[S]];if(T===void 0)throw new SyntaxError(`Non-${n} character`);y=y<<r|T,d+=r,d>=8&&(d-=8,g[E++]=255&y>>d)}if(d>=r||255&y<<8-d)throw new SyntaxError("Unexpected end of data");return g},Sp=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let u="",g=0,d=0;for(let y=0;y<t.length;++y)for(d=d<<8|t[y],g+=8;g>r;)g-=r,u+=e[i&d>>g];if(g&&(u+=e[i&d<<r-g]),n)for(;u.length*r&7;)u+="=";return u},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>bn({prefix:e,name:t,encode(i){return Sp(i,n,r)},decode(i){return Dp(i,n,r,t)}}),Op=bn({prefix:"\0",name:"identity",encode:t=>bp(t),decode:t=>_p(t)});var Ip=Object.freeze({__proto__:null,identity:Op});const xp=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pp=Object.freeze({__proto__:null,base2:xp});const Tp=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ap=Object.freeze({__proto__:null,base8:Tp});const Np=$r({prefix:"9",name:"base10",alphabet:"0123456789"});var Cp=Object.freeze({__proto__:null,base10:Np});const Rp=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Fp=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Lp=Object.freeze({__proto__:null,base16:Rp,base16upper:Fp});const Up=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jp=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mp=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$p=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Bp=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hp=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zp=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qp=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Kp=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Vp=Object.freeze({__proto__:null,base32:Up,base32upper:jp,base32pad:Mp,base32padupper:$p,base32hex:Bp,base32hexupper:Hp,base32hexpad:zp,base32hexpadupper:qp,base32z:Kp});const Gp=$r({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wp=$r({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var kp=Object.freeze({__proto__:null,base36:Gp,base36upper:Wp});const Yp=$r({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Jp=$r({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xp=Object.freeze({__proto__:null,base58btc:Yp,base58flickr:Jp});const Zp=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qp=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eg=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tg=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var rg=Object.freeze({__proto__:null,base64:Zp,base64pad:Qp,base64url:eg,base64urlpad:tg});const La=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ng=La.reduce((t,e,r)=>(t[r]=e,t),[]),ig=La.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function sg(t){return t.reduce((e,r)=>(e+=ng[r],e),"")}function og(t){const e=[];for(const r of t){const n=ig[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const ag=bn({prefix:"\u{1F680}",name:"base256emoji",encode:sg,decode:og});var cg=Object.freeze({__proto__:null,base256emoji:ag}),ug=Ua,Hs=128,hg=127,fg=~hg,lg=Math.pow(2,31);function Ua(t,e,r){e=e||[],r=r||0;for(var n=r;t>=lg;)e[r++]=t&255|Hs,t/=128;for(;t&fg;)e[r++]=t&255|Hs,t>>>=7;return e[r]=t|0,Ua.bytes=r-n+1,e}var dg=ti,pg=128,zs=127;function ti(t,n){var r=0,n=n||0,i=0,u=n,g,d=t.length;do{if(u>=d)throw ti.bytes=0,new RangeError("Could not decode varint");g=t[u++],r+=i<28?(g&zs)<<i:(g&zs)*Math.pow(2,i),i+=7}while(g>=pg);return ti.bytes=u-n,r}var gg=Math.pow(2,7),yg=Math.pow(2,14),_g=Math.pow(2,21),bg=Math.pow(2,28),mg=Math.pow(2,35),vg=Math.pow(2,42),wg=Math.pow(2,49),Eg=Math.pow(2,56),Dg=Math.pow(2,63),Sg=function(t){return t<gg?1:t<yg?2:t<_g?3:t<bg?4:t<mg?5:t<vg?6:t<wg?7:t<Eg?8:t<Dg?9:10},Og={encode:ug,decode:dg,encodingLength:Sg},ja=Og;const qs=(t,e,r=0)=>(ja.encode(t,e,r),e),Ks=t=>ja.encodingLength(t),ri=(t,e)=>{const r=e.byteLength,n=Ks(t),i=n+Ks(r),u=new Uint8Array(i+r);return qs(t,u,0),qs(r,u,n),u.set(e,i),new Ig(t,r,e,u)};class Ig{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Ma=({name:t,code:e,encode:r})=>new xg(t,e,r);class xg{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ri(this.code,r):r.then(n=>ri(this.code,n))}else throw Error("Unknown type, must be binary type")}}const $a=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pg=Ma({name:"sha2-256",code:18,encode:$a("SHA-256")}),Tg=Ma({name:"sha2-512",code:19,encode:$a("SHA-512")});var Ag=Object.freeze({__proto__:null,sha256:Pg,sha512:Tg});const Ba=0,Ng="identity",Ha=Ra,Cg=t=>ri(Ba,Ha(t)),Rg={code:Ba,name:Ng,encode:Ha,digest:Cg};var Fg=Object.freeze({__proto__:null,identity:Rg});new TextEncoder,new TextDecoder;const Vs={...Ip,...Pp,...Ap,...Cp,...Lp,...Vp,...kp,...Xp,...rg,...cg};({...Ag,...Fg});function Lg(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function za(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Gs=za("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Rn=za("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Lg(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ug={utf8:Gs,"utf-8":Gs,hex:Vs.base16,latin1:Rn,ascii:Rn,binary:Rn,...Vs};function jg(t,e="utf8"){const r=Ug[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const qa="wc",Mg=2,Ei="core",Bt=`${qa}@${2}:${Ei}:`,$g={name:Ei,logger:"error"},Bg={database:":memory:"},Hg="crypto",Ws="client_ed25519_seed",zg=ee.ONE_DAY,qg="keychain",Kg="0.3",Vg="messages",Gg="0.3",Wg=ee.SIX_HOURS,kg="publisher",Ka="irn",Yg="error",Va="wss://relay.walletconnect.com",Jg="relayer",tt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Xg="_subscription",Yr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ks=ee.ONE_SECOND,Zg="2.4.5",Qg="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ey="subscription",ty="0.3",ry=ee.FIVE_SECONDS*1e3,ny="pairing",iy="0.3",wr={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},Ot={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},sy="history",oy="0.3",ay="expirer",mt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},cy="0.3";class uy{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=qg,this.version=Kg,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:u}=J("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(u)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ma(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?va(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class hy{constructor(e,r,n){this.core=e,this.logger=r,this.name=Hg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),u=ys(i);return ta(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=jl();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const u=await this.getClientSeed(),g=ys(u),d=Xn();return await Yf(d,i,zg,g)},this.generateSharedKey=(i,u,g)=>{this.isInitialized();const d=this.getPrivateKey(i),y=Ml(d,u);return this.setSymKey(y,g)},this.setSymKey=async(i,u)=>{this.isInitialized();const g=u||$l(i);return await this.keychain.set(g,i),g},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,u,g)=>{this.isInitialized();const d=_a(g),y=$u(u);if(xs(d)){const $=d.senderPublicKey,C=d.receiverPublicKey;i=await this.generateSharedKey($,C)}const E=this.getSymKey(i),{type:S,senderPublicKey:T}=d;return Hl({type:S,symKey:E,message:y,senderPublicKey:T})},this.decode=async(i,u,g)=>{this.isInitialized();const d=Kl(u,g);if(xs(d)){const S=d.receiverPublicKey,T=d.senderPublicKey;i=await this.generateSharedKey(S,T)}const y=this.getSymKey(i),E=zl({symKey:y,encoded:u});return Mu(E)},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=n||new uy(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const r=gi(e);return Ur(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ws)}catch{e=Xn(),await this.keychain.set(Ws,e)}return jg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fy extends Au{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Vg,this.version=Gg,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const u=sn(i);let g=this.messages.get(n);return typeof g>"u"&&(g={}),typeof g[u]<"u"||(g[u]=i,this.messages.set(n,g),await this.persist()),u},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const u=this.get(n),g=sn(i);return typeof u[g]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ma(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?va(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ly extends Nu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ot.exports.EventEmitter,this.name=kg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,u)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:u}});try{const g=u?.ttl||Wg,d=Zn(u),y=u?.prompt||!1,E=u?.tag||0,S={topic:n,message:i,opts:{ttl:g,relay:d,prompt:y,tag:E}},T=sn(i);this.queue.set(T,S);try{await await wa(this.rpcPublish(n,i,g,d,y,E),this.publishTimeout),this.relayer.events.emit(tt.publish,S)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(tt.connection_stalled);return}this.onPublish(T,S),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,u,g){var d,y,E,S;const T={method:Qn(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:u,tag:g}};return ct((d=T.params)==null?void 0:d.prompt)&&((y=T.params)==null||delete y.prompt),ct((E=T.params)==null?void 0:E.tag)&&((S=T.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:T}),this.relayer.provider.request(T)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class dy{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(u=>u!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var py=Object.defineProperty,gy=Object.defineProperties,yy=Object.getOwnPropertyDescriptors,Ys=Object.getOwnPropertySymbols,_y=Object.prototype.hasOwnProperty,by=Object.prototype.propertyIsEnumerable,Js=(t,e,r)=>e in t?py(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jr=(t,e)=>{for(var r in e||(e={}))_y.call(e,r)&&Js(t,r,e[r]);if(Ys)for(var r of Ys(e))by.call(e,r)&&Js(t,r,e[r]);return t},Fn=(t,e)=>gy(t,yy(e));class my extends Fu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new dy,this.events=new ot.exports.EventEmitter,this.name=ey,this.version=ty,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Bt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const u=Zn(i),g={topic:n,relay:u};this.pending.set(n,g);const d=await this.rpcSubscribe(n,u);return this.onSubscribe(d,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),d}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,u)=>{const g=new ee.Watch;g.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(d),g.stop(this.pendingSubscriptionWatchLabel),i(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=ry&&(clearInterval(d),g.stop(this.pendingSubscriptionWatchLabel),u(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Zn(n);await this.rpcUnsubscribe(e,r,i);const u=Ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Qn(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await wa(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tt.connection_stalled)}return sn(e+this.clientId)}rpcUnsubscribe(e,r,n){const i={method:Qn(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,Fn(Jr({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Fn(Jr({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Jr({},r)),this.topicMap.set(r.topic,e),this.events.emit(It.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(It.deleted,Fn(Jr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:n}=e,i={topic:r,relay:n};this.pending.set(i.topic,i);const u=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(u,i)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(tt.connect,async()=>{await this.onConnect()}),this.relayer.on(tt.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var vy=Object.defineProperty,Xs=Object.getOwnPropertySymbols,wy=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable,Zs=(t,e,r)=>e in t?vy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dy=(t,e)=>{for(var r in e||(e={}))wy.call(e,r)&&Zs(t,r,e[r]);if(Xs)for(var r of Xs(e))Ey.call(e,r)&&Zs(t,r,e[r]);return t};class Sy extends Cu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ot.exports.EventEmitter,this.name=Jg,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Tr(Se.getDefaultLoggerOptions({level:e.logger||Yg})),this.messages=new fy(this.logger,e.core),this.subscriber=new my(this,this.logger),this.publisher=new ly(this,this.logger),this.relayUrl=e?.relayUrl||Va,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(It.created,u=>{u.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(tt.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(It.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(tt.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(tt.transport_closed,this.rejectTransportOpen))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw r;this.logger.error(r),this.events.emit(tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,ks)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Mr(new lp(id({sdkVersion:Zg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),vi(e)){if(!e.method.endsWith(Xg))return;const r=e.params,{topic:n,message:i}=r.data,u={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Dy({type:"event",event:r.id},u)),this.events.emit(r.id,u),await this.acknowledgePayload(e),await this.onMessageEvent(u)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=mi(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Yr.payload,e=>this.onProviderPayload(e)),this.provider.on(Yr.connect,()=>{this.events.emit(tt.connect)}),this.provider.on(Yr.disconnect,()=>{this.events.emit(tt.disconnect),this.attemptToReconnect()}),this.provider.on(Yr.error,e=>this.events.emit(tt.error,e)),this.events.on(tt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},ee.toMiliseconds(ks))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Oy=Object.defineProperty,Qs=Object.getOwnPropertySymbols,Iy=Object.prototype.hasOwnProperty,xy=Object.prototype.propertyIsEnumerable,eo=(t,e,r)=>e in t?Oy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,to=(t,e)=>{for(var r in e||(e={}))Iy.call(e,r)&&eo(t,r,e[r]);if(Qs)for(var r of Qs(e))xy.call(e,r)&&eo(t,r,e[r]);return t};class mn extends Ru{constructor(e,r,n,i=Bt,u=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=Qg,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{Od(g)?this.map.set(g.id,g):Id(g)?this.map.set(g.topic,g):this.getKey&&g!==null&&!ct(g)&&this.map.set(this.getKey(g),g)}),this.cached=[],this.initialized=!0)},this.set=async(g,d)=>{this.isInitialized(),this.map.has(g)?await this.update(g,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:d}),this.map.set(g,d),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(d=>Object.keys(g).every(y=>dp(d[y],g[y]))):this.values),this.update=async(g,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:d});const y=to(to({},this.getData(g)),d);this.map.set(g,y),await this.persist()},this.delete=async(g,d)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:d}),this.map.delete(g),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=u}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Py{constructor(e,r){this.core=e,this.logger=r,this.name=ny,this.version=iy,this.events=new ot.exports,this.initialized=!1,this.storagePrefix=Bt,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Xn(),i=await this.core.crypto.setSymKey(n),u=xt(ee.FIVE_MINUTES),g={protocol:Ka},d={topic:i,expiry:u,relay:g,active:!1},y=gd({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:g});return await this.pairings.set(i,d),await this.core.relayer.subscribe(i),this.core.expirer.set(i,u),{topic:i,uri:y}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:u,relay:g}=dd(n.uri),d=xt(ee.FIVE_MINUTES),y={topic:i,relay:g,expiry:d,active:!1};return await this.pairings.set(i,y),await this.core.crypto.setSymKey(u,i),await this.core.relayer.subscribe(i,{relay:g}),this.core.expirer.set(i,d),n.activatePairing&&await this.activate({topic:i}),y},this.activate=async({topic:n})=>{this.isInitialized();const i=xt(ee.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const u=await this.sendRequest(i,"wc_pairingPing",{}),{done:g,resolve:d,reject:y}=Xt();this.events.once(je("pairing_ping",u),({error:E})=>{E?y(E):d()}),await g()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ze("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,u)=>{const g=yn(i,u),d=await this.core.crypto.encode(n,g),y=wr[i].req;return this.core.history.set(n,g),await this.core.relayer.publish(n,d,y),g.id},this.sendResult=async(n,i,u)=>{const g=mi(n,u),d=await this.core.crypto.encode(i,g),y=await this.core.history.get(i,n),E=wr[y.request.method].res;await this.core.relayer.publish(i,d,E),await this.core.history.resolve(g)},this.sendError=async(n,i,u)=>{const g=_n(n,u),d=await this.core.crypto.encode(i,g),y=await this.core.history.get(i,n),E=wr[y.request.method]?wr[y.request.method].res:wr.unregistered_method.res;await this.core.relayer.publish(i,d,E),await this.core.history.resolve(g)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>Mt(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:u}=n,g=u.method;if(this.pairings.keys.includes(i))switch(g){case"wc_pairingPing":return this.onPairingPingRequest(i,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,u);default:return this.onUnknownRpcMethodRequest(i,u)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:u}=n,g=(await this.core.history.get(i,u.id)).request.method;if(this.pairings.keys.includes(i))switch(g){case"wc_pairingPing":return this.onPairingPingResponse(i,u);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(n,i)=>{const{id:u}=i;try{this.isValidPing({topic:n}),await this.sendResult(u,n,!0),this.events.emit("pairing_ping",{id:u,topic:n})}catch(g){await this.sendError(u,n,g),this.logger.error(g)}},this.onPairingPingResponse=(n,i)=>{const{id:u}=i;setTimeout(()=>{Rt(i)?this.events.emit(je("pairing_ping",u),{}):Et(i)&&this.events.emit(je("pairing_ping",u),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:u}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:u,topic:n})}catch(g){await this.sendError(u,n,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:u,method:g}=i;try{if(this.registeredMethods.includes(g))return;const d=Ze("WC_METHOD_UNSUPPORTED",g);await this.sendError(u,n,d),this.logger.error(d)}catch(d){await this.sendError(u,n,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ut(n)){const{message:i}=J("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!Sd(n.uri)){const{message:i}=J("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!ut(n)){const{message:u}=J("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(u)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!ut(n)){const{message:u}=J("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(u)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!Qe(n,!1)){const{message:i}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Mt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=J("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new mn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);vi(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):wi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(mt.expired,async e=>{const{topic:r}=Da(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Ty extends Tu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ot.exports.EventEmitter,this.name=sy,this.version=oy,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:u}),this.records.has(i.id))return;const g={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:u};this.records.set(g.id,g),this.events.emit(Ot.created,g)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Et(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Ot.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(u=>{if(u.topic===n){if(typeof i<"u"&&u.id!==i)return;this.records.delete(u.id),this.events.emit(Ot.deleted,u)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:yn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ot.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ot.created,e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.updated,e=>{const r=Ot.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.deleted,e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ay extends Lu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ot.exports.EventEmitter,this.name=ay,this.version=cy,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const u=this.formatTarget(n),g={target:u,expiry:i};this.expirations.set(u,g),this.checkExpiry(u,g),this.events.emit(mt.created,{target:u,expiration:g})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),u=this.getExpiration(i);this.expirations.delete(i),this.events.emit(mt.deleted,{target:i,expiration:u})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return sd(e);if(typeof e=="number")return od(e);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(mt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;ee.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(mt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Nr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(mt.created,e=>{const r=mt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(mt.expired,e=>{const r=mt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(mt.deleted,e=>{const r=mt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ny=Object.defineProperty,ro=Object.getOwnPropertySymbols,Cy=Object.prototype.hasOwnProperty,Ry=Object.prototype.propertyIsEnumerable,no=(t,e,r)=>e in t?Ny(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,io=(t,e)=>{for(var r in e||(e={}))Cy.call(e,r)&&no(t,r,e[r]);if(ro)for(var r of ro(e))Ry.call(e,r)&&no(t,r,e[r]);return t};class Di extends Pu{constructor(e){super(e),this.protocol=qa,this.version=Mg,this.name=Ei,this.events=new ot.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Va;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||$g.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Nr.HeartBeat,this.crypto=new hy(this,this.logger,e?.keychain),this.history=new Ty(this,this.logger),this.expirer=new Ay(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new du(io(io({},Bg),e?.storageOptions)),this.relayer=new Sy({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Py(this,this.logger)}static async init(e){const r=new Di(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Fy=Di,Ga="wc",Wa=2,ka="client",Si=`${Ga}@${Wa}:${ka}:`,Ln={name:ka,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ly="proposal",Uy="session",Xr=ee.SEVEN_DAYS,jy="engine",Er={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Un={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},My="request";var $y=Object.defineProperty,By=Object.defineProperties,Hy=Object.getOwnPropertyDescriptors,so=Object.getOwnPropertySymbols,zy=Object.prototype.hasOwnProperty,qy=Object.prototype.propertyIsEnumerable,oo=(t,e,r)=>e in t?$y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e)=>{for(var r in e||(e={}))zy.call(e,r)&&oo(t,r,e[r]);if(so)for(var r of so(e))qy.call(e,r)&&oo(t,r,e[r]);return t},jn=(t,e)=>By(t,Hy(e));class Ky extends ju{constructor(e){super(e),this.name=jy,this.events=new ot.exports,this.initialized=!1,this.ignoredPayloadTypes=[er],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Er)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const n=jn(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:u,optionalNamespaces:g,sessionProperties:d,relays:y}=n;let E=i,S,T=!1;if(E&&(T=this.client.core.pairing.pairings.get(E).active),!E||!T){const{topic:I,uri:b}=await this.client.core.pairing.create();E=I,S=b}const $=await this.client.core.crypto.generateKeyPair(),C=bt({requiredNamespaces:u,optionalNamespaces:g,relays:y??[{protocol:Ka}],proposer:{publicKey:$,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:P,resolve:z,done:B}=Xt();if(this.events.once(je("session_connect"),async({error:I,session:b})=>{if(I)P(I);else if(b){b.self.publicKey=$;const w=jn(bt({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces});await this.client.session.set(b.topic,w),await this.setExpiry(b.topic,b.expiry),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:b.peer.metadata}),z(w)}}),!E){const{message:I}=J("NO_MATCHING_KEY",`connect() pairing topic: ${E}`);throw new Error(I)}const G=await this.sendRequest(E,"wc_sessionPropose",C),m=xt(ee.FIVE_MINUTES);return await this.setProposal(G,bt({id:G,expiry:m},C)),{uri:S,approval:B}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:u,sessionProperties:g}=r,d=this.client.proposal.get(n);let{pairingTopic:y,proposer:E,requiredNamespaces:S,optionalNamespaces:T}=d;Sr(S)||(S=md(u,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),C=E.publicKey,P=await this.client.core.crypto.generateSharedKey($,C);y&&n&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:E.metadata}),await this.sendResult(n,y,{relay:{protocol:i??"irn"},responderPublicKey:$}),await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const z=bt({relay:{protocol:i??"irn"},namespaces:u,requiredNamespaces:S,optionalNamespaces:T,controller:{publicKey:$,metadata:this.client.metadata},expiry:xt(Xr)},g&&{sessionProperties:g});await this.client.core.relayer.subscribe(P);const B=await this.sendRequest(P,"wc_sessionSettle",z),{done:G,resolve:m,reject:I}=Xt();this.events.once(je("session_approve",B),({error:w})=>{w?I(w):m(this.client.session.get(P))});const b=jn(bt({},z),{topic:P,acknowledged:!1,self:z.controller,peer:{publicKey:E.publicKey,metadata:E.metadata},controller:$});return await this.client.session.set(P,b),await this.setExpiry(P,xt(Xr)),{topic:P,acknowledged:G}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:u}=this.client.proposal.get(n);u&&(await this.sendError(n,u,i),await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,u=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:g,resolve:d,reject:y}=Xt();return this.events.once(je("session_update",u),({error:E})=>{E?y(E):d()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:g}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:u,resolve:g,reject:d}=Xt();return this.events.once(je("session_extend",i),({error:y})=>{y?d(y):g()}),await this.setExpiry(n,xt(Xr)),{acknowledged:u}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:u,expiry:g}=r,d=await this.sendRequest(u,"wc_sessionRequest",{request:i,chainId:n},g),{done:y,resolve:E,reject:S}=Xt(g);return this.events.once(je("session_request",d),({error:T,result:$})=>{T?S(T):E($)}),this.client.events.emit("session_request_sent",{topic:u,request:i,chainId:n}),await y()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:u}=i;Rt(i)?await this.sendResult(u,n,i.result):Et(i)&&await this.sendError(u,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:u,resolve:g,reject:d}=Xt();this.events.once(je("session_ping",i),({error:y})=>{y?d(y):g()}),await u()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:u}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:u})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ze("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>Ed(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ze("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Er.wc_sessionRequest.req.ttl,{id:i,topic:u,params:g}=r;await this.client.pendingRequest.set(i,{id:i,topic:u,params:g}),n&&this.client.core.expirer.set(i,xt(n))},this.sendRequest=async(r,n,i,u)=>{const g=yn(n,i),d=await this.client.core.crypto.encode(r,g),y=Er[n].req;return u&&(y.ttl=u),this.client.core.history.set(r,g),this.client.core.relayer.publish(r,d,y),g.id},this.sendResult=async(r,n,i)=>{const u=mi(r,i),g=await this.client.core.crypto.encode(n,u),d=await this.client.core.history.get(n,r),y=Er[d.request.method].res;this.client.core.relayer.publish(n,g,y),await this.client.core.history.resolve(u)},this.sendError=async(r,n,i)=>{const u=_n(r,i),g=await this.client.core.crypto.encode(n,u),d=await this.client.core.history.get(n,r),y=Er[d.request.method].res;this.client.core.relayer.publish(n,g,y),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{Mt(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Mt(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,u=i.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,u=(await this.client.core.history.get(n,i.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:u}=n;try{this.isValidConnect(bt({},n.params));const g=xt(ee.FIVE_MINUTES),d=bt({id:u,pairingTopic:r,expiry:g},i);await this.setProposal(u,d),this.client.events.emit("session_proposal",{id:u,params:d})}catch(g){await this.sendError(u,r,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Rt(n)){const{result:u}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const g=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const d=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const y=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const E=await this.client.core.crypto.generateSharedKey(d,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:E});const S=await this.client.core.relayer.subscribe(E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:r})}else Et(n)&&(await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),this.events.emit(je("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:u}=n;try{this.isValidSessionSettleRequest(u);const{relay:g,controller:d,expiry:y,namespaces:E,requiredNamespaces:S,optionalNamespaces:T,sessionProperties:$}=n.params,C=bt({topic:r,relay:g,expiry:y,namespaces:E,acknowledged:!0,requiredNamespaces:S,optionalNamespaces:T,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},$&&{sessionProperties:$});await this.sendResult(n.id,r,!0),this.events.emit(je("session_connect"),{session:C})}catch(g){await this.sendError(i,r,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Rt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(je("session_approve",i),{})):Et(n)&&(await this.client.session.delete(r,Ze("USER_DISCONNECTED")),this.events.emit(je("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:u}=n;try{this.isValidUpdate(bt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(u,r,!0),this.client.events.emit("session_update",{id:u,topic:r,params:i})}catch(g){await this.sendError(u,r,g),this.client.logger.error(g)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(je("session_update",i),{}):Et(n)&&this.events.emit(je("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(Xr)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(u){await this.sendError(i,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(je("session_extend",i),{}):Et(n)&&this.events.emit(je("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(u){await this.sendError(i,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Rt(n)?this.events.emit(je("session_ping",i),{}):Et(n)&&this.events.emit(je("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),this.client.core.relayer.once(tt.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(i,r,!0),this.client.events.emit("session_delete",{id:i,topic:r})}catch(u){await this.sendError(i,r,u),this.client.logger.error(u)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:u}=n;try{this.isValidRequest(bt({topic:r},u)),await this.setPendingSessionRequest({id:i,topic:r,params:u}),this.client.events.emit("session_request",{id:i,topic:r,params:u})}catch(g){await this.sendError(i,r,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(je("session_request",i),{result:n.result}):Et(n)&&this.events.emit(je("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:u}=n;try{this.isValidEmit(bt({topic:r},u)),this.client.events.emit("session_event",{id:i,topic:r,params:u})}catch(g){await this.sendError(i,r,g),this.client.logger.error(g)}},this.isValidConnect=async r=>{if(!ut(r)){const{message:y}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(y)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:u,sessionProperties:g,relays:d}=r;if(ct(n)||await this.isValidPairingTopic(n),!Fd(d,!0)){const{message:y}=J("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(y)}!ct(i)&&Sr(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!ct(u)&&Sr(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),ct(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(r,n)=>{const i=Rd(r,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async r=>{if(!ut(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:u,sessionProperties:g}=r;await this.isValidProposalId(n);const d=this.client.proposal.get(n),y=en(i,"approve()");if(y)throw new Error(y.message);const E=Cn(d.requiredNamespaces,i,"approve()","requiredNamespaces");if(E)throw new Error(E.message);if(!Qe(u,!0)){const{message:S}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(S)}if(Object.keys(i).length>Object.keys(d.requiredNamespaces).length){const S=Object.keys(d.optionalNamespaces).filter(C=>i[C]),T={};for(const C in d.optionalNamespaces)S.includes(C)&&(T[C]=d.optionalNamespaces[C]);const $=Cn(T,i,"approve()","optionalNamespaces");if($)throw new Error($.message)}ct(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async r=>{if(!ut(r)){const{message:u}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Ud(i)){const{message:u}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!ut(r)){const{message:E}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(E)}const{relay:n,controller:i,namespaces:u,expiry:g}=r;if(!Oa(n)){const{message:E}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(E)}const d=xd(i,"onSessionSettleRequest()");if(d)throw new Error(d.message);const y=en(u,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(Mt(g)){const{message:E}=J("EXPIRED","onSessionSettleRequest()");throw new Error(E)}},this.isValidUpdate=async r=>{if(!ut(r)){const{message:y}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(y)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const u=this.client.session.get(n),g=en(i,"update()");if(g)throw new Error(g.message);const d=Cn(u.requiredNamespaces,i,"update()","requiredNamespaces");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!ut(r)){const{message:i}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!ut(r)){const{message:y}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(y)}const{topic:n,request:i,chainId:u,expiry:g}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Fs(d,u)){const{message:y}=J("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(y)}if(!jd(i)){const{message:y}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(y)}if(!Bd(d,u,i.method)){const{message:y}=J("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(y)}if(g&&!zd(g,Un)){const{message:y}=J("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${Un.min} and ${Un.max}`);throw new Error(y)}},this.isValidRespond=async r=>{if(!ut(r)){const{message:u}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!Md(i)){const{message:u}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!ut(r)){const{message:i}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!ut(r)){const{message:d}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:n,event:i,chainId:u}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!Fs(g,u)){const{message:d}=J("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(d)}if(!$d(i)){const{message:d}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(d)}if(!Hd(g,u,i.name)){const{message:d}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!ut(r)){const{message:i}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(i=>{if(!Qe(i,!1)){const{message:u}=J("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(u)}})}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(tt.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);vi(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):wi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(mt.expired,async e=>{const{topic:r,id:n}=Da(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=J("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Ld(e)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=J("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Vy extends mn{constructor(e,r){super(e,r,Ly,Si),this.core=e,this.logger=r}}class Gy extends mn{constructor(e,r){super(e,r,Uy,Si),this.core=e,this.logger=r}}class Wy extends mn{constructor(e,r){super(e,r,My,Si),this.core=e,this.logger=r}}class Oi extends Uu{constructor(e){super(e),this.protocol=Ga,this.version=Wa,this.name=Ln.name,this.events=new ot.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||Ln.name,this.metadata=e?.metadata||ed();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||Ln.logger}));this.core=e?.core||new Fy(e),this.logger=Se.generateChildLogger(r,this.name),this.session=new Gy(this.core,this.logger),this.proposal=new Vy(this.core,this.logger),this.pendingRequest=new Wy(this.core,this.logger),this.engine=new Ky(this)}static async init(e){const r=new Oi(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=xe.getLocation=xe.getLocationOrThrow=xe.getNavigator=xe.getNavigatorOrThrow=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function tr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=tr;function hr(t){const e=tr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=hr;function ky(){return hr("document")}xe.getDocumentOrThrow=ky;function Yy(){return tr("document")}xe.getDocument=Yy;function Jy(){return hr("navigator")}xe.getNavigatorOrThrow=Jy;function Xy(){return tr("navigator")}xe.getNavigator=Xy;function Zy(){return hr("location")}xe.getLocationOrThrow=Zy;function Qy(){return tr("location")}xe.getLocation=Qy;function e0(){return hr("crypto")}xe.getCryptoOrThrow=e0;function t0(){return tr("crypto")}xe.getCrypto=t0;function r0(){return hr("localStorage")}xe.getLocalStorageOrThrow=r0;function n0(){return tr("localStorage")}xe.getLocalStorage=n0;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.getWindowMetadata=void 0;const ao=xe;function i0(){let t,e;try{t=ao.getDocumentOrThrow(),e=ao.getLocationOrThrow()}catch{return null}function r(){const T=t.getElementsByTagName("link"),$=[];for(let C=0;C<T.length;C++){const P=T[C],z=P.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const B=P.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let G=e.protocol+"//"+e.host;if(B.indexOf("/")===0)G+=B;else{const m=e.pathname.split("/");m.pop(),G+=m.join("/")+"/"+B}$.push(G)}else if(B.indexOf("//")===0){const G=e.protocol+B;$.push(G)}else $.push(B)}}return $}function n(...T){const $=t.getElementsByTagName("meta");for(let C=0;C<$.length;C++){const P=$[C],z=["itemprop","property","name"].map(B=>P.getAttribute(B)).filter(B=>B?T.includes(B):!1);if(z.length&&z){const B=P.getAttribute("content");if(B)return B}}return""}function i(){let T=n("name","og:site_name","og:title","twitter:title");return T||(T=t.title),T}function u(){return n("description","og:description","twitter:description","keywords")}const g=i(),d=u(),y=e.origin,E=r();return{description:d,url:y,icons:E,name:g}}Ii.getWindowMetadata=i0;var s0={};(function(t){const e=ha,r=la,n=da,i=pa,u=m=>m==null,g=Symbol("encodeFragmentIdentifier");function d(m){switch(m.arrayFormat){case"index":return I=>(b,w)=>{const D=b.length;return w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),"[",D,"]"].join("")]:[...b,[S(I,m),"[",S(D,m),"]=",S(w,m)].join("")]};case"bracket":return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),"[]"].join("")]:[...b,[S(I,m),"[]=",S(w,m)].join("")];case"colon-list-separator":return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,[S(I,m),":list="].join("")]:[...b,[S(I,m),":list=",S(w,m)].join("")];case"comma":case"separator":case"bracket-separator":{const I=m.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,D)=>D===void 0||m.skipNull&&D===null||m.skipEmptyString&&D===""?w:(D=D===null?"":D,w.length===0?[[S(b,m),I,S(D,m)].join("")]:[[w,S(D,m)].join(m.arrayFormatSeparator)])}default:return I=>(b,w)=>w===void 0||m.skipNull&&w===null||m.skipEmptyString&&w===""?b:w===null?[...b,S(I,m)]:[...b,[S(I,m),"=",S(w,m)].join("")]}}function y(m){let I;switch(m.arrayFormat){case"index":return(b,w,D)=>{if(I=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!I){D[b]=w;return}D[b]===void 0&&(D[b]={}),D[b][I[1]]=w};case"bracket":return(b,w,D)=>{if(I=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!I){D[b]=w;return}if(D[b]===void 0){D[b]=[w];return}D[b]=[].concat(D[b],w)};case"colon-list-separator":return(b,w,D)=>{if(I=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!I){D[b]=w;return}if(D[b]===void 0){D[b]=[w];return}D[b]=[].concat(D[b],w)};case"comma":case"separator":return(b,w,D)=>{const s=typeof w=="string"&&w.includes(m.arrayFormatSeparator),p=typeof w=="string"&&!s&&T(w,m).includes(m.arrayFormatSeparator);w=p?T(w,m):w;const H=s||p?w.split(m.arrayFormatSeparator).map(o=>T(o,m)):w===null?w:T(w,m);D[b]=H};case"bracket-separator":return(b,w,D)=>{const s=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!s){D[b]=w&&T(w,m);return}const p=w===null?[]:w.split(m.arrayFormatSeparator).map(H=>T(H,m));if(D[b]===void 0){D[b]=p;return}D[b]=[].concat(D[b],p)};default:return(b,w,D)=>{if(D[b]===void 0){D[b]=w;return}D[b]=[].concat(D[b],w)}}}function E(m){if(typeof m!="string"||m.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(m,I){return I.encode?I.strict?e(m):encodeURIComponent(m):m}function T(m,I){return I.decode?r(m):m}function $(m){return Array.isArray(m)?m.sort():typeof m=="object"?$(Object.keys(m)).sort((I,b)=>Number(I)-Number(b)).map(I=>m[I]):m}function C(m){const I=m.indexOf("#");return I!==-1&&(m=m.slice(0,I)),m}function P(m){let I="";const b=m.indexOf("#");return b!==-1&&(I=m.slice(b)),I}function z(m){m=C(m);const I=m.indexOf("?");return I===-1?"":m.slice(I+1)}function B(m,I){return I.parseNumbers&&!Number.isNaN(Number(m))&&typeof m=="string"&&m.trim()!==""?m=Number(m):I.parseBooleans&&m!==null&&(m.toLowerCase()==="true"||m.toLowerCase()==="false")&&(m=m.toLowerCase()==="true"),m}function G(m,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),E(I.arrayFormatSeparator);const b=y(I),w=Object.create(null);if(typeof m!="string"||(m=m.trim().replace(/^[?#&]/,""),!m))return w;for(const D of m.split("&")){if(D==="")continue;let[s,p]=n(I.decode?D.replace(/\+/g," "):D,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?p:T(p,I),b(T(s,I),p,w)}for(const D of Object.keys(w)){const s=w[D];if(typeof s=="object"&&s!==null)for(const p of Object.keys(s))s[p]=B(s[p],I);else w[D]=B(s,I)}return I.sort===!1?w:(I.sort===!0?Object.keys(w).sort():Object.keys(w).sort(I.sort)).reduce((D,s)=>{const p=w[s];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?D[s]=$(p):D[s]=p,D},Object.create(null))}t.extract=z,t.parse=G,t.stringify=(m,I)=>{if(!m)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),E(I.arrayFormatSeparator);const b=p=>I.skipNull&&u(m[p])||I.skipEmptyString&&m[p]==="",w=d(I),D={};for(const p of Object.keys(m))b(p)||(D[p]=m[p]);const s=Object.keys(D);return I.sort!==!1&&s.sort(I.sort),s.map(p=>{const H=m[p];return H===void 0?"":H===null?S(p,I):Array.isArray(H)?H.length===0&&I.arrayFormat==="bracket-separator"?S(p,I)+"[]":H.reduce(w(p),[]).join("&"):S(p,I)+"="+S(H,I)}).filter(p=>p.length>0).join("&")},t.parseUrl=(m,I)=>{I=Object.assign({decode:!0},I);const[b,w]=n(m,"#");return Object.assign({url:b.split("?")[0]||"",query:G(z(m),I)},I&&I.parseFragmentIdentifier&&w?{fragmentIdentifier:T(w,I)}:{})},t.stringifyUrl=(m,I)=>{I=Object.assign({encode:!0,strict:!0,[g]:!0},I);const b=C(m.url).split("?")[0]||"",w=t.extract(m.url),D=t.parse(w,{sort:!1}),s=Object.assign(D,m.query);let p=t.stringify(s,I);p&&(p=`?${p}`);let H=P(m.url);return m.fragmentIdentifier&&(H=`#${I[g]?S(m.fragmentIdentifier,I):m.fragmentIdentifier}`),`${b}${p}${H}`},t.pick=(m,I,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[g]:!1},b);const{url:w,query:D,fragmentIdentifier:s}=t.parseUrl(m,b);return t.stringifyUrl({url:w,query:i(D,I),fragmentIdentifier:s},b)},t.exclude=(m,I,b)=>{const w=Array.isArray(I)?D=>!I.includes(D):(D,s)=>!I(D,s);return t.pick(m,w,b)}})(s0);const o0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function co(t,e){const{message:r,code:n}=o0[t];return{message:e?`${r} ${e}`:r,code:n}}function a0(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}var ni={exports:{}};(function(t,e){var r=typeof self<"u"?self:Ae,n=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(g){var d={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function y(c){return c&&DataView.prototype.isPrototypeOf(c)}if(d.arrayBuffer)var E=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],S=ArrayBuffer.isView||function(c){return c&&E.indexOf(Object.prototype.toString.call(c))>-1};function T(c){if(typeof c!="string"&&(c=String(c)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(c))throw new TypeError("Invalid character in header field name");return c.toLowerCase()}function $(c){return typeof c!="string"&&(c=String(c)),c}function C(c){var a={next:function(){var O=c.shift();return{done:O===void 0,value:O}}};return d.iterable&&(a[Symbol.iterator]=function(){return a}),a}function P(c){this.map={},c instanceof P?c.forEach(function(a,O){this.append(O,a)},this):Array.isArray(c)?c.forEach(function(a){this.append(a[0],a[1])},this):c&&Object.getOwnPropertyNames(c).forEach(function(a){this.append(a,c[a])},this)}P.prototype.append=function(c,a){c=T(c),a=$(a);var O=this.map[c];this.map[c]=O?O+", "+a:a},P.prototype.delete=function(c){delete this.map[T(c)]},P.prototype.get=function(c){return c=T(c),this.has(c)?this.map[c]:null},P.prototype.has=function(c){return this.map.hasOwnProperty(T(c))},P.prototype.set=function(c,a){this.map[T(c)]=$(a)},P.prototype.forEach=function(c,a){for(var O in this.map)this.map.hasOwnProperty(O)&&c.call(a,this.map[O],O,this)},P.prototype.keys=function(){var c=[];return this.forEach(function(a,O){c.push(O)}),C(c)},P.prototype.values=function(){var c=[];return this.forEach(function(a){c.push(a)}),C(c)},P.prototype.entries=function(){var c=[];return this.forEach(function(a,O){c.push([O,a])}),C(c)},d.iterable&&(P.prototype[Symbol.iterator]=P.prototype.entries);function z(c){if(c.bodyUsed)return Promise.reject(new TypeError("Already read"));c.bodyUsed=!0}function B(c){return new Promise(function(a,O){c.onload=function(){a(c.result)},c.onerror=function(){O(c.error)}})}function G(c){var a=new FileReader,O=B(a);return a.readAsArrayBuffer(c),O}function m(c){var a=new FileReader,O=B(a);return a.readAsText(c),O}function I(c){for(var a=new Uint8Array(c),O=new Array(a.length),A=0;A<a.length;A++)O[A]=String.fromCharCode(a[A]);return O.join("")}function b(c){if(c.slice)return c.slice(0);var a=new Uint8Array(c.byteLength);return a.set(new Uint8Array(c)),a.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(c){this._bodyInit=c,c?typeof c=="string"?this._bodyText=c:d.blob&&Blob.prototype.isPrototypeOf(c)?this._bodyBlob=c:d.formData&&FormData.prototype.isPrototypeOf(c)?this._bodyFormData=c:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)?this._bodyText=c.toString():d.arrayBuffer&&d.blob&&y(c)?(this._bodyArrayBuffer=b(c.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(c)||S(c))?this._bodyArrayBuffer=b(c):this._bodyText=c=Object.prototype.toString.call(c):this._bodyText="",this.headers.get("content-type")||(typeof c=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var c=z(this);if(c)return c;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(G)}),this.text=function(){var c=z(this);if(c)return c;if(this._bodyBlob)return m(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(I(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(H)}),this.json=function(){return this.text().then(JSON.parse)},this}var D=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function s(c){var a=c.toUpperCase();return D.indexOf(a)>-1?a:c}function p(c,a){a=a||{};var O=a.body;if(c instanceof p){if(c.bodyUsed)throw new TypeError("Already read");this.url=c.url,this.credentials=c.credentials,a.headers||(this.headers=new P(c.headers)),this.method=c.method,this.mode=c.mode,this.signal=c.signal,!O&&c._bodyInit!=null&&(O=c._bodyInit,c.bodyUsed=!0)}else this.url=String(c);if(this.credentials=a.credentials||this.credentials||"same-origin",(a.headers||!this.headers)&&(this.headers=new P(a.headers)),this.method=s(a.method||this.method||"GET"),this.mode=a.mode||this.mode||null,this.signal=a.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(O)}p.prototype.clone=function(){return new p(this,{body:this._bodyInit})};function H(c){var a=new FormData;return c.trim().split("&").forEach(function(O){if(O){var A=O.split("="),L=A.shift().replace(/\+/g," "),v=A.join("=").replace(/\+/g," ");a.append(decodeURIComponent(L),decodeURIComponent(v))}}),a}function o(c){var a=new P,O=c.replace(/\r?\n[\t ]+/g," ");return O.split(/\r?\n/).forEach(function(A){var L=A.split(":"),v=L.shift().trim();if(v){var U=L.join(":").trim();a.append(v,U)}}),a}w.call(p.prototype);function f(c,a){a||(a={}),this.type="default",this.status=a.status===void 0?200:a.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in a?a.statusText:"OK",this.headers=new P(a.headers),this.url=a.url||"",this._initBody(c)}w.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new P(this.headers),url:this.url})},f.error=function(){var c=new f(null,{status:0,statusText:""});return c.type="error",c};var l=[301,302,303,307,308];f.redirect=function(c,a){if(l.indexOf(a)===-1)throw new RangeError("Invalid status code");return new f(null,{status:a,headers:{location:c}})},g.DOMException=u.DOMException;try{new g.DOMException}catch{g.DOMException=function(a,O){this.message=a,this.name=O;var A=Error(a);this.stack=A.stack},g.DOMException.prototype=Object.create(Error.prototype),g.DOMException.prototype.constructor=g.DOMException}function _(c,a){return new Promise(function(O,A){var L=new p(c,a);if(L.signal&&L.signal.aborted)return A(new g.DOMException("Aborted","AbortError"));var v=new XMLHttpRequest;function U(){v.abort()}v.onload=function(){var K={status:v.status,statusText:v.statusText,headers:o(v.getAllResponseHeaders()||"")};K.url="responseURL"in v?v.responseURL:K.headers.get("X-Request-URL");var q="response"in v?v.response:v.responseText;O(new f(q,K))},v.onerror=function(){A(new TypeError("Network request failed"))},v.ontimeout=function(){A(new TypeError("Network request failed"))},v.onabort=function(){A(new g.DOMException("Aborted","AbortError"))},v.open(L.method,L.url,!0),L.credentials==="include"?v.withCredentials=!0:L.credentials==="omit"&&(v.withCredentials=!1),"responseType"in v&&d.blob&&(v.responseType="blob"),L.headers.forEach(function(K,q){v.setRequestHeader(q,K)}),L.signal&&(L.signal.addEventListener("abort",U),v.onreadystatechange=function(){v.readyState===4&&L.signal.removeEventListener("abort",U)}),v.send(typeof L._bodyInit>"u"?null:L._bodyInit)})}return _.polyfill=!0,u.fetch||(u.fetch=_,u.Headers=P,u.Request=p,u.Response=f),g.Headers=P,g.Request=p,g.Response=f,g.fetch=_,Object.defineProperty(g,"__esModule",{value:!0}),g})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e})(ni,ni.exports);const uo=$c(ni.exports);function c0(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function ho(t){return typeof t=="string"?t:JSON.stringify(t)}const u0={Accept:"application/json","Content-Type":"application/json"},h0="POST",fo={headers:u0,method:h0},lo=10;class vn{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ms(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const n=ho(e),u=await(await uo(this.url,Object.assign(Object.assign({},fo),{body:n}))).json();this.onPayload({data:u})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!Ms(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),i(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{const r=ho({id:1,jsonrpc:"2.0",method:"test",params:[]});await uo(e,Object.assign(Object.assign({},fo),{body:r})),this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?c0(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),u=_n(e,i);this.events.emit("payload",u)}parseError(e,r=this.url){return Pa(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>lo&&this.events.setMaxListeners(lo)}}const po="error",f0="wss://relay.walletconnect.com",l0="wc",d0="universal_provider",go=`${l0}@${2}:${d0}:`,p0="https://rpc.walletconnect.com/v1",Br={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Ht(t,e,r){let n;const i=ii(t);return e.rpcMap&&(n=e.rpcMap[i]),n||(n=`${p0}?chainId=eip155:${i}&projectId=${r}`),n}function ii(t){return t.includes("eip155")?Number(t.split(":")[1]):Number(t)}function g0(t,e){if(!e.includes(t))throw new Error(`Chain '${t}' not approved. Please use one of the following: ${e.toString()}`)}function y0(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}const wn=(t,e)=>{const r=n=>{n.request!==e.request||n.topic!==e.topic||(t.events.removeListener("session_request_sent",r),_0())};t.on("session_request_sent",r)};function _0(){if(typeof window<"u")try{const t=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(t){const e=JSON.parse(t);window.open(e.href,"_self","noreferrer noopener")}}catch(t){console.error(t)}}class b0{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(wn(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const n=ii(e);if(!this.httpProviders[n]){const i=r||Ht(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,i)}this.chainId=n,this.events.emit(Br.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const n=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Mr(new vn(n))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const n=ii(r);e[n]=this.createHttpProvider(n)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}handleSwitchChain(e){const r=parseInt(e,16),n=`${this.name}:${r}`;g0(n,this.namespace.chains),this.setDefaultChain(`${r}`)}}class m0{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(wn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const n=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Br.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||Ht(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Mr(new vn(n))}}class v0{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(wn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Br.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||Ht(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Mr(new vn(n))}}class w0{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(wn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||Ht(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Br.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||Ht(e,this.namespace);return typeof n>"u"?void 0:new Mr(new vn(n))}}var E0=Object.defineProperty,D0=Object.defineProperties,S0=Object.getOwnPropertyDescriptors,yo=Object.getOwnPropertySymbols,O0=Object.prototype.hasOwnProperty,I0=Object.prototype.propertyIsEnumerable,_o=(t,e,r)=>e in t?E0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zr=(t,e)=>{for(var r in e||(e={}))O0.call(e,r)&&_o(t,r,e[r]);if(yo)for(var r of yo(e))I0.call(e,r)&&_o(t,r,e[r]);return t},Mn=(t,e)=>D0(t,S0(e));class xi{constructor(e){this.events=new ot.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Tr(Se.getDefaultLoggerOptions({level:e?.logger||po}))}static async init(e){const r=new xi(e);return await r.initialize(),r}async request(e,r){const[n,i]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Zr({},e),chainId:`${n}:${i}`,topic:this.session.topic})}sendAsync(e,r,n){this.request(e,n).then(i=>r(null,i)).catch(i=>r(i,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:co("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await n(),this.createProviders(),this.onConnect(),this.session}setDefaultChain(e,r){try{const[n,i]=this.validateChain(e);this.getProvider(n).setDefaultChain(i,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(a0(r)){for(const n of r)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Oi.init({logger:this.providerOpts.logger||po,relayUrl:this.providerOpts.relayUrl||f0,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{var r,n,i;const u=((r=this.session)==null?void 0:r.namespaces[e].accounts)||[],g=y0(u),d=Mn(Zr({},Object.assign(this.namespaces[e],(i=(n=this.optionalNamespaces)==null?void 0:n[e])!=null?i:{})),{accounts:u,chains:g});switch(e){case"eip155":this.rpcProviders[e]=new b0({client:this.client,namespace:d,events:this.events});break;case"solana":this.rpcProviders[e]=new m0({client:this.client,namespace:d,events:this.events});break;case"cosmos":this.rpcProviders[e]=new v0({client:this.client,namespace:d,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new w0({client:this.client,namespace:d,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:n}=r;n.name==="accountsChanged"?this.events.emit("accountsChanged",n.data):n.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n;const{namespaces:i}=r,u=(n=this.client)==null?void 0:n.session.get(e);this.session=Mn(Zr({},u),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Mn(Zr({},co("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Br.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:n,sessionProperties:i}=e;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=n,this.sessionProperties=i,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(e){const[r,n]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const i=Object.keys(this.namespaces)[0],u=this.rpcProviders[i].getDefaultChain();return[i,u]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){const[n,i]=this.validateChain(e);r||this.getProvider(n).setDefaultChain(i),this.namespaces[n].defaultChain=i,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${go}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${go}/${e}`)}}var x0=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(u){return u instanceof r?u:new r(function(g){g(u)})}return new(r||(r=Promise))(function(u,g){function d(S){try{E(n.next(S))}catch(T){g(T)}}function y(S){try{E(n.throw(S))}catch(T){g(T)}}function E(S){S.done?u(S.value):i(S.value).then(d,y)}E((n=n.apply(t,e||[])).next())})},P0=globalThis&&globalThis.__generator||function(t,e){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},n,i,u,g;return g={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function d(E){return function(S){return y([E,S])}}function y(E){if(n)throw new TypeError("Generator is already executing.");for(;g&&(g=0,E[0]&&(r=0)),r;)try{if(n=1,i&&(u=E[0]&2?i.return:E[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,E[1])).done)return u;switch(i=0,u&&(E=[E[0]&2,u.value]),E[0]){case 0:case 1:u=E;break;case 4:return r.label++,{value:E[1],done:!1};case 5:r.label++,i=E[1],E=[0];continue;case 7:E=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(E[0]===6||E[0]===2)){r=0;continue}if(E[0]===3&&(!u||E[1]>u[0]&&E[1]<u[3])){r.label=E[1];break}if(E[0]===6&&r.label<u[1]){r.label=u[1],u=E;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(E);break}u[2]&&r.ops.pop(),r.trys.pop();continue}E=e.call(t,r)}catch(S){E=[6,S],i=0}finally{n=u=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},A0={1:"https://ethereum.publicnode.com",5:"https://eth-goerli.g.alchemy.com/v2/yVhq9zPJorAWsw-F87fEabSUl7cCU6z4",11155111:"https://sepolia.infura.io/v3/9f79b2f9274344af90b8d4e244b580ef",137:"https://polygon-rpc.com/",80001:"https://polygon-mumbai.g.alchemy.com/v2/rVI6pOV4irVsrw20cJxc1fxK_1cSeiY0",56:"https://bsc-dataseed.binance.org/",97:"https://data-seed-prebsc-1-s1.binance.org:8545",43114:"https://api.avax.network/ext/bc/C/rpc",43113:"https://api.avax-test.network/ext/bc/C/rpc",250:"https://rpc.fantom.network/",25:"https://evm-cronos.crypto.org",338:"https://evm-t3.cronos.org",42161:"https://arb1.arbitrum.io/rpc",421613:"https://arb-goerli.g.alchemy.com/v2/nFrflomLgsQQL5NWjGileAVqIGGxZWce",10:"https://mainnet.optimism.io"},N0=["eip155:1","eip155:137","eip155:250","eip155:25","eip155:42161","eip155:10"],C0=function(){return x0(void 0,void 0,void 0,function(){return P0(this,function(t){switch(t.label){case 0:return[4,xi.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,t.sent()]}})})};export{A0 as WC_DEFAULT_RPC_MAP,N0 as WC_V2_DEFAULT_CHAINS,C0 as getWalletConnectV2ProviderInstance};

import{b as Ae,d as Tc,r as Ac,g as Nc}from"./index.95f31e75.js";var yn,Ni;function Cc(){if(Ni)return yn;Ni=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}yn=e;function e(t,n,i){var f=i&&i.stringify||r,g=1;if(typeof t=="object"&&t!==null){var p=n.length+g;if(p===1)return t;var _=new Array(p);_[0]=f(t);for(var S=1;S<p;S++)_[S]=f(n[S]);return _.join(" ")}if(typeof t!="string")return t;var I=n.length;if(I===0)return t;for(var N="",j=1-g,C=-1,P=t&&t.length||0,M=0;M<P;){if(t.charCodeAt(M)===37&&M+1<P){switch(C=C>-1?C:0,t.charCodeAt(M+1)){case 100:case 102:if(j>=I||n[j]==null)break;C<M&&(N+=t.slice(C,M)),N+=Number(n[j]),C=M+2,M++;break;case 105:if(j>=I||n[j]==null)break;C<M&&(N+=t.slice(C,M)),N+=Math.floor(Number(n[j])),C=M+2,M++;break;case 79:case 111:case 106:if(j>=I||n[j]===void 0)break;C<M&&(N+=t.slice(C,M));var B=typeof n[j];if(B==="string"){N+="'"+n[j]+"'",C=M+2,M++;break}if(B==="function"){N+=n[j].name||"<anonymous>",C=M+2,M++;break}N+=f(n[j]),C=M+2,M++;break;case 115:if(j>=I)break;C<M&&(N+=t.slice(C,M)),N+=String(n[j]),C=M+2,M++;break;case 37:C<M&&(N+=t.slice(C,M)),N+="%",C=M+2,M++,j--;break}++j}++M}return C===-1?t:(C<P&&(N+=t.slice(C)),N)}return yn}var _n,Ci;function fo(){if(Ci)return _n;Ci=1;const r=Cc();_n=i;const e=E().console||{},t={mapHttpRequest:P,mapHttpResponse:P,wrapRequestSerializer:M,wrapResponseSerializer:M,wrapErrorSerializer:M,req:P,res:P,err:j};function n(y,s){return Array.isArray(y)?y.filter(function($){return $!=="!stdSerializers.err"}):y===!0?Object.keys(s):!1}function i(y){y=y||{},y.browser=y.browser||{};const s=y.browser.transmit;if(s&&typeof s.send!="function")throw Error("pino: transmit option must have a send function");const d=y.browser.write||e;y.browser.write&&(y.browser.asObject=!0);const $=y.serializers||{},o=n(y.browser.serialize,$);let h=y.browser.serialize;Array.isArray(y.browser.serialize)&&y.browser.serialize.indexOf("!stdSerializers.err")>-1&&(h=!1);const l=["error","fatal","warn","info","debug","trace"];typeof d=="function"&&(d.error=d.fatal=d.warn=d.info=d.debug=d.trace=d),y.enabled===!1&&(y.level="silent");const b=y.level||"info",a=Object.create(d);a.log||(a.log=B),Object.defineProperty(a,"levelVal",{get:D}),Object.defineProperty(a,"level",{get:T,set:U});const c={transmit:s,serialize:o,asObject:y.browser.asObject,levels:l,timestamp:C(y)};a.levels=i.levels,a.level=b,a.setMaxListeners=a.getMaxListeners=a.emit=a.addListener=a.on=a.prependListener=a.once=a.prependOnceListener=a.removeListener=a.removeAllListeners=a.listeners=a.listenerCount=a.eventNames=a.write=a.flush=B,a.serializers=$,a._serialize=o,a._stdErrSerialize=h,a.child=w,s&&(a._logEvent=N());function D(){return this.level==="silent"?1/0:this.levels.values[this.level]}function T(){return this._level}function U(R){if(R!=="silent"&&!this.levels.values[R])throw Error("unknown level "+R);this._level=R,f(c,a,"error","log"),f(c,a,"fatal","error"),f(c,a,"warn","error"),f(c,a,"info","log"),f(c,a,"debug","log"),f(c,a,"trace","log")}function w(R,K){if(!R)throw new Error("missing bindings for child Pino");K=K||{},o&&R.serializers&&(K.serializers=R.serializers);const z=K.serializers;if(o&&z){var V=Object.assign({},$,z),X=y.browser.serialize===!0?Object.keys(V):o;delete R.serializers,_([R],X,V,this._stdErrSerialize)}function Y(ee){this._childLevel=(ee._childLevel|0)+1,this.error=S(ee,R,"error"),this.fatal=S(ee,R,"fatal"),this.warn=S(ee,R,"warn"),this.info=S(ee,R,"info"),this.debug=S(ee,R,"debug"),this.trace=S(ee,R,"trace"),V&&(this.serializers=V,this._serialize=X),s&&(this._logEvent=N([].concat(ee._logEvent.bindings,R)))}return Y.prototype=this,new Y(this)}return a}i.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},i.stdSerializers=t,i.stdTimeFunctions=Object.assign({},{nullTime:G,epochTime:v,unixTime:O,isoTime:m});function f(y,s,d,$){const o=Object.getPrototypeOf(s);s[d]=s.levelVal>s.levels.values[d]?B:o[d]?o[d]:e[d]||e[$]||B,g(y,s,d)}function g(y,s,d){!y.transmit&&s[d]===B||(s[d]=function($){return function(){const h=y.timestamp(),l=new Array(arguments.length),b=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var a=0;a<l.length;a++)l[a]=arguments[a];if(y.serialize&&!y.asObject&&_(l,this._serialize,this.serializers,this._stdErrSerialize),y.asObject?$.call(b,p(this,d,l,h)):$.apply(b,l),y.transmit){const c=y.transmit.level||s.level,D=i.levels.values[c],T=i.levels.values[d];if(T<D)return;I(this,{ts:h,methodLevel:d,methodValue:T,transmitLevel:c,transmitValue:i.levels.values[y.transmit.level||s.level],send:y.transmit.send,val:s.levelVal},l)}}}(s[d]))}function p(y,s,d,$){y._serialize&&_(d,y._serialize,y.serializers,y._stdErrSerialize);const o=d.slice();let h=o[0];const l={};$&&(l.time=$),l.level=i.levels.values[s];let b=(y._childLevel|0)+1;if(b<1&&(b=1),h!==null&&typeof h=="object"){for(;b--&&typeof o[0]=="object";)Object.assign(l,o.shift());h=o.length?r(o.shift(),o):void 0}else typeof h=="string"&&(h=r(o.shift(),o));return h!==void 0&&(l.msg=h),l}function _(y,s,d,$){for(const o in y)if($&&y[o]instanceof Error)y[o]=i.stdSerializers.err(y[o]);else if(typeof y[o]=="object"&&!Array.isArray(y[o]))for(const h in y[o])s&&s.indexOf(h)>-1&&h in d&&(y[o][h]=d[h](y[o][h]))}function S(y,s,d){return function(){const $=new Array(1+arguments.length);$[0]=s;for(var o=1;o<$.length;o++)$[o]=arguments[o-1];return y[d].apply(this,$)}}function I(y,s,d){const $=s.send,o=s.ts,h=s.methodLevel,l=s.methodValue,b=s.val,a=y._logEvent.bindings;_(d,y._serialize||Object.keys(y.serializers),y.serializers,y._stdErrSerialize===void 0?!0:y._stdErrSerialize),y._logEvent.ts=o,y._logEvent.messages=d.filter(function(c){return a.indexOf(c)===-1}),y._logEvent.level.label=h,y._logEvent.level.value=l,$(h,y._logEvent,b),y._logEvent=N(a)}function N(y){return{ts:0,messages:[],bindings:y||[],level:{label:"",value:0}}}function j(y){const s={type:y.constructor.name,msg:y.message,stack:y.stack};for(const d in y)s[d]===void 0&&(s[d]=y[d]);return s}function C(y){return typeof y.timestamp=="function"?y.timestamp:y.timestamp===!1?G:v}function P(){return{}}function M(y){return y}function B(){}function G(){return!1}function v(){return Date.now()}function O(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function E(){function y(s){return typeof s<"u"&&s}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return y(self)||y(window)||y(this)||{}}}return _n}var Zr=fo(),ot={exports:{}},ir=typeof Reflect=="object"?Reflect:null,Ri=ir&&typeof ir.apply=="function"?ir.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Gr;ir&&typeof ir.ownKeys=="function"?Gr=ir.ownKeys:Object.getOwnPropertySymbols?Gr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Gr=function(e){return Object.getOwnPropertyNames(e)};function Rc(r){console&&console.warn&&console.warn(r)}var lo=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ot.exports=Oe;ot.exports.once=jc;Oe.EventEmitter=Oe;Oe.prototype._events=void 0;Oe.prototype._eventsCount=0;Oe.prototype._maxListeners=void 0;var Fi=10;function Qr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return Fi},set:function(r){if(typeof r!="number"||r<0||lo(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Fi=r}});Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||lo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function po(r){return r._maxListeners===void 0?Oe.defaultMaxListeners:r._maxListeners}Oe.prototype.getMaxListeners=function(){return po(this)};Oe.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",f=this._events;if(f!==void 0)i=i&&f.error===void 0;else if(!i)return!1;if(i){var g;if(t.length>0&&(g=t[0]),g instanceof Error)throw g;var p=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw p.context=g,p}var _=f[e];if(_===void 0)return!1;if(typeof _=="function")Ri(_,this,t);else for(var S=_.length,I=mo(_,S),n=0;n<S;++n)Ri(I[n],this,t);return!0};function go(r,e,t,n){var i,f,g;if(Qr(t),f=r._events,f===void 0?(f=r._events=Object.create(null),r._eventsCount=0):(f.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),f=r._events),g=f[e]),g===void 0)g=f[e]=t,++r._eventsCount;else if(typeof g=="function"?g=f[e]=n?[t,g]:[g,t]:n?g.unshift(t):g.push(t),i=po(r),i>0&&g.length>i&&!g.warned){g.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=r,p.type=e,p.count=g.length,Rc(p)}return r}Oe.prototype.addListener=function(e,t){return go(this,e,t,!1)};Oe.prototype.on=Oe.prototype.addListener;Oe.prototype.prependListener=function(e,t){return go(this,e,t,!0)};function Fc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function yo(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Fc.bind(n);return i.listener=t,n.wrapFn=i,i}Oe.prototype.once=function(e,t){return Qr(t),this.on(e,yo(this,e,t)),this};Oe.prototype.prependOnceListener=function(e,t){return Qr(t),this.prependListener(e,yo(this,e,t)),this};Oe.prototype.removeListener=function(e,t){var n,i,f,g,p;if(Qr(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(f=-1,g=n.length-1;g>=0;g--)if(n[g]===t||n[g].listener===t){p=n[g].listener,f=g;break}if(f<0)return this;f===0?n.shift():Lc(n,f),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,p||t)}return this};Oe.prototype.off=Oe.prototype.removeListener;Oe.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var f=Object.keys(n),g;for(i=0;i<f.length;++i)g=f[i],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function _o(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Uc(i):mo(i,i.length)}Oe.prototype.listeners=function(e){return _o(this,e,!0)};Oe.prototype.rawListeners=function(e){return _o(this,e,!1)};Oe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):bo.call(r,e)};Oe.prototype.listenerCount=bo;function bo(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Gr(this._events):[]};function mo(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Lc(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Uc(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function jc(r,e){return new Promise(function(t,n){function i(g){r.removeListener(e,f),n(g)}function f(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}vo(r,e,f,{once:!0}),e!=="error"&&Mc(r,i,{once:!0})})}function Mc(r,e,t){typeof r.on=="function"&&vo(r,"error",e,t)}function vo(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(f){n.once&&r.removeEventListener(e,i),t(f)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var en={},Zn={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,n,i,f,g,p,_,S,I,N,j,C,P,M,B,G,v,O,m,E,y,s;(function(d){var $=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(o($,o(r.exports)));function o(h,l){return h!==$&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(b,a){return h[b]=l?l(b,a):a}}})(function(d){var $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var l in h)h.hasOwnProperty(l)&&(o[l]=h[l])};e=function(o,h){$(o,h);function l(){this.constructor=o}o.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)},t=Object.assign||function(o){for(var h,l=1,b=arguments.length;l<b;l++){h=arguments[l];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(o[a]=h[a])}return o},n=function(o,h){var l={};for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&h.indexOf(b)<0&&(l[b]=o[b]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,b=Object.getOwnPropertySymbols(o);a<b.length;a++)h.indexOf(b[a])<0&&Object.prototype.propertyIsEnumerable.call(o,b[a])&&(l[b[a]]=o[b[a]]);return l},i=function(o,h,l,b){var a=arguments.length,c=a<3?h:b===null?b=Object.getOwnPropertyDescriptor(h,l):b,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,h,l,b);else for(var T=o.length-1;T>=0;T--)(D=o[T])&&(c=(a<3?D(c):a>3?D(h,l,c):D(h,l))||c);return a>3&&c&&Object.defineProperty(h,l,c),c},f=function(o,h){return function(l,b){h(l,b,o)}},g=function(o,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,h)},p=function(o,h,l,b){function a(c){return c instanceof l?c:new l(function(D){D(c)})}return new(l||(l=Promise))(function(c,D){function T(R){try{w(b.next(R))}catch(K){D(K)}}function U(R){try{w(b.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(T,U)}w((b=b.apply(o,h||[])).next())})},_=function(o,h){var l={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,D;return D={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function T(w){return function(R){return U([w,R])}}function U(w){if(b)throw new TypeError("Generator is already executing.");for(;l;)try{if(b=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,a=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){l.label=w[1];break}if(w[0]===6&&l.label<c[1]){l.label=c[1],c=w;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(w);break}c[2]&&l.ops.pop(),l.trys.pop();continue}w=h.call(o,l)}catch(R){w=[6,R],a=0}finally{b=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},s=function(o,h,l,b){b===void 0&&(b=l),o[b]=h[l]},S=function(o,h){for(var l in o)l!=="default"&&!h.hasOwnProperty(l)&&(h[l]=o[l])},I=function(o){var h=typeof Symbol=="function"&&Symbol.iterator,l=h&&o[h],b=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&b>=o.length&&(o=void 0),{value:o&&o[b++],done:!o}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(o,h){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var b=l.call(o),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=b.next()).done;)c.push(a.value)}catch(T){D={error:T}}finally{try{a&&!a.done&&(l=b.return)&&l.call(b)}finally{if(D)throw D.error}}return c},j=function(){for(var o=[],h=0;h<arguments.length;h++)o=o.concat(N(arguments[h]));return o},C=function(){for(var o=0,h=0,l=arguments.length;h<l;h++)o+=arguments[h].length;for(var b=Array(o),a=0,h=0;h<l;h++)for(var c=arguments[h],D=0,T=c.length;D<T;D++,a++)b[a]=c[D];return b},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},M=function(o,h,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=l.apply(o,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){b[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||T(z,V)})})}function T(z,V){try{U(b[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof P?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){T("next",z)}function R(z){T("throw",z)}function K(z,V){z(V),c.shift(),c.length&&T(c[0][0],c[0][1])}},B=function(o){var h,l;return h={},b("next"),b("throw",function(a){throw a}),b("return"),h[Symbol.iterator]=function(){return this},h;function b(a,c){h[a]=o[a]?function(D){return(l=!l)?{value:P(o[a](D)),done:a==="return"}:c?c(D):D}:c}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o[Symbol.asyncIterator],l;return h?h.call(o):(o=typeof I=="function"?I(o):o[Symbol.iterator](),l={},b("next"),b("throw"),b("return"),l[Symbol.asyncIterator]=function(){return this},l);function b(c){l[c]=o[c]&&function(D){return new Promise(function(T,U){D=o[c](D),a(T,U,D.done,D.value)})}}function a(c,D,T,U){Promise.resolve(U).then(function(w){c({value:w,done:T})},D)}},v=function(o,h){return Object.defineProperty?Object.defineProperty(o,"raw",{value:h}):o.raw=h,o},O=function(o){if(o&&o.__esModule)return o;var h={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(h[l]=o[l]);return h.default=o,h},m=function(o){return o&&o.__esModule?o:{default:o}},E=function(o,h){if(!h.has(o))throw new TypeError("attempted to get private field on non-instance");return h.get(o)},y=function(o,h,l){if(!h.has(o))throw new TypeError("attempted to set private field on non-instance");return h.set(o,l),l},d("__extends",e),d("__assign",t),d("__rest",n),d("__decorate",i),d("__param",f),d("__metadata",g),d("__awaiter",p),d("__generator",_),d("__exportStar",S),d("__createBinding",s),d("__values",I),d("__read",N),d("__spread",j),d("__spreadArrays",C),d("__await",P),d("__asyncGenerator",M),d("__asyncDelegator",B),d("__asyncValues",G),d("__makeTemplateObject",v),d("__importStar",O),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(Zn);var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});function $c(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}Sr.safeJsonParse=$c;function Bc(r){return typeof r=="string"?r:JSON.stringify(r,(e,t)=>typeof t>"u"?null:t)}Sr.safeJsonStringify=Bc;var fr={exports:{}},Li;function Hc(){return Li||(Li=1,function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ae<"u"&&Ae.localStorage?fr.exports=Ae.localStorage:typeof window<"u"&&window.localStorage?fr.exports=window.localStorage:fr.exports=new e}()),fr.exports}var bn={},lr={},Ui;function qc(){if(Ui)return lr;Ui=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.IKeyValueStorage=void 0;class r{}return lr.IKeyValueStorage=r,lr}var dr={},ji;function zc(){if(ji)return dr;ji=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.parseEntry=void 0;const r=Sr;function e(t){var n;return[t[0],r.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}return dr.parseEntry=e,dr}var Mi;function Kc(){return Mi||(Mi=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Zn.exports;e.__exportStar(qc(),r),e.__exportStar(zc(),r)}(bn)),bn}Object.defineProperty(en,"__esModule",{value:!0});en.KeyValueStorage=void 0;const nr=Zn.exports,$i=Sr,Vc=nr.__importDefault(Hc()),Gc=Kc();class wo{constructor(){this.localStorage=Vc.default}getKeys(){return nr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return nr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Gc.parseEntry)})}getItem(e){return nr.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return $i.safeJsonParse(t)})}setItem(e,t){return nr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,$i.safeJsonStringify(t))})}removeItem(e){return nr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}en.KeyValueStorage=wo;var Wc=en.default=wo,Or={},Ir={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,n,i,f,g,p,_,S,I,N,j,C,P,M,B,G,v,O,m,E,y,s;(function(d){var $=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(o($,o(r.exports)));function o(h,l){return h!==$&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(b,a){return h[b]=l?l(b,a):a}}})(function(d){var $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var l in h)h.hasOwnProperty(l)&&(o[l]=h[l])};e=function(o,h){$(o,h);function l(){this.constructor=o}o.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)},t=Object.assign||function(o){for(var h,l=1,b=arguments.length;l<b;l++){h=arguments[l];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(o[a]=h[a])}return o},n=function(o,h){var l={};for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&h.indexOf(b)<0&&(l[b]=o[b]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,b=Object.getOwnPropertySymbols(o);a<b.length;a++)h.indexOf(b[a])<0&&Object.prototype.propertyIsEnumerable.call(o,b[a])&&(l[b[a]]=o[b[a]]);return l},i=function(o,h,l,b){var a=arguments.length,c=a<3?h:b===null?b=Object.getOwnPropertyDescriptor(h,l):b,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,h,l,b);else for(var T=o.length-1;T>=0;T--)(D=o[T])&&(c=(a<3?D(c):a>3?D(h,l,c):D(h,l))||c);return a>3&&c&&Object.defineProperty(h,l,c),c},f=function(o,h){return function(l,b){h(l,b,o)}},g=function(o,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,h)},p=function(o,h,l,b){function a(c){return c instanceof l?c:new l(function(D){D(c)})}return new(l||(l=Promise))(function(c,D){function T(R){try{w(b.next(R))}catch(K){D(K)}}function U(R){try{w(b.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(T,U)}w((b=b.apply(o,h||[])).next())})},_=function(o,h){var l={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,D;return D={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function T(w){return function(R){return U([w,R])}}function U(w){if(b)throw new TypeError("Generator is already executing.");for(;l;)try{if(b=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,a=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){l.label=w[1];break}if(w[0]===6&&l.label<c[1]){l.label=c[1],c=w;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(w);break}c[2]&&l.ops.pop(),l.trys.pop();continue}w=h.call(o,l)}catch(R){w=[6,R],a=0}finally{b=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},s=function(o,h,l,b){b===void 0&&(b=l),o[b]=h[l]},S=function(o,h){for(var l in o)l!=="default"&&!h.hasOwnProperty(l)&&(h[l]=o[l])},I=function(o){var h=typeof Symbol=="function"&&Symbol.iterator,l=h&&o[h],b=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&b>=o.length&&(o=void 0),{value:o&&o[b++],done:!o}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(o,h){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var b=l.call(o),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=b.next()).done;)c.push(a.value)}catch(T){D={error:T}}finally{try{a&&!a.done&&(l=b.return)&&l.call(b)}finally{if(D)throw D.error}}return c},j=function(){for(var o=[],h=0;h<arguments.length;h++)o=o.concat(N(arguments[h]));return o},C=function(){for(var o=0,h=0,l=arguments.length;h<l;h++)o+=arguments[h].length;for(var b=Array(o),a=0,h=0;h<l;h++)for(var c=arguments[h],D=0,T=c.length;D<T;D++,a++)b[a]=c[D];return b},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},M=function(o,h,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=l.apply(o,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){b[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||T(z,V)})})}function T(z,V){try{U(b[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof P?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){T("next",z)}function R(z){T("throw",z)}function K(z,V){z(V),c.shift(),c.length&&T(c[0][0],c[0][1])}},B=function(o){var h,l;return h={},b("next"),b("throw",function(a){throw a}),b("return"),h[Symbol.iterator]=function(){return this},h;function b(a,c){h[a]=o[a]?function(D){return(l=!l)?{value:P(o[a](D)),done:a==="return"}:c?c(D):D}:c}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o[Symbol.asyncIterator],l;return h?h.call(o):(o=typeof I=="function"?I(o):o[Symbol.iterator](),l={},b("next"),b("throw"),b("return"),l[Symbol.asyncIterator]=function(){return this},l);function b(c){l[c]=o[c]&&function(D){return new Promise(function(T,U){D=o[c](D),a(T,U,D.done,D.value)})}}function a(c,D,T,U){Promise.resolve(U).then(function(w){c({value:w,done:T})},D)}},v=function(o,h){return Object.defineProperty?Object.defineProperty(o,"raw",{value:h}):o.raw=h,o},O=function(o){if(o&&o.__esModule)return o;var h={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(h[l]=o[l]);return h.default=o,h},m=function(o){return o&&o.__esModule?o:{default:o}},E=function(o,h){if(!h.has(o))throw new TypeError("attempted to get private field on non-instance");return h.get(o)},y=function(o,h,l){if(!h.has(o))throw new TypeError("attempted to set private field on non-instance");return h.set(o,l),l},d("__extends",e),d("__assign",t),d("__rest",n),d("__decorate",i),d("__param",f),d("__metadata",g),d("__awaiter",p),d("__generator",_),d("__exportStar",S),d("__createBinding",s),d("__values",I),d("__read",N),d("__spread",j),d("__spreadArrays",C),d("__await",P),d("__asyncGenerator",M),d("__asyncDelegator",B),d("__asyncValues",G),d("__makeTemplateObject",v),d("__importStar",O),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(Ir);var pr={},te={},xr={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,n,i,f,g,p,_,S,I,N,j,C,P,M,B,G,v,O,m,E,y,s;(function(d){var $=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(o($,o(r.exports)));function o(h,l){return h!==$&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(b,a){return h[b]=l?l(b,a):a}}})(function(d){var $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var l in h)h.hasOwnProperty(l)&&(o[l]=h[l])};e=function(o,h){$(o,h);function l(){this.constructor=o}o.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)},t=Object.assign||function(o){for(var h,l=1,b=arguments.length;l<b;l++){h=arguments[l];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(o[a]=h[a])}return o},n=function(o,h){var l={};for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&h.indexOf(b)<0&&(l[b]=o[b]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,b=Object.getOwnPropertySymbols(o);a<b.length;a++)h.indexOf(b[a])<0&&Object.prototype.propertyIsEnumerable.call(o,b[a])&&(l[b[a]]=o[b[a]]);return l},i=function(o,h,l,b){var a=arguments.length,c=a<3?h:b===null?b=Object.getOwnPropertyDescriptor(h,l):b,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,h,l,b);else for(var T=o.length-1;T>=0;T--)(D=o[T])&&(c=(a<3?D(c):a>3?D(h,l,c):D(h,l))||c);return a>3&&c&&Object.defineProperty(h,l,c),c},f=function(o,h){return function(l,b){h(l,b,o)}},g=function(o,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,h)},p=function(o,h,l,b){function a(c){return c instanceof l?c:new l(function(D){D(c)})}return new(l||(l=Promise))(function(c,D){function T(R){try{w(b.next(R))}catch(K){D(K)}}function U(R){try{w(b.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(T,U)}w((b=b.apply(o,h||[])).next())})},_=function(o,h){var l={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,D;return D={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function T(w){return function(R){return U([w,R])}}function U(w){if(b)throw new TypeError("Generator is already executing.");for(;l;)try{if(b=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,a=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){l.label=w[1];break}if(w[0]===6&&l.label<c[1]){l.label=c[1],c=w;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(w);break}c[2]&&l.ops.pop(),l.trys.pop();continue}w=h.call(o,l)}catch(R){w=[6,R],a=0}finally{b=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},s=function(o,h,l,b){b===void 0&&(b=l),o[b]=h[l]},S=function(o,h){for(var l in o)l!=="default"&&!h.hasOwnProperty(l)&&(h[l]=o[l])},I=function(o){var h=typeof Symbol=="function"&&Symbol.iterator,l=h&&o[h],b=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&b>=o.length&&(o=void 0),{value:o&&o[b++],done:!o}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(o,h){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var b=l.call(o),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=b.next()).done;)c.push(a.value)}catch(T){D={error:T}}finally{try{a&&!a.done&&(l=b.return)&&l.call(b)}finally{if(D)throw D.error}}return c},j=function(){for(var o=[],h=0;h<arguments.length;h++)o=o.concat(N(arguments[h]));return o},C=function(){for(var o=0,h=0,l=arguments.length;h<l;h++)o+=arguments[h].length;for(var b=Array(o),a=0,h=0;h<l;h++)for(var c=arguments[h],D=0,T=c.length;D<T;D++,a++)b[a]=c[D];return b},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},M=function(o,h,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=l.apply(o,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){b[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||T(z,V)})})}function T(z,V){try{U(b[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof P?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){T("next",z)}function R(z){T("throw",z)}function K(z,V){z(V),c.shift(),c.length&&T(c[0][0],c[0][1])}},B=function(o){var h,l;return h={},b("next"),b("throw",function(a){throw a}),b("return"),h[Symbol.iterator]=function(){return this},h;function b(a,c){h[a]=o[a]?function(D){return(l=!l)?{value:P(o[a](D)),done:a==="return"}:c?c(D):D}:c}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o[Symbol.asyncIterator],l;return h?h.call(o):(o=typeof I=="function"?I(o):o[Symbol.iterator](),l={},b("next"),b("throw"),b("return"),l[Symbol.asyncIterator]=function(){return this},l);function b(c){l[c]=o[c]&&function(D){return new Promise(function(T,U){D=o[c](D),a(T,U,D.done,D.value)})}}function a(c,D,T,U){Promise.resolve(U).then(function(w){c({value:w,done:T})},D)}},v=function(o,h){return Object.defineProperty?Object.defineProperty(o,"raw",{value:h}):o.raw=h,o},O=function(o){if(o&&o.__esModule)return o;var h={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(h[l]=o[l]);return h.default=o,h},m=function(o){return o&&o.__esModule?o:{default:o}},E=function(o,h){if(!h.has(o))throw new TypeError("attempted to get private field on non-instance");return h.get(o)},y=function(o,h,l){if(!h.has(o))throw new TypeError("attempted to set private field on non-instance");return h.set(o,l),l},d("__extends",e),d("__assign",t),d("__rest",n),d("__decorate",i),d("__param",f),d("__metadata",g),d("__awaiter",p),d("__generator",_),d("__exportStar",S),d("__createBinding",s),d("__values",I),d("__read",N),d("__spread",j),d("__spreadArrays",C),d("__await",P),d("__asyncGenerator",M),d("__asyncDelegator",B),d("__asyncValues",G),d("__makeTemplateObject",v),d("__importStar",O),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(xr);var mn={},gr={},Bi;function kc(){if(Bi)return gr;Bi=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return gr.delay=r,gr}var Gt={},vn={},Wt={},Hi;function Yc(){return Hi||(Hi=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0,Wt.ONE_HUNDRED=100,Wt.ONE_THOUSAND=1e3),Wt}var wn={},qi;function Jc(){return qi||(qi=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(wn)),wn}var zi;function Eo(){return zi||(zi=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Yc(),r),e.__exportStar(Jc(),r)}(vn)),vn}var Ki;function Xc(){if(Ki)return Gt;Ki=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.fromMiliseconds=Gt.toMiliseconds=void 0;const r=Eo();function e(n){return n*r.ONE_THOUSAND}Gt.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Gt.fromMiliseconds=t,Gt}var Vi;function Zc(){return Vi||(Vi=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(kc(),r),e.__exportStar(Xc(),r)}(mn)),mn}var rr={},Gi;function Qc(){if(Gi)return rr;Gi=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const i=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:i})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return rr.Watch=r,rr.default=r,rr}var En={},yr={},Wi;function eu(){if(Wi)return yr;Wi=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.IWatch=void 0;class r{}return yr.IWatch=r,yr}var ki;function tu(){return ki||(ki=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),xr.exports.__exportStar(eu(),r)}(En)),En}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xr.exports;e.__exportStar(Zc(),r),e.__exportStar(Qc(),r),e.__exportStar(tu(),r),e.__exportStar(Eo(),r)})(te);var Dn={},_r={};class Xt{}const ru=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xt},Symbol.toStringTag,{value:"Module"})),nu=Tc(ru);var Yi;function iu(){if(Yi)return _r;Yi=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IHeartBeat=void 0;const r=nu;class e extends r.IEvents{constructor(n){super()}}return _r.IHeartBeat=e,_r}var Ji;function Do(){return Ji||(Ji=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(iu(),r)}(Dn)),Dn}var Sn={},kt={},Xi;function su(){if(Xi)return kt;Xi=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.HEARTBEAT_EVENTS=kt.HEARTBEAT_INTERVAL=void 0;const r=te;return kt.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,kt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},kt}var Zi;function So(){return Zi||(Zi=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),Ir.exports.__exportStar(su(),r)}(Sn)),Sn}var Qi;function ou(){if(Qi)return pr;Qi=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.HeartBeat=void 0;const r=Ir.exports,e=ot.exports,t=te,n=Do(),i=So();class f extends n.IHeartBeat{constructor(p){super(p),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=p?.interval||i.HEARTBEAT_INTERVAL}static init(p){return r.__awaiter(this,void 0,void 0,function*(){const _=new f(p);return yield _.init(),_})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,_){this.events.on(p,_)}once(p,_){this.events.once(p,_)}off(p,_){this.events.off(p,_)}removeListener(p,_){this.events.removeListener(p,_)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return pr.HeartBeat=f,pr}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Ir.exports;e.__exportStar(ou(),r),e.__exportStar(Do(),r),e.__exportStar(So(),r)})(Or);var Se={},Oo={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,n,i,f,g,p,_,S,I,N,j,C,P,M,B,G,v,O,m,E,y,s;(function(d){var $=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(o($,o(r.exports)));function o(h,l){return h!==$&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(b,a){return h[b]=l?l(b,a):a}}})(function(d){var $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var l in h)h.hasOwnProperty(l)&&(o[l]=h[l])};e=function(o,h){$(o,h);function l(){this.constructor=o}o.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)},t=Object.assign||function(o){for(var h,l=1,b=arguments.length;l<b;l++){h=arguments[l];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(o[a]=h[a])}return o},n=function(o,h){var l={};for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&h.indexOf(b)<0&&(l[b]=o[b]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,b=Object.getOwnPropertySymbols(o);a<b.length;a++)h.indexOf(b[a])<0&&Object.prototype.propertyIsEnumerable.call(o,b[a])&&(l[b[a]]=o[b[a]]);return l},i=function(o,h,l,b){var a=arguments.length,c=a<3?h:b===null?b=Object.getOwnPropertyDescriptor(h,l):b,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,h,l,b);else for(var T=o.length-1;T>=0;T--)(D=o[T])&&(c=(a<3?D(c):a>3?D(h,l,c):D(h,l))||c);return a>3&&c&&Object.defineProperty(h,l,c),c},f=function(o,h){return function(l,b){h(l,b,o)}},g=function(o,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,h)},p=function(o,h,l,b){function a(c){return c instanceof l?c:new l(function(D){D(c)})}return new(l||(l=Promise))(function(c,D){function T(R){try{w(b.next(R))}catch(K){D(K)}}function U(R){try{w(b.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(T,U)}w((b=b.apply(o,h||[])).next())})},_=function(o,h){var l={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,D;return D={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function T(w){return function(R){return U([w,R])}}function U(w){if(b)throw new TypeError("Generator is already executing.");for(;l;)try{if(b=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,a=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){l.label=w[1];break}if(w[0]===6&&l.label<c[1]){l.label=c[1],c=w;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(w);break}c[2]&&l.ops.pop(),l.trys.pop();continue}w=h.call(o,l)}catch(R){w=[6,R],a=0}finally{b=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},s=function(o,h,l,b){b===void 0&&(b=l),o[b]=h[l]},S=function(o,h){for(var l in o)l!=="default"&&!h.hasOwnProperty(l)&&(h[l]=o[l])},I=function(o){var h=typeof Symbol=="function"&&Symbol.iterator,l=h&&o[h],b=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&b>=o.length&&(o=void 0),{value:o&&o[b++],done:!o}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(o,h){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var b=l.call(o),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=b.next()).done;)c.push(a.value)}catch(T){D={error:T}}finally{try{a&&!a.done&&(l=b.return)&&l.call(b)}finally{if(D)throw D.error}}return c},j=function(){for(var o=[],h=0;h<arguments.length;h++)o=o.concat(N(arguments[h]));return o},C=function(){for(var o=0,h=0,l=arguments.length;h<l;h++)o+=arguments[h].length;for(var b=Array(o),a=0,h=0;h<l;h++)for(var c=arguments[h],D=0,T=c.length;D<T;D++,a++)b[a]=c[D];return b},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},M=function(o,h,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=l.apply(o,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){b[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||T(z,V)})})}function T(z,V){try{U(b[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof P?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){T("next",z)}function R(z){T("throw",z)}function K(z,V){z(V),c.shift(),c.length&&T(c[0][0],c[0][1])}},B=function(o){var h,l;return h={},b("next"),b("throw",function(a){throw a}),b("return"),h[Symbol.iterator]=function(){return this},h;function b(a,c){h[a]=o[a]?function(D){return(l=!l)?{value:P(o[a](D)),done:a==="return"}:c?c(D):D}:c}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o[Symbol.asyncIterator],l;return h?h.call(o):(o=typeof I=="function"?I(o):o[Symbol.iterator](),l={},b("next"),b("throw"),b("return"),l[Symbol.asyncIterator]=function(){return this},l);function b(c){l[c]=o[c]&&function(D){return new Promise(function(T,U){D=o[c](D),a(T,U,D.done,D.value)})}}function a(c,D,T,U){Promise.resolve(U).then(function(w){c({value:w,done:T})},D)}},v=function(o,h){return Object.defineProperty?Object.defineProperty(o,"raw",{value:h}):o.raw=h,o},O=function(o){if(o&&o.__esModule)return o;var h={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(h[l]=o[l]);return h.default=o,h},m=function(o){return o&&o.__esModule?o:{default:o}},E=function(o,h){if(!h.has(o))throw new TypeError("attempted to get private field on non-instance");return h.get(o)},y=function(o,h,l){if(!h.has(o))throw new TypeError("attempted to set private field on non-instance");return h.set(o,l),l},d("__extends",e),d("__assign",t),d("__rest",n),d("__decorate",i),d("__param",f),d("__metadata",g),d("__awaiter",p),d("__generator",_),d("__exportStar",S),d("__createBinding",s),d("__values",I),d("__read",N),d("__spread",j),d("__spreadArrays",C),d("__await",P),d("__asyncGenerator",M),d("__asyncDelegator",B),d("__asyncValues",G),d("__makeTemplateObject",v),d("__importStar",O),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(Oo);var Yt={},es;function Io(){return es||(es=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PINO_CUSTOM_CONTEXT_KEY=Yt.PINO_LOGGER_DEFAULTS=void 0,Yt.PINO_LOGGER_DEFAULTS={level:"info"},Yt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Yt}var at={},ts;function au(){if(ts)return at;ts=1,Object.defineProperty(at,"__esModule",{value:!0}),at.generateChildLogger=at.formatChildLoggerContext=at.getLoggerContext=at.setBrowserLoggerContext=at.getBrowserLoggerContext=at.getDefaultLoggerOptions=void 0;const r=Io();function e(p){return Object.assign(Object.assign({},p),{level:p?.level||r.PINO_LOGGER_DEFAULTS.level})}at.getDefaultLoggerOptions=e;function t(p,_=r.PINO_CUSTOM_CONTEXT_KEY){return p[_]||""}at.getBrowserLoggerContext=t;function n(p,_,S=r.PINO_CUSTOM_CONTEXT_KEY){return p[S]=_,p}at.setBrowserLoggerContext=n;function i(p,_=r.PINO_CUSTOM_CONTEXT_KEY){let S="";return typeof p.bindings>"u"?S=t(p,_):S=p.bindings().context||"",S}at.getLoggerContext=i;function f(p,_,S=r.PINO_CUSTOM_CONTEXT_KEY){const I=i(p,S);return I.trim()?`${I}/${_}`:_}at.formatChildLoggerContext=f;function g(p,_,S=r.PINO_CUSTOM_CONTEXT_KEY){const I=f(p,_,S),N=p.child({context:I});return n(N,I,S)}return at.generateChildLogger=g,at}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;const e=Oo.exports,t=e.__importDefault(fo());Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Io(),r),e.__exportStar(au(),r)})(Se);class cu extends Xt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class uu extends Xt{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class hu{constructor(e,t){this.logger=e,this.core=t}}class fu extends Xt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class lu extends Xt{constructor(e){super()}}class du{constructor(e,t,n,i){this.core=e,this.logger=t,this.name=n}}class pu extends Xt{constructor(e,t){super(),this.relayer=e,this.logger=t}}class gu extends Xt{constructor(e,t){super(),this.core=e,this.logger=t}}class yu{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class _u{constructor(e){this.client=e}}function bu(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function mu(r){return typeof r=="string"?r:JSON.stringify(r)}var Qn={},sr={},tn={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});rn.BrowserRandomSource=void 0;const rs=65536;class vu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let n=0;n<t.length;n+=rs)this._crypto.getRandomValues(t.subarray(n,n+Math.min(t.length-n,rs)));return t}}rn.BrowserRandomSource=vu;function wu(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nn={},gt={};Object.defineProperty(gt,"__esModule",{value:!0});function Eu(r){for(var e=0;e<r.length;e++)r[e]=0;return r}gt.wipe=Eu;Object.defineProperty(nn,"__esModule",{value:!0});nn.NodeRandomSource=void 0;const Du=gt;class Su{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof wu<"u"){const e=Ac;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=t[i];return(0,Du.wipe)(t),n}}nn.NodeRandomSource=Su;Object.defineProperty(tn,"__esModule",{value:!0});tn.SystemRandomSource=void 0;const Ou=rn,Iu=nn;class xu{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ou.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Iu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}tn.SystemRandomSource=xu;var ie={},xo={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(p,_){var S=p>>>16&65535,I=p&65535,N=_>>>16&65535,j=_&65535;return I*j+(S*j+I*N<<16>>>0)|0}r.mul=Math.imul||e;function t(p,_){return p+_|0}r.add=t;function n(p,_){return p-_|0}r.sub=n;function i(p,_){return p<<_|p>>>32-_}r.rotl=i;function f(p,_){return p<<32-_|p>>>_}r.rotr=f;function g(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p}r.isInteger=Number.isInteger||g,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(p){return r.isInteger(p)&&p>=-r.MAX_SAFE_INTEGER&&p<=r.MAX_SAFE_INTEGER}})(xo);Object.defineProperty(ie,"__esModule",{value:!0});var Po=xo;function Pu(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}ie.readInt16BE=Pu;function Tu(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}ie.readUint16BE=Tu;function Au(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}ie.readInt16LE=Au;function Nu(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}ie.readUint16LE=Nu;function To(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}ie.writeUint16BE=To;ie.writeInt16BE=To;function Ao(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}ie.writeUint16LE=Ao;ie.writeInt16LE=Ao;function Rn(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}ie.readInt32BE=Rn;function Fn(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}ie.readUint32BE=Fn;function Ln(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}ie.readInt32LE=Ln;function Un(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}ie.readUint32LE=Un;function kr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}ie.writeUint32BE=kr;ie.writeInt32BE=kr;function Yr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}ie.writeUint32LE=Yr;ie.writeInt32LE=Yr;function Cu(r,e){e===void 0&&(e=0);var t=Rn(r,e),n=Rn(r,e+4);return t*4294967296+n-(n>>31)*4294967296}ie.readInt64BE=Cu;function Ru(r,e){e===void 0&&(e=0);var t=Fn(r,e),n=Fn(r,e+4);return t*4294967296+n}ie.readUint64BE=Ru;function Fu(r,e){e===void 0&&(e=0);var t=Ln(r,e),n=Ln(r,e+4);return n*4294967296+t-(t>>31)*4294967296}ie.readInt64LE=Fu;function Lu(r,e){e===void 0&&(e=0);var t=Un(r,e),n=Un(r,e+4);return n*4294967296+t}ie.readUint64LE=Lu;function No(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),kr(r/4294967296>>>0,e,t),kr(r>>>0,e,t+4),e}ie.writeUint64BE=No;ie.writeInt64BE=No;function Co(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Yr(r>>>0,e,t),Yr(r/4294967296>>>0,e,t+4),e}ie.writeUint64LE=Co;ie.writeInt64LE=Co;function Uu(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,f=r/8+t-1;f>=t;f--)n+=e[f]*i,i*=256;return n}ie.readUintBE=Uu;function ju(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,f=t;f<t+r/8;f++)n+=e[f]*i,i*=256;return n}ie.readUintLE=ju;function Mu(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Po.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,f=r/8+n-1;f>=n;f--)t[f]=e/i&255,i*=256;return t}ie.writeUintBE=Mu;function $u(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Po.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,f=n;f<n+r/8;f++)t[f]=e/i&255,i*=256;return t}ie.writeUintLE=$u;function Bu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}ie.readFloat32BE=Bu;function Hu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}ie.readFloat32LE=Hu;function qu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}ie.readFloat64BE=qu;function zu(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}ie.readFloat64LE=zu;function Ku(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r),e}ie.writeFloat32BE=Ku;function Vu(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r,!0),e}ie.writeFloat32LE=Vu;function Gu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r),e}ie.writeFloat64BE=Gu;function Wu(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r,!0),e}ie.writeFloat64LE=Wu;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=tn,t=ie,n=gt;r.defaultRandomSource=new e.SystemRandomSource;function i(S,I=r.defaultRandomSource){return I.randomBytes(S)}r.randomBytes=i;function f(S=r.defaultRandomSource){const I=i(4,S),N=(0,t.readUint32LE)(I);return(0,n.wipe)(I),N}r.randomUint32=f;const g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function p(S,I=g,N=r.defaultRandomSource){if(I.length<2)throw new Error("randomString charset is too short");if(I.length>256)throw new Error("randomString charset is too long");let j="";const C=I.length,P=256-256%C;for(;S>0;){const M=i(Math.ceil(S*256/P),N);for(let B=0;B<M.length&&S>0;B++){const G=M[B];G<P&&(j+=I.charAt(G%C),S--)}(0,n.wipe)(M)}return j}r.randomString=p;function _(S,I=g,N=r.defaultRandomSource){const j=Math.ceil(S/(Math.log(I.length)/Math.LN2));return p(j,I,N)}r.randomStringForEntropy=_})(sr);var Ro={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=gt;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var n=function(){function p(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(_,S){if(S===void 0&&(S=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&S>0;)this._buffer[this._bufferLength++]=_[I++],S--;this._bufferLength===this.blockSize&&(f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(I=f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,I,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=_[I++],S--;return this},p.prototype.finish=function(_){if(!this._finished){var S=this._bytesHashed,I=this._bufferLength,N=S/536870912|0,j=S<<3,C=S%128<112?128:256;this._buffer[I]=128;for(var P=I+1;P<C-8;P++)this._buffer[P]=0;e.writeUint32BE(N,this._buffer,C-8),e.writeUint32BE(j,this._buffer,C-4),f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,C),this._finished=!0}for(var P=0;P<this.digestLength/8;P++)e.writeUint32BE(this._stateHi[P],_,P*8),e.writeUint32BE(this._stateLo[P],_,P*8+4);return this},p.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},p}();r.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function f(p,_,S,I,N,j,C){for(var P=S[0],M=S[1],B=S[2],G=S[3],v=S[4],O=S[5],m=S[6],E=S[7],y=I[0],s=I[1],d=I[2],$=I[3],o=I[4],h=I[5],l=I[6],b=I[7],a,c,D,T,U,w,R,K;C>=128;){for(var z=0;z<16;z++){var V=8*z+j;p[z]=e.readUint32BE(N,V),_[z]=e.readUint32BE(N,V+4)}for(var z=0;z<80;z++){var X=P,Y=M,ee=B,q=G,H=v,F=O,u=m,A=E,k=y,Z=s,fe=d,_e=$,de=o,ve=h,Ue=l,Ce=b;if(a=E,c=b,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=(v>>>14|o<<32-14)^(v>>>18|o<<32-18)^(o>>>41-32|v<<32-(41-32)),c=(o>>>14|v<<32-14)^(o>>>18|v<<32-18)^(v>>>41-32|o<<32-(41-32)),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=v&O^~v&m,c=o&h^~o&l,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=i[z*2],c=i[z*2+1],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=p[z%16],c=_[z%16],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,D=R&65535|K<<16,T=U&65535|w<<16,a=D,c=T,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=(P>>>28|y<<32-28)^(y>>>34-32|P<<32-(34-32))^(y>>>39-32|P<<32-(39-32)),c=(y>>>28|P<<32-28)^(P>>>34-32|y<<32-(34-32))^(P>>>39-32|y<<32-(39-32)),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,a=P&M^P&B^M&B,c=y&s^y&d^s&d,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,A=R&65535|K<<16,Ce=U&65535|w<<16,a=q,c=_e,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=D,c=T,U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,q=R&65535|K<<16,_e=U&65535|w<<16,M=X,B=Y,G=ee,v=q,O=H,m=F,E=u,P=A,s=k,d=Z,$=fe,o=_e,h=de,l=ve,b=Ue,y=Ce,z%16===15)for(var V=0;V<16;V++)a=p[V],c=_[V],U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=p[(V+9)%16],c=_[(V+9)%16],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,D=p[(V+1)%16],T=_[(V+1)%16],a=(D>>>1|T<<32-1)^(D>>>8|T<<32-8)^D>>>7,c=(T>>>1|D<<32-1)^(T>>>8|D<<32-8)^(T>>>7|D<<32-7),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,D=p[(V+14)%16],T=_[(V+14)%16],a=(D>>>19|T<<32-19)^(T>>>61-32|D<<32-(61-32))^D>>>6,c=(T>>>19|D<<32-19)^(D>>>61-32|T<<32-(61-32))^(T>>>6|D<<32-6),U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,p[V]=R&65535|K<<16,_[V]=U&65535|w<<16}a=P,c=y,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[0],c=I[0],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[0]=P=R&65535|K<<16,I[0]=y=U&65535|w<<16,a=M,c=s,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[1],c=I[1],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[1]=M=R&65535|K<<16,I[1]=s=U&65535|w<<16,a=B,c=d,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[2],c=I[2],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[2]=B=R&65535|K<<16,I[2]=d=U&65535|w<<16,a=G,c=$,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[3],c=I[3],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[3]=G=R&65535|K<<16,I[3]=$=U&65535|w<<16,a=v,c=o,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[4],c=I[4],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[4]=v=R&65535|K<<16,I[4]=o=U&65535|w<<16,a=O,c=h,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[5],c=I[5],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[5]=O=R&65535|K<<16,I[5]=h=U&65535|w<<16,a=m,c=l,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[6],c=I[6],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[6]=m=R&65535|K<<16,I[6]=l=U&65535|w<<16,a=E,c=b,U=c&65535,w=c>>>16,R=a&65535,K=a>>>16,a=S[7],c=I[7],U+=c&65535,w+=c>>>16,R+=a&65535,K+=a>>>16,w+=U>>>16,R+=w>>>16,K+=R>>>16,S[7]=E=R&65535|K<<16,I[7]=b=U&65535|w<<16,j+=128,C-=128}return j}function g(p){var _=new n;_.update(p);var S=_.digest();return _.clean(),S}r.hash=g})(Ro);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=sr,t=Ro,n=gt;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function i(q){const H=new Float64Array(16);if(q)for(let F=0;F<q.length;F++)H[F]=q[F];return H}const f=new Uint8Array(32);f[0]=9;const g=i(),p=i([1]),_=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),S=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function C(q,H){for(let F=0;F<16;F++)q[F]=H[F]|0}function P(q){let H=1;for(let F=0;F<16;F++){let u=q[F]+H+65535;H=Math.floor(u/65536),q[F]=u-H*65536}q[0]+=H-1+37*(H-1)}function M(q,H,F){const u=~(F-1);for(let A=0;A<16;A++){const k=u&(q[A]^H[A]);q[A]^=k,H[A]^=k}}function B(q,H){const F=i(),u=i();for(let A=0;A<16;A++)u[A]=H[A];P(u),P(u),P(u);for(let A=0;A<2;A++){F[0]=u[0]-65517;for(let Z=1;Z<15;Z++)F[Z]=u[Z]-65535-(F[Z-1]>>16&1),F[Z-1]&=65535;F[15]=u[15]-32767-(F[14]>>16&1);const k=F[15]>>16&1;F[14]&=65535,M(u,F,1-k)}for(let A=0;A<16;A++)q[2*A]=u[A]&255,q[2*A+1]=u[A]>>8}function G(q,H){let F=0;for(let u=0;u<32;u++)F|=q[u]^H[u];return(1&F-1>>>8)-1}function v(q,H){const F=new Uint8Array(32),u=new Uint8Array(32);return B(F,q),B(u,H),G(F,u)}function O(q){const H=new Uint8Array(32);return B(H,q),H[0]&1}function m(q,H){for(let F=0;F<16;F++)q[F]=H[2*F]+(H[2*F+1]<<8);q[15]&=32767}function E(q,H,F){for(let u=0;u<16;u++)q[u]=H[u]+F[u]}function y(q,H,F){for(let u=0;u<16;u++)q[u]=H[u]-F[u]}function s(q,H,F){let u,A,k=0,Z=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=0,pe=0,le=0,ue=0,ce=0,ae=0,oe=0,re=0,he=0,ge=0,ne=0,be=0,me=0,Ee=0,De=0,we=0,vt=0,Dt=0,Rt=0,dt=0,qt=0,cr=0,Lr=0,Me=F[0],Re=F[1],$e=F[2],Be=F[3],He=F[4],Fe=F[5],Ke=F[6],Ve=F[7],Ge=F[8],We=F[9],ke=F[10],ze=F[11],qe=F[12],Te=F[13],Ye=F[14],Je=F[15];u=H[0],k+=u*Me,Z+=u*Re,fe+=u*$e,_e+=u*Be,de+=u*He,ve+=u*Fe,Ue+=u*Ke,Ce+=u*Ve,ye+=u*Ge,pe+=u*We,le+=u*ke,ue+=u*ze,ce+=u*qe,ae+=u*Te,oe+=u*Ye,re+=u*Je,u=H[1],Z+=u*Me,fe+=u*Re,_e+=u*$e,de+=u*Be,ve+=u*He,Ue+=u*Fe,Ce+=u*Ke,ye+=u*Ve,pe+=u*Ge,le+=u*We,ue+=u*ke,ce+=u*ze,ae+=u*qe,oe+=u*Te,re+=u*Ye,he+=u*Je,u=H[2],fe+=u*Me,_e+=u*Re,de+=u*$e,ve+=u*Be,Ue+=u*He,Ce+=u*Fe,ye+=u*Ke,pe+=u*Ve,le+=u*Ge,ue+=u*We,ce+=u*ke,ae+=u*ze,oe+=u*qe,re+=u*Te,he+=u*Ye,ge+=u*Je,u=H[3],_e+=u*Me,de+=u*Re,ve+=u*$e,Ue+=u*Be,Ce+=u*He,ye+=u*Fe,pe+=u*Ke,le+=u*Ve,ue+=u*Ge,ce+=u*We,ae+=u*ke,oe+=u*ze,re+=u*qe,he+=u*Te,ge+=u*Ye,ne+=u*Je,u=H[4],de+=u*Me,ve+=u*Re,Ue+=u*$e,Ce+=u*Be,ye+=u*He,pe+=u*Fe,le+=u*Ke,ue+=u*Ve,ce+=u*Ge,ae+=u*We,oe+=u*ke,re+=u*ze,he+=u*qe,ge+=u*Te,ne+=u*Ye,be+=u*Je,u=H[5],ve+=u*Me,Ue+=u*Re,Ce+=u*$e,ye+=u*Be,pe+=u*He,le+=u*Fe,ue+=u*Ke,ce+=u*Ve,ae+=u*Ge,oe+=u*We,re+=u*ke,he+=u*ze,ge+=u*qe,ne+=u*Te,be+=u*Ye,me+=u*Je,u=H[6],Ue+=u*Me,Ce+=u*Re,ye+=u*$e,pe+=u*Be,le+=u*He,ue+=u*Fe,ce+=u*Ke,ae+=u*Ve,oe+=u*Ge,re+=u*We,he+=u*ke,ge+=u*ze,ne+=u*qe,be+=u*Te,me+=u*Ye,Ee+=u*Je,u=H[7],Ce+=u*Me,ye+=u*Re,pe+=u*$e,le+=u*Be,ue+=u*He,ce+=u*Fe,ae+=u*Ke,oe+=u*Ve,re+=u*Ge,he+=u*We,ge+=u*ke,ne+=u*ze,be+=u*qe,me+=u*Te,Ee+=u*Ye,De+=u*Je,u=H[8],ye+=u*Me,pe+=u*Re,le+=u*$e,ue+=u*Be,ce+=u*He,ae+=u*Fe,oe+=u*Ke,re+=u*Ve,he+=u*Ge,ge+=u*We,ne+=u*ke,be+=u*ze,me+=u*qe,Ee+=u*Te,De+=u*Ye,we+=u*Je,u=H[9],pe+=u*Me,le+=u*Re,ue+=u*$e,ce+=u*Be,ae+=u*He,oe+=u*Fe,re+=u*Ke,he+=u*Ve,ge+=u*Ge,ne+=u*We,be+=u*ke,me+=u*ze,Ee+=u*qe,De+=u*Te,we+=u*Ye,vt+=u*Je,u=H[10],le+=u*Me,ue+=u*Re,ce+=u*$e,ae+=u*Be,oe+=u*He,re+=u*Fe,he+=u*Ke,ge+=u*Ve,ne+=u*Ge,be+=u*We,me+=u*ke,Ee+=u*ze,De+=u*qe,we+=u*Te,vt+=u*Ye,Dt+=u*Je,u=H[11],ue+=u*Me,ce+=u*Re,ae+=u*$e,oe+=u*Be,re+=u*He,he+=u*Fe,ge+=u*Ke,ne+=u*Ve,be+=u*Ge,me+=u*We,Ee+=u*ke,De+=u*ze,we+=u*qe,vt+=u*Te,Dt+=u*Ye,Rt+=u*Je,u=H[12],ce+=u*Me,ae+=u*Re,oe+=u*$e,re+=u*Be,he+=u*He,ge+=u*Fe,ne+=u*Ke,be+=u*Ve,me+=u*Ge,Ee+=u*We,De+=u*ke,we+=u*ze,vt+=u*qe,Dt+=u*Te,Rt+=u*Ye,dt+=u*Je,u=H[13],ae+=u*Me,oe+=u*Re,re+=u*$e,he+=u*Be,ge+=u*He,ne+=u*Fe,be+=u*Ke,me+=u*Ve,Ee+=u*Ge,De+=u*We,we+=u*ke,vt+=u*ze,Dt+=u*qe,Rt+=u*Te,dt+=u*Ye,qt+=u*Je,u=H[14],oe+=u*Me,re+=u*Re,he+=u*$e,ge+=u*Be,ne+=u*He,be+=u*Fe,me+=u*Ke,Ee+=u*Ve,De+=u*Ge,we+=u*We,vt+=u*ke,Dt+=u*ze,Rt+=u*qe,dt+=u*Te,qt+=u*Ye,cr+=u*Je,u=H[15],re+=u*Me,he+=u*Re,ge+=u*$e,ne+=u*Be,be+=u*He,me+=u*Fe,Ee+=u*Ke,De+=u*Ve,we+=u*Ge,vt+=u*We,Dt+=u*ke,Rt+=u*ze,dt+=u*qe,qt+=u*Te,cr+=u*Ye,Lr+=u*Je,k+=38*he,Z+=38*ge,fe+=38*ne,_e+=38*be,de+=38*me,ve+=38*Ee,Ue+=38*De,Ce+=38*we,ye+=38*vt,pe+=38*Dt,le+=38*Rt,ue+=38*dt,ce+=38*qt,ae+=38*cr,oe+=38*Lr,A=1,u=k+A+65535,A=Math.floor(u/65536),k=u-A*65536,u=Z+A+65535,A=Math.floor(u/65536),Z=u-A*65536,u=fe+A+65535,A=Math.floor(u/65536),fe=u-A*65536,u=_e+A+65535,A=Math.floor(u/65536),_e=u-A*65536,u=de+A+65535,A=Math.floor(u/65536),de=u-A*65536,u=ve+A+65535,A=Math.floor(u/65536),ve=u-A*65536,u=Ue+A+65535,A=Math.floor(u/65536),Ue=u-A*65536,u=Ce+A+65535,A=Math.floor(u/65536),Ce=u-A*65536,u=ye+A+65535,A=Math.floor(u/65536),ye=u-A*65536,u=pe+A+65535,A=Math.floor(u/65536),pe=u-A*65536,u=le+A+65535,A=Math.floor(u/65536),le=u-A*65536,u=ue+A+65535,A=Math.floor(u/65536),ue=u-A*65536,u=ce+A+65535,A=Math.floor(u/65536),ce=u-A*65536,u=ae+A+65535,A=Math.floor(u/65536),ae=u-A*65536,u=oe+A+65535,A=Math.floor(u/65536),oe=u-A*65536,u=re+A+65535,A=Math.floor(u/65536),re=u-A*65536,k+=A-1+37*(A-1),A=1,u=k+A+65535,A=Math.floor(u/65536),k=u-A*65536,u=Z+A+65535,A=Math.floor(u/65536),Z=u-A*65536,u=fe+A+65535,A=Math.floor(u/65536),fe=u-A*65536,u=_e+A+65535,A=Math.floor(u/65536),_e=u-A*65536,u=de+A+65535,A=Math.floor(u/65536),de=u-A*65536,u=ve+A+65535,A=Math.floor(u/65536),ve=u-A*65536,u=Ue+A+65535,A=Math.floor(u/65536),Ue=u-A*65536,u=Ce+A+65535,A=Math.floor(u/65536),Ce=u-A*65536,u=ye+A+65535,A=Math.floor(u/65536),ye=u-A*65536,u=pe+A+65535,A=Math.floor(u/65536),pe=u-A*65536,u=le+A+65535,A=Math.floor(u/65536),le=u-A*65536,u=ue+A+65535,A=Math.floor(u/65536),ue=u-A*65536,u=ce+A+65535,A=Math.floor(u/65536),ce=u-A*65536,u=ae+A+65535,A=Math.floor(u/65536),ae=u-A*65536,u=oe+A+65535,A=Math.floor(u/65536),oe=u-A*65536,u=re+A+65535,A=Math.floor(u/65536),re=u-A*65536,k+=A-1+37*(A-1),q[0]=k,q[1]=Z,q[2]=fe,q[3]=_e,q[4]=de,q[5]=ve,q[6]=Ue,q[7]=Ce,q[8]=ye,q[9]=pe,q[10]=le,q[11]=ue,q[12]=ce,q[13]=ae,q[14]=oe,q[15]=re}function d(q,H){s(q,H,H)}function $(q,H){const F=i();let u;for(u=0;u<16;u++)F[u]=H[u];for(u=253;u>=0;u--)d(F,F),u!==2&&u!==4&&s(F,F,H);for(u=0;u<16;u++)q[u]=F[u]}function o(q,H){const F=i();let u;for(u=0;u<16;u++)F[u]=H[u];for(u=250;u>=0;u--)d(F,F),u!==1&&s(F,F,H);for(u=0;u<16;u++)q[u]=F[u]}function h(q,H){const F=i(),u=i(),A=i(),k=i(),Z=i(),fe=i(),_e=i(),de=i(),ve=i();y(F,q[1],q[0]),y(ve,H[1],H[0]),s(F,F,ve),E(u,q[0],q[1]),E(ve,H[0],H[1]),s(u,u,ve),s(A,q[3],H[3]),s(A,A,S),s(k,q[2],H[2]),E(k,k,k),y(Z,u,F),y(fe,k,A),E(_e,k,A),E(de,u,F),s(q[0],Z,fe),s(q[1],de,_e),s(q[2],_e,fe),s(q[3],Z,de)}function l(q,H,F){for(let u=0;u<4;u++)M(q[u],H[u],F)}function b(q,H){const F=i(),u=i(),A=i();$(A,H[2]),s(F,H[0],A),s(u,H[1],A),B(q,u),q[31]^=O(F)<<7}function a(q,H,F){C(q[0],g),C(q[1],p),C(q[2],p),C(q[3],g);for(let u=255;u>=0;--u){const A=F[u/8|0]>>(u&7)&1;l(q,H,A),h(H,q),h(q,q),l(q,H,A)}}function c(q,H){const F=[i(),i(),i(),i()];C(F[0],I),C(F[1],N),C(F[2],p),s(F[3],I,N),a(q,F,H)}function D(q){if(q.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const H=(0,t.hash)(q);H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(32),u=[i(),i(),i(),i()];c(u,H),b(F,u);const A=new Uint8Array(64);return A.set(q),A.set(F,32),{publicKey:F,secretKey:A}}r.generateKeyPairFromSeed=D;function T(q){const H=(0,e.randomBytes)(32,q),F=D(H);return(0,n.wipe)(H),F}r.generateKeyPair=T;function U(q){if(q.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}r.extractPublicKeyFromSecretKey=U;const w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function R(q,H){let F,u,A,k;for(u=63;u>=32;--u){for(F=0,A=u-32,k=u-12;A<k;++A)H[A]+=F-16*H[u]*w[A-(u-32)],F=Math.floor((H[A]+128)/256),H[A]-=F*256;H[A]+=F,H[u]=0}for(F=0,A=0;A<32;A++)H[A]+=F-(H[31]>>4)*w[A],F=H[A]>>8,H[A]&=255;for(A=0;A<32;A++)H[A]-=F*w[A];for(u=0;u<32;u++)H[u+1]+=H[u]>>8,q[u]=H[u]&255}function K(q){const H=new Float64Array(64);for(let F=0;F<64;F++)H[F]=q[F];for(let F=0;F<64;F++)q[F]=0;R(q,H)}function z(q,H){const F=new Float64Array(64),u=[i(),i(),i(),i()],A=(0,t.hash)(q.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const k=new Uint8Array(64);k.set(A.subarray(32),32);const Z=new t.SHA512;Z.update(k.subarray(32)),Z.update(H);const fe=Z.digest();Z.clean(),K(fe),c(u,fe),b(k,u),Z.reset(),Z.update(k.subarray(0,32)),Z.update(q.subarray(32)),Z.update(H);const _e=Z.digest();K(_e);for(let de=0;de<32;de++)F[de]=fe[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)F[de+ve]+=_e[de]*A[ve];return R(k.subarray(32),F),k}r.sign=z;function V(q,H){const F=i(),u=i(),A=i(),k=i(),Z=i(),fe=i(),_e=i();return C(q[2],p),m(q[1],H),d(A,q[1]),s(k,A,_),y(A,A,q[2]),E(k,q[2],k),d(Z,k),d(fe,Z),s(_e,fe,Z),s(F,_e,A),s(F,F,k),o(F,F),s(F,F,A),s(F,F,k),s(F,F,k),s(q[0],F,k),d(u,q[0]),s(u,u,k),v(u,A)&&s(q[0],q[0],j),d(u,q[0]),s(u,u,k),v(u,A)?-1:(O(q[0])===H[31]>>7&&y(q[0],g,q[0]),s(q[3],q[0],q[1]),0)}function X(q,H,F){const u=new Uint8Array(32),A=[i(),i(),i(),i()],k=[i(),i(),i(),i()];if(F.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(V(k,q))return!1;const Z=new t.SHA512;Z.update(F.subarray(0,32)),Z.update(q),Z.update(H);const fe=Z.digest();return K(fe),a(A,k,fe),c(k,F.subarray(32)),h(A,k),b(u,A),!G(F,u)}r.verify=X;function Y(q){let H=[i(),i(),i(),i()];if(V(H,q))throw new Error("Ed25519: invalid public key");let F=i(),u=i(),A=H[1];E(F,p,A),y(u,p,A),$(u,u),s(F,F,u);let k=new Uint8Array(32);return B(k,F),k}r.convertPublicKeyToX25519=Y;function ee(q){const H=(0,t.hash)(q.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(H.subarray(0,32));return(0,n.wipe)(H),F}r.convertSecretKeyToX25519=ee})(Qn);const ku="EdDSA",Yu="JWT",Fo=".",Lo="base64url",Ju="utf8",Xu="utf8",Zu=":",Qu="did",eh="key",ns="base58btc",th="z",rh="K36",nh=32;function Uo(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function jn(r,e){e||(e=r.reduce((i,f)=>i+f.length,0));const t=Uo(e);let n=0;for(const i of r)t.set(i,n),n+=i.length;return t}function ih(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var f=r.charAt(i),g=f.charCodeAt(0);if(t[g]!==255)throw new TypeError(f+" is ambiguous");t[g]=i}var p=r.length,_=r.charAt(0),S=Math.log(p)/Math.log(256),I=Math.log(256)/Math.log(p);function N(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var M=0,B=0,G=0,v=P.length;G!==v&&P[G]===0;)G++,M++;for(var O=(v-G)*I+1>>>0,m=new Uint8Array(O);G!==v;){for(var E=P[G],y=0,s=O-1;(E!==0||y<B)&&s!==-1;s--,y++)E+=256*m[s]>>>0,m[s]=E%p>>>0,E=E/p>>>0;if(E!==0)throw new Error("Non-zero carry");B=y,G++}for(var d=O-B;d!==O&&m[d]===0;)d++;for(var $=_.repeat(M);d<O;++d)$+=r.charAt(m[d]);return $}function j(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var M=0;if(P[M]!==" "){for(var B=0,G=0;P[M]===_;)B++,M++;for(var v=(P.length-M)*S+1>>>0,O=new Uint8Array(v);P[M];){var m=t[P.charCodeAt(M)];if(m===255)return;for(var E=0,y=v-1;(m!==0||E<G)&&y!==-1;y--,E++)m+=p*O[y]>>>0,O[y]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");G=E,M++}if(P[M]!==" "){for(var s=v-G;s!==v&&O[s]===0;)s++;for(var d=new Uint8Array(B+(v-s)),$=B;s!==v;)d[$++]=O[s++];return d}}}function C(P){var M=j(P);if(M)return M;throw new Error(`Non-${e} character`)}return{encode:N,decodeUnsafe:j,decode:C}}var sh=ih,oh=sh;const jo=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},ah=r=>new TextEncoder().encode(r),ch=r=>new TextDecoder().decode(r);class uh{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hh{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Mo(this,e)}}class fh{constructor(e){this.decoders=e}or(e){return Mo(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Mo=(r,e)=>new fh({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class lh{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new uh(e,t,n),this.decoder=new hh(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const sn=({name:r,prefix:e,encode:t,decode:n})=>new lh(r,e,t,n),Pr=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=oh(t,e);return sn({prefix:r,name:e,encode:n,decode:f=>jo(i(f))})},dh=(r,e,t,n)=>{const i={};for(let I=0;I<e.length;++I)i[e[I]]=I;let f=r.length;for(;r[f-1]==="=";)--f;const g=new Uint8Array(f*t/8|0);let p=0,_=0,S=0;for(let I=0;I<f;++I){const N=i[r[I]];if(N===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<t|N,p+=t,p>=8&&(p-=8,g[S++]=255&_>>p)}if(p>=t||255&_<<8-p)throw new SyntaxError("Unexpected end of data");return g},ph=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let f="",g=0,p=0;for(let _=0;_<r.length;++_)for(p=p<<8|r[_],g+=8;g>t;)g-=t,f+=e[i&p>>g];if(g&&(f+=e[i&p<<t-g]),n)for(;f.length*t&7;)f+="=";return f},rt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>sn({prefix:e,name:r,encode(i){return ph(i,n,t)},decode(i){return dh(i,n,t,r)}}),gh=sn({prefix:"\0",name:"identity",encode:r=>ch(r),decode:r=>ah(r)}),yh=Object.freeze(Object.defineProperty({__proto__:null,identity:gh},Symbol.toStringTag,{value:"Module"})),_h=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),bh=Object.freeze(Object.defineProperty({__proto__:null,base2:_h},Symbol.toStringTag,{value:"Module"})),mh=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),vh=Object.freeze(Object.defineProperty({__proto__:null,base8:mh},Symbol.toStringTag,{value:"Module"})),wh=Pr({prefix:"9",name:"base10",alphabet:"0123456789"}),Eh=Object.freeze(Object.defineProperty({__proto__:null,base10:wh},Symbol.toStringTag,{value:"Module"})),Dh=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sh=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Oh=Object.freeze(Object.defineProperty({__proto__:null,base16:Dh,base16upper:Sh},Symbol.toStringTag,{value:"Module"})),Ih=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xh=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ph=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Th=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ah=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Nh=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ch=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rh=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fh=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Lh=Object.freeze(Object.defineProperty({__proto__:null,base32:Ih,base32upper:xh,base32pad:Ph,base32padupper:Th,base32hex:Ah,base32hexupper:Nh,base32hexpad:Ch,base32hexpadupper:Rh,base32z:Fh},Symbol.toStringTag,{value:"Module"})),Uh=Pr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jh=Pr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Mh=Object.freeze(Object.defineProperty({__proto__:null,base36:Uh,base36upper:jh},Symbol.toStringTag,{value:"Module"})),$h=Pr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Bh=Pr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Hh=Object.freeze(Object.defineProperty({__proto__:null,base58btc:$h,base58flickr:Bh},Symbol.toStringTag,{value:"Module"})),qh=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zh=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kh=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vh=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Gh=Object.freeze(Object.defineProperty({__proto__:null,base64:qh,base64pad:zh,base64url:Kh,base64urlpad:Vh},Symbol.toStringTag,{value:"Module"})),$o=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Wh=$o.reduce((r,e,t)=>(r[t]=e,r),[]),kh=$o.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Yh(r){return r.reduce((e,t)=>(e+=Wh[t],e),"")}function Jh(r){const e=[];for(const t of r){const n=kh[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const Xh=sn({prefix:"\u{1F680}",name:"base256emoji",encode:Yh,decode:Jh}),Zh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Xh},Symbol.toStringTag,{value:"Module"}));var Qh=Bo,is=128,ef=127,tf=~ef,rf=Math.pow(2,31);function Bo(r,e,t){e=e||[],t=t||0;for(var n=t;r>=rf;)e[t++]=r&255|is,r/=128;for(;r&tf;)e[t++]=r&255|is,r>>>=7;return e[t]=r|0,Bo.bytes=t-n+1,e}var nf=Mn,sf=128,ss=127;function Mn(r,n){var t=0,n=n||0,i=0,f=n,g,p=r.length;do{if(f>=p)throw Mn.bytes=0,new RangeError("Could not decode varint");g=r[f++],t+=i<28?(g&ss)<<i:(g&ss)*Math.pow(2,i),i+=7}while(g>=sf);return Mn.bytes=f-n,t}var of=Math.pow(2,7),af=Math.pow(2,14),cf=Math.pow(2,21),uf=Math.pow(2,28),hf=Math.pow(2,35),ff=Math.pow(2,42),lf=Math.pow(2,49),df=Math.pow(2,56),pf=Math.pow(2,63),gf=function(r){return r<of?1:r<af?2:r<cf?3:r<uf?4:r<hf?5:r<ff?6:r<lf?7:r<df?8:r<pf?9:10},yf={encode:Qh,decode:nf,encodingLength:gf},Ho=yf;const os=(r,e,t=0)=>(Ho.encode(r,e,t),e),as=r=>Ho.encodingLength(r),$n=(r,e)=>{const t=e.byteLength,n=as(r),i=n+as(t),f=new Uint8Array(i+t);return os(r,f,0),os(t,f,n),f.set(e,i),new _f(r,t,e,f)};class _f{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const qo=({name:r,code:e,encode:t})=>new bf(r,e,t);class bf{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$n(this.code,t):t.then(n=>$n(this.code,n))}else throw Error("Unknown type, must be binary type")}}const zo=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),mf=qo({name:"sha2-256",code:18,encode:zo("SHA-256")}),vf=qo({name:"sha2-512",code:19,encode:zo("SHA-512")}),wf=Object.freeze(Object.defineProperty({__proto__:null,sha256:mf,sha512:vf},Symbol.toStringTag,{value:"Module"})),Ko=0,Ef="identity",Vo=jo,Df=r=>$n(Ko,Vo(r)),Sf={code:Ko,name:Ef,encode:Vo,digest:Df},Of=Object.freeze(Object.defineProperty({__proto__:null,identity:Sf},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const cs={...yh,...bh,...vh,...Eh,...Oh,...Lh,...Mh,...Hh,...Gh,...Zh};({...wf,...Of});function Go(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const us=Go("utf8","u",r=>{const e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),On=Go("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Uo(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Wo={utf8:us,"utf-8":us,hex:cs.base16,latin1:On,ascii:On,binary:On,...cs};function lt(r,e="utf8"){const t=Wo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function ht(r,e="utf8"){const t=Wo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function If(r){return typeof r=="string"?r:JSON.stringify(r)}function Jr(r){return lt(ht(If(r),Ju),Lo)}function ko(r){const e=ht(rh,ns),t=th+lt(jn([e,r]),ns);return[Qu,eh,t].join(Zu)}function xf(r){return lt(r,Lo)}function Pf(r){return ht([Jr(r.header),Jr(r.payload)].join(Fo),Xu)}function Tf(r){return[Jr(r.header),Jr(r.payload),xf(r.signature)].join(Fo)}function hs(r=sr.randomBytes(nh)){return Qn.generateKeyPairFromSeed(r)}async function Af(r,e,t,n,i=te.fromMiliseconds(Date.now())){const f={alg:ku,typ:Yu},g=ko(n.publicKey),p=i+t,_={iss:g,sub:r,aud:e,iat:i,exp:p},S=Pf({header:f,payload:_}),I=Qn.sign(n.secretKey,S);return Tf({header:f,payload:_,signature:I})}var ei={},on={};Object.defineProperty(on,"__esModule",{value:!0});var st=ie,Bn=gt,Nf=20;function Cf(r,e,t){for(var n=1634760805,i=857760878,f=2036477234,g=1797285236,p=t[3]<<24|t[2]<<16|t[1]<<8|t[0],_=t[7]<<24|t[6]<<16|t[5]<<8|t[4],S=t[11]<<24|t[10]<<16|t[9]<<8|t[8],I=t[15]<<24|t[14]<<16|t[13]<<8|t[12],N=t[19]<<24|t[18]<<16|t[17]<<8|t[16],j=t[23]<<24|t[22]<<16|t[21]<<8|t[20],C=t[27]<<24|t[26]<<16|t[25]<<8|t[24],P=t[31]<<24|t[30]<<16|t[29]<<8|t[28],M=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],G=e[11]<<24|e[10]<<16|e[9]<<8|e[8],v=e[15]<<24|e[14]<<16|e[13]<<8|e[12],O=n,m=i,E=f,y=g,s=p,d=_,$=S,o=I,h=N,l=j,b=C,a=P,c=M,D=B,T=G,U=v,w=0;w<Nf;w+=2)O=O+s|0,c^=O,c=c>>>32-16|c<<16,h=h+c|0,s^=h,s=s>>>32-12|s<<12,m=m+d|0,D^=m,D=D>>>32-16|D<<16,l=l+D|0,d^=l,d=d>>>32-12|d<<12,E=E+$|0,T^=E,T=T>>>32-16|T<<16,b=b+T|0,$^=b,$=$>>>32-12|$<<12,y=y+o|0,U^=y,U=U>>>32-16|U<<16,a=a+U|0,o^=a,o=o>>>32-12|o<<12,E=E+$|0,T^=E,T=T>>>32-8|T<<8,b=b+T|0,$^=b,$=$>>>32-7|$<<7,y=y+o|0,U^=y,U=U>>>32-8|U<<8,a=a+U|0,o^=a,o=o>>>32-7|o<<7,m=m+d|0,D^=m,D=D>>>32-8|D<<8,l=l+D|0,d^=l,d=d>>>32-7|d<<7,O=O+s|0,c^=O,c=c>>>32-8|c<<8,h=h+c|0,s^=h,s=s>>>32-7|s<<7,O=O+d|0,U^=O,U=U>>>32-16|U<<16,b=b+U|0,d^=b,d=d>>>32-12|d<<12,m=m+$|0,c^=m,c=c>>>32-16|c<<16,a=a+c|0,$^=a,$=$>>>32-12|$<<12,E=E+o|0,D^=E,D=D>>>32-16|D<<16,h=h+D|0,o^=h,o=o>>>32-12|o<<12,y=y+s|0,T^=y,T=T>>>32-16|T<<16,l=l+T|0,s^=l,s=s>>>32-12|s<<12,E=E+o|0,D^=E,D=D>>>32-8|D<<8,h=h+D|0,o^=h,o=o>>>32-7|o<<7,y=y+s|0,T^=y,T=T>>>32-8|T<<8,l=l+T|0,s^=l,s=s>>>32-7|s<<7,m=m+$|0,c^=m,c=c>>>32-8|c<<8,a=a+c|0,$^=a,$=$>>>32-7|$<<7,O=O+d|0,U^=O,U=U>>>32-8|U<<8,b=b+U|0,d^=b,d=d>>>32-7|d<<7;st.writeUint32LE(O+n|0,r,0),st.writeUint32LE(m+i|0,r,4),st.writeUint32LE(E+f|0,r,8),st.writeUint32LE(y+g|0,r,12),st.writeUint32LE(s+p|0,r,16),st.writeUint32LE(d+_|0,r,20),st.writeUint32LE($+S|0,r,24),st.writeUint32LE(o+I|0,r,28),st.writeUint32LE(h+N|0,r,32),st.writeUint32LE(l+j|0,r,36),st.writeUint32LE(b+C|0,r,40),st.writeUint32LE(a+P|0,r,44),st.writeUint32LE(c+M|0,r,48),st.writeUint32LE(D+B|0,r,52),st.writeUint32LE(T+G|0,r,56),st.writeUint32LE(U+v|0,r,60)}function Yo(r,e,t,n,i){if(i===void 0&&(i=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<t.length)throw new Error("ChaCha: destination is shorter than source");var f,g;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");f=new Uint8Array(16),g=f.length-e.length,f.set(e,g)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");f=e,g=i}for(var p=new Uint8Array(64),_=0;_<t.length;_+=64){Cf(p,f,r);for(var S=_;S<_+64&&S<t.length;S++)n[S]=t[S]^p[S-_];Ff(f,0,g)}return Bn.wipe(p),i===0&&Bn.wipe(f),n}on.streamXOR=Yo;function Rf(r,e,t,n){return n===void 0&&(n=0),Bn.wipe(t),Yo(r,e,t,t,n)}on.stream=Rf;function Ff(r,e,t){for(var n=1;t--;)n=n+(r[e]&255)|0,r[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Jo={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});function Lf(r,e,t){return~(r-1)&e|r-1&t}Ht.select=Lf;function Uf(r,e){return(r|0)-(e|0)-1>>>31&1}Ht.lessOrEqual=Uf;function Xo(r,e){if(r.length!==e.length)return 0;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return 1&t-1>>>8}Ht.compare=Xo;function jf(r,e){return r.length===0||e.length===0?!1:Xo(r,e)!==0}Ht.equal=jf;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ht,t=gt;r.DIGEST_LENGTH=16;var n=function(){function g(p){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=p[0]|p[1]<<8;this._r[0]=_&8191;var S=p[2]|p[3]<<8;this._r[1]=(_>>>13|S<<3)&8191;var I=p[4]|p[5]<<8;this._r[2]=(S>>>10|I<<6)&7939;var N=p[6]|p[7]<<8;this._r[3]=(I>>>7|N<<9)&8191;var j=p[8]|p[9]<<8;this._r[4]=(N>>>4|j<<12)&255,this._r[5]=j>>>1&8190;var C=p[10]|p[11]<<8;this._r[6]=(j>>>14|C<<2)&8191;var P=p[12]|p[13]<<8;this._r[7]=(C>>>11|P<<5)&8065;var M=p[14]|p[15]<<8;this._r[8]=(P>>>8|M<<8)&8191,this._r[9]=M>>>5&127,this._pad[0]=p[16]|p[17]<<8,this._pad[1]=p[18]|p[19]<<8,this._pad[2]=p[20]|p[21]<<8,this._pad[3]=p[22]|p[23]<<8,this._pad[4]=p[24]|p[25]<<8,this._pad[5]=p[26]|p[27]<<8,this._pad[6]=p[28]|p[29]<<8,this._pad[7]=p[30]|p[31]<<8}return g.prototype._blocks=function(p,_,S){for(var I=this._fin?0:2048,N=this._h[0],j=this._h[1],C=this._h[2],P=this._h[3],M=this._h[4],B=this._h[5],G=this._h[6],v=this._h[7],O=this._h[8],m=this._h[9],E=this._r[0],y=this._r[1],s=this._r[2],d=this._r[3],$=this._r[4],o=this._r[5],h=this._r[6],l=this._r[7],b=this._r[8],a=this._r[9];S>=16;){var c=p[_+0]|p[_+1]<<8;N+=c&8191;var D=p[_+2]|p[_+3]<<8;j+=(c>>>13|D<<3)&8191;var T=p[_+4]|p[_+5]<<8;C+=(D>>>10|T<<6)&8191;var U=p[_+6]|p[_+7]<<8;P+=(T>>>7|U<<9)&8191;var w=p[_+8]|p[_+9]<<8;M+=(U>>>4|w<<12)&8191,B+=w>>>1&8191;var R=p[_+10]|p[_+11]<<8;G+=(w>>>14|R<<2)&8191;var K=p[_+12]|p[_+13]<<8;v+=(R>>>11|K<<5)&8191;var z=p[_+14]|p[_+15]<<8;O+=(K>>>8|z<<8)&8191,m+=z>>>5|I;var V=0,X=V;X+=N*E,X+=j*(5*a),X+=C*(5*b),X+=P*(5*l),X+=M*(5*h),V=X>>>13,X&=8191,X+=B*(5*o),X+=G*(5*$),X+=v*(5*d),X+=O*(5*s),X+=m*(5*y),V+=X>>>13,X&=8191;var Y=V;Y+=N*y,Y+=j*E,Y+=C*(5*a),Y+=P*(5*b),Y+=M*(5*l),V=Y>>>13,Y&=8191,Y+=B*(5*h),Y+=G*(5*o),Y+=v*(5*$),Y+=O*(5*d),Y+=m*(5*s),V+=Y>>>13,Y&=8191;var ee=V;ee+=N*s,ee+=j*y,ee+=C*E,ee+=P*(5*a),ee+=M*(5*b),V=ee>>>13,ee&=8191,ee+=B*(5*l),ee+=G*(5*h),ee+=v*(5*o),ee+=O*(5*$),ee+=m*(5*d),V+=ee>>>13,ee&=8191;var q=V;q+=N*d,q+=j*s,q+=C*y,q+=P*E,q+=M*(5*a),V=q>>>13,q&=8191,q+=B*(5*b),q+=G*(5*l),q+=v*(5*h),q+=O*(5*o),q+=m*(5*$),V+=q>>>13,q&=8191;var H=V;H+=N*$,H+=j*d,H+=C*s,H+=P*y,H+=M*E,V=H>>>13,H&=8191,H+=B*(5*a),H+=G*(5*b),H+=v*(5*l),H+=O*(5*h),H+=m*(5*o),V+=H>>>13,H&=8191;var F=V;F+=N*o,F+=j*$,F+=C*d,F+=P*s,F+=M*y,V=F>>>13,F&=8191,F+=B*E,F+=G*(5*a),F+=v*(5*b),F+=O*(5*l),F+=m*(5*h),V+=F>>>13,F&=8191;var u=V;u+=N*h,u+=j*o,u+=C*$,u+=P*d,u+=M*s,V=u>>>13,u&=8191,u+=B*y,u+=G*E,u+=v*(5*a),u+=O*(5*b),u+=m*(5*l),V+=u>>>13,u&=8191;var A=V;A+=N*l,A+=j*h,A+=C*o,A+=P*$,A+=M*d,V=A>>>13,A&=8191,A+=B*s,A+=G*y,A+=v*E,A+=O*(5*a),A+=m*(5*b),V+=A>>>13,A&=8191;var k=V;k+=N*b,k+=j*l,k+=C*h,k+=P*o,k+=M*$,V=k>>>13,k&=8191,k+=B*d,k+=G*s,k+=v*y,k+=O*E,k+=m*(5*a),V+=k>>>13,k&=8191;var Z=V;Z+=N*a,Z+=j*b,Z+=C*l,Z+=P*h,Z+=M*o,V=Z>>>13,Z&=8191,Z+=B*$,Z+=G*d,Z+=v*s,Z+=O*y,Z+=m*E,V+=Z>>>13,Z&=8191,V=(V<<2)+V|0,V=V+X|0,X=V&8191,V=V>>>13,Y+=V,N=X,j=Y,C=ee,P=q,M=H,B=F,G=u,v=A,O=k,m=Z,_+=16,S-=16}this._h[0]=N,this._h[1]=j,this._h[2]=C,this._h[3]=P,this._h[4]=M,this._h[5]=B,this._h[6]=G,this._h[7]=v,this._h[8]=O,this._h[9]=m},g.prototype.finish=function(p,_){_===void 0&&(_=0);var S=new Uint16Array(10),I,N,j,C;if(this._leftover){for(C=this._leftover,this._buffer[C++]=1;C<16;C++)this._buffer[C]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(I=this._h[1]>>>13,this._h[1]&=8191,C=2;C<10;C++)this._h[C]+=I,I=this._h[C]>>>13,this._h[C]&=8191;for(this._h[0]+=I*5,I=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=I,I=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=I,S[0]=this._h[0]+5,I=S[0]>>>13,S[0]&=8191,C=1;C<10;C++)S[C]=this._h[C]+I,I=S[C]>>>13,S[C]&=8191;for(S[9]-=1<<13,N=(I^1)-1,C=0;C<10;C++)S[C]&=N;for(N=~N,C=0;C<10;C++)this._h[C]=this._h[C]&N|S[C];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,j=this._h[0]+this._pad[0],this._h[0]=j&65535,C=1;C<8;C++)j=(this._h[C]+this._pad[C]|0)+(j>>>16)|0,this._h[C]=j&65535;return p[_+0]=this._h[0]>>>0,p[_+1]=this._h[0]>>>8,p[_+2]=this._h[1]>>>0,p[_+3]=this._h[1]>>>8,p[_+4]=this._h[2]>>>0,p[_+5]=this._h[2]>>>8,p[_+6]=this._h[3]>>>0,p[_+7]=this._h[3]>>>8,p[_+8]=this._h[4]>>>0,p[_+9]=this._h[4]>>>8,p[_+10]=this._h[5]>>>0,p[_+11]=this._h[5]>>>8,p[_+12]=this._h[6]>>>0,p[_+13]=this._h[6]>>>8,p[_+14]=this._h[7]>>>0,p[_+15]=this._h[7]>>>8,this._finished=!0,this},g.prototype.update=function(p){var _=0,S=p.length,I;if(this._leftover){I=16-this._leftover,I>S&&(I=S);for(var N=0;N<I;N++)this._buffer[this._leftover+N]=p[_+N];if(S-=I,_+=I,this._leftover+=I,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(S>=16&&(I=S-S%16,this._blocks(p,_,I),_+=I,S-=I),S){for(var N=0;N<S;N++)this._buffer[this._leftover+N]=p[_+N];this._leftover+=S}return this},g.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var p=new Uint8Array(16);return this.finish(p),p},g.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},g}();r.Poly1305=n;function i(g,p){var _=new n(g);_.update(p);var S=_.digest();return _.clean(),S}r.oneTimeAuth=i;function f(g,p){return g.length!==r.DIGEST_LENGTH||p.length!==r.DIGEST_LENGTH?!1:e.equal(g,p)}r.equal=f})(Jo);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=on,t=Jo,n=gt,i=ie,f=Ht;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var g=new Uint8Array(16),p=function(){function _(S){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,S.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(S)}return _.prototype.seal=function(S,I,N,j){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var C=new Uint8Array(16);C.set(S,C.length-S.length);var P=new Uint8Array(32);e.stream(this._key,C,P,4);var M=I.length+this.tagLength,B;if(j){if(j.length!==M)throw new Error("ChaCha20Poly1305: incorrect destination length");B=j}else B=new Uint8Array(M);return e.streamXOR(this._key,C,I,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),P,B.subarray(0,B.length-this.tagLength),N),n.wipe(C),B},_.prototype.open=function(S,I,N,j){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(I.length<this.tagLength)return null;var C=new Uint8Array(16);C.set(S,C.length-S.length);var P=new Uint8Array(32);e.stream(this._key,C,P,4);var M=new Uint8Array(this.tagLength);if(this._authenticate(M,P,I.subarray(0,I.length-this.tagLength),N),!f.equal(M,I.subarray(I.length-this.tagLength,I.length)))return null;var B=I.length-this.tagLength,G;if(j){if(j.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");G=j}else G=new Uint8Array(B);return e.streamXOR(this._key,C,I.subarray(0,I.length-this.tagLength),G,4),n.wipe(C),G},_.prototype.clean=function(){return n.wipe(this._key),this},_.prototype._authenticate=function(S,I,N,j){var C=new t.Poly1305(I);j&&(C.update(j),j.length%16>0&&C.update(g.subarray(j.length%16))),C.update(N),N.length%16>0&&C.update(g.subarray(N.length%16));var P=new Uint8Array(8);j&&i.writeUint64LE(j.length,P),C.update(P),i.writeUint64LE(N.length,P),C.update(P);for(var M=C.digest(),B=0;B<M.length;B++)S[B]=M[B];C.clean(),n.wipe(M),n.wipe(P)},_}();r.ChaCha20Poly1305=p})(ei);var Zo={},Tr={},ti={};Object.defineProperty(ti,"__esModule",{value:!0});function Mf(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}ti.isSerializableHash=Mf;Object.defineProperty(Tr,"__esModule",{value:!0});var St=ti,$f=Ht,Bf=gt,Qo=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(n).clean():n.set(t);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Bf.wipe(n)}return r.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Tr.HMAC=Qo;function Hf(r,e,t){var n=new Qo(r,e);n.update(t);var i=n.digest();return n.clean(),i}Tr.hmac=Hf;Tr.equal=$f.equal;Object.defineProperty(Zo,"__esModule",{value:!0});var fs=Tr,ls=gt,qf=function(){function r(e,t,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var f=fs.hmac(this._hash,n,t);this._hmac=new fs.HMAC(e,f),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[n]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),ls.wipe(this._buffer),ls.wipe(this._counter),this._bufpos=0},r}(),zf=Zo.HKDF=qf,an={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=gt;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var n=function(){function p(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},p.prototype.update=function(_,S){if(S===void 0&&(S=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var I=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&S>0;)this._buffer[this._bufferLength++]=_[I++],S--;this._bufferLength===this.blockSize&&(f(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(I=f(this._temp,this._state,_,I,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=_[I++],S--;return this},p.prototype.finish=function(_){if(!this._finished){var S=this._bytesHashed,I=this._bufferLength,N=S/536870912|0,j=S<<3,C=S%64<56?64:128;this._buffer[I]=128;for(var P=I+1;P<C-8;P++)this._buffer[P]=0;e.writeUint32BE(N,this._buffer,C-8),e.writeUint32BE(j,this._buffer,C-4),f(this._temp,this._state,this._buffer,0,C),this._finished=!0}for(var P=0;P<this.digestLength/4;P++)e.writeUint32BE(this._state[P],_,P*4);return this},p.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(_){t.wipe(_.state),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},p}();r.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function f(p,_,S,I,N){for(;N>=64;){for(var j=_[0],C=_[1],P=_[2],M=_[3],B=_[4],G=_[5],v=_[6],O=_[7],m=0;m<16;m++){var E=I+m*4;p[m]=e.readUint32BE(S,E)}for(var m=16;m<64;m++){var y=p[m-2],s=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=p[m-15];var d=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;p[m]=(s+p[m-7]|0)+(d+p[m-16]|0)}for(var m=0;m<64;m++){var s=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&G^~B&v)|0)+(O+(i[m]+p[m]|0)|0)|0,d=((j>>>2|j<<32-2)^(j>>>13|j<<32-13)^(j>>>22|j<<32-22))+(j&C^j&P^C&P)|0;O=v,v=G,G=B,B=M+s|0,M=P,P=C,C=j,j=s+d|0}_[0]+=j,_[1]+=C,_[2]+=P,_[3]+=M,_[4]+=B,_[5]+=G,_[6]+=v,_[7]+=O,I+=64,N-=64}return I}function g(p){var _=new n;_.update(p);var S=_.digest();return _.clean(),S}r.hash=g})(an);var ri={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=sr,t=gt;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function n(m){const E=new Float64Array(16);if(m)for(let y=0;y<m.length;y++)E[y]=m[y];return E}const i=new Uint8Array(32);i[0]=9;const f=n([56129,1]);function g(m){let E=1;for(let y=0;y<16;y++){let s=m[y]+E+65535;E=Math.floor(s/65536),m[y]=s-E*65536}m[0]+=E-1+37*(E-1)}function p(m,E,y){const s=~(y-1);for(let d=0;d<16;d++){const $=s&(m[d]^E[d]);m[d]^=$,E[d]^=$}}function _(m,E){const y=n(),s=n();for(let d=0;d<16;d++)s[d]=E[d];g(s),g(s),g(s);for(let d=0;d<2;d++){y[0]=s[0]-65517;for(let o=1;o<15;o++)y[o]=s[o]-65535-(y[o-1]>>16&1),y[o-1]&=65535;y[15]=s[15]-32767-(y[14]>>16&1);const $=y[15]>>16&1;y[14]&=65535,p(s,y,1-$)}for(let d=0;d<16;d++)m[2*d]=s[d]&255,m[2*d+1]=s[d]>>8}function S(m,E){for(let y=0;y<16;y++)m[y]=E[2*y]+(E[2*y+1]<<8);m[15]&=32767}function I(m,E,y){for(let s=0;s<16;s++)m[s]=E[s]+y[s]}function N(m,E,y){for(let s=0;s<16;s++)m[s]=E[s]-y[s]}function j(m,E,y){let s,d,$=0,o=0,h=0,l=0,b=0,a=0,c=0,D=0,T=0,U=0,w=0,R=0,K=0,z=0,V=0,X=0,Y=0,ee=0,q=0,H=0,F=0,u=0,A=0,k=0,Z=0,fe=0,_e=0,de=0,ve=0,Ue=0,Ce=0,ye=y[0],pe=y[1],le=y[2],ue=y[3],ce=y[4],ae=y[5],oe=y[6],re=y[7],he=y[8],ge=y[9],ne=y[10],be=y[11],me=y[12],Ee=y[13],De=y[14],we=y[15];s=E[0],$+=s*ye,o+=s*pe,h+=s*le,l+=s*ue,b+=s*ce,a+=s*ae,c+=s*oe,D+=s*re,T+=s*he,U+=s*ge,w+=s*ne,R+=s*be,K+=s*me,z+=s*Ee,V+=s*De,X+=s*we,s=E[1],o+=s*ye,h+=s*pe,l+=s*le,b+=s*ue,a+=s*ce,c+=s*ae,D+=s*oe,T+=s*re,U+=s*he,w+=s*ge,R+=s*ne,K+=s*be,z+=s*me,V+=s*Ee,X+=s*De,Y+=s*we,s=E[2],h+=s*ye,l+=s*pe,b+=s*le,a+=s*ue,c+=s*ce,D+=s*ae,T+=s*oe,U+=s*re,w+=s*he,R+=s*ge,K+=s*ne,z+=s*be,V+=s*me,X+=s*Ee,Y+=s*De,ee+=s*we,s=E[3],l+=s*ye,b+=s*pe,a+=s*le,c+=s*ue,D+=s*ce,T+=s*ae,U+=s*oe,w+=s*re,R+=s*he,K+=s*ge,z+=s*ne,V+=s*be,X+=s*me,Y+=s*Ee,ee+=s*De,q+=s*we,s=E[4],b+=s*ye,a+=s*pe,c+=s*le,D+=s*ue,T+=s*ce,U+=s*ae,w+=s*oe,R+=s*re,K+=s*he,z+=s*ge,V+=s*ne,X+=s*be,Y+=s*me,ee+=s*Ee,q+=s*De,H+=s*we,s=E[5],a+=s*ye,c+=s*pe,D+=s*le,T+=s*ue,U+=s*ce,w+=s*ae,R+=s*oe,K+=s*re,z+=s*he,V+=s*ge,X+=s*ne,Y+=s*be,ee+=s*me,q+=s*Ee,H+=s*De,F+=s*we,s=E[6],c+=s*ye,D+=s*pe,T+=s*le,U+=s*ue,w+=s*ce,R+=s*ae,K+=s*oe,z+=s*re,V+=s*he,X+=s*ge,Y+=s*ne,ee+=s*be,q+=s*me,H+=s*Ee,F+=s*De,u+=s*we,s=E[7],D+=s*ye,T+=s*pe,U+=s*le,w+=s*ue,R+=s*ce,K+=s*ae,z+=s*oe,V+=s*re,X+=s*he,Y+=s*ge,ee+=s*ne,q+=s*be,H+=s*me,F+=s*Ee,u+=s*De,A+=s*we,s=E[8],T+=s*ye,U+=s*pe,w+=s*le,R+=s*ue,K+=s*ce,z+=s*ae,V+=s*oe,X+=s*re,Y+=s*he,ee+=s*ge,q+=s*ne,H+=s*be,F+=s*me,u+=s*Ee,A+=s*De,k+=s*we,s=E[9],U+=s*ye,w+=s*pe,R+=s*le,K+=s*ue,z+=s*ce,V+=s*ae,X+=s*oe,Y+=s*re,ee+=s*he,q+=s*ge,H+=s*ne,F+=s*be,u+=s*me,A+=s*Ee,k+=s*De,Z+=s*we,s=E[10],w+=s*ye,R+=s*pe,K+=s*le,z+=s*ue,V+=s*ce,X+=s*ae,Y+=s*oe,ee+=s*re,q+=s*he,H+=s*ge,F+=s*ne,u+=s*be,A+=s*me,k+=s*Ee,Z+=s*De,fe+=s*we,s=E[11],R+=s*ye,K+=s*pe,z+=s*le,V+=s*ue,X+=s*ce,Y+=s*ae,ee+=s*oe,q+=s*re,H+=s*he,F+=s*ge,u+=s*ne,A+=s*be,k+=s*me,Z+=s*Ee,fe+=s*De,_e+=s*we,s=E[12],K+=s*ye,z+=s*pe,V+=s*le,X+=s*ue,Y+=s*ce,ee+=s*ae,q+=s*oe,H+=s*re,F+=s*he,u+=s*ge,A+=s*ne,k+=s*be,Z+=s*me,fe+=s*Ee,_e+=s*De,de+=s*we,s=E[13],z+=s*ye,V+=s*pe,X+=s*le,Y+=s*ue,ee+=s*ce,q+=s*ae,H+=s*oe,F+=s*re,u+=s*he,A+=s*ge,k+=s*ne,Z+=s*be,fe+=s*me,_e+=s*Ee,de+=s*De,ve+=s*we,s=E[14],V+=s*ye,X+=s*pe,Y+=s*le,ee+=s*ue,q+=s*ce,H+=s*ae,F+=s*oe,u+=s*re,A+=s*he,k+=s*ge,Z+=s*ne,fe+=s*be,_e+=s*me,de+=s*Ee,ve+=s*De,Ue+=s*we,s=E[15],X+=s*ye,Y+=s*pe,ee+=s*le,q+=s*ue,H+=s*ce,F+=s*ae,u+=s*oe,A+=s*re,k+=s*he,Z+=s*ge,fe+=s*ne,_e+=s*be,de+=s*me,ve+=s*Ee,Ue+=s*De,Ce+=s*we,$+=38*Y,o+=38*ee,h+=38*q,l+=38*H,b+=38*F,a+=38*u,c+=38*A,D+=38*k,T+=38*Z,U+=38*fe,w+=38*_e,R+=38*de,K+=38*ve,z+=38*Ue,V+=38*Ce,d=1,s=$+d+65535,d=Math.floor(s/65536),$=s-d*65536,s=o+d+65535,d=Math.floor(s/65536),o=s-d*65536,s=h+d+65535,d=Math.floor(s/65536),h=s-d*65536,s=l+d+65535,d=Math.floor(s/65536),l=s-d*65536,s=b+d+65535,d=Math.floor(s/65536),b=s-d*65536,s=a+d+65535,d=Math.floor(s/65536),a=s-d*65536,s=c+d+65535,d=Math.floor(s/65536),c=s-d*65536,s=D+d+65535,d=Math.floor(s/65536),D=s-d*65536,s=T+d+65535,d=Math.floor(s/65536),T=s-d*65536,s=U+d+65535,d=Math.floor(s/65536),U=s-d*65536,s=w+d+65535,d=Math.floor(s/65536),w=s-d*65536,s=R+d+65535,d=Math.floor(s/65536),R=s-d*65536,s=K+d+65535,d=Math.floor(s/65536),K=s-d*65536,s=z+d+65535,d=Math.floor(s/65536),z=s-d*65536,s=V+d+65535,d=Math.floor(s/65536),V=s-d*65536,s=X+d+65535,d=Math.floor(s/65536),X=s-d*65536,$+=d-1+37*(d-1),d=1,s=$+d+65535,d=Math.floor(s/65536),$=s-d*65536,s=o+d+65535,d=Math.floor(s/65536),o=s-d*65536,s=h+d+65535,d=Math.floor(s/65536),h=s-d*65536,s=l+d+65535,d=Math.floor(s/65536),l=s-d*65536,s=b+d+65535,d=Math.floor(s/65536),b=s-d*65536,s=a+d+65535,d=Math.floor(s/65536),a=s-d*65536,s=c+d+65535,d=Math.floor(s/65536),c=s-d*65536,s=D+d+65535,d=Math.floor(s/65536),D=s-d*65536,s=T+d+65535,d=Math.floor(s/65536),T=s-d*65536,s=U+d+65535,d=Math.floor(s/65536),U=s-d*65536,s=w+d+65535,d=Math.floor(s/65536),w=s-d*65536,s=R+d+65535,d=Math.floor(s/65536),R=s-d*65536,s=K+d+65535,d=Math.floor(s/65536),K=s-d*65536,s=z+d+65535,d=Math.floor(s/65536),z=s-d*65536,s=V+d+65535,d=Math.floor(s/65536),V=s-d*65536,s=X+d+65535,d=Math.floor(s/65536),X=s-d*65536,$+=d-1+37*(d-1),m[0]=$,m[1]=o,m[2]=h,m[3]=l,m[4]=b,m[5]=a,m[6]=c,m[7]=D,m[8]=T,m[9]=U,m[10]=w,m[11]=R,m[12]=K,m[13]=z,m[14]=V,m[15]=X}function C(m,E){j(m,E,E)}function P(m,E){const y=n();for(let s=0;s<16;s++)y[s]=E[s];for(let s=253;s>=0;s--)C(y,y),s!==2&&s!==4&&j(y,y,E);for(let s=0;s<16;s++)m[s]=y[s]}function M(m,E){const y=new Uint8Array(32),s=new Float64Array(80),d=n(),$=n(),o=n(),h=n(),l=n(),b=n();for(let T=0;T<31;T++)y[T]=m[T];y[31]=m[31]&127|64,y[0]&=248,S(s,E);for(let T=0;T<16;T++)$[T]=s[T];d[0]=h[0]=1;for(let T=254;T>=0;--T){const U=y[T>>>3]>>>(T&7)&1;p(d,$,U),p(o,h,U),I(l,d,o),N(d,d,o),I(o,$,h),N($,$,h),C(h,l),C(b,d),j(d,o,d),j(o,$,l),I(l,d,o),N(d,d,o),C($,d),N(o,h,b),j(d,o,f),I(d,d,h),j(o,o,d),j(d,h,b),j(h,$,s),C($,l),p(d,$,U),p(o,h,U)}for(let T=0;T<16;T++)s[T+16]=d[T],s[T+32]=o[T],s[T+48]=$[T],s[T+64]=h[T];const a=s.subarray(32),c=s.subarray(16);P(a,a),j(c,c,a);const D=new Uint8Array(32);return _(D,c),D}r.scalarMult=M;function B(m){return M(m,i)}r.scalarMultBase=B;function G(m){if(m.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(m);return{publicKey:B(E),secretKey:E}}r.generateKeyPairFromSeed=G;function v(m){const E=(0,e.randomBytes)(32,m),y=G(E);return(0,t.wipe)(E),y}r.generateKeyPair=v;function O(m,E,y=!1){if(m.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const s=M(m,E);if(y){let d=0;for(let $=0;$<s.length;$++)d|=s[$];if(d===0)throw new Error("X25519: invalid shared key")}return s}r.sharedKey=O})(ri);var ds=globalThis&&globalThis.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,f;n<i;n++)(f||!(n in e))&&(f||(f=Array.prototype.slice.call(e,0,n)),f[n]=e[n]);return r.concat(f||Array.prototype.slice.call(e))},Kf=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),Vf=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),Gf=function(){function r(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}return r}(),Wf=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),kf=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),Yf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Jf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ps=3,Xf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Yf]],gs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Zf(r){return r?ys(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new kf:typeof navigator<"u"?ys(navigator.userAgent):tl()}function Qf(r){return r!==""&&Xf.reduce(function(e,t){var n=t[0],i=t[1];if(e)return e;var f=i.exec(r);return!!f&&[n,f]},!1)}function ys(r){var e=Qf(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new Wf;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<ps&&(i=ds(ds([],i,!0),rl(ps-i.length),!0)):i=[];var f=i.join("."),g=el(r),p=Jf.exec(r);return p&&p[1]?new Gf(t,f,g,p[1]):new Kf(t,f,g)}function el(r){for(var e=0,t=gs.length;e<t;e++){var n=gs[e],i=n[0],f=n[1],g=f.exec(r);if(g)return i}return null}function tl(){var r=typeof process<"u"&&process.version;return r?new Vf(process.version.slice(1)):null}function rl(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=ta=Ie.getLocation=Ie.getLocationOrThrow=ni=Ie.getNavigator=Ie.getNavigatorOrThrow=ea=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Zt(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Ie.getFromWindow=Zt;function or(r){const e=Zt(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Ie.getFromWindowOrThrow=or;function nl(){return or("document")}Ie.getDocumentOrThrow=nl;function il(){return Zt("document")}var ea=Ie.getDocument=il;function sl(){return or("navigator")}Ie.getNavigatorOrThrow=sl;function ol(){return Zt("navigator")}var ni=Ie.getNavigator=ol;function al(){return or("location")}Ie.getLocationOrThrow=al;function cl(){return Zt("location")}var ta=Ie.getLocation=cl;function ul(){return or("crypto")}Ie.getCryptoOrThrow=ul;function hl(){return Zt("crypto")}Ie.getCrypto=hl;function fl(){return or("localStorage")}Ie.getLocalStorageOrThrow=fl;function ll(){return Zt("localStorage")}Ie.getLocalStorage=ll;var ii={};Object.defineProperty(ii,"__esModule",{value:!0});var ra=ii.getWindowMetadata=void 0;const _s=Ie;function dl(){let r,e;try{r=_s.getDocumentOrThrow(),e=_s.getLocationOrThrow()}catch{return null}function t(){const N=r.getElementsByTagName("link"),j=[];for(let C=0;C<N.length;C++){const P=N[C],M=P.getAttribute("rel");if(M&&M.toLowerCase().indexOf("icon")>-1){const B=P.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let G=e.protocol+"//"+e.host;if(B.indexOf("/")===0)G+=B;else{const v=e.pathname.split("/");v.pop(),G+=v.join("/")+"/"+B}j.push(G)}else if(B.indexOf("//")===0){const G=e.protocol+B;j.push(G)}else j.push(B)}}return j}function n(...N){const j=r.getElementsByTagName("meta");for(let C=0;C<j.length;C++){const P=j[C],M=["itemprop","property","name"].map(B=>P.getAttribute(B)).filter(B=>B?N.includes(B):!1);if(M.length&&M){const B=P.getAttribute("content");if(B)return B}}return""}function i(){let N=n("name","og:site_name","og:title","twitter:title");return N||(N=r.title),N}function f(){return n("description","og:description","twitter:description","keywords")}const g=i(),p=f(),_=e.origin,S=t();return{description:p,url:_,icons:S,name:g}}ra=ii.getWindowMetadata=dl;var Dr={},na=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ia="%[a-f0-9]{2}",bs=new RegExp("("+ia+")|([^%]+?)","gi"),ms=new RegExp("("+ia+")+","gi");function Hn(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var t=r.slice(0,e),n=r.slice(e);return Array.prototype.concat.call([],Hn(t),Hn(n))}function pl(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(bs)||[],t=1;t<e.length;t++)r=Hn(e,t).join(""),e=r.match(bs)||[];return r}}function gl(r){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},t=ms.exec(r);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var n=pl(t[0]);n!==t[0]&&(e[t[0]]=n)}t=ms.exec(r)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),f=0;f<i.length;f++){var g=i[f];r=r.replace(new RegExp(g,"g"),e[g])}return r}var sa=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return gl(r)}},oa=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const t=r.indexOf(e);return t===-1?[r]:[r.slice(0,t),r.slice(t+e.length)]},aa=function(r,e){for(var t={},n=Object.keys(r),i=Array.isArray(e),f=0;f<n.length;f++){var g=n[f],p=r[g];(i?e.indexOf(g)!==-1:e(g,p,r))&&(t[g]=p)}return t};(function(r){const e=na,t=sa,n=oa,i=aa,f=v=>v==null,g=Symbol("encodeFragmentIdentifier");function p(v){switch(v.arrayFormat){case"index":return O=>(m,E)=>{const y=m.length;return E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),"[",y,"]"].join("")]:[...m,[I(O,v),"[",I(y,v),"]=",I(E,v)].join("")]};case"bracket":return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),"[]"].join("")]:[...m,[I(O,v),"[]=",I(E,v)].join("")];case"colon-list-separator":return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),":list="].join("")]:[...m,[I(O,v),":list=",I(E,v)].join("")];case"comma":case"separator":case"bracket-separator":{const O=v.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(E,y)=>y===void 0||v.skipNull&&y===null||v.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[I(m,v),O,I(y,v)].join("")]:[[E,I(y,v)].join(v.arrayFormatSeparator)])}default:return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,I(O,v)]:[...m,[I(O,v),"=",I(E,v)].join("")]}}function _(v){let O;switch(v.arrayFormat){case"index":return(m,E,y)=>{if(O=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!O){y[m]=E;return}y[m]===void 0&&(y[m]={}),y[m][O[1]]=E};case"bracket":return(m,E,y)=>{if(O=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!O){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"colon-list-separator":return(m,E,y)=>{if(O=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!O){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"comma":case"separator":return(m,E,y)=>{const s=typeof E=="string"&&E.includes(v.arrayFormatSeparator),d=typeof E=="string"&&!s&&N(E,v).includes(v.arrayFormatSeparator);E=d?N(E,v):E;const $=s||d?E.split(v.arrayFormatSeparator).map(o=>N(o,v)):E===null?E:N(E,v);y[m]=$};case"bracket-separator":return(m,E,y)=>{const s=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!s){y[m]=E&&N(E,v);return}const d=E===null?[]:E.split(v.arrayFormatSeparator).map($=>N($,v));if(y[m]===void 0){y[m]=d;return}y[m]=[].concat(y[m],d)};default:return(m,E,y)=>{if(y[m]===void 0){y[m]=E;return}y[m]=[].concat(y[m],E)}}}function S(v){if(typeof v!="string"||v.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(v,O){return O.encode?O.strict?e(v):encodeURIComponent(v):v}function N(v,O){return O.decode?t(v):v}function j(v){return Array.isArray(v)?v.sort():typeof v=="object"?j(Object.keys(v)).sort((O,m)=>Number(O)-Number(m)).map(O=>v[O]):v}function C(v){const O=v.indexOf("#");return O!==-1&&(v=v.slice(0,O)),v}function P(v){let O="";const m=v.indexOf("#");return m!==-1&&(O=v.slice(m)),O}function M(v){v=C(v);const O=v.indexOf("?");return O===-1?"":v.slice(O+1)}function B(v,O){return O.parseNumbers&&!Number.isNaN(Number(v))&&typeof v=="string"&&v.trim()!==""?v=Number(v):O.parseBooleans&&v!==null&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")&&(v=v.toLowerCase()==="true"),v}function G(v,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),S(O.arrayFormatSeparator);const m=_(O),E=Object.create(null);if(typeof v!="string"||(v=v.trim().replace(/^[?#&]/,""),!v))return E;for(const y of v.split("&")){if(y==="")continue;let[s,d]=n(O.decode?y.replace(/\+/g," "):y,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?d:N(d,O),m(N(s,O),d,E)}for(const y of Object.keys(E)){const s=E[y];if(typeof s=="object"&&s!==null)for(const d of Object.keys(s))s[d]=B(s[d],O);else E[y]=B(s,O)}return O.sort===!1?E:(O.sort===!0?Object.keys(E).sort():Object.keys(E).sort(O.sort)).reduce((y,s)=>{const d=E[s];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?y[s]=j(d):y[s]=d,y},Object.create(null))}r.extract=M,r.parse=G,r.stringify=(v,O)=>{if(!v)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),S(O.arrayFormatSeparator);const m=d=>O.skipNull&&f(v[d])||O.skipEmptyString&&v[d]==="",E=p(O),y={};for(const d of Object.keys(v))m(d)||(y[d]=v[d]);const s=Object.keys(y);return O.sort!==!1&&s.sort(O.sort),s.map(d=>{const $=v[d];return $===void 0?"":$===null?I(d,O):Array.isArray($)?$.length===0&&O.arrayFormat==="bracket-separator"?I(d,O)+"[]":$.reduce(E(d),[]).join("&"):I(d,O)+"="+I($,O)}).filter(d=>d.length>0).join("&")},r.parseUrl=(v,O)=>{O=Object.assign({decode:!0},O);const[m,E]=n(v,"#");return Object.assign({url:m.split("?")[0]||"",query:G(M(v),O)},O&&O.parseFragmentIdentifier&&E?{fragmentIdentifier:N(E,O)}:{})},r.stringifyUrl=(v,O)=>{O=Object.assign({encode:!0,strict:!0,[g]:!0},O);const m=C(v.url).split("?")[0]||"",E=r.extract(v.url),y=r.parse(E,{sort:!1}),s=Object.assign(y,v.query);let d=r.stringify(s,O);d&&(d=`?${d}`);let $=P(v.url);return v.fragmentIdentifier&&($=`#${O[g]?I(v.fragmentIdentifier,O):v.fragmentIdentifier}`),`${m}${d}${$}`},r.pick=(v,O,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[g]:!1},m);const{url:E,query:y,fragmentIdentifier:s}=r.parseUrl(v,m);return r.stringifyUrl({url:E,query:i(y,O),fragmentIdentifier:s},m)},r.exclude=(v,O,m)=>{const E=Array.isArray(O)?y=>!O.includes(y):(y,s)=>!O(y,s);return r.pick(v,E,m)}})(Dr);const yl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function si(r,e){return r.includes(":")?[r]:e.chains||[]}const ca="base10",ft="base16",qn="base64pad",oi="utf8",ua=0,Qt=1,_l=0,vs=1,zn=12,ai=32;function bl(){const r=ri.generateKeyPair();return{privateKey:lt(r.secretKey,ft),publicKey:lt(r.publicKey,ft)}}function Kn(){const r=sr.randomBytes(ai);return lt(r,ft)}function ml(r,e){const t=ri.sharedKey(ht(r,ft),ht(e,ft)),n=new zf(an.SHA256,t).expand(ai);return lt(n,ft)}function vl(r){const e=an.hash(ht(r,ft));return lt(e,ft)}function Xr(r){const e=an.hash(ht(r,oi));return lt(e,ft)}function wl(r){return ht(`${r}`,ca)}function Ar(r){return Number(lt(r,ca))}function El(r){const e=wl(typeof r.type<"u"?r.type:ua);if(Ar(e)===Qt&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?ht(r.senderPublicKey,ft):void 0,n=typeof r.iv<"u"?ht(r.iv,ft):sr.randomBytes(zn),i=new ei.ChaCha20Poly1305(ht(r.symKey,ft)).seal(n,ht(r.message,oi));return Sl({type:e,sealed:i,iv:n,senderPublicKey:t})}function Dl(r){const e=new ei.ChaCha20Poly1305(ht(r.symKey,ft)),{sealed:t,iv:n}=ci(r.encoded),i=e.open(n,t);if(i===null)throw new Error("Failed to decrypt");return lt(i,oi)}function Sl(r){if(Ar(r.type)===Qt){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lt(jn([r.type,r.senderPublicKey,r.iv,r.sealed]),qn)}return lt(jn([r.type,r.iv,r.sealed]),qn)}function ci(r){const e=ht(r,qn),t=e.slice(_l,vs),n=vs;if(Ar(t)===Qt){const p=n+ai,_=p+zn,S=e.slice(n,p),I=e.slice(p,_),N=e.slice(_);return{type:t,sealed:N,iv:I,senderPublicKey:S}}const i=n+zn,f=e.slice(n,i),g=e.slice(i);return{type:t,sealed:g,iv:f}}function Ol(r,e){const t=ci(r);return ha({type:Ar(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?lt(t.senderPublicKey,ft):void 0,receiverPublicKey:e?.receiverPublicKey})}function ha(r){const e=r?.type||ua;if(e===Qt){if(typeof r?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof r?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r?.senderPublicKey,receiverPublicKey:r?.receiverPublicKey}}function ws(r){return r.type===Qt&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var Il=Object.defineProperty,Es=Object.getOwnPropertySymbols,xl=Object.prototype.hasOwnProperty,Pl=Object.prototype.propertyIsEnumerable,Ds=(r,e,t)=>e in r?Il(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ss=(r,e)=>{for(var t in e||(e={}))xl.call(e,t)&&Ds(r,t,e[t]);if(Es)for(var t of Es(e))Pl.call(e,t)&&Ds(r,t,e[t]);return r};const Tl="ReactNative",vr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Al="js";function fa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Nl(){return!ea()&&!!ni()&&navigator.product===Tl}function Cl(){return!fa()&&!!ni()}function Rl(){return Nl()?vr.reactNative:fa()?vr.node:Cl()?vr.browser:vr.unknown}function Fl(r,e){let t=Dr.parse(r);return t=Ss(Ss({},t),e),r=Dr.stringify(t),r}function Ll(){return ra()||{name:"",description:"",url:"",icons:[""]}}function Ul(){const r=Zf();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function jl(){var r;const e=Rl();return e===vr.browser?[e,((r=ta())==null?void 0:r.host)||"unknown"].join(":"):e}function Ml(r,e,t){const n=Ul(),i=jl();return[[r,e].join("-"),[Al,t].join("-"),n,i].join("/")}function $l({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:i,projectId:f}){const g=t.split("?"),p=Ml(r,e,n),_={auth:i,ua:p,projectId:f},S=Fl(g[1]||"",_);return g[0]+"?"+S}function Mt(r,e){return r.filter(t=>e.includes(t)).length===r.length}function la(r){return Object.fromEntries(r.entries())}function da(r){return new Map(Object.entries(r))}function Jt(r){const e=te.toMiliseconds(r||te.FIVE_MINUTES);let t,n,i;return{resolve:f=>{i&&t&&(clearTimeout(i),t(f))},reject:f=>{i&&n&&(clearTimeout(i),n(f))},done:()=>new Promise((f,g)=>{i=setTimeout(g,e),t=f,n=g})}}function pa(r,e){return new Promise(async(t,n)=>{const i=setTimeout(()=>n(),e),f=await r;clearTimeout(i),t(f)})}function ga(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function Bl(r){return ga("topic",r)}function Hl(r){return ga("id",r)}function ya(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function xt(r,e){return te.fromMiliseconds((e||Date.now())+te.toMiliseconds(r))}function jt(r){return Date.now()>=te.toMiliseconds(r)}function je(r,e){return`${r}${e?`:${e}`:""}`}const ql="irn";function Vn(r){return r?.relay||{protocol:ql}}function Gn(r){const e=yl[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var zl=Object.defineProperty,Os=Object.getOwnPropertySymbols,Kl=Object.prototype.hasOwnProperty,Vl=Object.prototype.propertyIsEnumerable,Is=(r,e,t)=>e in r?zl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gl=(r,e)=>{for(var t in e||(e={}))Kl.call(e,t)&&Is(r,t,e[t]);if(Os)for(var t of Os(e))Vl.call(e,t)&&Is(r,t,e[t]);return r};function Wl(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(i=>{if(i.startsWith(n)){const f=i.replace(n,""),g=r[i];t[f]=g}}),t}function kl(r){const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),i=r.substring(e+1,t).split("@"),f=typeof t<"u"?r.substring(t):"",g=Dr.parse(f);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:g.symKey,relay:Wl(g)}}function Yl(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(i=>{const f=t+e+i;r[i]&&(n[f]=r[i])}),n}function Jl(r){return`${r.protocol}:${r.topic}@${r.version}?`+Dr.stringify(Gl({symKey:r.symKey},Yl(r.relay)))}function Nr(r){const e=[];return r.forEach(t=>{const[n,i]=t.split(":");e.push(`${n}:${i}`)}),e}function Xl(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Nr(t.accounts))}),e}function Zl(r,e){const t=[];return Object.values(r).forEach(n=>{Nr(n.accounts).includes(e)&&t.push(...n.methods)}),t}function Ql(r,e){const t=[];return Object.values(r).forEach(n=>{Nr(n.accounts).includes(e)&&t.push(...n.events)}),t}function ed(r,e){const t=Wr(r,e);if(t)throw new Error(t.message);const n={};for(const[i,f]of Object.entries(r))n[i]={methods:f.methods,events:f.events,chains:f.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return n}const td={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},rd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(r,e){const{message:t,code:n}=rd[r];return{message:e?`${t} ${e}`:t,code:n}}function Ze(r,e){const{message:t,code:n}=td[r];return{message:e?`${t} ${e}`:t,code:n}}function cn(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function wr(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ct(r){return typeof r>"u"}function Qe(r,e){return e&&ct(r)?!0:typeof r=="string"&&Boolean(r.trim().length)}function ui(r,e){return e&&ct(r)?!0:typeof r=="number"&&!isNaN(r)}function nd(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),i=Object.keys(t);let f=!0;return Mt(i,n)?(n.forEach(g=>{const{accounts:p,methods:_,events:S}=r.namespaces[g],I=Nr(p),N=t[g];(!Mt(si(g,N),I)||!Mt(N.methods,_)||!Mt(N.events,S))&&(f=!1)}),f):!1}function hi(r){return Qe(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function id(r){if(Qe(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&hi(t)}}return!1}function sd(r){if(Qe(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function od(r){var e;return(e=r?.proposer)==null?void 0:e.publicKey}function ad(r){return r?.topic}function cd(r,e){let t=null;return Qe(r?.publicKey,!1)||(t=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function xs(r){let e=!0;return cn(r)?r.length&&(e=r.every(t=>Qe(t,!1))):e=!1,e}function ud(r,e,t){let n=null;return cn(e)?e.forEach(i=>{n||(!hi(i)||!i.includes(r))&&(n=Ze("UNSUPPORTED_CHAINS",`${t}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ze("UNSUPPORTED_CHAINS",`${t}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function hd(r,e){let t=null;return Object.entries(r).forEach(([n,i])=>{if(t)return;const f=ud(n,si(n,i),`${e} requiredNamespace`);f&&(t=f)}),t}function fd(r,e){let t=null;return cn(r)?r.forEach(n=>{t||id(n)||(t=Ze("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=Ze("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function ld(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=fd(n?.accounts,`${e} namespace`);i&&(t=i)}),t}function dd(r,e){let t=null;return xs(r?.methods)?xs(r?.events)||(t=Ze("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ze("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function _a(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const i=dd(n,`${e}, namespace`);i&&(t=i)}),t}function pd(r,e,t){let n=null;if(r&&wr(r)){const i=_a(r,e);i&&(n=i);const f=hd(r,e);f&&(n=f)}else n=J("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function Wr(r,e){let t=null;if(r&&wr(r)){const n=_a(r,e);n&&(t=n);const i=ld(r,e);i&&(t=i)}else t=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function ba(r){return Qe(r.protocol,!0)}function gd(r,e){let t=!1;return e&&!r?t=!0:r&&cn(r)&&r.length&&r.forEach(n=>{t=ba(n)}),t}function yd(r){return typeof r=="number"}function ut(r){return typeof r<"u"&&typeof r!==null}function _d(r){return!(!r||typeof r!="object"||!r.code||!ui(r.code,!1)||!r.message||!Qe(r.message,!1))}function bd(r){return!(ct(r)||!Qe(r.method,!1))}function md(r){return!(ct(r)||ct(r.result)&&ct(r.error)||!ui(r.id,!1)||!Qe(r.jsonrpc,!1))}function vd(r){return!(ct(r)||!Qe(r.name,!1))}function Ps(r,e){return!(!hi(e)||!Xl(r).includes(e))}function wd(r,e,t){return Qe(t,!1)?Zl(r,e).includes(t):!1}function Ed(r,e,t){return Qe(t,!1)?Ql(r,e).includes(t):!1}function In(r,e,t,n){let i=null;const f=Object.keys(r),g=Object.keys(e);return Mt(f,g)?f.forEach(p=>{if(i)return;const _=Nr(e[p].accounts);Mt(si(p,r[p]),_)?Mt(r[p].methods,e[p].methods)?Mt(r[p].events,e[p].events)||(i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${p}`)):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${p}`):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace chains for ${p}`)}):i=J("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy ${n}`),i}function Dd(r,e){return ui(r,!1)&&r<=e.max&&r>=e.min}const Sd="PARSE_ERROR",Od="INVALID_REQUEST",Id="METHOD_NOT_FOUND",xd="INVALID_PARAMS",ma="INTERNAL_ERROR",fi="SERVER_ERROR",Pd=[-32700,-32600,-32601,-32602,-32603],Er={[Sd]:{code:-32700,message:"Parse error"},[Od]:{code:-32600,message:"Invalid Request"},[Id]:{code:-32601,message:"Method not found"},[xd]:{code:-32602,message:"Invalid params"},[ma]:{code:-32603,message:"Internal error"},[fi]:{code:-32e3,message:"Server error"}},va=fi;function Td(r){return Pd.includes(r)}function Ts(r){return Object.keys(Er).includes(r)?Er[r]:Er[va]}function Ad(r){const e=Object.values(Er).find(t=>t.code===r);return e||Er[va]}function wa(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var Ea={},Da={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,n,i,f,g,p,_,S,I,N,j,C,P,M,B,G,v,O,m,E,y,s;(function(d){var $=typeof Ae=="object"?Ae:typeof self=="object"?self:typeof this=="object"?this:{};d(o($,o(r.exports)));function o(h,l){return h!==$&&(typeof Object.create=="function"?Object.defineProperty(h,"__esModule",{value:!0}):h.__esModule=!0),function(b,a){return h[b]=l?l(b,a):a}}})(function(d){var $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,h){o.__proto__=h}||function(o,h){for(var l in h)h.hasOwnProperty(l)&&(o[l]=h[l])};e=function(o,h){$(o,h);function l(){this.constructor=o}o.prototype=h===null?Object.create(h):(l.prototype=h.prototype,new l)},t=Object.assign||function(o){for(var h,l=1,b=arguments.length;l<b;l++){h=arguments[l];for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&(o[a]=h[a])}return o},n=function(o,h){var l={};for(var b in o)Object.prototype.hasOwnProperty.call(o,b)&&h.indexOf(b)<0&&(l[b]=o[b]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,b=Object.getOwnPropertySymbols(o);a<b.length;a++)h.indexOf(b[a])<0&&Object.prototype.propertyIsEnumerable.call(o,b[a])&&(l[b[a]]=o[b[a]]);return l},i=function(o,h,l,b){var a=arguments.length,c=a<3?h:b===null?b=Object.getOwnPropertyDescriptor(h,l):b,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,h,l,b);else for(var T=o.length-1;T>=0;T--)(D=o[T])&&(c=(a<3?D(c):a>3?D(h,l,c):D(h,l))||c);return a>3&&c&&Object.defineProperty(h,l,c),c},f=function(o,h){return function(l,b){h(l,b,o)}},g=function(o,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,h)},p=function(o,h,l,b){function a(c){return c instanceof l?c:new l(function(D){D(c)})}return new(l||(l=Promise))(function(c,D){function T(R){try{w(b.next(R))}catch(K){D(K)}}function U(R){try{w(b.throw(R))}catch(K){D(K)}}function w(R){R.done?c(R.value):a(R.value).then(T,U)}w((b=b.apply(o,h||[])).next())})},_=function(o,h){var l={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},b,a,c,D;return D={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function T(w){return function(R){return U([w,R])}}function U(w){if(b)throw new TypeError("Generator is already executing.");for(;l;)try{if(b=1,a&&(c=w[0]&2?a.return:w[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,w[1])).done)return c;switch(a=0,c&&(w=[w[0]&2,c.value]),w[0]){case 0:case 1:c=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,a=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!c||w[1]>c[0]&&w[1]<c[3])){l.label=w[1];break}if(w[0]===6&&l.label<c[1]){l.label=c[1],c=w;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(w);break}c[2]&&l.ops.pop(),l.trys.pop();continue}w=h.call(o,l)}catch(R){w=[6,R],a=0}finally{b=c=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},s=function(o,h,l,b){b===void 0&&(b=l),o[b]=h[l]},S=function(o,h){for(var l in o)l!=="default"&&!h.hasOwnProperty(l)&&(h[l]=o[l])},I=function(o){var h=typeof Symbol=="function"&&Symbol.iterator,l=h&&o[h],b=0;if(l)return l.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&b>=o.length&&(o=void 0),{value:o&&o[b++],done:!o}}};throw new TypeError(h?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(o,h){var l=typeof Symbol=="function"&&o[Symbol.iterator];if(!l)return o;var b=l.call(o),a,c=[],D;try{for(;(h===void 0||h-- >0)&&!(a=b.next()).done;)c.push(a.value)}catch(T){D={error:T}}finally{try{a&&!a.done&&(l=b.return)&&l.call(b)}finally{if(D)throw D.error}}return c},j=function(){for(var o=[],h=0;h<arguments.length;h++)o=o.concat(N(arguments[h]));return o},C=function(){for(var o=0,h=0,l=arguments.length;h<l;h++)o+=arguments[h].length;for(var b=Array(o),a=0,h=0;h<l;h++)for(var c=arguments[h],D=0,T=c.length;D<T;D++,a++)b[a]=c[D];return b},P=function(o){return this instanceof P?(this.v=o,this):new P(o)},M=function(o,h,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=l.apply(o,h||[]),a,c=[];return a={},D("next"),D("throw"),D("return"),a[Symbol.asyncIterator]=function(){return this},a;function D(z){b[z]&&(a[z]=function(V){return new Promise(function(X,Y){c.push([z,V,X,Y])>1||T(z,V)})})}function T(z,V){try{U(b[z](V))}catch(X){K(c[0][3],X)}}function U(z){z.value instanceof P?Promise.resolve(z.value.v).then(w,R):K(c[0][2],z)}function w(z){T("next",z)}function R(z){T("throw",z)}function K(z,V){z(V),c.shift(),c.length&&T(c[0][0],c[0][1])}},B=function(o){var h,l;return h={},b("next"),b("throw",function(a){throw a}),b("return"),h[Symbol.iterator]=function(){return this},h;function b(a,c){h[a]=o[a]?function(D){return(l=!l)?{value:P(o[a](D)),done:a==="return"}:c?c(D):D}:c}},G=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h=o[Symbol.asyncIterator],l;return h?h.call(o):(o=typeof I=="function"?I(o):o[Symbol.iterator](),l={},b("next"),b("throw"),b("return"),l[Symbol.asyncIterator]=function(){return this},l);function b(c){l[c]=o[c]&&function(D){return new Promise(function(T,U){D=o[c](D),a(T,U,D.done,D.value)})}}function a(c,D,T,U){Promise.resolve(U).then(function(w){c({value:w,done:T})},D)}},v=function(o,h){return Object.defineProperty?Object.defineProperty(o,"raw",{value:h}):o.raw=h,o},O=function(o){if(o&&o.__esModule)return o;var h={};if(o!=null)for(var l in o)Object.hasOwnProperty.call(o,l)&&(h[l]=o[l]);return h.default=o,h},m=function(o){return o&&o.__esModule?o:{default:o}},E=function(o,h){if(!h.has(o))throw new TypeError("attempted to get private field on non-instance");return h.get(o)},y=function(o,h,l){if(!h.has(o))throw new TypeError("attempted to set private field on non-instance");return h.set(o,l),l},d("__extends",e),d("__assign",t),d("__rest",n),d("__decorate",i),d("__param",f),d("__metadata",g),d("__awaiter",p),d("__generator",_),d("__exportStar",S),d("__createBinding",s),d("__values",I),d("__read",N),d("__spread",j),d("__spreadArrays",C),d("__await",P),d("__asyncGenerator",M),d("__asyncDelegator",B),d("__asyncValues",G),d("__makeTemplateObject",v),d("__importStar",O),d("__importDefault",m),d("__classPrivateFieldGet",E),d("__classPrivateFieldSet",y)})})(Da);var At={},As;function Nd(){if(As)return At;As=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function r(){return(Ae===null||Ae===void 0?void 0:Ae.crypto)||(Ae===null||Ae===void 0?void 0:Ae.msCrypto)||{}}At.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}At.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return At.isBrowserCryptoAvailable=t,At}var Nt={},Ns;function Cd(){if(Ns)return Nt;Ns=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowser=Nt.isNode=Nt.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Nt.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Nt.isNode=e;function t(){return!r()&&!e()}return Nt.isBrowser=t,Nt}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=Da.exports;e.__exportStar(Nd(),r),e.__exportStar(Cd(),r)})(Ea);function Rd(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function un(r,e,t){return{id:t||Rd(),jsonrpc:"2.0",method:r,params:e}}function li(r,e){return{id:r,jsonrpc:"2.0",result:e}}function hn(r,e,t){return{id:r,jsonrpc:"2.0",error:Fd(e,t)}}function Fd(r,e){return typeof r>"u"?Ts(ma):(typeof r=="string"&&(r=Object.assign(Object.assign({},Ts(fi)),{message:r})),typeof e<"u"&&(r.data=e),Td(r.code)&&(r=Ad(r.code)),r)}class Ld{}class Ud extends Ld{constructor(){super()}}class jd extends Ud{constructor(e){super()}}const Md="^https?:",$d="^wss?:";function Bd(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Sa(r,e){const t=Bd(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Cs(r){return Sa(r,Md)}function Rs(r){return Sa(r,$d)}function Hd(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Oa(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function di(r){return Oa(r)&&"method"in r}function pi(r){return Oa(r)&&(Ct(r)||Et(r))}function Ct(r){return"result"in r}function Et(r){return"error"in r}class Cr extends jd{constructor(e){super(e),this.events=new ot.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(un(e.method,e.params||[]),t)}async requestStrict(e,t){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(f){i(f)}this.events.on(`${e.id}`,f=>{Et(f)?i(f.error):n(f.result)});try{await this.connection.send(e,t)}catch(f){i(f)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),pi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}function qd(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function zd(r){return typeof r=="string"?r:JSON.stringify(r)}const Fs=10,Kd=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Vd=()=>typeof window<"u",Gd=Kd();class Wd{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.registering=!1,!Rs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(zd(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Rs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),i(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const i=Ea.isReactNative()?void 0:{rejectUnauthorized:!Hd(e)},f=new Gd(e,[],i);Vd()?f.onerror=g=>{const p=g;n(this.emitError(p.error))}:f.on("error",g=>{n(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),t(f)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?qd(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),f=hn(e,i);this.events.emit("payload",f)}parseError(e,t=this.url){return wa(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Fs&&this.events.setMaxListeners(Fs)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}var Wn={exports:{}};(function(r,e){var t=200,n="__lodash_hash_undefined__",i=1,f=2,g=9007199254740991,p="[object Arguments]",_="[object Array]",S="[object AsyncFunction]",I="[object Boolean]",N="[object Date]",j="[object Error]",C="[object Function]",P="[object GeneratorFunction]",M="[object Map]",B="[object Number]",G="[object Null]",v="[object Object]",O="[object Promise]",m="[object Proxy]",E="[object RegExp]",y="[object Set]",s="[object String]",d="[object Symbol]",$="[object Undefined]",o="[object WeakMap]",h="[object ArrayBuffer]",l="[object DataView]",b="[object Float32Array]",a="[object Float64Array]",c="[object Int8Array]",D="[object Int16Array]",T="[object Int32Array]",U="[object Uint8Array]",w="[object Uint8ClampedArray]",R="[object Uint16Array]",K="[object Uint32Array]",z=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,Y={};Y[b]=Y[a]=Y[c]=Y[D]=Y[T]=Y[U]=Y[w]=Y[R]=Y[K]=!0,Y[p]=Y[_]=Y[h]=Y[I]=Y[l]=Y[N]=Y[j]=Y[C]=Y[M]=Y[B]=Y[v]=Y[E]=Y[y]=Y[s]=Y[o]=!1;var ee=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,q=typeof self=="object"&&self&&self.Object===Object&&self,H=ee||q||Function("return this")(),F=e&&!e.nodeType&&e,u=F&&!0&&r&&!r.nodeType&&r,A=u&&u.exports===F,k=A&&ee.process,Z=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),fe=Z&&Z.isTypedArray;function _e(x,L){for(var W=-1,Q=x==null?0:x.length,Pe=0,se=[];++W<Q;){var Le=x[W];L(Le,W,x)&&(se[Pe++]=Le)}return se}function de(x,L){for(var W=-1,Q=L.length,Pe=x.length;++W<Q;)x[Pe+W]=L[W];return x}function ve(x,L){for(var W=-1,Q=x==null?0:x.length;++W<Q;)if(L(x[W],W,x))return!0;return!1}function Ue(x,L){for(var W=-1,Q=Array(x);++W<x;)Q[W]=L(W);return Q}function Ce(x){return function(L){return x(L)}}function ye(x,L){return x.has(L)}function pe(x,L){return x?.[L]}function le(x){var L=-1,W=Array(x.size);return x.forEach(function(Q,Pe){W[++L]=[Pe,Q]}),W}function ue(x,L){return function(W){return x(L(W))}}function ce(x){var L=-1,W=Array(x.size);return x.forEach(function(Q){W[++L]=Q}),W}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,he=H["__core-js_shared__"],ge=oe.toString,ne=re.hasOwnProperty,be=function(){var x=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),me=re.toString,Ee=RegExp("^"+ge.call(ne).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=A?H.Buffer:void 0,we=H.Symbol,vt=H.Uint8Array,Dt=re.propertyIsEnumerable,Rt=ae.splice,dt=we?we.toStringTag:void 0,qt=Object.getOwnPropertySymbols,cr=De?De.isBuffer:void 0,Lr=ue(Object.keys,Object),Me=tr(H,"DataView"),Re=tr(H,"Map"),$e=tr(H,"Promise"),Be=tr(H,"Set"),He=tr(H,"WeakMap"),Fe=tr(Object,"create"),Ke=Kt(Me),Ve=Kt(Re),Ge=Kt($e),We=Kt(Be),ke=Kt(He),ze=we?we.prototype:void 0,qe=ze?ze.valueOf:void 0;function Te(x){var L=-1,W=x==null?0:x.length;for(this.clear();++L<W;){var Q=x[L];this.set(Q[0],Q[1])}}function Ye(){this.__data__=Fe?Fe(null):{},this.size=0}function Je(x){var L=this.has(x)&&delete this.__data__[x];return this.size-=L?1:0,L}function qa(x){var L=this.__data__;if(Fe){var W=L[x];return W===n?void 0:W}return ne.call(L,x)?L[x]:void 0}function za(x){var L=this.__data__;return Fe?L[x]!==void 0:ne.call(L,x)}function Ka(x,L){var W=this.__data__;return this.size+=this.has(x)?0:1,W[x]=Fe&&L===void 0?n:L,this}Te.prototype.clear=Ye,Te.prototype.delete=Je,Te.prototype.get=qa,Te.prototype.has=za,Te.prototype.set=Ka;function Pt(x){var L=-1,W=x==null?0:x.length;for(this.clear();++L<W;){var Q=x[L];this.set(Q[0],Q[1])}}function Va(){this.__data__=[],this.size=0}function Ga(x){var L=this.__data__,W=jr(L,x);if(W<0)return!1;var Q=L.length-1;return W==Q?L.pop():Rt.call(L,W,1),--this.size,!0}function Wa(x){var L=this.__data__,W=jr(L,x);return W<0?void 0:L[W][1]}function ka(x){return jr(this.__data__,x)>-1}function Ya(x,L){var W=this.__data__,Q=jr(W,x);return Q<0?(++this.size,W.push([x,L])):W[Q][1]=L,this}Pt.prototype.clear=Va,Pt.prototype.delete=Ga,Pt.prototype.get=Wa,Pt.prototype.has=ka,Pt.prototype.set=Ya;function zt(x){var L=-1,W=x==null?0:x.length;for(this.clear();++L<W;){var Q=x[L];this.set(Q[0],Q[1])}}function Ja(){this.size=0,this.__data__={hash:new Te,map:new(Re||Pt),string:new Te}}function Xa(x){var L=Mr(this,x).delete(x);return this.size-=L?1:0,L}function Za(x){return Mr(this,x).get(x)}function Qa(x){return Mr(this,x).has(x)}function ec(x,L){var W=Mr(this,x),Q=W.size;return W.set(x,L),this.size+=W.size==Q?0:1,this}zt.prototype.clear=Ja,zt.prototype.delete=Xa,zt.prototype.get=Za,zt.prototype.has=Qa,zt.prototype.set=ec;function Ur(x){var L=-1,W=x==null?0:x.length;for(this.__data__=new zt;++L<W;)this.add(x[L])}function tc(x){return this.__data__.set(x,n),this}function rc(x){return this.__data__.has(x)}Ur.prototype.add=Ur.prototype.push=tc,Ur.prototype.has=rc;function Ft(x){var L=this.__data__=new Pt(x);this.size=L.size}function nc(){this.__data__=new Pt,this.size=0}function ic(x){var L=this.__data__,W=L.delete(x);return this.size=L.size,W}function sc(x){return this.__data__.get(x)}function oc(x){return this.__data__.has(x)}function ac(x,L){var W=this.__data__;if(W instanceof Pt){var Q=W.__data__;if(!Re||Q.length<t-1)return Q.push([x,L]),this.size=++W.size,this;W=this.__data__=new zt(Q)}return W.set(x,L),this.size=W.size,this}Ft.prototype.clear=nc,Ft.prototype.delete=ic,Ft.prototype.get=sc,Ft.prototype.has=oc,Ft.prototype.set=ac;function cc(x,L){var W=$r(x),Q=!W&&Dc(x),Pe=!W&&!Q&&gn(x),se=!W&&!Q&&!Pe&&Ti(x),Le=W||Q||Pe||se,Xe=Le?Ue(x.length,String):[],et=Xe.length;for(var Ne in x)(L||ne.call(x,Ne))&&!(Le&&(Ne=="length"||Pe&&(Ne=="offset"||Ne=="parent")||se&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||bc(Ne,et)))&&Xe.push(Ne);return Xe}function jr(x,L){for(var W=x.length;W--;)if(Oi(x[W][0],L))return W;return-1}function uc(x,L,W){var Q=L(x);return $r(x)?Q:de(Q,W(x))}function ur(x){return x==null?x===void 0?$:G:dt&&dt in Object(x)?yc(x):Ec(x)}function wi(x){return hr(x)&&ur(x)==p}function Ei(x,L,W,Q,Pe){return x===L?!0:x==null||L==null||!hr(x)&&!hr(L)?x!==x&&L!==L:hc(x,L,W,Q,Ei,Pe)}function hc(x,L,W,Q,Pe,se){var Le=$r(x),Xe=$r(L),et=Le?_:Lt(x),Ne=Xe?_:Lt(L);et=et==p?v:et,Ne=Ne==p?v:Ne;var pt=et==v,wt=Ne==v,it=et==Ne;if(it&&gn(x)){if(!gn(L))return!1;Le=!0,pt=!1}if(it&&!pt)return se||(se=new Ft),Le||Ti(x)?Di(x,L,W,Q,Pe,se):pc(x,L,et,W,Q,Pe,se);if(!(W&i)){var yt=pt&&ne.call(x,"__wrapped__"),_t=wt&&ne.call(L,"__wrapped__");if(yt||_t){var Ut=yt?x.value():x,Tt=_t?L.value():L;return se||(se=new Ft),Pe(Ut,Tt,W,Q,se)}}return it?(se||(se=new Ft),gc(x,L,W,Q,Pe,se)):!1}function fc(x){if(!Pi(x)||vc(x))return!1;var L=Ii(x)?Ee:V;return L.test(Kt(x))}function lc(x){return hr(x)&&xi(x.length)&&!!Y[ur(x)]}function dc(x){if(!wc(x))return Lr(x);var L=[];for(var W in Object(x))ne.call(x,W)&&W!="constructor"&&L.push(W);return L}function Di(x,L,W,Q,Pe,se){var Le=W&i,Xe=x.length,et=L.length;if(Xe!=et&&!(Le&&et>Xe))return!1;var Ne=se.get(x);if(Ne&&se.get(L))return Ne==L;var pt=-1,wt=!0,it=W&f?new Ur:void 0;for(se.set(x,L),se.set(L,x);++pt<Xe;){var yt=x[pt],_t=L[pt];if(Q)var Ut=Le?Q(_t,yt,pt,L,x,se):Q(yt,_t,pt,x,L,se);if(Ut!==void 0){if(Ut)continue;wt=!1;break}if(it){if(!ve(L,function(Tt,Vt){if(!ye(it,Vt)&&(yt===Tt||Pe(yt,Tt,W,Q,se)))return it.push(Vt)})){wt=!1;break}}else if(!(yt===_t||Pe(yt,_t,W,Q,se))){wt=!1;break}}return se.delete(x),se.delete(L),wt}function pc(x,L,W,Q,Pe,se,Le){switch(W){case l:if(x.byteLength!=L.byteLength||x.byteOffset!=L.byteOffset)return!1;x=x.buffer,L=L.buffer;case h:return!(x.byteLength!=L.byteLength||!se(new vt(x),new vt(L)));case I:case N:case B:return Oi(+x,+L);case j:return x.name==L.name&&x.message==L.message;case E:case s:return x==L+"";case M:var Xe=le;case y:var et=Q&i;if(Xe||(Xe=ce),x.size!=L.size&&!et)return!1;var Ne=Le.get(x);if(Ne)return Ne==L;Q|=f,Le.set(x,L);var pt=Di(Xe(x),Xe(L),Q,Pe,se,Le);return Le.delete(x),pt;case d:if(qe)return qe.call(x)==qe.call(L)}return!1}function gc(x,L,W,Q,Pe,se){var Le=W&i,Xe=Si(x),et=Xe.length,Ne=Si(L),pt=Ne.length;if(et!=pt&&!Le)return!1;for(var wt=et;wt--;){var it=Xe[wt];if(!(Le?it in L:ne.call(L,it)))return!1}var yt=se.get(x);if(yt&&se.get(L))return yt==L;var _t=!0;se.set(x,L),se.set(L,x);for(var Ut=Le;++wt<et;){it=Xe[wt];var Tt=x[it],Vt=L[it];if(Q)var Ai=Le?Q(Vt,Tt,it,L,x,se):Q(Tt,Vt,it,x,L,se);if(!(Ai===void 0?Tt===Vt||Pe(Tt,Vt,W,Q,se):Ai)){_t=!1;break}Ut||(Ut=it=="constructor")}if(_t&&!Ut){var Br=x.constructor,Hr=L.constructor;Br!=Hr&&"constructor"in x&&"constructor"in L&&!(typeof Br=="function"&&Br instanceof Br&&typeof Hr=="function"&&Hr instanceof Hr)&&(_t=!1)}return se.delete(x),se.delete(L),_t}function Si(x){return uc(x,Ic,_c)}function Mr(x,L){var W=x.__data__;return mc(L)?W[typeof L=="string"?"string":"hash"]:W.map}function tr(x,L){var W=pe(x,L);return fc(W)?W:void 0}function yc(x){var L=ne.call(x,dt),W=x[dt];try{x[dt]=void 0;var Q=!0}catch{}var Pe=me.call(x);return Q&&(L?x[dt]=W:delete x[dt]),Pe}var _c=qt?function(x){return x==null?[]:(x=Object(x),_e(qt(x),function(L){return Dt.call(x,L)}))}:xc,Lt=ur;(Me&&Lt(new Me(new ArrayBuffer(1)))!=l||Re&&Lt(new Re)!=M||$e&&Lt($e.resolve())!=O||Be&&Lt(new Be)!=y||He&&Lt(new He)!=o)&&(Lt=function(x){var L=ur(x),W=L==v?x.constructor:void 0,Q=W?Kt(W):"";if(Q)switch(Q){case Ke:return l;case Ve:return M;case Ge:return O;case We:return y;case ke:return o}return L});function bc(x,L){return L=L??g,!!L&&(typeof x=="number"||X.test(x))&&x>-1&&x%1==0&&x<L}function mc(x){var L=typeof x;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?x!=="__proto__":x===null}function vc(x){return!!be&&be in x}function wc(x){var L=x&&x.constructor,W=typeof L=="function"&&L.prototype||re;return x===W}function Ec(x){return me.call(x)}function Kt(x){if(x!=null){try{return ge.call(x)}catch{}try{return x+""}catch{}}return""}function Oi(x,L){return x===L||x!==x&&L!==L}var Dc=wi(function(){return arguments}())?wi:function(x){return hr(x)&&ne.call(x,"callee")&&!Dt.call(x,"callee")},$r=Array.isArray;function Sc(x){return x!=null&&xi(x.length)&&!Ii(x)}var gn=cr||Pc;function Oc(x,L){return Ei(x,L)}function Ii(x){if(!Pi(x))return!1;var L=ur(x);return L==C||L==P||L==S||L==m}function xi(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=g}function Pi(x){var L=typeof x;return x!=null&&(L=="object"||L=="function")}function hr(x){return x!=null&&typeof x=="object"}var Ti=fe?Ce(fe):lc;function Ic(x){return Sc(x)?cc(x):dc(x)}function xc(){return[]}function Pc(){return!1}r.exports=Oc})(Wn,Wn.exports);const kd=Wn.exports;function Yd(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var f=r.charAt(i),g=f.charCodeAt(0);if(t[g]!==255)throw new TypeError(f+" is ambiguous");t[g]=i}var p=r.length,_=r.charAt(0),S=Math.log(p)/Math.log(256),I=Math.log(256)/Math.log(p);function N(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var M=0,B=0,G=0,v=P.length;G!==v&&P[G]===0;)G++,M++;for(var O=(v-G)*I+1>>>0,m=new Uint8Array(O);G!==v;){for(var E=P[G],y=0,s=O-1;(E!==0||y<B)&&s!==-1;s--,y++)E+=256*m[s]>>>0,m[s]=E%p>>>0,E=E/p>>>0;if(E!==0)throw new Error("Non-zero carry");B=y,G++}for(var d=O-B;d!==O&&m[d]===0;)d++;for(var $=_.repeat(M);d<O;++d)$+=r.charAt(m[d]);return $}function j(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var M=0;if(P[M]!==" "){for(var B=0,G=0;P[M]===_;)B++,M++;for(var v=(P.length-M)*S+1>>>0,O=new Uint8Array(v);P[M];){var m=t[P.charCodeAt(M)];if(m===255)return;for(var E=0,y=v-1;(m!==0||E<G)&&y!==-1;y--,E++)m+=p*O[y]>>>0,O[y]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");G=E,M++}if(P[M]!==" "){for(var s=v-G;s!==v&&O[s]===0;)s++;for(var d=new Uint8Array(B+(v-s)),$=B;s!==v;)d[$++]=O[s++];return d}}}function C(P){var M=j(P);if(M)return M;throw new Error(`Non-${e} character`)}return{encode:N,decodeUnsafe:j,decode:C}}var Jd=Yd,Xd=Jd;const Ia=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Zd=r=>new TextEncoder().encode(r),Qd=r=>new TextDecoder().decode(r);class ep{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class tp{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return xa(this,e)}}class rp{constructor(e){this.decoders=e}or(e){return xa(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xa=(r,e)=>new rp({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class np{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new ep(e,t,n),this.decoder=new tp(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const fn=({name:r,prefix:e,encode:t,decode:n})=>new np(r,e,t,n),Rr=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:i}=Xd(t,e);return fn({prefix:r,name:e,encode:n,decode:f=>Ia(i(f))})},ip=(r,e,t,n)=>{const i={};for(let I=0;I<e.length;++I)i[e[I]]=I;let f=r.length;for(;r[f-1]==="=";)--f;const g=new Uint8Array(f*t/8|0);let p=0,_=0,S=0;for(let I=0;I<f;++I){const N=i[r[I]];if(N===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<t|N,p+=t,p>=8&&(p-=8,g[S++]=255&_>>p)}if(p>=t||255&_<<8-p)throw new SyntaxError("Unexpected end of data");return g},sp=(r,e,t)=>{const n=e[e.length-1]==="=",i=(1<<t)-1;let f="",g=0,p=0;for(let _=0;_<r.length;++_)for(p=p<<8|r[_],g+=8;g>t;)g-=t,f+=e[i&p>>g];if(g&&(f+=e[i&p<<t-g]),n)for(;f.length*t&7;)f+="=";return f},nt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>fn({prefix:e,name:r,encode(i){return sp(i,n,t)},decode(i){return ip(i,n,t,r)}}),op=fn({prefix:"\0",name:"identity",encode:r=>Qd(r),decode:r=>Zd(r)});var ap=Object.freeze({__proto__:null,identity:op});const cp=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var up=Object.freeze({__proto__:null,base2:cp});const hp=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var fp=Object.freeze({__proto__:null,base8:hp});const lp=Rr({prefix:"9",name:"base10",alphabet:"0123456789"});var dp=Object.freeze({__proto__:null,base10:lp});const pp=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),gp=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var yp=Object.freeze({__proto__:null,base16:pp,base16upper:gp});const _p=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bp=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mp=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vp=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wp=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ep=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dp=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Sp=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Op=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ip=Object.freeze({__proto__:null,base32:_p,base32upper:bp,base32pad:mp,base32padupper:vp,base32hex:wp,base32hexupper:Ep,base32hexpad:Dp,base32hexpadupper:Sp,base32z:Op});const xp=Rr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Pp=Rr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Tp=Object.freeze({__proto__:null,base36:xp,base36upper:Pp});const Ap=Rr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Np=Rr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Cp=Object.freeze({__proto__:null,base58btc:Ap,base58flickr:Np});const Rp=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fp=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lp=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Up=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var jp=Object.freeze({__proto__:null,base64:Rp,base64pad:Fp,base64url:Lp,base64urlpad:Up});const Pa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Mp=Pa.reduce((r,e,t)=>(r[t]=e,r),[]),$p=Pa.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Bp(r){return r.reduce((e,t)=>(e+=Mp[t],e),"")}function Hp(r){const e=[];for(const t of r){const n=$p[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const qp=fn({prefix:"\u{1F680}",name:"base256emoji",encode:Bp,decode:Hp});var zp=Object.freeze({__proto__:null,base256emoji:qp}),Kp=Ta,Ls=128,Vp=127,Gp=~Vp,Wp=Math.pow(2,31);function Ta(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Wp;)e[t++]=r&255|Ls,r/=128;for(;r&Gp;)e[t++]=r&255|Ls,r>>>=7;return e[t]=r|0,Ta.bytes=t-n+1,e}var kp=kn,Yp=128,Us=127;function kn(r,n){var t=0,n=n||0,i=0,f=n,g,p=r.length;do{if(f>=p)throw kn.bytes=0,new RangeError("Could not decode varint");g=r[f++],t+=i<28?(g&Us)<<i:(g&Us)*Math.pow(2,i),i+=7}while(g>=Yp);return kn.bytes=f-n,t}var Jp=Math.pow(2,7),Xp=Math.pow(2,14),Zp=Math.pow(2,21),Qp=Math.pow(2,28),eg=Math.pow(2,35),tg=Math.pow(2,42),rg=Math.pow(2,49),ng=Math.pow(2,56),ig=Math.pow(2,63),sg=function(r){return r<Jp?1:r<Xp?2:r<Zp?3:r<Qp?4:r<eg?5:r<tg?6:r<rg?7:r<ng?8:r<ig?9:10},og={encode:Kp,decode:kp,encodingLength:sg},Aa=og;const js=(r,e,t=0)=>(Aa.encode(r,e,t),e),Ms=r=>Aa.encodingLength(r),Yn=(r,e)=>{const t=e.byteLength,n=Ms(r),i=n+Ms(t),f=new Uint8Array(i+t);return js(r,f,0),js(t,f,n),f.set(e,i),new ag(r,t,e,f)};class ag{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const Na=({name:r,code:e,encode:t})=>new cg(r,e,t);class cg{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Yn(this.code,t):t.then(n=>Yn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ca=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),ug=Na({name:"sha2-256",code:18,encode:Ca("SHA-256")}),hg=Na({name:"sha2-512",code:19,encode:Ca("SHA-512")});var fg=Object.freeze({__proto__:null,sha256:ug,sha512:hg});const Ra=0,lg="identity",Fa=Ia,dg=r=>Yn(Ra,Fa(r)),pg={code:Ra,name:lg,encode:Fa,digest:dg};var gg=Object.freeze({__proto__:null,identity:pg});new TextEncoder,new TextDecoder;const $s={...ap,...up,...fp,...dp,...yp,...Ip,...Tp,...Cp,...jp,...zp};({...fg,...gg});function yg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function La(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Bs=La("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),xn=La("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=yg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),_g={utf8:Bs,"utf-8":Bs,hex:$s.base16,latin1:xn,ascii:xn,binary:xn,...$s};function bg(r,e="utf8"){const t=_g[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const Ua="wc",mg=2,gi="core",$t=`${Ua}@${2}:${gi}:`,vg={name:gi,logger:"error"},wg={database:":memory:"},Eg="crypto",Hs="client_ed25519_seed",Dg=te.ONE_DAY,Sg="keychain",Og="0.3",Ig="messages",xg="0.3",Pg=te.SIX_HOURS,Tg="publisher",ja="irn",Ag="error",Ma="wss://relay.walletconnect.com",Ng="relayer",tt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Cg="_subscription",qr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},qs=te.ONE_SECOND,Rg="2.4.5",Fg="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Lg="subscription",Ug="0.3",jg=te.FIVE_SECONDS*1e3,Mg="pairing",$g="0.3",br={wc_pairingDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:te.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:te.ONE_DAY,prompt:!1,tag:0},res:{ttl:te.ONE_DAY,prompt:!1,tag:0}}},Ot={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Bg="history",Hg="0.3",qg="expirer",mt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},zg="0.3";class Kg{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=Sg,this.version=Og,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:f}=J("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(f)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,la(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?da(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Vg{constructor(e,t,n){this.core=e,this.logger=t,this.name=Eg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),f=hs(i);return ko(f.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=bl();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const f=await this.getClientSeed(),g=hs(f),p=Kn();return await Af(p,i,Dg,g)},this.generateSharedKey=(i,f,g)=>{this.isInitialized();const p=this.getPrivateKey(i),_=ml(p,f);return this.setSymKey(_,g)},this.setSymKey=async(i,f)=>{this.isInitialized();const g=f||vl(i);return await this.keychain.set(g,i),g},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,f,g)=>{this.isInitialized();const p=ha(g),_=mu(f);if(ws(p)){const j=p.senderPublicKey,C=p.receiverPublicKey;i=await this.generateSharedKey(j,C)}const S=this.getSymKey(i),{type:I,senderPublicKey:N}=p;return El({type:I,symKey:S,message:_,senderPublicKey:N})},this.decode=async(i,f,g)=>{this.isInitialized();const p=Ol(f,g);if(ws(p)){const I=p.receiverPublicKey,N=p.senderPublicKey;i=await this.generateSharedKey(I,N)}const _=this.getSymKey(i),S=Dl({symKey:_,encoded:f});return bu(S)},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.keychain=n||new Kg(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const t=ci(e);return Ar(t.type)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hs)}catch{e=Kn(),await this.keychain.set(Hs,e)}return bg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Gg extends hu{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Ig,this.version=xg,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const f=Xr(i);let g=this.messages.get(n);return typeof g>"u"&&(g={}),typeof g[f]<"u"||(g[f]=i,this.messages.set(n,g),await this.persist()),f},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const f=this.get(n),g=Xr(i);return typeof f[g]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=t}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,la(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?da(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Wg extends fu{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new ot.exports.EventEmitter,this.name=Tg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,f)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:f}});try{const g=f?.ttl||Pg,p=Vn(f),_=f?.prompt||!1,S=f?.tag||0,I={topic:n,message:i,opts:{ttl:g,relay:p,prompt:_,tag:S}},N=Xr(i);this.queue.set(N,I);try{await await pa(this.rpcPublish(n,i,g,p,_,S),this.publishTimeout),this.relayer.events.emit(tt.publish,I)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(tt.connection_stalled);return}this.onPublish(N,I),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:f}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,t,n,i,f,g){var p,_,S,I;const N={method:Gn(i.protocol).publish,params:{topic:e,message:t,ttl:n,prompt:f,tag:g}};return ct((p=N.params)==null?void 0:p.prompt)&&((_=N.params)==null||delete _.prompt),ct((S=N.params)==null?void 0:S.tag)&&((I=N.params)==null||delete I.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:N}),this.relayer.provider.request(N)}onPublish(e,t){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:n,opts:i}=e;await this.publish(t,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class kg{constructor(){this.map=new Map,this.set=(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const i=n.filter(f=>f!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Yg=Object.defineProperty,Jg=Object.defineProperties,Xg=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,Zg=Object.prototype.hasOwnProperty,Qg=Object.prototype.propertyIsEnumerable,Ks=(r,e,t)=>e in r?Yg(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zr=(r,e)=>{for(var t in e||(e={}))Zg.call(e,t)&&Ks(r,t,e[t]);if(zs)for(var t of zs(e))Qg.call(e,t)&&Ks(r,t,e[t]);return r},Pn=(r,e)=>Jg(r,Xg(e));class ey extends pu{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new kg,this.events=new ot.exports.EventEmitter,this.name=Lg,this.version=Ug,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$t,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const f=Vn(i),g={topic:n,relay:f};this.pending.set(n,g);const p=await this.rpcSubscribe(n,f);return this.onSubscribe(p,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),p}catch(f){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(f),f}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,f)=>{const g=new te.Watch;g.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(p),g.stop(this.pendingSubscriptionWatchLabel),i(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=jg&&(clearInterval(p),g.stop(this.pendingSubscriptionWatchLabel),f(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const i=Vn(n);await this.rpcUnsubscribe(e,t,i);const f=Ze("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,f),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,t){const n={method:Gn(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await pa(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tt.connection_stalled)}return Xr(e+this.clientId)}rpcUnsubscribe(e,t,n){const i={method:Gn(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,t){this.setSubscription(e,Pn(zr({},t),{id:e})),this.pending.delete(t.topic)}onResubscribe(e,t){this.addSubscription(e,Pn(zr({},t),{id:e})),this.pending.delete(t.topic)}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,zr({},t)),this.topicMap.set(t.topic,e),this.events.emit(It.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(It.deleted,Pn(zr({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:t,relay:n}=e,i={topic:t,relay:n};this.pending.set(i.topic,i);const f=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(f,i)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const t=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(t,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(tt.connect,async()=>{await this.onConnect()}),this.relayer.on(tt.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const t=It.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const t=It.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var ty=Object.defineProperty,Vs=Object.getOwnPropertySymbols,ry=Object.prototype.hasOwnProperty,ny=Object.prototype.propertyIsEnumerable,Gs=(r,e,t)=>e in r?ty(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,iy=(r,e)=>{for(var t in e||(e={}))ry.call(e,t)&&Gs(r,t,e[t]);if(Vs)for(var t of Vs(e))ny.call(e,t)&&Gs(r,t,e[t]);return r};class sy extends lu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ot.exports.EventEmitter,this.name=Ng,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Zr(Se.getDefaultLoggerOptions({level:e.logger||Ag})),this.messages=new Gg(this.logger,e.core),this.subscriber=new ey(this,this.logger),this.publisher=new Wg(this,this.logger),this.relayUrl=e?.relayUrl||Ma,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t})}async subscribe(e,t){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(It.created,f=>{f.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,t),i()})]),n}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(tt.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(It.resubscribed,()=>{t()})}),await Promise.race([new Promise(async t=>{await this.provider.connect(),this.removeListener(tt.transport_closed,this.rejectTransportOpen),t()}),new Promise(t=>this.once(tt.transport_closed,this.rejectTransportOpen))])])}catch(t){const n=t;if(!/socket hang up/i.test(n.message))throw t;this.logger.error(t),this.events.emit(tt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(t=>setTimeout(t,qs)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Cr(new Wd($l({sdkVersion:Rg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:t,message:n}=e;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),di(e)){if(!e.method.endsWith(Cg))return;const t=e.params,{topic:n,message:i}=t.data,f={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(iy({type:"event",event:t.id},f)),this.events.emit(t.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=li(e.id,!0);await this.provider.connection.send(t)}registerEventListeners(){this.provider.on(qr.payload,e=>this.onProviderPayload(e)),this.provider.on(qr.connect,()=>{this.events.emit(tt.connect)}),this.provider.on(qr.disconnect,()=>{this.events.emit(tt.disconnect),this.attemptToReconnect()}),this.provider.on(qr.error,e=>this.events.emit(tt.error,e)),this.events.on(tt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},te.toMiliseconds(qs))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var oy=Object.defineProperty,Ws=Object.getOwnPropertySymbols,ay=Object.prototype.hasOwnProperty,cy=Object.prototype.propertyIsEnumerable,ks=(r,e,t)=>e in r?oy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ys=(r,e)=>{for(var t in e||(e={}))ay.call(e,t)&&ks(r,t,e[t]);if(Ws)for(var t of Ws(e))cy.call(e,t)&&ks(r,t,e[t]);return r};class ln extends du{constructor(e,t,n,i=$t,f=void 0){super(e,t,n,i),this.core=e,this.logger=t,this.name=n,this.map=new Map,this.version=Fg,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{od(g)?this.map.set(g.id,g):ad(g)?this.map.set(g.topic,g):this.getKey&&g!==null&&!ct(g)&&this.map.set(this.getKey(g),g)}),this.cached=[],this.initialized=!0)},this.set=async(g,p)=>{this.isInitialized(),this.map.has(g)?await this.update(g,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:p}),this.map.set(g,p),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(p=>Object.keys(g).every(_=>kd(p[_],g[_]))):this.values),this.update=async(g,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:p});const _=Ys(Ys({},this.getData(g)),p);this.map.set(g,_),await this.persist()},this.delete=async(g,p)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:p}),this.map.delete(g),await this.persist())},this.logger=Se.generateChildLogger(t,this.name),this.storagePrefix=i,this.getKey=f}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class uy{constructor(e,t){this.core=e,this.logger=t,this.name=Mg,this.version=$g,this.events=new ot.exports,this.initialized=!1,this.storagePrefix=$t,this.ignoredPayloadTypes=[Qt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Kn(),i=await this.core.crypto.setSymKey(n),f=xt(te.FIVE_MINUTES),g={protocol:ja},p={topic:i,expiry:f,relay:g,active:!1},_=Jl({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:g});return await this.pairings.set(i,p),await this.core.relayer.subscribe(i),this.core.expirer.set(i,f),{topic:i,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:f,relay:g}=kl(n.uri),p=xt(te.FIVE_MINUTES),_={topic:i,relay:g,expiry:p,active:!1};return await this.pairings.set(i,_),await this.core.crypto.setSymKey(f,i),await this.core.relayer.subscribe(i,{relay:g}),this.core.expirer.set(i,p),n.activatePairing&&await this.activate({topic:i}),_},this.activate=async({topic:n})=>{this.isInitialized();const i=xt(te.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const f=await this.sendRequest(i,"wc_pairingPing",{}),{done:g,resolve:p,reject:_}=Jt();this.events.once(je("pairing_ping",f),({error:S})=>{S?_(S):p()}),await g()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ze("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,f)=>{const g=un(i,f),p=await this.core.crypto.encode(n,g),_=br[i].req;return this.core.history.set(n,g),await this.core.relayer.publish(n,p,_),g.id},this.sendResult=async(n,i,f)=>{const g=li(n,f),p=await this.core.crypto.encode(i,g),_=await this.core.history.get(i,n),S=br[_.request.method].res;await this.core.relayer.publish(i,p,S),await this.core.history.resolve(g)},this.sendError=async(n,i,f)=>{const g=hn(n,f),p=await this.core.crypto.encode(i,g),_=await this.core.history.get(i,n),S=br[_.request.method]?br[_.request.method].res:br.unregistered_method.res;await this.core.relayer.publish(i,p,S),await this.core.history.resolve(g)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ze("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>jt(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:f}=n,g=f.method;if(this.pairings.keys.includes(i))switch(g){case"wc_pairingPing":return this.onPairingPingRequest(i,f);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,f);default:return this.onUnknownRpcMethodRequest(i,f)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:f}=n,g=(await this.core.history.get(i,f.id)).request.method;if(this.pairings.keys.includes(i))switch(g){case"wc_pairingPing":return this.onPairingPingResponse(i,f);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(n,i)=>{const{id:f}=i;try{this.isValidPing({topic:n}),await this.sendResult(f,n,!0),this.events.emit("pairing_ping",{id:f,topic:n})}catch(g){await this.sendError(f,n,g),this.logger.error(g)}},this.onPairingPingResponse=(n,i)=>{const{id:f}=i;setTimeout(()=>{Ct(i)?this.events.emit(je("pairing_ping",f),{}):Et(i)&&this.events.emit(je("pairing_ping",f),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:f}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:f,topic:n})}catch(g){await this.sendError(f,n,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:f,method:g}=i;try{if(this.registeredMethods.includes(g))return;const p=Ze("WC_METHOD_UNSUPPORTED",g);await this.sendError(f,n,p),this.logger.error(p)}catch(p){await this.sendError(f,n,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ze("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ut(n)){const{message:i}=J("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!sd(n.uri)){const{message:i}=J("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!ut(n)){const{message:f}=J("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(f)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!ut(n)){const{message:f}=J("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(f)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!Qe(n,!1)){const{message:i}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(jt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=J("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.pairings=new ln(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:t,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(t,n);di(i)?(this.core.history.set(t,i),this.onRelayEventRequest({topic:t,payload:i})):pi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:t,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(mt.expired,async e=>{const{topic:t}=ya(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class hy extends uu{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new ot.exports.EventEmitter,this.name=Bg,this.version=Hg,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,f)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:f}),this.records.has(i.id))return;const g={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:f};this.records.set(g.id,g),this.events.emit(Ot.created,g)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Et(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Ot.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(f=>{if(f.topic===n){if(typeof i<"u"&&f.id!==i)return;this.records.delete(f.id),this.events.emit(Ot.deleted,f)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:un(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ot.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ot.created,e=>{const t=Ot.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Ot.updated,e=>{const t=Ot.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Ot.deleted,e=>{const t=Ot.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class fy extends gu{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new ot.exports.EventEmitter,this.name=qg,this.version=zg,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const f=this.formatTarget(n),g={target:f,expiry:i};this.expirations.set(f,g),this.checkExpiry(f,g),this.events.emit(mt.created,{target:f,expiration:g})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),f=this.getExpiration(i);this.expirations.delete(i),this.events.emit(mt.deleted,{target:i,expiration:f})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Bl(e);if(typeof e=="number")return Hl(e);const{message:t}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(mt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;te.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(mt.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(mt.created,e=>{const t=mt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(mt.expired,e=>{const t=mt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(mt.deleted,e=>{const t=mt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ly=Object.defineProperty,Js=Object.getOwnPropertySymbols,dy=Object.prototype.hasOwnProperty,py=Object.prototype.propertyIsEnumerable,Xs=(r,e,t)=>e in r?ly(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zs=(r,e)=>{for(var t in e||(e={}))dy.call(e,t)&&Xs(r,t,e[t]);if(Js)for(var t of Js(e))py.call(e,t)&&Xs(r,t,e[t]);return r};class yi extends cu{constructor(e){super(e),this.protocol=Ua,this.version=mg,this.name=gi,this.events=new ot.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Ma;const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Zr(Se.getDefaultLoggerOptions({level:e?.logger||vg.logger}));this.logger=Se.generateChildLogger(t,this.name),this.heartbeat=new Or.HeartBeat,this.crypto=new Vg(this,this.logger,e?.keychain),this.history=new hy(this,this.logger),this.expirer=new fy(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Wc(Zs(Zs({},wg),e?.storageOptions)),this.relayer=new sy({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new uy(this,this.logger)}static async init(e){const t=new yi(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const gy=yi,$a="wc",Ba=2,Ha="client",_i=`${$a}@${Ba}:${Ha}:`,Tn={name:Ha,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},yy="proposal",_y="session",Kr=te.SEVEN_DAYS,by="engine",mr={wc_sessionPropose:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1104},res:{ttl:te.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1106},res:{ttl:te.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1112},res:{ttl:te.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1115}}},An={min:te.FIVE_MINUTES,max:te.SEVEN_DAYS},my="request";var vy=Object.defineProperty,wy=Object.defineProperties,Ey=Object.getOwnPropertyDescriptors,Qs=Object.getOwnPropertySymbols,Dy=Object.prototype.hasOwnProperty,Sy=Object.prototype.propertyIsEnumerable,eo=(r,e,t)=>e in r?vy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,bt=(r,e)=>{for(var t in e||(e={}))Dy.call(e,t)&&eo(r,t,e[t]);if(Qs)for(var t of Qs(e))Sy.call(e,t)&&eo(r,t,e[t]);return r},Nn=(r,e)=>wy(r,Ey(e));class Oy extends _u{constructor(e){super(e),this.name=by,this.events=new ot.exports,this.initialized=!1,this.ignoredPayloadTypes=[Qt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(mr)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const n=Nn(bt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:f,optionalNamespaces:g,sessionProperties:p,relays:_}=n;let S=i,I,N=!1;if(S&&(N=this.client.core.pairing.pairings.get(S).active),!S||!N){const{topic:O,uri:m}=await this.client.core.pairing.create();S=O,I=m}const j=await this.client.core.crypto.generateKeyPair(),C=bt({requiredNamespaces:f,optionalNamespaces:g,relays:_??[{protocol:ja}],proposer:{publicKey:j,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:P,resolve:M,done:B}=Jt();if(this.events.once(je("session_connect"),async({error:O,session:m})=>{if(O)P(O);else if(m){m.self.publicKey=j;const E=Nn(bt({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,E),await this.setExpiry(m.topic,m.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:m.peer.metadata}),M(E)}}),!S){const{message:O}=J("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(O)}const G=await this.sendRequest(S,"wc_sessionPropose",C),v=xt(te.FIVE_MINUTES);return await this.setProposal(G,bt({id:G,expiry:v},C)),{uri:I,approval:B}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:i,namespaces:f,sessionProperties:g}=t,p=this.client.proposal.get(n);let{pairingTopic:_,proposer:S,requiredNamespaces:I,optionalNamespaces:N}=p;wr(I)||(I=ed(f,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),C=S.publicKey,P=await this.client.core.crypto.generateSharedKey(j,C);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:S.metadata}),await this.sendResult(n,_,{relay:{protocol:i??"irn"},responderPublicKey:j}),await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const M=bt({relay:{protocol:i??"irn"},namespaces:f,requiredNamespaces:I,optionalNamespaces:N,controller:{publicKey:j,metadata:this.client.metadata},expiry:xt(Kr)},g&&{sessionProperties:g});await this.client.core.relayer.subscribe(P);const B=await this.sendRequest(P,"wc_sessionSettle",M),{done:G,resolve:v,reject:O}=Jt();this.events.once(je("session_approve",B),({error:E})=>{E?O(E):v(this.client.session.get(P))});const m=Nn(bt({},M),{topic:P,acknowledged:!1,self:M.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:j});return await this.client.session.set(P,m),await this.setExpiry(P,xt(Kr)),{topic:P,acknowledged:G}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:n,reason:i}=t,{pairingTopic:f}=this.client.proposal.get(n);f&&(await this.sendError(n,f,i),await this.client.proposal.delete(n,Ze("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:i}=t,f=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:g,resolve:p,reject:_}=Jt();return this.events.once(je("session_update",f),({error:S})=>{S?_(S):p()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:g}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:f,resolve:g,reject:p}=Jt();return this.events.once(je("session_extend",i),({error:_})=>{_?p(_):g()}),await this.setExpiry(n,xt(Kr)),{acknowledged:f}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:i,topic:f,expiry:g}=t,p=await this.sendRequest(f,"wc_sessionRequest",{request:i,chainId:n},g),{done:_,resolve:S,reject:I}=Jt(g);return this.events.once(je("session_request",p),({error:N,result:j})=>{N?I(N):S(j)}),this.client.events.emit("session_request_sent",{topic:f,request:i,chainId:n}),await _()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:i}=t,{id:f}=i;Ct(i)?await this.sendResult(f,n,i.result):Et(i)&&await this.sendError(f,n,i.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:f,resolve:g,reject:p}=Jt();this.events.once(je("session_ping",i),({error:_})=>{_?p(_):g()}),await f()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:i,chainId:f}=t;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:f})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ze("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>nd(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(t,n)=>{const{self:i}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,Ze("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(t),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,Ze("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),i?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=mr.wc_sessionRequest.req.ttl,{id:i,topic:f,params:g}=t;await this.client.pendingRequest.set(i,{id:i,topic:f,params:g}),n&&this.client.core.expirer.set(i,xt(n))},this.sendRequest=async(t,n,i,f)=>{const g=un(n,i),p=await this.client.core.crypto.encode(t,g),_=mr[n].req;return f&&(_.ttl=f),this.client.core.history.set(t,g),this.client.core.relayer.publish(t,p,_),g.id},this.sendResult=async(t,n,i)=>{const f=li(t,i),g=await this.client.core.crypto.encode(n,f),p=await this.client.core.history.get(n,t),_=mr[p.request.method].res;this.client.core.relayer.publish(n,g,_),await this.client.core.history.resolve(f)},this.sendError=async(t,n,i)=>{const f=hn(t,i),g=await this.client.core.crypto.encode(n,f),p=await this.client.core.history.get(n,t),_=mr[p.request.method].res;this.client.core.relayer.publish(n,g,_),await this.client.core.history.resolve(f)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(i=>{jt(i.expiry)&&t.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{jt(i.expiry)&&n.push(i.id)}),await Promise.all([...t.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=t=>{const{topic:n,payload:i}=t,f=i.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:i}=t,f=(await this.client.core.history.get(n,i.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onSessionProposeRequest=async(t,n)=>{const{params:i,id:f}=n;try{this.isValidConnect(bt({},n.params));const g=xt(te.FIVE_MINUTES),p=bt({id:f,pairingTopic:t,expiry:g},i);await this.setProposal(f,p),this.client.events.emit("session_proposal",{id:f,params:p})}catch(g){await this.sendError(f,t,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(t,n)=>{const{id:i}=n;if(Ct(n)){const{result:f}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const g=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const p=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const _=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const S=await this.client.core.crypto.generateSharedKey(p,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const I=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:t})}else Et(n)&&(await this.client.proposal.delete(i,Ze("USER_DISCONNECTED")),this.events.emit(je("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:i,params:f}=n;try{this.isValidSessionSettleRequest(f);const{relay:g,controller:p,expiry:_,namespaces:S,requiredNamespaces:I,optionalNamespaces:N,sessionProperties:j}=n.params,C=bt({topic:t,relay:g,expiry:_,namespaces:S,acknowledged:!0,requiredNamespaces:I,optionalNamespaces:N,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},j&&{sessionProperties:j});await this.sendResult(n.id,t,!0),this.events.emit(je("session_connect"),{session:C})}catch(g){await this.sendError(i,t,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(t,n)=>{const{id:i}=n;Ct(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(je("session_approve",i),{})):Et(n)&&(await this.client.session.delete(t,Ze("USER_DISCONNECTED")),this.events.emit(je("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:i,id:f}=n;try{this.isValidUpdate(bt({topic:t},i)),await this.client.session.update(t,{namespaces:i.namespaces}),await this.sendResult(f,t,!0),this.client.events.emit("session_update",{id:f,topic:t,params:i})}catch(g){await this.sendError(f,t,g),this.client.logger.error(g)}},this.onSessionUpdateResponse=(t,n)=>{const{id:i}=n;Ct(n)?this.events.emit(je("session_update",i),{}):Et(n)&&this.events.emit(je("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:i}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,xt(Kr)),await this.sendResult(i,t,!0),this.client.events.emit("session_extend",{id:i,topic:t})}catch(f){await this.sendError(i,t,f),this.client.logger.error(f)}},this.onSessionExtendResponse=(t,n)=>{const{id:i}=n;Ct(n)?this.events.emit(je("session_extend",i),{}):Et(n)&&this.events.emit(je("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:i}=n;try{this.isValidPing({topic:t}),await this.sendResult(i,t,!0),this.client.events.emit("session_ping",{id:i,topic:t})}catch(f){await this.sendError(i,t,f),this.client.logger.error(f)}},this.onSessionPingResponse=(t,n)=>{const{id:i}=n;setTimeout(()=>{Ct(n)?this.events.emit(je("session_ping",i),{}):Et(n)&&this.events.emit(je("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),this.client.core.relayer.once(tt.publish,async()=>{await this.deleteSession(t)}),await this.sendResult(i,t,!0),this.client.events.emit("session_delete",{id:i,topic:t})}catch(f){await this.sendError(i,t,f),this.client.logger.error(f)}},this.onSessionRequest=async(t,n)=>{const{id:i,params:f}=n;try{this.isValidRequest(bt({topic:t},f)),await this.setPendingSessionRequest({id:i,topic:t,params:f}),this.client.events.emit("session_request",{id:i,topic:t,params:f})}catch(g){await this.sendError(i,t,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(t,n)=>{const{id:i}=n;Ct(n)?this.events.emit(je("session_request",i),{result:n.result}):Et(n)&&this.events.emit(je("session_request",i),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:i,params:f}=n;try{this.isValidEmit(bt({topic:t},f)),this.client.events.emit("session_event",{id:i,topic:t,params:f})}catch(g){await this.sendError(i,t,g),this.client.logger.error(g)}},this.isValidConnect=async t=>{if(!ut(t)){const{message:_}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:f,sessionProperties:g,relays:p}=t;if(ct(n)||await this.isValidPairingTopic(n),!gd(p,!0)){const{message:_}=J("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(_)}!ct(i)&&wr(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!ct(f)&&wr(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),ct(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(t,n)=>{const i=pd(t,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async t=>{if(!ut(t))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:i,relayProtocol:f,sessionProperties:g}=t;await this.isValidProposalId(n);const p=this.client.proposal.get(n),_=Wr(i,"approve()");if(_)throw new Error(_.message);const S=In(p.requiredNamespaces,i,"approve()","requiredNamespaces");if(S)throw new Error(S.message);if(!Qe(f,!0)){const{message:I}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(I)}if(Object.keys(i).length>Object.keys(p.requiredNamespaces).length){const I=Object.keys(p.optionalNamespaces).filter(C=>i[C]),N={};for(const C in p.optionalNamespaces)I.includes(C)&&(N[C]=p.optionalNamespaces[C]);const j=In(N,i,"approve()","optionalNamespaces");if(j)throw new Error(j.message)}ct(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async t=>{if(!ut(t)){const{message:f}=J("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(f)}const{id:n,reason:i}=t;if(await this.isValidProposalId(n),!_d(i)){const{message:f}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(f)}},this.isValidSessionSettleRequest=t=>{if(!ut(t)){const{message:S}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(S)}const{relay:n,controller:i,namespaces:f,expiry:g}=t;if(!ba(n)){const{message:S}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const p=cd(i,"onSessionSettleRequest()");if(p)throw new Error(p.message);const _=Wr(f,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(jt(g)){const{message:S}=J("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async t=>{if(!ut(t)){const{message:_}=J("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:n,namespaces:i}=t;await this.isValidSessionTopic(n);const f=this.client.session.get(n),g=Wr(i,"update()");if(g)throw new Error(g.message);const p=In(f.requiredNamespaces,i,"update()","requiredNamespaces");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!ut(t)){const{message:i}=J("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!ut(t)){const{message:_}=J("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:n,request:i,chainId:f,expiry:g}=t;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Ps(p,f)){const{message:_}=J("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(_)}if(!bd(i)){const{message:_}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(_)}if(!wd(p,f,i.method)){const{message:_}=J("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(_)}if(g&&!Dd(g,An)){const{message:_}=J("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${An.min} and ${An.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!ut(t)){const{message:f}=J("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(f)}const{topic:n,response:i}=t;if(await this.isValidSessionTopic(n),!md(i)){const{message:f}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(f)}},this.isValidPing=async t=>{if(!ut(t)){const{message:i}=J("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!ut(t)){const{message:p}=J("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:n,event:i,chainId:f}=t;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!Ps(g,f)){const{message:p}=J("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(p)}if(!vd(i)){const{message:p}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(p)}if(!Ed(g,f,i.name)){const{message:p}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!ut(t)){const{message:i}=J("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(i)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(i=>{if(!Qe(i,!1)){const{message:f}=J("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(f)}})}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(tt.message,async e=>{const{topic:t,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(t,n);di(i)?(this.client.core.history.set(t,i),this.onRelayEventRequest({topic:t,payload:i})):pi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:t,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(mt.expired,async e=>{const{topic:t,id:n}=ya(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,J("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(jt(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:t}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(jt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=J("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:t}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!yd(e)){const{message:t}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(jt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=J("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class Iy extends ln{constructor(e,t){super(e,t,yy,_i),this.core=e,this.logger=t}}class xy extends ln{constructor(e,t){super(e,t,_y,_i),this.core=e,this.logger=t}}class Py extends ln{constructor(e,t){super(e,t,my,_i),this.core=e,this.logger=t}}class bi extends yu{constructor(e){super(e),this.protocol=$a,this.version=Ba,this.name=Tn.name,this.events=new ot.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||Tn.name,this.metadata=e?.metadata||Ll();const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Zr(Se.getDefaultLoggerOptions({level:e?.logger||Tn.logger}));this.core=e?.core||new gy(e),this.logger=Se.generateChildLogger(t,this.name),this.session=new xy(this.core,this.logger),this.proposal=new Iy(this.core,this.logger),this.pendingRequest=new Py(this.core,this.logger),this.engine=new Oy(this)}static async init(e){const t=new bi(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=xe.getLocation=xe.getLocationOrThrow=xe.getNavigator=xe.getNavigatorOrThrow=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function er(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}xe.getFromWindow=er;function ar(r){const e=er(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}xe.getFromWindowOrThrow=ar;function Ty(){return ar("document")}xe.getDocumentOrThrow=Ty;function Ay(){return er("document")}xe.getDocument=Ay;function Ny(){return ar("navigator")}xe.getNavigatorOrThrow=Ny;function Cy(){return er("navigator")}xe.getNavigator=Cy;function Ry(){return ar("location")}xe.getLocationOrThrow=Ry;function Fy(){return er("location")}xe.getLocation=Fy;function Ly(){return ar("crypto")}xe.getCryptoOrThrow=Ly;function Uy(){return er("crypto")}xe.getCrypto=Uy;function jy(){return ar("localStorage")}xe.getLocalStorageOrThrow=jy;function My(){return er("localStorage")}xe.getLocalStorage=My;var mi={};Object.defineProperty(mi,"__esModule",{value:!0});mi.getWindowMetadata=void 0;const to=xe;function $y(){let r,e;try{r=to.getDocumentOrThrow(),e=to.getLocationOrThrow()}catch{return null}function t(){const N=r.getElementsByTagName("link"),j=[];for(let C=0;C<N.length;C++){const P=N[C],M=P.getAttribute("rel");if(M&&M.toLowerCase().indexOf("icon")>-1){const B=P.getAttribute("href");if(B)if(B.toLowerCase().indexOf("https:")===-1&&B.toLowerCase().indexOf("http:")===-1&&B.indexOf("//")!==0){let G=e.protocol+"//"+e.host;if(B.indexOf("/")===0)G+=B;else{const v=e.pathname.split("/");v.pop(),G+=v.join("/")+"/"+B}j.push(G)}else if(B.indexOf("//")===0){const G=e.protocol+B;j.push(G)}else j.push(B)}}return j}function n(...N){const j=r.getElementsByTagName("meta");for(let C=0;C<j.length;C++){const P=j[C],M=["itemprop","property","name"].map(B=>P.getAttribute(B)).filter(B=>B?N.includes(B):!1);if(M.length&&M){const B=P.getAttribute("content");if(B)return B}}return""}function i(){let N=n("name","og:site_name","og:title","twitter:title");return N||(N=r.title),N}function f(){return n("description","og:description","twitter:description","keywords")}const g=i(),p=f(),_=e.origin,S=t();return{description:p,url:_,icons:S,name:g}}mi.getWindowMetadata=$y;var By={};(function(r){const e=na,t=sa,n=oa,i=aa,f=v=>v==null,g=Symbol("encodeFragmentIdentifier");function p(v){switch(v.arrayFormat){case"index":return O=>(m,E)=>{const y=m.length;return E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),"[",y,"]"].join("")]:[...m,[I(O,v),"[",I(y,v),"]=",I(E,v)].join("")]};case"bracket":return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),"[]"].join("")]:[...m,[I(O,v),"[]=",I(E,v)].join("")];case"colon-list-separator":return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,[I(O,v),":list="].join("")]:[...m,[I(O,v),":list=",I(E,v)].join("")];case"comma":case"separator":case"bracket-separator":{const O=v.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(E,y)=>y===void 0||v.skipNull&&y===null||v.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[I(m,v),O,I(y,v)].join("")]:[[E,I(y,v)].join(v.arrayFormatSeparator)])}default:return O=>(m,E)=>E===void 0||v.skipNull&&E===null||v.skipEmptyString&&E===""?m:E===null?[...m,I(O,v)]:[...m,[I(O,v),"=",I(E,v)].join("")]}}function _(v){let O;switch(v.arrayFormat){case"index":return(m,E,y)=>{if(O=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!O){y[m]=E;return}y[m]===void 0&&(y[m]={}),y[m][O[1]]=E};case"bracket":return(m,E,y)=>{if(O=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!O){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"colon-list-separator":return(m,E,y)=>{if(O=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!O){y[m]=E;return}if(y[m]===void 0){y[m]=[E];return}y[m]=[].concat(y[m],E)};case"comma":case"separator":return(m,E,y)=>{const s=typeof E=="string"&&E.includes(v.arrayFormatSeparator),d=typeof E=="string"&&!s&&N(E,v).includes(v.arrayFormatSeparator);E=d?N(E,v):E;const $=s||d?E.split(v.arrayFormatSeparator).map(o=>N(o,v)):E===null?E:N(E,v);y[m]=$};case"bracket-separator":return(m,E,y)=>{const s=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!s){y[m]=E&&N(E,v);return}const d=E===null?[]:E.split(v.arrayFormatSeparator).map($=>N($,v));if(y[m]===void 0){y[m]=d;return}y[m]=[].concat(y[m],d)};default:return(m,E,y)=>{if(y[m]===void 0){y[m]=E;return}y[m]=[].concat(y[m],E)}}}function S(v){if(typeof v!="string"||v.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(v,O){return O.encode?O.strict?e(v):encodeURIComponent(v):v}function N(v,O){return O.decode?t(v):v}function j(v){return Array.isArray(v)?v.sort():typeof v=="object"?j(Object.keys(v)).sort((O,m)=>Number(O)-Number(m)).map(O=>v[O]):v}function C(v){const O=v.indexOf("#");return O!==-1&&(v=v.slice(0,O)),v}function P(v){let O="";const m=v.indexOf("#");return m!==-1&&(O=v.slice(m)),O}function M(v){v=C(v);const O=v.indexOf("?");return O===-1?"":v.slice(O+1)}function B(v,O){return O.parseNumbers&&!Number.isNaN(Number(v))&&typeof v=="string"&&v.trim()!==""?v=Number(v):O.parseBooleans&&v!==null&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")&&(v=v.toLowerCase()==="true"),v}function G(v,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),S(O.arrayFormatSeparator);const m=_(O),E=Object.create(null);if(typeof v!="string"||(v=v.trim().replace(/^[?#&]/,""),!v))return E;for(const y of v.split("&")){if(y==="")continue;let[s,d]=n(O.decode?y.replace(/\+/g," "):y,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?d:N(d,O),m(N(s,O),d,E)}for(const y of Object.keys(E)){const s=E[y];if(typeof s=="object"&&s!==null)for(const d of Object.keys(s))s[d]=B(s[d],O);else E[y]=B(s,O)}return O.sort===!1?E:(O.sort===!0?Object.keys(E).sort():Object.keys(E).sort(O.sort)).reduce((y,s)=>{const d=E[s];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?y[s]=j(d):y[s]=d,y},Object.create(null))}r.extract=M,r.parse=G,r.stringify=(v,O)=>{if(!v)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),S(O.arrayFormatSeparator);const m=d=>O.skipNull&&f(v[d])||O.skipEmptyString&&v[d]==="",E=p(O),y={};for(const d of Object.keys(v))m(d)||(y[d]=v[d]);const s=Object.keys(y);return O.sort!==!1&&s.sort(O.sort),s.map(d=>{const $=v[d];return $===void 0?"":$===null?I(d,O):Array.isArray($)?$.length===0&&O.arrayFormat==="bracket-separator"?I(d,O)+"[]":$.reduce(E(d),[]).join("&"):I(d,O)+"="+I($,O)}).filter(d=>d.length>0).join("&")},r.parseUrl=(v,O)=>{O=Object.assign({decode:!0},O);const[m,E]=n(v,"#");return Object.assign({url:m.split("?")[0]||"",query:G(M(v),O)},O&&O.parseFragmentIdentifier&&E?{fragmentIdentifier:N(E,O)}:{})},r.stringifyUrl=(v,O)=>{O=Object.assign({encode:!0,strict:!0,[g]:!0},O);const m=C(v.url).split("?")[0]||"",E=r.extract(v.url),y=r.parse(E,{sort:!1}),s=Object.assign(y,v.query);let d=r.stringify(s,O);d&&(d=`?${d}`);let $=P(v.url);return v.fragmentIdentifier&&($=`#${O[g]?I(v.fragmentIdentifier,O):v.fragmentIdentifier}`),`${m}${d}${$}`},r.pick=(v,O,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[g]:!1},m);const{url:E,query:y,fragmentIdentifier:s}=r.parseUrl(v,m);return r.stringifyUrl({url:E,query:i(y,O),fragmentIdentifier:s},m)},r.exclude=(v,O,m)=>{const E=Array.isArray(O)?y=>!O.includes(y):(y,s)=>!O(y,s);return r.pick(v,E,m)}})(By);const Hy={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function ro(r,e){const{message:t,code:n}=Hy[r];return{message:e?`${t} ${e}`:t,code:n}}function qy(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}var Jn={exports:{}};(function(r,e){var t=typeof self<"u"?self:Ae,n=function(){function f(){this.fetch=!1,this.DOMException=t.DOMException}return f.prototype=t,new f}();(function(f){(function(g){var p={searchParams:"URLSearchParams"in f,iterable:"Symbol"in f&&"iterator"in Symbol,blob:"FileReader"in f&&"Blob"in f&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in f,arrayBuffer:"ArrayBuffer"in f};function _(a){return a&&DataView.prototype.isPrototypeOf(a)}if(p.arrayBuffer)var S=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(a){return a&&S.indexOf(Object.prototype.toString.call(a))>-1};function N(a){if(typeof a!="string"&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function j(a){return typeof a!="string"&&(a=String(a)),a}function C(a){var c={next:function(){var D=a.shift();return{done:D===void 0,value:D}}};return p.iterable&&(c[Symbol.iterator]=function(){return c}),c}function P(a){this.map={},a instanceof P?a.forEach(function(c,D){this.append(D,c)},this):Array.isArray(a)?a.forEach(function(c){this.append(c[0],c[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(c){this.append(c,a[c])},this)}P.prototype.append=function(a,c){a=N(a),c=j(c);var D=this.map[a];this.map[a]=D?D+", "+c:c},P.prototype.delete=function(a){delete this.map[N(a)]},P.prototype.get=function(a){return a=N(a),this.has(a)?this.map[a]:null},P.prototype.has=function(a){return this.map.hasOwnProperty(N(a))},P.prototype.set=function(a,c){this.map[N(a)]=j(c)},P.prototype.forEach=function(a,c){for(var D in this.map)this.map.hasOwnProperty(D)&&a.call(c,this.map[D],D,this)},P.prototype.keys=function(){var a=[];return this.forEach(function(c,D){a.push(D)}),C(a)},P.prototype.values=function(){var a=[];return this.forEach(function(c){a.push(c)}),C(a)},P.prototype.entries=function(){var a=[];return this.forEach(function(c,D){a.push([D,c])}),C(a)},p.iterable&&(P.prototype[Symbol.iterator]=P.prototype.entries);function M(a){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}function B(a){return new Promise(function(c,D){a.onload=function(){c(a.result)},a.onerror=function(){D(a.error)}})}function G(a){var c=new FileReader,D=B(c);return c.readAsArrayBuffer(a),D}function v(a){var c=new FileReader,D=B(c);return c.readAsText(a),D}function O(a){for(var c=new Uint8Array(a),D=new Array(c.length),T=0;T<c.length;T++)D[T]=String.fromCharCode(c[T]);return D.join("")}function m(a){if(a.slice)return a.slice(0);var c=new Uint8Array(a.byteLength);return c.set(new Uint8Array(a)),c.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(a){this._bodyInit=a,a?typeof a=="string"?this._bodyText=a:p.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:p.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():p.arrayBuffer&&p.blob&&_(a)?(this._bodyArrayBuffer=m(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||I(a))?this._bodyArrayBuffer=m(a):this._bodyText=a=Object.prototype.toString.call(a):this._bodyText="",this.headers.get("content-type")||(typeof a=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var a=M(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?M(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(G)}),this.text=function(){var a=M(this);if(a)return a;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(O(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function s(a){var c=a.toUpperCase();return y.indexOf(c)>-1?c:a}function d(a,c){c=c||{};var D=c.body;if(a instanceof d){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,c.headers||(this.headers=new P(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,!D&&a._bodyInit!=null&&(D=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=c.credentials||this.credentials||"same-origin",(c.headers||!this.headers)&&(this.headers=new P(c.headers)),this.method=s(c.method||this.method||"GET"),this.mode=c.mode||this.mode||null,this.signal=c.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}d.prototype.clone=function(){return new d(this,{body:this._bodyInit})};function $(a){var c=new FormData;return a.trim().split("&").forEach(function(D){if(D){var T=D.split("="),U=T.shift().replace(/\+/g," "),w=T.join("=").replace(/\+/g," ");c.append(decodeURIComponent(U),decodeURIComponent(w))}}),c}function o(a){var c=new P,D=a.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(T){var U=T.split(":"),w=U.shift().trim();if(w){var R=U.join(":").trim();c.append(w,R)}}),c}E.call(d.prototype);function h(a,c){c||(c={}),this.type="default",this.status=c.status===void 0?200:c.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in c?c.statusText:"OK",this.headers=new P(c.headers),this.url=c.url||"",this._initBody(a)}E.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new P(this.headers),url:this.url})},h.error=function(){var a=new h(null,{status:0,statusText:""});return a.type="error",a};var l=[301,302,303,307,308];h.redirect=function(a,c){if(l.indexOf(c)===-1)throw new RangeError("Invalid status code");return new h(null,{status:c,headers:{location:a}})},g.DOMException=f.DOMException;try{new g.DOMException}catch{g.DOMException=function(c,D){this.message=c,this.name=D;var T=Error(c);this.stack=T.stack},g.DOMException.prototype=Object.create(Error.prototype),g.DOMException.prototype.constructor=g.DOMException}function b(a,c){return new Promise(function(D,T){var U=new d(a,c);if(U.signal&&U.signal.aborted)return T(new g.DOMException("Aborted","AbortError"));var w=new XMLHttpRequest;function R(){w.abort()}w.onload=function(){var K={status:w.status,statusText:w.statusText,headers:o(w.getAllResponseHeaders()||"")};K.url="responseURL"in w?w.responseURL:K.headers.get("X-Request-URL");var z="response"in w?w.response:w.responseText;D(new h(z,K))},w.onerror=function(){T(new TypeError("Network request failed"))},w.ontimeout=function(){T(new TypeError("Network request failed"))},w.onabort=function(){T(new g.DOMException("Aborted","AbortError"))},w.open(U.method,U.url,!0),U.credentials==="include"?w.withCredentials=!0:U.credentials==="omit"&&(w.withCredentials=!1),"responseType"in w&&p.blob&&(w.responseType="blob"),U.headers.forEach(function(K,z){w.setRequestHeader(z,K)}),U.signal&&(U.signal.addEventListener("abort",R),w.onreadystatechange=function(){w.readyState===4&&U.signal.removeEventListener("abort",R)}),w.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return b.polyfill=!0,f.fetch||(f.fetch=b,f.Headers=P,f.Request=d,f.Response=h),g.Headers=P,g.Request=d,g.Response=h,g.fetch=b,Object.defineProperty(g,"__esModule",{value:!0}),g})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,r.exports=e})(Jn,Jn.exports);const no=Nc(Jn.exports);function zy(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function io(r){return typeof r=="string"?r:JSON.stringify(r)}const Ky={Accept:"application/json","Content-Type":"application/json"},Vy="POST",so={headers:Ky,method:Vy},oo=10;class dn{constructor(e){if(this.url=e,this.events=new ot.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!Cs(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const n=io(e),f=await(await no(this.url,Object.assign(Object.assign({},so),{body:n}))).json();this.onPayload({data:f})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!Cs(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,i)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),i(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{const t=io({id:1,jsonrpc:"2.0",method:"test",params:[]});await no(e,Object.assign(Object.assign({},so),{body:t})),this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?zy(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),f=hn(e,i);this.events.emit("payload",f)}parseError(e,t=this.url){return wa(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>oo&&this.events.setMaxListeners(oo)}}const ao="error",Gy="wss://relay.walletconnect.com",Wy="wc",ky="universal_provider",co=`${Wy}@${2}:${ky}:`,Yy="https://rpc.walletconnect.com/v1",Fr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Bt(r,e,t){let n;const i=Xn(r);return e.rpcMap&&(n=e.rpcMap[i]),n||(n=`${Yy}?chainId=eip155:${i}&projectId=${t}`),n}function Xn(r){return r.includes("eip155")?Number(r.split(":")[1]):Number(r)}function Jy(r,e){if(!e.includes(r))throw new Error(`Chain '${r}' not approved. Please use one of the following: ${e.toString()}`)}function Xy(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}const pn=(r,e)=>{const t=n=>{n.request!==e.request||n.topic!==e.topic||(r.events.removeListener("session_request_sent",t),Zy())};r.on("session_request_sent",t)};function Zy(){if(typeof window<"u")try{const r=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(r){const e=JSON.parse(r);window.open(e.href,"_self","noreferrer noopener")}}catch(r){console.error(r)}}class Qy{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var t;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(pn(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const n=Xn(e);if(!this.httpProviders[n]){const i=t||Bt(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,i)}this.chainId=n,this.events.emit(Fr.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||Bt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Cr(new dn(n))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=Xn(t);e[n]=this.createHttpProvider(n)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){const t=parseInt(e,16),n=`${this.name}:${t}`;Jy(n,this.namespace.chains),this.setDefaultChain(`${t}`)}}class e0{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(pn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||Bt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Fr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Bt(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Cr(new dn(n))}}class t0{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(pn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||Bt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Fr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Bt(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Cr(new dn(n))}}class r0{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(pn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||Bt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Fr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||Bt(e,this.namespace);return typeof n>"u"?void 0:new Cr(new dn(n))}}var n0=Object.defineProperty,i0=Object.defineProperties,s0=Object.getOwnPropertyDescriptors,uo=Object.getOwnPropertySymbols,o0=Object.prototype.hasOwnProperty,a0=Object.prototype.propertyIsEnumerable,ho=(r,e,t)=>e in r?n0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vr=(r,e)=>{for(var t in e||(e={}))o0.call(e,t)&&ho(r,t,e[t]);if(uo)for(var t of uo(e))a0.call(e,t)&&ho(r,t,e[t]);return r},Cn=(r,e)=>i0(r,s0(e));class vi{constructor(e){this.events=new ot.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Zr(Se.getDefaultLoggerOptions({level:e?.logger||ao}))}static async init(e){const t=new vi(e);return await t.initialize(),t}async request(e,t){const[n,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Vr({},e),chainId:`${n}:${i}`,topic:this.session.topic})}sendAsync(e,t,n){this.request(e,n).then(i=>t(null,i)).catch(i=>t(i,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:ro("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});return t&&(this.uri=t,this.events.emit("display_uri",t)),this.session=await n(),this.createProviders(),this.onConnect(),this.session}setDefaultChain(e,t){try{const[n,i]=this.validateChain(e);this.getProvider(n).setDefaultChain(i,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(qy(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await bi.init({logger:this.providerOpts.logger||ao,relayUrl:this.providerOpts.relayUrl||Gy,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{var t,n,i;const f=((t=this.session)==null?void 0:t.namespaces[e].accounts)||[],g=Xy(f),p=Cn(Vr({},Object.assign(this.namespaces[e],(i=(n=this.optionalNamespaces)==null?void 0:n[e])!=null?i:{})),{accounts:f,chains:g});switch(e){case"eip155":this.rpcProviders[e]=new Qy({client:this.client,namespace:p,events:this.events});break;case"solana":this.rpcProviders[e]=new e0({client:this.client,namespace:p,events:this.events});break;case"cosmos":this.rpcProviders[e]=new t0({client:this.client,namespace:p,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new r0({client:this.client,namespace:p,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:n}=t;n.name==="accountsChanged"?this.events.emit("accountsChanged",n.data):n.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n;const{namespaces:i}=t,f=(n=this.client)==null?void 0:n.session.get(e);this.session=Cn(Vr({},f),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Cn(Vr({},ro("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Fr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:i}=e;if(!t||!Object.keys(t).length)throw new Error("Namespaces must be not empty");this.namespaces=t,this.optionalNamespaces=n,this.sessionProperties=i,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(e){const[t,n]=e?.split(":")||["",""];if(t&&!Object.keys(this.namespaces).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const i=Object.keys(this.namespaces)[0],f=this.rpcProviders[i].getDefaultChain();return[i,f]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){const[n,i]=this.validateChain(e);t||this.getProvider(n).setDefaultChain(i),this.namespaces[n].defaultChain=i,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i)}onConnect(){this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${co}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${co}/${e}`)}}var c0=globalThis&&globalThis.__awaiter||function(r,e,t,n){function i(f){return f instanceof t?f:new t(function(g){g(f)})}return new(t||(t=Promise))(function(f,g){function p(I){try{S(n.next(I))}catch(N){g(N)}}function _(I){try{S(n.throw(I))}catch(N){g(N)}}function S(I){I.done?f(I.value):i(I.value).then(p,_)}S((n=n.apply(r,e||[])).next())})},u0=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},n,i,f,g;return g={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function p(S){return function(I){return _([S,I])}}function _(S){if(n)throw new TypeError("Generator is already executing.");for(;g&&(g=0,S[0]&&(t=0)),t;)try{if(n=1,i&&(f=S[0]&2?i.return:S[0]?i.throw||((f=i.return)&&f.call(i),0):i.next)&&!(f=f.call(i,S[1])).done)return f;switch(i=0,f&&(S=[S[0]&2,f.value]),S[0]){case 0:case 1:f=S;break;case 4:return t.label++,{value:S[1],done:!1};case 5:t.label++,i=S[1],S=[0];continue;case 7:S=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(S[0]===6||S[0]===2)){t=0;continue}if(S[0]===3&&(!f||S[1]>f[0]&&S[1]<f[3])){t.label=S[1];break}if(S[0]===6&&t.label<f[1]){t.label=f[1],f=S;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(S);break}f[2]&&t.ops.pop(),t.trys.pop();continue}S=e.call(r,t)}catch(I){S=[6,I],i=0}finally{n=f=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},f0={1:"https://ethereum.publicnode.com",5:"https://eth-goerli.g.alchemy.com/v2/yVhq9zPJorAWsw-F87fEabSUl7cCU6z4",11155111:"https://sepolia.infura.io/v3/9f79b2f9274344af90b8d4e244b580ef",137:"https://polygon-rpc.com/",80001:"https://polygon-mumbai.g.alchemy.com/v2/rVI6pOV4irVsrw20cJxc1fxK_1cSeiY0",56:"https://bsc-dataseed.binance.org/",97:"https://data-seed-prebsc-1-s1.binance.org:8545",43114:"https://api.avax.network/ext/bc/C/rpc",43113:"https://api.avax-test.network/ext/bc/C/rpc",250:"https://rpc.fantom.network/",25:"https://evm-cronos.crypto.org",338:"https://evm-t3.cronos.org",42161:"https://arb1.arbitrum.io/rpc",421613:"https://arb-goerli.g.alchemy.com/v2/nFrflomLgsQQL5NWjGileAVqIGGxZWce",10:"https://mainnet.optimism.io"},l0=["eip155:1","eip155:137","eip155:250","eip155:25","eip155:42161","eip155:10"],d0=function(){return c0(void 0,void 0,void 0,function(){return u0(this,function(r){switch(r.label){case 0:return[4,vi.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,r.sent()]}})})};export{f0 as WC_DEFAULT_RPC_MAP,l0 as WC_V2_DEFAULT_CHAINS,d0 as getWalletConnectV2ProviderInstance};
